"use strict";!function(e){function t(n){if(i[n])return i[n].exports;var a=i[n]={i:n,l:!1,exports:{}};return e[n].call(a.exports,a,a.exports,t),a.l=!0,a.exports}var i={};t.m=e,t.c=i,t.d=function(e,i,n){t.o(e,i)||Object.defineProperty(e,i,{configurable:!1,enumerable:!0,get:n})},t.n=function(e){var i=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(i,"a",i),i},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=353)}([function(e,t){e.exports=Backbone},function(e,t){e.exports=jQuery},function(e,t,i){var n=i(362),a=i(5),s=i(18),o=i(363),r=i(10),l=i(66),d=i(39),u=function(){};u.prototype.render=function(e,t){var i=n.twig({data:e});return t=t||{},t.isMobile=window.ivi.adaptive.isMobile,t.isWorld=r.default.isWorld,t.hasSubscription=r.default.hasSubscription,t.abExperiment=s.default,t.app={config:r.default},t.internationalExpansion=d.default,t.declension=l.default,i.render(t)},n.extend(function(e){e.exports.extendTag({type:"stopwatch",regex:/^stopwatch\s+(.+)$/,next:["endstopwatch"],open:!0,parse:function(e,t,i){return{chain:i,output:""}}}),e.exports.extendTag({type:"endstopwatch",regex:/^endstopwatch$/,next:[],open:!1}),e.exports.extendFilter("bbcode_filter",function(e){return o.render(e||"")})}),n.extend(function(e){var t=e.lib.formatDate;e.lib.formatDate=function(e,i){var n="января,февраля,марта,апреля,мая,июня,июля,августа,сентября,октября,ноября,декабря".split(",");return t(e,i.replace(/MMMM/g,n[e.getMonth()]))},e.functions.min=function(e){return a.min(e)},e.functions.max=function(e){return a.max(e)},e.filters.locale_date=e.filters.date,e.filters.credit_card_format=function(e){e=e.replace(/x/g,"•");for(var t=e.length,i=[],n=0;n<t;n+=4)i.push(e.substring(n,n+4));return i.length?i.join(" "):e},e.filters.card_validity=function(t){return t&&t instanceof Date?(t.setMonth(t.getMonth()-1),e.lib.formatDate(t,"m/y")):""},e.filters.money_format=function(t){var i=t-Math.floor(t)>0?2:0;return e.filter("number_format",t,[i,"."," "])},e.filters.specialEscape=function(t,i){if(t){switch(i?i[0]:"comment"){case"bbcode":return o.render(t);case"comment":return e.filter("escape",t).replace(/\/n/g,"<br>");case"review":return o.render(e.filter("escape",t)).replace(/&lt;((\/)?(br|p|strong|em|strike)\s*(\/)?)&gt;/g,"<$1>")}}}}),t.default=new u},function(e,t,i){var n=i(1),a=i(0),s=i(32),o=i(5),r=i(35),l=i(105),d=i(358),u=i(43),c=d;o.extend(c,a.Events);var p,f=n.Deferred(),h=c.track,g=c.trackSearch,m=c.metrics,v=new s.default,_=["page_view","content_watch","trailer_watch"];c.listenTo(l.default,"groot:initialized",function(){f.resolve()}),c.track=function(e,t){var i=this;f.done(function(){t=t||{},t.source&&c.setSource(t.source);var n=r.getByFilter("^ab_.*[^\\d]$");o.isEmpty(n)||(t.abTests=n);var a=u.default.getUserABTests();a&&a.length&&(t.abTests||(t.abTests={}),o.each(a,function(e){t.abTests[e.test_code]=e.group_code})),t.lib=window.ivi.adaptive.isPhone()?"web-mobile":window.ivi.adaptive.isTablet()?"web-tablet":"web",t.is_mobile=v.isMobile(),r.get("internal_source")&&(t.internal_source=r.get("internal_source")),r.get("titr_lastarticle")&&(t.titr_lastarticle=r.get("titr_lastarticle")),o.contains(["buy_click","price_click","price_selection","svod_selection"],e)&&delete t.svod_period,w(e,t),h.bind(i)(e,t)})};var b=function(e,t){r.set(e,t,{expires:864e5,domain:document.domain.replace(/^(.*?)(\w+\.\w+)$/,".$2")})},y=function(e){return r.get(e)},w=function(e,t){-1!==_.indexOf(e)&&(o.extend(t,c.getPromoAndCollectionParams()),c.rewriteSuperProperties(t))};c.setSource=function(e){e&&(b("source",e),c.register_super_properties({source:e}))},c.getSource=function(){return y("source")},c.metrics=function(e,t,i,n){var a=this;f.done(function(){m.bind(a)(e,t,i,n)})},c.trackSearch=function(e,t){var i=this;f.done(function(){g.bind(i)(e,t)})},c.setBlockId=function(e){b("block",e),c.setRecCompilationId(""),c.setRecContentId("")},c.getBlockId=function(){return y("block")};var C=function(e,t){return 10*parseInt(e)+t};c.getMetricsContentId=function(e){return C(e,1)},c.getMetricsCompilationId=function(e){return C(e,2)},c.setRefPage=function(e){void 0===e&&(e=c.getRefPageFromGrootView()),b("ref_page",e)},c.getRefPage=function(){return y("ref_page")},c.setPrevRefPage=function(e){b("prev_ref_page",e)},c.getPrevRefPage=function(){return y("prev_ref_page")},c.getRefPageFromGrootView=function(){return u.default.getRefPage()},c.isTrialAvailable=function(){return u.default.getTrialAvailability()},c.isApplePayAvailable=function(){return u.default.getApplePayAvailability()},c.isUserPesonalizable=function(){return u.default.isUserPesonalizable()},c.getSiteSectionId=function(){return u.default.getSiteSectionId()},c.getPromoAndCollectionParams=function(){return JSON.parse(y("promo_collection_params"))||{}},c.updatePromoAndCollectionParams=function(e){var t=this.getPromoAndCollectionParams();o.extend(t,e),b("promo_collection_params",JSON.stringify(t))},c.setPromoId=function(e){b("promo_id",e)},c.getPromoId=function(){return y("promo_id")},c.setCollectionId=function(e){b("collection_id",e)},c.setRecContentId=function(e){b("rec_content_id",e)},c.setRecCompilationId=function(e){b("rec_compilation_id",e)},c.getRecContentId=function(){return y("rec_content_id")},c.getRecCompilationId=function(){return y("rec_compilation_id")},c.setContentId=function(e){b("content_id",e)},c.setCompilationId=function(e){b("compilation_id",e)},c.getContentId=function(){return y("content_id")},c.getCompilationId=function(){return y("compilation_id")},c.getSuperParams=function(){return["page","ref_page","compilation_id","content_id","authorizeduser","source","block_id","promo_id","collection_id","autoplay","svod_active","renew_active","dobill_active","svod_by_card"]},c.rewriteAutoProperties=function(e){if(e){var t=c.auto_properties;o.each(e,function(i,n){n in t&&(t[n]=e[n])})}},c.rewriteSuperProperties=function(e){var t={};o.each(this.getSuperParams(),function(i){i in e&&(t[i]=e[i])}),Object.keys(t).length&&f.done(function(){c.register_super_properties(t)})},c.clearSuperProperties=function(e){e&&e.length&&f.done(function(){c.unregister_super_properties(e)})},c.getCollectionId=function(){return y("collection_id")},c.setAutoProperties=function(e){if(e){var t=c.auto_properties;o.each(e,function(i,n){t&&t[n]&&(t[n]=e[n])})}},c.setBrowserAndOsData=function(){var e=c.auto_properties;e.$browser=v.getBrowserName(),e.$browser_version=v.getBrowserVersion(),e.$os=v.getOsName(),e.$os_version=v.getOsVersion(),e.$device_model=v.getDeviceName()},c.getBlockIds=function(){if(o.isUndefined(p)){var e=c.getRefPageFromGrootView();p={collectionsBlockId:e+"_collections",promoBlockId:e+"_promo",favouritesBlockId:"main_wanted",favouritesSimilarBlockId:"main_wanted_similar",contentSimilarBlockId:"content_similar",profileShopBlockId:"profile_shop",profileWantedBlockId:"profile_wanted",mainTrailersBlock:"main_trailers_block",mainTrailersThumbnail:"main_trailers_thumbnail"}}return p},c.getSuperProperty=function(e){return c.super_properties&&c.super_properties[e]},c.loadGutmCookie=function(){return c.load_gutm_cookie()},c.setPullDeliveryId=function(e){b("pullDeliveryId",e)},c.getPullDeliveryId=function(){return y("pullDeliveryId")},c.setPullDeliveryTypeId=function(e){b("pullDeliveryTypeId",e)},c.getPullDeliveryTypeId=function(){return y("pullDeliveryTypeId")},t.default=c},function(e,t,i){var n=i(10),a=i(5),s=i(50),o={};o.getViewPort=function(){var e,t;return window.innerHeight?(e=window.innerHeight,t=window.innerWidth):document.documentElement&&document.documentElement.clientHeight?(e=document.documentElement.clientHeight,t=document.documentElement.clientWidth):document.body&&document.body.clientHeight&&(e=document.body.clientHeight,t=document.body.clientWidth),{width:t,height:e}},o.redirect=function(e){n.default.external&&!/https?:\/\//.test(e)&&(e="https://www.ivi.ru"+e),window.location.href=e},o.postRedirect=function(e,t){void 0===t&&(t={});var i=s.default.createElement("form");i.method="POST",i.action=e,a.each(t,function(e,t){var n=s.default.createElement("input");n.type="hidden",n.name=t,n.value=e,i.appendChild(n)}),s.default.appendToBody(i),i.submit()},o.redirectParentWindow=function(e){window.parent.location.href=e},o.open=function(e,t,i){return window.open(e,t,i)},o.postMessage=function(e,t){window.postMessage(e,t)},o.postMessageToOpener=function(e,t){window.opener.postMessage(e,t)},o.postMessageToParent=function(e,t){window.parent.postMessage(e,t)},o.postMessageToIframe=function(e,t,i){e.contentWindow.postMessage(t,i)},o.getLocation=function(){return window.location},o.getTopLocation=function(){return window.top.location},o.reload=function(){window.location.href=window.location.href.replace(window.location.hash,"")},o.forceReload=function(e){void 0===e&&(e=!1),window.location.reload(e)},o.pushHistoryState=function(e,t,i){window.history.pushState(e,t,i)},o.replaceHistoryState=function(e,t,i){window.history.replaceState(e,t,i)},o.getNavigator=function(){return window.navigator},o.getNavigatorPlugins=function(){return window.navigator.plugins},o.getScreenLeft=function(){return void 0!==window.screenLeft?window.screenLeft:screen.left},o.getScreenTop=function(){return void 0!==window.screenTop?window.screenTop:screen.top},o.hasFocus=function(){return!!window.focus},o.getClipboardData=function(){return window.clipboardData},o.getPathname=function(){return window.location.pathname},o.pushToDataLayer=function(e){window.dataLayer&&window.dataLayer.push(e)},o.getProtocol=function(){return window.location.protocol},o.getHost=function(){return window.location.host},o.getOrigin=function(){return window.location.origin},o.isMainPage=function(){return window.location.href===window.location.origin+"/"},o.getPageYOffset=function(){return window.pageYOffset},o.isIE11=function(){return!!navigator.userAgent.match(/Trident.*rv\:11\./)},o.matchMedia=function(e){return window.matchMedia(e).matches},o.mathTrunc=function(e){return e-e%1},o.getPerformance=function(){return window.performance},o.requestAnimationFrame=function(e){window.requestAnimationFrame(e)},o.getSpecialLinks=function(){try{var e=window.specLinks?window.atob(window.specLinks):"{}";return JSON.parse(e)}catch(e){return{}}},t.default=o},function(e,t){e.exports=_},function(e,t,i){var n=i(1),a=i(0),s=i(28),o=i(5),r=i(204),l=i(4),d=function(){this.setUpPseudoRouter(),this.initialize.apply(this)};d.prototype.routes=[],d.extend=s.default.extend,d.prototype.scrollElem=!1,d.prototype.initialize=function(){},d.prototype.run=function(){},d.prototype.pseudoRouteEventHandler=function(){this.enablePseudoRoute&&this.pseudoRouter&&this.pseudoRouter(l.default.getLocation().hash)},d.prototype.emptyQueryParams=function(){window.history&&o.isFunction(window.history.pushState)&&window.history.pushState("","",window.location.origin+window.location.pathname)},d.prototype.execute=function(e,t){var i=this;this.params=t;var a=function(t){i.run(e,t),i.pseudoRouteEventHandler()};i.scrollElem?n(this.scrollElem).each(function(e,t){r.default.createElement(t,a)}):a()},d.prototype.queryParams=s.default.queryParams(window.location.search),d.prototype.decodedQueryParams=s.default.decodeParams(o.clone(d.prototype.queryParams)),d.prototype.setUpPseudoRouter=function(){this.enablePseudoRoute&&void 0!==window.onhashchange&&n(window).on("hashchange",this.pseudoRouteEventHandler.bind(this))},d.prototype.isEmbed=function(){return-1!==l.default.getLocation().href.indexOf("/embeds/")},d.prototype.isProfile=function(){return-1!==l.default.getLocation().href.indexOf("/profile")},o.extend(d.prototype,a.Events),t.default=d},function(e,t,i){var n=i(0);t.default=new n.Model},function(e,t,i){var n=i(1),a=i(205),s=i(14),o=i(28),r=i(5),l=i(7),d=i(35),u=i(65),c=i(19),p=i(4),f=i(140),h=i(11),g=s.default.extend({uri:"/user/info/v5/",emailChangeUri:"/user/change/email/v5/",passwordChangeUri:"/user/change/password/v6/",paymentCredentialsChangeUri:"/user/change/payment_credentials/v5/",freshStoragelessSession:!1,invalidSession:!1,validation:{email:{required:!1,pattern:"email",minLength:1}},authenticationTypes:["email","facebook","vkontakte"],passwordChangeErrorsText:{base:"Не удалось сменить пароль",passwordsNotEqual:"Пароль и подтверждение не совпадают",112:"Задан неверный пароль",allFieldsRequired:"Необходимо задать все поля"},isBuyerCookieName:"is_buyer",isBuyerCookieLifeTime:31536e3,SESSION_OUT_OF_DATE_DAYS:29,balanceModel:new a.default,phoneNumberHelper:new f.default,initialize:function(){s.default.prototype.initialize.call(this),this.preparePostUserParams(),this.listenTo(l.default,"user:logout",this.logout)},logout:function(){this.set("isAuthenticated",!1)},getId:function(){return this.get("id")},getFavCount:function(){return this.get("favCount")},getBrowserTimeZoneInMapiFormat:function(){var e,t=(new Date).getTimezoneOffset()/60;return e=t<=0?"+":"-",Math.abs(t)>9?e+=Math.abs(t):e+="0"+Math.abs(t),e+":00"},getUserLang:function(){var e=p.default.getNavigator();return(e.userLanguage||e.language).slice(0,2)},preparePostUserParams:function(e){this.userPostData=e||{},this.userPostData.tz=this.getBrowserTimeZoneInMapiFormat(),this.userPostData.lang=this.getUserLang()},parse:function(e){if(e.error)return e.error;var t=e.result;return"ok"===t||t.session?t:(t.hasOwnProperty("tz")&&t.hasOwnProperty("storageless")&&!t.storageless&&this.isUserChangeTimeZone(t.tz)&&this.mapiPost({data:{tz:this.getBrowserTimeZoneInMapiFormat(),lang:this.getUserLang()}}),t.isAuthenticated=!1,t.isIdentified=!1,t.isGuest=!0,t.facebook=!1,t.vkontakte=!1,t.yandex=!1,t.phoneAuth=!1,r.each(t.joined,function(e,i){var n=i.split("_")[1];"verimatrix"!==n?(t.isAuthenticated=!0,t.isIdentified=!0,t.isGuest=!1):1===r.size(t.joined)&&(t.isIdentified=!0),"facebook"===n&&(t.facebook=!0),"vkontakte"===n&&(t.vkontakte=!0),"yandex"===n&&(t.yandex=!0),"phone"===n&&(t.phoneAuth=!0)}),t)},isUserChangeTimeZone:function(e){return this.getBrowserTimeZoneInMapiFormat()!==e},isGuest:function(){return!this.isAuthenticated()},isAuthenticated:function(){return this.get("isAuthenticated")},isIdentified:function(){return this.get("isIdentified")},isEmailConfirmed:function(){return!!this.get("confirmed")},setConfirmed:function(e){this.set("confirmed",e)},getName:function(){return this.get("lastname")&&this.get("firstname")?o.default.escapeText(this.get("firstname")+" "+this.get("lastname")):this.get("lastname")||this.get("firstname")?o.default.escapeText(this.get("lastname"))||o.default.escapeText(this.get("firstname")):""},getFirstName:function(){return this.get("firstname")||""},getLastName:function(){return this.get("lastname")||""},getEmail:function(){return this.get("email")||""},getMsisdn:function(){return this.get("msisdn")||""},getPaymentCredentials:function(){return this.get("payment_credentials")},getGender:function(){return this.get("gender")},getBirthday:function(){return this.get("birthday")},getAge:function(){var e=0;if(!this.getBirthday())return e;var t=this.getBirthday().split("-");if(3!==t.length)return e;var i=new Date;return e=i.getFullYear()-parseInt(t[0]),i.getMonth()<parseInt(t[1]-1)?e--:i.getMonth()===parseInt(t[1])&&i.getDate()<parseInt(t[2])&&e--,e},isSubscribed:function(){return!!this.get("subscribed")},isSocialAuth:function(){return this.get("facebook")||this.get("vkontakte")||this.get("yandex")},setName:function(e){var t=e.trim().replace(/\s/," ").split(" "),i=t[0],n=null;t.length>1&&(n=t.slice(1).join(" "));var a=r.extend(r.clone(this.userPostData),{firstname:i,lastname:n});this.processMapiPost(a,l.default,"user","Name")},setEmail:function(e,t){var i=this;this.mapiPost({data:{email_new:e,password:t},uri:this.emailChangeUri}).done(function(t){t.result&&t.result.session&&(u.default.set(t.result.session),i.set("email",e)),i.handleMapiPostResult(l.default,"user","Email",t)})},setPaymentCredentials:function(e){this.mapiPost({data:e,uri:this.paymentCredentialsChangeUri}).done(function(e){e&&"ok"===e.result?l.default.trigger("user:paymentCredentialsChanged",!0):l.default.trigger("user:paymentCredentialsChanged",!1)}).fail(function(){l.default.trigger("user:paymentCredentialsChanged",!1)})},setPassword:function(e,t,i){var n=this;t&&i?t===i?this.mapiPost({data:{password:e,password_new:t,password_repeat:i},uri:this.passwordChangeUri}).done(function(e){e.result&&e.result.session&&u.default.set(e.result.session),n.handleMapiPostResult(l.default,"user","Password",e)}):l.default.trigger("user:setPasswordError","passwordsNotEqual"):l.default.trigger("user:setPasswordError","allFieldsRequired")},setBirthday:function(e){var t=r.extend(r.clone(this.userPostData),{birthday:e});this.processMapiPost(t,l.default,"user","Birthday")},setGender:function(e){var t=r.extend(r.clone(this.userPostData),{gender:e});this.processMapiPost(t,l.default,"user","Gender")},setSubscribed:function(e){var t=r.extend(r.clone(this.userPostData),{subscribed:e?1:0});this.processMapiPost(t,l.default,"user","Subscribtion")},getBalance:function(){return this.get("balance")},isFreshStoragelessSession:function(){return this.freshStoragelessSession},setFreshStoragelessSession:function(e){this.freshStoragelessSession=e},canAuthenticate:function(){if(!this.userCanAuthenticate){var e=r.map(r.keys(this.get("joined")),function(e){var t=e.split("_");return t.length>1?t[1]:null});e&&e.length?this.userCanAuthenticate=r.intersection(e,this.authenticationTypes).length>0:this.userCanAuthenticate=!1}return this.userCanAuthenticate},isPhoneAuth:function(){return this.get("phoneAuth")},getFormattedPhoneNumber:function(){return this.phoneNumberHelper.getFormattedRussianPhone(this.get("msisdn"))},getPhoneNumber:function(){return this.get("msisdn")},setIsBuyerCookie:function(e){if(e&&e.length){e.findWhere({object_type:"content"})&&!d.get(this.isBuyerCookieName)&&d.set(this.isBuyerCookieName,1,{expires:this.isBuyerCookieLifeTime})}},isBuyer:function(){return"1"===d.get(this.isBuyerCookieName)},removeIsBuyerCookie:function(){d.expire(this.isBuyerCookieName)},getTimeZone:function(){return this.get("tz")},getSessionExpirationDate:function(){return this.get("expiration")?new Date(this.get("expiration")):null},getFirstCreatedDate:function(){return this.get("first_created")?new Date(this.get("first_created")):null},getSubscription:function(){return this.get("subscription")},hasSubscription:function(){return!!this.getSubscription()&&this.getSubscription().hasSubscription()},setSubscription:function(e){this.set("subscription",e)},sessionNeedUpdate:function(){var e=!1;if(!this.isFreshStoragelessSession()){var t=this.getSessionExpirationDate();t&&(t.setDate(t.getDate()-this.SESSION_OUT_OF_DATE_DAYS),e=Date.now()>t.getTime())}return e},loadBalance:function(){var e=this,t=n.Deferred();return this.balanceModel.mapiGet().done(function(){e.set("balance",e.balanceModel.getBalance()||0),t.resolve(e.balanceModel)}),t.promise()},isUserPersonalizable:function(){var e=this.get("properties"),t=this.get("is_personalizable");return e&&"is_personalizable"in e?e.is_personalizable:t},isTrialAvailable:function(){var e=this.getFirstCreatedDate(),t=new c.default,i=t.getTrialAvailabilityPeriod();return!e||!i||(e.setDate(e.getDate()+i),Date.now()<=e.getTime())},purchasePersonal:function(e,t,i){var n=e.getMaxUserPrice();if(this.getId()&&this.getBalance()>=n){var a=e.toJSON();return h.default.trigger("purchase:personal",a,t,i?decodeURIComponent(i):null),!0}return!1}});t.default=new g},function(e,t,i){var n=i(6),a=i(19),s=i(434),o=i(10),r=i(35),l=i(435),d=i(4);t.default=n.default.extend({args:{},routes:[],excludeRoutes:[],isExternalController:!1,initApp:function(){if(o.default.isPaywall=!1,o.default.isWorld=!1,o.default.hasSubscription=!1,"function"==typeof window.brandingCallback&&!window.ivi.adaptive.isMobileStyle)try{window.brandingCallback.call()}catch(e){}var e=new a.default,t=parseInt(e.getAppVersion()),i=parseInt(e.getSubsiteId());t&&t!==o.default.mapi.params.app_version&&(o.default.mapi.params.app_version=t),i&&i!==o.default.mapi.params.subsite&&(o.default.mapi.params.subsite=i),o.default.isWorld=e.isWorld(),o.default.isPaywall=e.isPaywall(),r.defaults.domain=document.domain.replace(/^(.*?)(\w+\.\w+)$/,".$2"),o.default.external=this.isExternalController,"fronttest"===o.default.env&&(window.onerror=function(e){window.alert(e)},l.default())},isMatch:function(){var e=this,t=!1;return this.routes.forEach(function(i){var n=new s.default(i),a=d.default.getLocation().pathname;if(n.test(a)){var o=!1;e.excludeRoutes.forEach(function(e){new RegExp(e).test(a)&&(o=!0)}),o||t||(t=!0,e.args=n.extractParams(a))}}),t},launch:function(){this.initApp(),this.execute(this.args)}})},function(e,t){t.default={mapi:{url:"https://api.ivi.ru/mobileapi",params:{subsite:353,app_version:870}},isPaywall:!1,isWorld:!1,hasSubscription:!1,external:!1,payments:{spasibo_payment_desktop_app_version:10594,spasibo_scoring_desktop_app_version:10750,spasibo_payment_mobile_app_version:10751,spasibo_scoring_mobile_app_version:10752},player:{free:{url:"//www.ivi.ru/video/player?_isB2C=1",siteId:"s353"},paid:{url:"//www.ivi.ru/video/pay/player?_isB2C=1",siteId:"s353"},light:{url:"//www.ivi.ru/video/playerlight",siteId:"s353"},trailer:{url:"//www.ivi.ru/video/player?_isB2C=1",siteId:"s353"},embed:{url:"/embeds/"},params:{width:"978px",height:"550px",lightUrl:"https://api.ivi.ru/light/",mapiUrl:"https://api.ivi.ru/mobileapi",loggerUrl:"https://l.ivi.ru/logger/"}},groot:{host:"https://groot.ivi.ru"},rocket:{host:"https://rocket.ivi.ru"},env:"prod",facebook:{client_id:0x7ad2a334eb56,display:"popup",redirect_uri:"/auth/facebook",response_type:"token",scope:"public_profile,user_friends,email"},vk:{client_id:1955190,display:"popup",redirect_uri:"/auth/vk",response_type:"token",scope:"offline,friends,email",v:5.44},yandex:{client_id:"ecdd6a42a8c94d9a9c51081b9294dcac",display:"popup",redirect_uri:"/auth/yandex",response_type:"token"},host:"//www.ivi.ru",static:{host:"https://st.tivision.ru"},pullworker:{url:"https://api.ivi.ru/pull"},oauth2:{base_url:"https://oauth.ivi.lan/",js_url:"https://oauth.ivi.ru/"}}},function(e,t,i){var n=i(0);t.default=new n.Model({})},function(e,t,i){var n=i(81),a=i(211),s=i(147),o=i(224),r=i(225),l=i(151),d=i(152),u=i(231),c=i(232),p=i(153),f=i(233),h=i(235),g=i(154),m=i(236),v=i(157),_=i(238),b=i(9),y=i(239),w=i(247),C=i(248),k=i(457),P=i(461),S=i(464),T=i(4);t.default=b.default.extend({isMatch:function(){return!0},run:function(){var e=T.default.getLocation().pathname||"",t=["/buy.*","/embeds.*","/auth.*"],i=new RegExp(t.join("|")),b=i.test(e);n.default.check(),(new c.default).execute(),(new y.default).execute(),(new h.default).execute(),(new f.default).execute(),(new a.default).execute(),(new l.default).execute(),(new g.default).execute(),(new m.default).execute(),(new u.default).execute(),(new o.default).execute(),(new v.default).execute(b),(new r.default).execute(),(new w.default).execute(),(new d.default).execute(),(new s.default).execute(),(new C.default).execute(),(new p.default).execute(),(new S.default).execute(),b||((new _.default).execute(),(new k.default).execute(),(new P.default).execute())}})},function(e,t,i){"use strict";function n(e,t,i,n,s,o,r,l){if(a(t),!e){var d;if(void 0===t)d=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var u=[i,n,s,o,r,l],c=0;d=new Error(t.replace(/%s/g,function(){return u[c++]})),d.name="Invariant Violation"}throw d.framesToPop=1,d}}var a=function(e){};e.exports=n},function(e,t,i){var n=i(0),a=i(206);t.default=n.Model.extend(a.default)},function(e,t,i){"use strict";function n(e){for(var t=arguments.length-1,i="Minified React error #"+e+"; visit http://facebook.github.io/react/docs/error-decoder.html?invariant="+e,n=0;n<t;n++)i+="&args[]="+encodeURIComponent(arguments[n+1]);i+=" for the full message or use the non-minified dev environment for full errors and additional helpful warnings.";var a=new Error(i);throw a.name="Invariant Violation",a.framesToPop=1,a}e.exports=n},function(e,t,i){var n=i(1),a=i(207),s=i(82),o=i(4),r=i(368);t.default=a.extend({openEvent:"",closeEvent:"",modalId:"",cancelEl:".js-modal-close",mobileModal:!1,mobileScroll:!1,mobileBodyClass:"",mobileModalClass:"has-mobile-modal",bodyClass:null,fullAnimation:!1,FULL_ANIMATION_WRAPPER_STYLES:{top:"0",left:"0",position:"absolute","z-index":"1001",width:"100%",height:"100%"},beforeRenderCallbacks:[],getModalId:function(){return this.modalId},listen:function(e){this.eventsObject=e,this.listenTo(this.eventsObject,this.openEvent,this.open),this.listenTo(this.eventsObject,this.openEvent,this.close),this.on("modal:destroy",this.onDestroy)},open:function(e,t,i){this.source=t,this.from=i,this.eventParams=e,this.onOpen(),window.ivi.adaptive.isMobile&&s.default.trigger("modal:open:extraData",this),this.addMobileModalClass()},close:function(){this.eventsObject.trigger("modal:close",this)},beforeRender:function(){},closeModal:function(){this.$(this.cancelEl).click()},beforeCancel:function(){window.ivi.adaptive.isMobile&&s.default.trigger("modal:close:extraData",this),this.removeMobileModalClass(),this.removeBodyClass()},hasMobileModal:function(){return this.mobileModal},canMobileScroll:function(){return this.mobileScroll},getMobileBodyClass:function(){return this.mobileBodyClass},onOpen:function(){this.beforeRender(this.eventParams),this.runBeforeRenderCallbacks(this.eventParams),this.render(),this.getModalId()&&this.$el.attr("id",this.getModalId()),r.default.render(this.$el),this.$el.css("display",""),this.addBodyClass()},onDestroy:function(){this.fullAnimation||this.$el.hide()},addMobileModalClass:function(){this.hasMobileModal()&&n("body").addClass(this.mobileModalClass)},removeMobileModalClass:function(){this.hasMobileModal()&&n("body").removeClass(this.mobileModalClass)},addBodyClass:function(){n("body").addClass(this.bodyClass)},removeBodyClass:function(){this.bodyClass&&n("body").removeClass(this.bodyClass)},disableModalEvents:function(){this.active=!1,this.keyControl=!1},addBeforeRenderCallbacks:function(e){this.beforeRenderCallbacks.push(e)},runBeforeRenderCallbacks:function(e){for(;this.beforeRenderCallbacks.length>0;)this.beforeRenderCallbacks.pop()(e)},sendMessageToPlayer:function(e,t){void 0===t&&(t=null);var i=document.getElementById("player-iframe");i&&o.default.postMessageToIframe(i,{type:"player",message:e,params:t},"*")},pausePlayer:function(){this.sendMessageToPlayer("contentPlayingPause")},resumePlayer:function(){this.sendMessageToPlayer("contentPlayingResume")},playFromEndScreen:function(){this.sendMessageToPlayer("playFromEndScreen")},autoStartPlayer:function(){this.sendMessageToPlayer("play")},clickOutside:function(e){var t=this.outsideElement;(null!=t?t.hasClass(this.prefix+"-modal"):void 0)&&this.active&&this.triggerCancel(e)},setAnimation:function(e){this.animate=e},onRenderAnimation:function(){var e=this;this.animate&&this.fullAnimation?(this.$el.css(this.FULL_ANIMATION_WRAPPER_STYLES),this.$el.fadeIn({duration:this.renderAnimationDuration,complete:function(){e.$el.removeAttr("style"),e.rendererCompleted()}})):a.prototype.onRenderAnimation.apply(this,arguments)},onDestroyAnimation:function(){var e=this;this.animate&&this.fullAnimation?(this.$el.css(this.FULL_ANIMATION_WRAPPER_STYLES),this.$el.fadeOut({duration:this.destroyAnimationDuration,complete:function(){e.$el.empty()}})):a.prototype.onDestroyAnimation.apply(this,arguments)}})},function(e,t,i){"use strict";var n=i(46),a=n;e.exports=a},function(e,t,i){var n=i(360),a=i(5),s=i(35),o=i(43),r=i(32),l=i(19),d=function(){function e(){this.abTests={},this.abTestsLoaded=!1,this.GROUP_CODES={Group0:"0",Group1:"1",Group2:"2",Group3:"3",Group4:"4",Group5:"5"},this.browserInfo=new r.default,this.mapiInfo=null,this.loadABManagerTests()}return e.prototype.loadABManagerTests=function(){var e=this;if(!this.abTestsLoaded){var t=o.default.getUserABTests();t&&t.length&&(this.abTestsLoaded=!0,a.each(t,function(t){e.abTests[t.test_code]=new n.default(t)})),this.mapiInfo=new l.default}},e.prototype.getUserBucket=function(){return parseInt(s.get("user_ab_bucket"),10)},e.prototype.canSellBundles=function(){this.loadABManagerTests();var e=this.abTests.ab_bundle;return e&&e.getGroupCode()===this.GROUP_CODES.Group1},e.prototype.showMultiPageIviplusLanding=function(){this.loadABManagerTests();var e=this.abTests.ab_svod_landing;return e&&e.getGroupCode()===this.GROUP_CODES.Group1},e.prototype.showMultiSectionPromo=function(){this.loadABManagerTests();var e=this.abTests.multi_section_promo;return e&&e.getGroupCode()===this.GROUP_CODES.Group2},e.prototype.showFavouritesOnboardingInCollectionsOffer=function(){this.loadABManagerTests();var e=this.abTests.content_onboarding_offer_on_main;return e&&e.getGroupCode()===this.GROUP_CODES.Group3},e.prototype.showFavouritesOnboardingToplineOffer=function(){this.loadABManagerTests();var e=this.abTests.content_onboarding_offer_on_main;return e&&e.getGroupCode()===this.GROUP_CODES.Group2},e.prototype.useNewPriceBadges=function(){this.loadABManagerTests();var e=this.abTests.ab_price_badge;return e&&(e.getGroupCode()===this.GROUP_CODES.Group2||e.getGroupCode()===this.GROUP_CODES.Group3)&&!this.browserInfo.isSearchBot()&&!window.ivi.adaptive.isMobile},e.prototype.showFreeBadge=function(){var e=this.abTests.ab_price_badge;return e&&e.getGroupCode()===this.GROUP_CODES.Group2},e.prototype.showNewPreorderPopup=function(){this.loadABManagerTests();var e=this.abTests.ab_preorder_page_web,t=e&&e.getGroupCode();return!this.browserInfo.isSearchBot()&&!window.ivi.adaptive.isMobile&&e&&(t===this.GROUP_CODES.Group1||t===this.GROUP_CODES.Group2)},e.prototype.showImageInNewPreorderPopup=function(){this.loadABManagerTests();var e=this.abTests.ab_preorder_page_web;return!this.browserInfo.isSearchBot()&&!window.ivi.adaptive.isMobile&&e&&e.getGroupCode()===this.GROUP_CODES.Group2},e.prototype.showNewSeriesNotificationButton=function(){this.loadABManagerTests();var e=this.abTests.web_notifications_subscribtion;return e&&e.getGroupCode()===this.GROUP_CODES.Group2},e.prototype.showSeriesNewEndscreen=function(){this.loadABManagerTests();var e=this.abTests.tv_shows_endscreen_rate_web;return!(!e||e.getGroupCode()!==this.GROUP_CODES.Group2)},e.prototype.showNewRegistrationMotivation=function(){if(!this.mapiInfo.showNewRegistrationMotivation())return!1;this.loadABManagerTests();var e=this.abTests.motivation_reg_trial;return(e?e.getGroupCode():null)===this.GROUP_CODES.Group2},e.prototype.showRegistrationMotivationWithBonus=function(){if(!this.mapiInfo.showNewRegistrationMotivation())return!1;this.loadABManagerTests();var e=this.abTests.motivation_reg_trial,t=e?e.getGroupCode():null;return t===this.GROUP_CODES.Group3||t===this.GROUP_CODES.Group4||t===this.GROUP_CODES.Group5},e.prototype.getRegistrationMotivationBonusValue=function(){this.loadABManagerTests();var e=this.abTests.motivation_reg_trial;return e?e.getValue():0},e.prototype.showNewAdBlock=function(){this.loadABManagerTests();var e=this.abTests.ab_new_antiblocker;return!(!e||e.getGroupCode()!==this.GROUP_CODES.Group2)},e.prototype.showAuthBeforePurchase=function(){return!1},e.prototype.offerSubscriptionOnAvod=function(){this.loadABManagerTests();var e=this.abTests.ab_web_payments_reg,t=e&&e.getGroupCode();return!this.browserInfo.isSearchBot()&&e&&t===this.GROUP_CODES.Group2},e.prototype.isBindContactsAvailable=function(){this.loadABManagerTests();var e=this.abTests.add_conacts;return(e?e.getGroupCode():null)===this.GROUP_CODES.Group2},e}();t.default=new d},function(e,t,i){var n=i(0);t.default=n.View.extend({el:"mapi",getAppVersion:function(){return parseInt(this.$el.data("app-version"))},getSubsiteId:function(){return this.$el.data("subsite")},isSMSRegistrationCapability:function(){return!!this.$el.data("sms-registration-capability")},isFzShowPaymentStatementButtonCapability:function(){return!!this.$el.data("fz-show-payment-statement-button-capability")},isYandexOauthCapability:function(){return!!this.$el.data("yandex-oauth-capability")},isSocialButtonsCapability:function(){return!!this.$el.data("social-buttons-capability")},isSubscriptionSpasiboPaymentCapability:function(){return!!this.$el.data("subscription-spasibo-payment-capability")},isEnableSubscriptionSpasiboScoringCapability:function(){return!!this.$el.data("subscription-spasibo-scoring-capability")},isWorld:function(){return 1===parseInt(this.$el.data("is-world"))},isPaywall:function(){return 1===parseInt(this.$el.data("is-paywall"))},showOpenInAppBlock:function(){return 1===parseInt(this.$el.data("show-open-in-app"))},getStartAuthMotivationPeriod:function(){var e=this.$el.data("start-auth-motivation-period");return""!==e&&Number(e)},isAuthorizeOnEntry:function(){return!!this.$el.data("authorize-on-entry")},getTrialForBuyersPopupShowInterval:function(){return this.$el.data("trial-for-buyers-popup-show-interval")},getTrialForBuyersDuration:function(){return this.$el.data("trial-for-buyers-duration")},getTrialForMastercardDuration:function(){return this.$el.data("trial-for-mastercard-duration")},getSberbankHoldersDuration:function(){return this.$el.data("sb-holders-duration")},getNoSberbankHoldersDuration:function(){return this.$el.data("no-sb-holders-duration")},showFavouritesOnboarding:function(){return!!this.$el.data("show-favourites-onboarding")},getFavouritesOnboardingContentMinSelect:function(){return parseInt(this.$el.data("favourites-onboarding-content-min-select"),10)},getFavouritesOnboardingContentDefaultSelect:function(){return parseInt(this.$el.data("favourites-onboarding-content-default-select"),10)},getTrialAvailabilityPeriod:function(){return this.$el.data("trial-availability-period")},showPrivacyPolicy:function(){return!!this.$el.data("show-privacy-policy")},getPasswordRules:function(){try{return JSON.parse(this.$el.data("password-rules").replace(/'/g,'"'))}catch(e){return{}}},showLoginByCode:function(){return!!this.$el.data("show-login-by-code")},isTrialForBuyersActive:function(){return!!this.$el.data("trial-for-buyers-active")},isTrialForMastercardActive:function(){return!!this.$el.data("trial-for-mastercard-active")},isSberbankCertificateActive:function(){return!!this.$el.data("sber-certificate-active")},isNoSberbankCertificateActive:function(){return!!this.$el.data("nosber-certificate-active")},showSubscriptionSpasiboEnterPoint:function(){return!!this.$el.data("show-subscription-spasibo-enter-point")},showNewRegistrationMotivation:function(){return!!this.$el.data("show-new-registration-motivation")},isBindContactsAvailable:function(){return!!this.$el.data("bind-contacts-available")}})},function(e,t){var i=function(){function e(){this.localStorage={},this.sessionStorage={},this.changeCardAccountIdKey="change_card_account_id",this.longTrialModalShowTime="long_trial_time",this.mastercardTrialModalShowTime="mastercard_trial_time",this.MOTIVATION_REGISTRATION_COMPLETED="motivation_registration_completed";var e=function(){};this.localStorage=this.sessionStorage={setItem:e,getItem:e,clear:e,removeItem:e,length:e},this.init()}return e.prototype.init=function(){if("localStorage"in window)try{window.localStorage.setItem("_tmptest","tmpval"),window.localStorage.removeItem("_tmptest"),this.localStorage=window.localStorage,this.sessionStorage=window.sessionStorage}catch(e){}},e.prototype.setChangeCardAccountId=function(e){this.localStorage.setItem(this.changeCardAccountIdKey,e)},e.prototype.getChangeCardAccountId=function(){var e=parseInt(this.localStorage.getItem(this.changeCardAccountIdKey),10);return this.localStorage.removeItem(this.changeCardAccountIdKey),e},e.prototype.getLongTrialModalShowTime=function(){return parseInt(this.localStorage.getItem(this.longTrialModalShowTime),10)},e.prototype.setLongTrialModalShowTime=function(e){this.localStorage.setItem(this.longTrialModalShowTime,e)},e.prototype.getMastercardTrialModalShowTime=function(){return parseInt(this.localStorage.getItem(this.mastercardTrialModalShowTime),10)},e.prototype.setMastercardTrialModalShowTime=function(e){this.localStorage.setItem(this.mastercardTrialModalShowTime,e)},e.prototype.setMotivationRegistrationCompletion=function(e){e?this.localStorage.setItem(this.MOTIVATION_REGISTRATION_COMPLETED,"1"):this.localStorage.removeItem(this.MOTIVATION_REGISTRATION_COMPLETED)},e.prototype.getMotivationRegistrationCompletion=function(){return!!this.localStorage.getItem(this.MOTIVATION_REGISTRATION_COMPLETED)},e}();t.default=new i},function(e,t,i){"use strict";function n(e,t){function i(){this.constructor=e}w(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}function a(e,t){var i={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(i[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var a=0,n=Object.getOwnPropertySymbols(e);a<n.length;a++)t.indexOf(n[a])<0&&(i[n[a]]=e[n[a]]);return i}function s(e,t,i,n){var a,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var r=e.length-1;r>=0;r--)(a=e[r])&&(o=(s<3?a(o):s>3?a(t,i,o):a(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o}function o(e,t){return function(i,n){t(i,n,e)}}function r(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}function l(e,t,i,n){return new(i||(i=Promise))(function(a,s){function o(e){try{l(n.next(e))}catch(e){s(e)}}function r(e){try{l(n.throw(e))}catch(e){s(e)}}function l(e){e.done?a(e.value):new i(function(t){t(e.value)}).then(o,r)}l((n=n.apply(e,t||[])).next())})}function d(e,t){function i(e){return function(t){return n([e,t])}}function n(i){if(a)throw new TypeError("Generator is already executing.");for(;l;)try{if(a=1,s&&(o=s[2&i[0]?"return":i[0]?"throw":"next"])&&!(o=o.call(s,i[1])).done)return o;switch(s=0,o&&(i=[0,o.value]),i[0]){case 0:case 1:o=i;break;case 4:return l.label++,{value:i[1],done:!1};case 5:l.label++,s=i[1],i=[0];continue;case 7:i=l.ops.pop(),l.trys.pop();continue;default:if(o=l.trys,!(o=o.length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){l=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){l.label=i[1];break}if(6===i[0]&&l.label<o[1]){l.label=o[1],o=i;break}if(o&&l.label<o[2]){l.label=o[2],l.ops.push(i);break}o[2]&&l.ops.pop(),l.trys.pop();continue}i=t.call(e,l)}catch(e){i=[6,e],s=0}finally{a=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}var a,s,o,r,l={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return r={next:i(0),throw:i(1),return:i(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r}function u(e,t){for(var i in e)t.hasOwnProperty(i)||(t[i]=e[i])}function c(e){var t="function"==typeof Symbol&&e[Symbol.iterator],i=0;return t?t.call(e):{next:function(){return e&&i>=e.length&&(e=void 0),{value:e&&e[i++],done:!e}}}}function p(e,t){var i="function"==typeof Symbol&&e[Symbol.iterator];if(!i)return e;var n,a,s=i.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(n=s.next()).done;)o.push(n.value)}catch(e){a={error:e}}finally{try{n&&!n.done&&(i=s.return)&&i.call(s)}finally{if(a)throw a.error}}return o}function f(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(p(arguments[t]));return e}function h(e){return this instanceof h?(this.v=e,this):new h(e)}function g(e,t,i){function n(e){u[e]&&(d[e]=function(t){return new Promise(function(i,n){c.push([e,t,i,n])>1||a(e,t)})})}function a(e,t){try{s(u[e](t))}catch(e){l(c[0][3],e)}}function s(e){e.value instanceof h?Promise.resolve(e.value.v).then(o,r):l(c[0][2],e)}function o(e){a("next",e)}function r(e){a("throw",e)}function l(e,t){e(t),c.shift(),c.length&&a(c[0][0],c[0][1])}if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var d,u=i.apply(e,t||[]),c=[];return d={},n("next"),n("throw"),n("return"),d[Symbol.asyncIterator]=function(){return this},d}function m(e){function t(t,a){e[t]&&(i[t]=function(i){return(n=!n)?{value:h(e[t](i)),done:"return"===t}:a?a(i):i})}var i,n;return i={},t("next"),t("throw",function(e){throw e}),t("return"),i[Symbol.iterator]=function(){return this},i}function v(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t=e[Symbol.asyncIterator];return t?t.call(e):"function"==typeof c?c(e):e[Symbol.iterator]()}function _(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}function b(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t.default=e,t}function y(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.__extends=n,i.d(t,"__assign",function(){return C}),t.__rest=a,t.__decorate=s,t.__param=o,t.__metadata=r,t.__awaiter=l,t.__generator=d,t.__exportStar=u,t.__values=c,t.__read=p,t.__spread=f,t.__await=h,t.__asyncGenerator=g,t.__asyncDelegator=m,t.__asyncValues=v,t.__makeTemplateObject=_,t.__importStar=b,t.__importDefault=y;/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */
var w=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])},C=Object.assign||function(e){for(var t,i=1,n=arguments.length;i<n;i++){t=arguments[i];for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a])}return e}},function(e,t,i){var n=i(1),a=i(0),s=i(5),o=i(14),r=i(80),l=i(8),d=i(32),u=i(364),c=i(4),p=i(20),f=i(10),h=i(3),g=i(365),m=i(65),v=i(18),_=i(7);t.default=new(o.default.extend({DEVICE_ID_POSTFIX_KEY:"deviceIdPostFix",validation:{email:{required:!0,minLength:1},pass:{minLength:1}},deferred:n.Deferred(),registerStoragelessUri:"/user/register/storageless/v5/",registerVerimatrixChallenge:"/user/register/verimatrix/challenge/v5/",registerByEmailUri:"/user/register/v6/",loginByEmailUri:"/user/login/ivi/v5/",resetPassByEmailUri:"/user/reset/password/v5",userConfirmEmailUri:"/user/confirm/email/v5/",REGISTER_BY_SMS_V6_URI:"/user/register/phone/v6/",loginBySMSUri:"/user/login/phone/v5/",mergeSessionUri:"/user/merge/v5/",loginByFacebookUri:"/user/login/facebook/v5/",loginByYandexUri:"/user/login/yandex/v5/",loginByVkUri:"/user/login/vkontakte/v5/",LOGIN_BY_CODE:"/user/auth_code/v5/",VALIDATE_AUTH_TOKEN_URI:"/user/validate/v5/",verimatrixSession:null,userBlocked:!1,emptyPurchaseList:new r.default,browserInfo:new d.default,initialize:function(){"fronttest"===f.default.env&&(this.newVid=function(){return"329d0284cdc56e011aa1d69d95ad321f"}),this.listenTo(_.default,"autologin",this.onUserStatus)},autoLogin:function(){var e=this;return _.default.once("loadUser",function(t){t.sessionNeedUpdate()?(new u.default).mapiPost({session:m.default.get(),data:{device:e.getDevice()}}).done(function(i){i.result&&m.default.set(i.result),e.loadUserHandler(t)}).fail(function(){e.loadUserHandler(t)}):e.loadUserHandler(t)}),m.default.get()?this.loadUser():this.registerStorageless().done(this.loadUser.bind(this)),this.deferred},loadUserHandler:function(e){var t=this;if(e.isIdentified()){var i=new r.default;i.mapiGet().done(function(){t.set("purchases",i),t.fillUserSubscriptionData(i,e),e.setIsBuyerCookie(i),_.default.trigger("autologin",e),t.deferred.resolve(e)}).fail(function(){t.deferred.reject()})}else _.default.trigger("autologin",e),this.deferred.resolve(e)},fillUserSubscriptionData:function(e,t){if(t.setSubscription(e.createSubscriptionPurchaseObject()),f.default.hasSubscription=t.getSubscription().hasSubscription(),e.size()){var i=e.where({object_type:"content"});i&&i.length&&t.set("purchasedContent",new a.Collection(i))}t.hasSubscription()?_.default.trigger("user:hasSubscription"):_.default.trigger("user:hasNotSubscription")},registerStorageless:function(){var e=this;return this.mapiPost({uri:this.registerStoragelessUri}).done(function(t){t.result&&(m.default.setVerimatrix(!1),l.default.setFreshStoragelessSession(!0),t.result.session?e.saveAndMergeSession(t.result.session):(e.userBlocked||h.default.track("empty_session"),e.userBlocked=!0))})},registerProofOfWork:function(){var e=this;if(m.default.isVerimatrix())return e.verimatrixSession=m.default.get(),e.loadUser();var t=n.Deferred();return this.mapiGet({uri:this.registerVerimatrixChallenge,data:{verimatrix_id:this.newVid()}}).done(function(i){if(i.result){var n=i.result;n.collisions=g.default.solve(n.seed,n.size,n.count,n.xored).join(","),e.mapiPost({uri:e.registerVerimatrixChallenge,data:n}).done(function(i){i.error?t.reject():(e.verimatrixSession=i.result.session,e.listenToOnce(_.default,"merge",function(){e.listenToOnce(_.default,"loadUser",function(){h.default.identify(l.default.get("id")),t.resolve(l.default)}),e.loadUser()}),e.saveAndMergeSession(i.result.session))}).fail(t.reject)}else t.reject()}).fail(t.reject),t.promise()},validateAuthToken:function(e){void 0===e&&(e={});var t={value:e.authToken||this.get("authToken")};return(e.expectedType||this.get("expected_type"))&&(t.expected_type=e.expectedType||this.get("expected_type")),this.mapiPost({uri:this.VALIDATE_AUTH_TOKEN_URI,data:t}).done(function(e){e.result?_.default.trigger("auth:validateAuthToken:success"):_.default.trigger("auth:request:error",e.error.user_message,e.error.code)}).fail(function(){_.default.trigger("auth:request:error")})},registerByEmail:function(e,t){var i=this;void 0===e&&(e=!1),void 0===t&&(t=!1);var n={email:this.get("email"),device:this.getDevice()};return this.get("password")&&(n.password=this.get("password")),this.get("passwordRepeat")&&(n.password_repeat=this.get("passwordRepeat")),v.default.showRegistrationMotivationWithBonus()&&t&&(n.user_ab_bucket=v.default.getUserBucket(),n.user_popup="1"),this.mapiPost({uri:this.registerByEmailUri,data:n}).done(function(t){t.error?_.default.trigger("auth:request:error",t.error.user_message,t.error.code):e?_.default.trigger("oauth2:get:userInfo",t.result.session,t.result.email):i.saveAndMergeSessionWithLoadUser(t.result.session,!0)}).fail(function(){_.default.trigger("auth:request:error")})},loginByEmail:function(e){var t=this;return void 0===e&&(e=!1),this.mapiPost({uri:this.loginByEmailUri,data:{email:this.get("email"),password:this.get("password"),device:this.getDevice()}}).done(function(i){i.error?_.default.trigger("auth:request:error",i.error.user_message,i.error.code):e?_.default.trigger("oauth2:get:userInfo",i.result.session,i.result.email):t.saveAndMergeSessionWithLoadUser(i.result.session)}).fail(function(){_.default.trigger("auth:request:error")})},saveAndMergeSessionWithLoadUser:function(e,t){var i=this;void 0===t&&(t=!1),this.saveAndMergeSession(e).done(function(){i.loadUser().done(function(e){e.error&&!t?_.default.trigger("auth:request:error"):(_.default.trigger("isUser",l.default),_.default.trigger("auth:request:success"),t||_.default.trigger("auth:removePopup"))})})},resetPassByEmail:function(){return this.mapiPost({uri:this.resetPassByEmailUri,data:{email:this.get("email"),device:this.getDevice()}}).done(function(e){e.error?_.default.trigger("auth:passReset:error",e.error.user_message,e.error.code):_.default.trigger("auth:passReset:success")}).fail(function(){_.default.trigger("auth:passReset:error")})},sendConfirmEmail:function(e,t){void 0===e&&(e=!1),void 0===t&&(t=!1);var i={session:m.default.get(),device:this.getDevice()};return v.default.showRegistrationMotivationWithBonus()&&e&&(i.user_ab_bucket=v.default.getUserBucket(),i.user_popup="1"),t&&(i.set_password="1"),this.mapiPost({uri:this.userConfirmEmailUri,data:i}).done(function(e){e&&"ok"===e.result&&_.default.trigger("auth:email:confirm:sent")})},registerBySMS:function(){return this.mapiPost({uri:this.REGISTER_BY_SMS_V6_URI,data:{phone:this.get("phone"),device:this.getDevice()}}).done(function(e){e.error?_.default.trigger("auth:request:error",e.error.user_message,e.error.code):_.default.trigger("auth:phoneConfirmation")}).fail(function(){_.default.trigger("auth:request:error")})},loginBySMS:function(){var e=this,t=this.get("smsVerifyCode");return this.mapiPost({uri:this.loginBySMSUri,data:{phone:this.get("phone"),code:t,device:this.getDevice()}}).done(function(t){t.error?_.default.trigger("auth:request:error",t.error.user_message,t.error.code):e.saveAndMergeSession(t.result.session).done(function(){e.loadUser().done(function(e){e.error?_.default.trigger("auth:request:error"):(_.default.trigger("isUser",l.default),_.default.trigger("auth:request:success"),_.default.trigger("auth:removePopup"))})})}).fail(function(){_.default.trigger("auth:request:error")})},loginByFacebook:function(e){var t=this;return this.mapiPost({uri:this.loginByFacebookUri,data:{access_token:e,device:this.getDevice()}}).done(function(e){e.result&&e.result.session?t.saveAndMergeSession(e.result.session).fail(function(){_.default.trigger("auth:facebook:error")}):_.default.trigger("auth:facebook:error")}).fail(function(){_.default.trigger("auth:facebook:error")})},loginByYandex:function(e){var t=this;return this.mapiPost({uri:this.loginByYandexUri,data:{access_token:e,device:this.getDevice()}}).done(function(e){e.result&&e.result.session?t.saveAndMergeSession(e.result.session).fail(function(){_.default.trigger("auth:yandex:error")}):e.error&&e.error.user_message?_.default.trigger("auth:yandex:error",e.error.user_message):_.default.trigger("auth:yandex:error")}).fail(function(){_.default.trigger("auth:yandex:error")})},loginByVk:function(e){var t=this;return this.mapiPost({uri:this.loginByVkUri,data:{access_token:e,device:this.getDevice()}}).done(function(e){e.result&&e.result.session?t.saveAndMergeSession(e.result.session).fail(function(){_.default.trigger("auth:vk:error")}):_.default.trigger("auth:vk:error")}).fail(function(){_.default.trigger("auth:vk:error")})},loginByCode:function(e){this.mapiPost({uri:this.LOGIN_BY_CODE,data:{code:e,device:this.getDevice()}}).done(function(e){e.result?_.default.trigger("auth:loginByCode:success"):_.default.trigger("auth:loginByCode:error",e.error.user_message,e.error.code)}).fail(function(){_.default.trigger("auth:loginByCode:error")})},logout:function(){this.mapiPost({uri:"/user/logout/v5/"}),this.unset("purchases"),l.default.set("subscription",{expire:0}),m.default.expire(),p.default.localStorage.removeItem(this.DEVICE_ID_POSTFIX_KEY),l.default.removeIsBuyerCookie();var e=this;return this.registerStorageless().done(function(){e.loadUser(),_.default.trigger("isGuest"),_.default.trigger("user:logout"),h.default.track("auth_cancel")})},loadUser:function(){var e=this;return l.default.mapiGet().done(function(){_.default.once("auth:processInvalidSession",e.processInvalidSession.bind(e)),l.default.get("code")===e.invalidSessionCodeError?e.registerStorageless().done(function(){e.loadUserBalanceData()}):(e.loadUserBalanceData(),e.verimatrixSession?m.default.setVerimatrix(!0):m.default.setVerimatrix(!1))}).fail(function(){_.default.trigger("auth:loadUserFailed")})},loadUserBalanceData:function(){l.default.loadBalance().done(function(e){_.default.trigger("auth:userBalanceLoad",e),_.default.trigger("loadUser",l.default)})},saveAndMergeSession:function(e){var t=this,i=m.default.get();if(m.default.set(e),i){var a=n.Deferred();return this.checkInvalidSessionMessage=!0,this.mapiPost({uri:this.mergeSessionUri,data:{rightsession:i}}).done(function(e){"ok"===e.result?(a.resolve(e),_.default.trigger("merge")):(a.reject(e),m.default.set(i),_.default.trigger("auth:mergeError",e.error.user_message,e.error.code,e.error.controls))}).always(function(){t.checkInvalidSessionMessage=!1}),a.promise()}},accepts:function(){var e="";return s.each(c.default.getNavigatorPlugins(),function(t){s.each(t,function(t){e+=t.description+";"+t.type+";"+t.suffixes})}),e},newVid:function(){return g.default.hasher(navigator.userAgent+this.accepts()+(new Date).getTime()+screen.width+"x"+screen.height+"x"+screen.colorDepth+navigator.language)},processInvalidSession:function(){this.registerStorageless().done(function(){l.default.canAuthenticate()?c.default.redirect("/?login_modal=1&invalid_session=1"):c.default.reload()})},handleSessionError:function(e){e.error&&e.error.code===this.invalidSessionCodeError&&this.verimatrixSession&&!this.checkInvalidSessionMessage?(this.verimatrixSession=null,h.default.track("invalid_session"),_.default.trigger("merge")):o.default.prototype.handleSessionError.call(this,e)},isUserBlocked:function(){return this.userBlocked},onUserStatus:function(){l.default.isAuthenticated()?_.default.trigger("isUser",l.default):_.default.trigger("isGuest")},getDevice:function(){if("fronttest"===f.default.env)return"";var e=p.default.localStorage.getItem(this.DEVICE_ID_POSTFIX_KEY);if(!e){var t=m.default.get();t&&(e=t.slice(0,5),p.default.localStorage.setItem(this.DEVICE_ID_POSTFIX_KEY,e))}var i=this.browserInfo.getOsName();return this.browserInfo.getOsVersion()&&(i+=" v."+this.browserInfo.getOsVersion()),i+" "+this.browserInfo.getBrowserName()+" v."+this.browserInfo.getBrowserVersion()+" "+e}}))},function(e,t,i){var n=i(0),a=i(40),s=i(5),o=i(10);t.default=n.View.extend({el:"video-info",contentEntity:null,getId:function(){return this.$el.data("id")},getHru:function(){return this.$el.data("hru")||""},getCompilationId:function(){return this.$el.data("compilation-id")},getRightTypeList:function(){var e=this.$el.data("right-types")?this.$el.data("right-types").split(","):[];return e=e.map(function(e){return e.toUpperCase()}),o.default.isPaywall&&(e=s.uniq(e.map(function(e){return"AVOD"===e?"SVOD":e}))),e},getPoster:function(){return this.$el.data("poster")},getTitle:function(){return this.$el.data("title")},isFake:function(){return!!parseInt(this.$el.data("f"),10)},isPreorderable:function(){return!!parseInt(this.$el.data("preorderable"),10)},isDRMOnly:function(){return!!parseInt(this.$el.data("drm-only"),10)},getIviReleaseDate:function(){return this.$el.data("release-date")},getRightTypeForGroot:function(){var e={};if(this.getRightTypeList().map(function(t){e["m_"+t.toLowerCase()]=1}),this.$el.data("right-types-quality")){var t=JSON.parse(this.$el.data("right-types-quality").replace(/'/g,'"'));s.each(t,function(t,i){e["price_"+i.toLowerCase()]=parseFloat(t)})}return e},getWatchLink:function(){return"/watch/"+this.$el.data("id")},isPaid:function(){return o.default.isPaywall?!this.isFake():!this.isFree()&&!this.isFake()},isFree:function(){return this.getRightTypeList().length>0&&this.getRightTypeList().indexOf("AVOD")>=0},isSvod:function(){return this.getRightTypeList().length>0&&this.getRightTypeList().indexOf("SVOD")>=0},isTvod:function(){return this.getRightTypeList().length>0&&this.getRightTypeList().indexOf("TVOD")>=0},isEst:function(){return this.getRightTypeList().length>0&&this.getRightTypeList().indexOf("EST")>=0},isPartiallyFree:function(){return this.isFree()&&(this.isSvod()||this.isTvod()||this.isEst())},isBought:function(){return!!parseInt(this.$el.data("is-bought"),10)},isEternalBought:function(){return!!parseInt(this.$el.data("is-eternal-bought"),10)},isSerie:function(){return this.getCompilationId()&&this.getId()},checkIfExists:function(){return this.$el.length>0},isCompilation:function(){return!!this.$el.data("is-compilation")},getContentType:function(){return"video"},getKind:function(){return 1},isForAdult:function(){return!!this.$el.data("for-adult")},isAnimation:function(){return!!this.$el.data("is-animation")},getCategoryHru:function(){return this.$el.data("category-hru")},isUsedToBePaid:function(){return this.$el.data("is-used-to-be-paid")},getSynopsis:function(){return this.$el.data("synopsis")},getPromoImageUrl:function(){return this.$el.data("promo-image-url")},getContentEntity:function(){return this.contentEntity||(this.contentEntity=new a.default({used_to_be_paid:this.isUsedToBePaid(),id:this.getId(),preorderable:this.isPreorderable(),content_paid_types:this.getRightTypeList(),fake:this.isFake(),isBought:this.isBought(),restrict:this.isForAdult(),poster_originals:[{path:this.getPoster()}],title:this.getTitle()})),this.contentEntity}})},function(e,t,i){"use strict";function n(e){if(null===e||void 0===e)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(e)}/*
object-assign
(c) Sindre Sorhus
@license MIT
*/
var a=Object.getOwnPropertySymbols,s=Object.prototype.hasOwnProperty,o=Object.prototype.propertyIsEnumerable;e.exports=function(){try{if(!Object.assign)return!1;var e=new String("abc");if(e[5]="de","5"===Object.getOwnPropertyNames(e)[0])return!1;for(var t={},i=0;i<10;i++)t["_"+String.fromCharCode(i)]=i;if("0123456789"!==Object.getOwnPropertyNames(t).map(function(e){return t[e]}).join(""))return!1;var n={};return"abcdefghijklmnopqrst".split("").forEach(function(e){n[e]=e}),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},n)).join("")}catch(e){return!1}}()?Object.assign:function(e,t){for(var i,r,l=n(e),d=1;d<arguments.length;d++){i=Object(arguments[d]);for(var u in i)s.call(i,u)&&(l[u]=i[u]);if(a){r=a(i);for(var c=0;c<r.length;c++)o.call(i,r[c])&&(l[r[c]]=i[r[c]])}}return l}},function(e,t,i){var n=i(1),a=i(12),s=i(685),o=i(9);t.default=o.default.extend({run:function(e){a.default.prototype.run(e),(new s.default).execute(e),n("body").hasClass("tablet")&&n(".js-premiers-tab").remove()}})},function(e,t,i){var n=i(0);t.default=new n.Model({})},function(e,t,i){"use strict";function n(e){for(var t;t=e._renderedComponent;)e=t;return e}function a(e,t){var i=n(e);i._hostNode=t,t[g]=i}function s(e){var t=e._hostNode;t&&(delete t[g],e._hostNode=null)}function o(e,t){if(!(e._flags&h.hasCachedChildNodes)){var i=e._renderedChildren,s=t.firstChild;e:for(var o in i)if(i.hasOwnProperty(o)){var r=i[o],l=n(r)._domID;if(null!=l){for(;null!==s;s=s.nextSibling)if(1===s.nodeType&&s.getAttribute(f)===String(l)||8===s.nodeType&&s.nodeValue===" react-text: "+l+" "||8===s.nodeType&&s.nodeValue===" react-empty: "+l+" "){a(r,s);continue e}u("32",l)}}e._flags|=h.hasCachedChildNodes}}function r(e){if(e[g])return e[g];for(var t=[];!e[g];){if(t.push(e),!e.parentNode)return null;e=e.parentNode}for(var i,n;e&&(n=e[g]);e=t.pop())i=n,t.length&&o(n,e);return i}function l(e){var t=r(e);return null!=t&&t._hostNode===e?t:null}function d(e){if(void 0===e._hostNode&&u("33"),e._hostNode)return e._hostNode;for(var t=[];!e._hostNode;)t.push(e),e._hostParent||u("34"),e=e._hostParent;for(;t.length;e=t.pop())o(e,e._hostNode);return e._hostNode}var u=i(15),c=i(85),p=i(286),f=(i(13),c.ID_ATTRIBUTE_NAME),h=p,g="__reactInternalInstance$"+Math.random().toString(36).slice(2),m={getClosestInstanceFromNode:r,getInstanceFromNode:l,getNodeFromInstance:d,precacheChildNodes:o,precacheNode:a,uncacheNode:s};e.exports=m},function(e,t,i){var n=i(5),a=function(){},s={};s.extend=function(e,t){var i=s.inherits(this,e,t);return i.extend=this.extend,i},s.inherits=function(e,t,i){var s;return s=t&&t.hasOwnProperty("constructor")?t.constructor:function(){e.apply(this,arguments)},n.extend(s,e),a.prototype=e.prototype,s.prototype=new a,t&&n.extend(s.prototype,t),i&&n.extend(s,i),s.prototype.constructor=s,s.__super__=e.prototype,s},s.randomStub=function(){var e=[1,2,3,4,5,6,7,8];return{getRandomImages:function(t){var i=[];if(!t)return i;for(var a=[];t>a.length;){var s=n.random(0,e.length-1);a.length&&e[s]===a[a.length-1]||a.push(e[s])}return n.each(a,function(e){i.push("/images/stubs/pixel_{n}.gif".replace("{n}",e))}),i}}},s.queryParams=function(e){var t={};if(-1!==e.indexOf("?"))for(var i=e.substring(e.indexOf("?")+1),n=i.split("&"),a=0;a<n.length;a++){var s=n[a].split("=");void 0===t[s[0]]?t[s[0]]=s[1]:"string"==typeof t[s[0]]?t[s[0]]=[t[s[0]],s[1]]:t[s[0]].push(s[1])}return t},s.escapeText=function(e){return"string"==typeof e&&e?e.replace(/["&'\/<>]/g,function(e){return{'"':"&quot;","&":"&amp;","'":"&#39;","/":"&#47;","<":"&lt;",">":"&gt;"}[e]}):e},s.urlHasParams=function(e){return-1!==e.indexOf("?")},s.urlHasParam=function(e,t){return t in s.queryParams(e)},s.addParamsToUrl=function(e,t){return e||(e=""),n.isString(t)?e+=(s.urlHasParams(e)?"&":"?")+t:n.isArray(t)?n.each(t,function(t){e=s.addParamsToUrl(e,t)}):n.isObject(t)&&n.each(t,function(t,i){t&&(e=s.addParamsToUrl(e,i+"="+t))}),e},s.replaceParamsInUrl=function(e,t,i){if(void 0===t&&(t=null),void 0===i&&(i=""),!i)return e;var n=new RegExp("\\b("+t+"=).*?(&|$)");return e.search(n)>=0?e.replace(n,"$1"+i+"$2"):e},s.setRandomNumber=function(e){return e.replace("[RANDOM]",(new Date).getTime())},s.schemaLessUrl=function(e){return e.replace(/(https:|http:)/,"")},s.decodeParams=function(e){return n.each(e,function(t,i){try{e[i]=decodeURIComponent(t)}catch(n){e[i]=t}}),e},s.padNumber=function(e,t){for(var i=e+"";i.length<t;)i="0"+i;return i},t.default=s},function(e,t,i){var n=i(0),a=i(206);t.default=n.Collection.extend(a.default)},function(e,t,i){var n=i(0);t.default=new n.Model({})},function(e,t,i){"use strict";e.exports=i(544)},function(e,t,i){var n=i(1),a=i(0);t.default=a.View.extend({FIREFOX_VERSION_WITH_WIDEVINE:47,getParam:function(e){return n("browser").data(e)},getBrowserName:function(){return this.getParam("browser-name")},getBrowserVersion:function(){return this.getParam("browser-version")},getBrowserMajorVersion:function(){var e=this.getParam("browser-version");return e?parseInt(e,10):null},browserCanPlayDrm:function(){return!window.ivi.adaptive.isMobile&&(this.isChromeBrowser()||this.isFirefoxBrowser()&&this.getBrowserMajorVersion()>=this.FIREFOX_VERSION_WITH_WIDEVINE)},getOsName:function(){return this.getParam("os-name")},getOsVersion:function(){return this.getParam("os-version")},getDeviceName:function(){return this.getParam("device-name")},isIE:function(){return!!this.getParam("is-ie")},isEdge:function(){return"Edge"===this.getBrowserName()},isYandexBrowser:function(){return"Yandex"===this.getBrowserName()},isChromeBrowser:function(){return"Chrome"===this.getBrowserName()},isFirefoxBrowser:function(){return"Firefox"===this.getBrowserName()},isOperaBrowser:function(){return"Opera"===this.getBrowserName()},isSafariBrowser:function(){return"Safari"===this.getBrowserName()},isMobile:function(){return this.getParam("is-mobile")},isSearchBot:function(){return!!this.getParam("is-sb")},isIos:function(){return"iOS"===this.getOsName()},isAndroid:function(){return"Android"===this.getOsName()},isWindows10:function(){return"Windows"===this.getOsName()&&"10.0"===this.getOsVersion()}})},function(e,t,i){var n=i(6),a=i(22);t.default=n.default.extend({run:function(e){var t=this;a.default.deferred.done(function(){t.afterLogin.call(t,e)})}})},function(e,t,i){"use strict";var n=!("undefined"==typeof window||!window.document||!window.document.createElement),a={canUseDOM:n,canUseWorkers:"undefined"!=typeof Worker,canUseEventListeners:n&&!(!window.addEventListener&&!window.attachEvent),canUseViewport:n&&!!window.screen,isInWorker:!n};e.exports=a},function(e,t){e.exports=Cookies},function(e,t,i){var n=i(14),a=i(106),s=i(208),o=i(5),r=i(3);t.default=n.default.extend({uri:"/billing/v1/purchase/content/options/",sendUserABBucket:!0,SUBSCRIPTION_OBJECT_TYPE:"subscription",CONTENT_OBJECT_TYPE:"content",SEASON_OBJECT_TYPE:"season",COLLECTION_OBJECT_TYPE:"collection",SUBSCRIPTION_OBJECT_ID:6,getPurchaseOptionList:function(e){void 0===e&&(e=null);var t=this.get("purchase_options");e!==this.SUBSCRIPTION_OBJECT_TYPE&&e!==this.CONTENT_OBJECT_TYPE&&e!==this.SEASON_OBJECT_TYPE&&e!==this.COLLECTION_OBJECT_TYPE||(t=o.filter(t,function(t){return t.object_type===e}));var i=r.default.loadGutmCookie();if(i&&"cpa"===i.g_medium&&!o.isUndefined(i.g_term))for(var n=i.g_term,a=0;a<t.length;a++){var l=t[a].payment_options;if(!o.isUndefined(l))for(var d=0;d<l.length;d++){var u=l[d].purchase_params;o.isUndefined(u)||(u.cpa_id=n)}}return new s.default(this.sortByPriceAndQuality(t))},isPurchased:function(){return void 0!==this.get("purchases")&&this.get("purchases").length>0},sortByPriceAndQuality:function(e){var t=e?e.slice():e;return t&&t.sort(function(e,t){var i=e.price_ranges.user_price.min,n=t.price_ranges.user_price.min;return i===n?e.quality!==a.default.prototype.sdQuality&&t.quality===a.default.prototype.sdQuality?1:0:i-n}),t},getMinUserPrice:function(){return this.get("price_ranges").user_price.min}})},function(e,t,i){var n=i(113),a=i(23),s=i(10);t.default=a.default.extend({getWatchLink:function(){return"/watch/"+this.$el.data("hru")},getActualSerieId:function(){return this.$el.data("current-serie-id")?this.$el.data("current-serie-id"):this.$el.data("initial-serie-id")},getActualSerieSeason:function(){return this.$el.data("current-serie-season")?this.$el.data("current-serie-season"):this.$el.data("initial-serie-season")},isSeasonUsedToBePaid:function(e){var t=this.getSeasonsExtraInfo();return!(!t||!t[e])&&t[e].used_to_be_paid},getSeasonId:function(e){var t=this.getSeasonsExtraInfo();return t&&t[e]?t[e].season_id:null},getContentEntity:function(){return this.contentEntity||(this.contentEntity=new n.default({id:this.getActualSerieId(),season:this.getActualSerieSeason(),content_paid_types:this.getActualSeriePaidTypes(),episode:this.getActualSerieEpisode(),compilation_hru:this.getCompilationHru(),poster_originals:[{path:this.getPoster()}],title:this.getTitle()})),this.contentEntity},getActualSerieEpisode:function(){return this.$el.data("current-serie-episode")?this.$el.data("current-serie-episode"):this.$el.data("initial-serie-episode")},getSerieWatchLink:function(e){return"/watch/"+this.$el.data("hru")+"/"+(e||this.getActualSerieId())},getActualSeriePaidTypes:function(){var e;return e=this.$el.data("current-serie-paid-types")?this.$el.data("current-serie-paid-types").split(","):this.$el.data("initial-serie-paid-types")?this.$el.data("initial-serie-paid-types").split(","):[],e.map(function(e){return e.toUpperCase()})},isCompilation:function(){return this.$el.data("is-compilation")},getCompilationHru:function(){return this.$el.data("hru")},getContentType:function(){return"compilation"},getKind:function(){return 2},getTitle:function(){return this.$el.data("title")},isPaid:function(){return s.default.isPaywall?!this.isFake():(this.isSvod()||this.isTvod()||this.isEst())&&!this.isFake()},getSeasonsExtraInfo:function(){var e=this.$el.data("compilation-seasons-extra-info");return e?JSON.parse(e.replace(/'/g,'"')):null},isPartiallyFree:function(){return this.isFree()&&this.getRightTypeList().length>1},hasUpcomingEpisodes:function(){return!!this.$el.data("has-upcoming-episodes")}})},function(e,t,i){"use strict";var n=null;e.exports={debugTool:n}},function(e,t,i){var n=i(0),a=i(5),s=i(7),o=i(10),r=i(66),l=i(4),d=/(\w+\.\w+)$/,u=function(){this.initialize()};a.extend(u.prototype,n.Events,{DEFAULT_CURRENCY:"RUB",initialize:function(){this.listenTo(s.default,"auth:userBalanceLoad",this.setCurrency),this.currency=this.DEFAULT_CURRENCY},getRightHost:function(){var e=l.default.getLocation().origin&&l.default.getLocation().origin.match(d);return e&&e.length>1?e[1]:"ivi.ru"},getSchemaWithHost:function(e,t){var i=l.default.getLocation().hostname;return"prod"===o.default.env?e+"://"+t:e+"://"+i},getFormattedCurrency:function(e){return this.currency===this.DEFAULT_CURRENCY?e?r.default.currency(parseInt(e)):"руб.":this.currency},getPriceWithCurrency:function(e,t,i){if(!(e||"number"==typeof e&&isFinite(e)))return"";var n=this.getFormattedCurrency(i);return t||(t=" "),this.currency===this.DEFAULT_CURRENCY?e+t+n:n+t+e},getRightHostOrigin:function(){return this.getSchemaWithHost("https","www."+this.getRightHost())},getLocalDateTime:function(e){return!e instanceof Date?new Date(e):e},setCurrency:function(e){this.currency=e.getCurrency()},getCurrency:function(){return this.currency},isDefaultCurrency:function(){return this.getCurrency()===this.DEFAULT_CURRENCY}}),t.default=new u},function(e,t,i){var n=i(0),a=i(5),s=i(10),o=i(28);t.default=n.Model.extend({CONTENT_TYPE:"video",ageLimit:18,moviesCategory:14,paidTypeAvod:"AVOD",paidTypeSvod:"SVOD",paidTypeTvod:"TVOD",paidTypeEst:"EST",stubUrlDefault:"/images/stubs/poster.jpg",blockbustersIconName:"blockbuster",getId:function(){return this.get("id")},getTitle:function(){return this.get("title")},getHru:function(){return this.get("hru")},isFake:function(){return this.get("fake")||this.isCompilation()&&!this.get("fake")&&!this.get("episodes")},isPaid:function(){return s.default.isPaywall?!this.isFake():!this.isFree()&&!this.isFake()},isFree:function(){return!s.default.isPaywall&&-1!==this.getContentPaidTypes().indexOf("AVOD")},isCompilation:function(){return 2===this.get("kind")},isMovie:function(){var e=this.get("categories");return void 0!==e&&-1!==a.indexOf(e,this.moviesCategory)},getKind:function(){return this.get("kind")},getBaseWatchLink:function(){var e="/watch/";return this.isCompilation()?e+=this.get("hru"):this.get("compilation_hru")?e=e+this.get("compilation_hru")+"/"+this.get("id"):e+=this.get("id"),e},getWatchLink:function(e){e=void 0!==e&&e;var t=this.getBaseWatchLink();return!this.isFake()||this.isCompilation()||e?t:t+"/description"},getTrailersWatchLink:function(){return this.getBaseWatchLink()+"/trailers#play"},getSecondaryPageLink:function(e){var t=this.getWatchLink();return this.isCompilation()?"description"!==e&&(t+="/"+e):this.get("compilation_hru")?(t="/watch/"+this.get("compilation_hru"),"description"!==e&&(t+="/"+e)):t+="/"+e,t},getCompilationWatchLink:function(){var e="/watch/";return this.isCompilation()?e+=this.get("hru"):this.get("compilation_hru")?e+=this.get("compilation_hru"):e="",e},getContentPaidTypes:function(){var e=this.get("content_paid_types")?this.get("content_paid_types"):[];return s.default.isPaywall&&(e=a.uniq(e.map(function(e){return"AVOD"===e?"SVOD":e}))),e},setContentPaidTypes:function(e){this.set("content_paid_types",e?e.slice():[])},isSvod:function(){return-1!==this.getContentPaidTypes().indexOf(this.paidTypeSvod)},isEst:function(){return-1!==this.getContentPaidTypes().indexOf(this.paidTypeEst)},isTvod:function(){return-1!==this.getContentPaidTypes().indexOf(this.paidTypeTvod)},isBought:function(){return void 0!==this.get("isBought")&&this.get("isBought")},setBought:function(){this.set("isBought",!0)},isUsedToBePaid:function(){return void 0!==this.get("used_to_be_paid")&&this.get("used_to_be_paid")},getPosterPath:function(e,t,i){void 0===i&&(i={});var n=null;return n=this.get("poster_originals")&&this.get("poster_originals")[0]?this.get("poster_originals")[0].path.replace("http:","")+(e||""):t||this.stubUrlDefault,i.blur&&(n=o.default.addParamsToUrl(n,{blur:1})),n},getThumbPath:function(){if(this.get("thumb_originals")&&this.get("thumb_originals")[0])return this.get("thumb_originals")[0].path.replace("http:","")},getCompilationTitle:function(){return this.get("compilation_title")},getCompilationContentCount:function(){return this.get("total_contents")},getSeason:function(){return this.get("season")},getEpisode:function(){return this.get("episode")},isSerie:function(){return!!this.get("compilation_hru")},getWatchedTimeMinutes:function(){var e=Math.ceil(this.get("watch_time")/60);return e>this.get("duration_minutes")?this.get("duration_minutes"):e},getDurationMinutes:function(){return this.get("duration_minutes")},getWatchPercent:function(){if(this.get("watch_percent"))return this.get("watch_percent");if(0!==this.getDurationMinutes()){var e=Math.round(this.getWatchedTimeMinutes()/this.getDurationMinutes()*100);return this.set("watch_percent",e),e}return 0},getPaidIcon:function(){return this.isPaid()?this.isSvod()?"":this.blockbustersIconName:""},getAvailableInCountries:function(){return this.get("available_in_countries")},getWatchDate:function(){return this.get("watch_date")},getWatchYear:function(){return this.getWatchDate()?this.get("watch_date").slice(0,4):null},isDRMOnly:function(){return!!this.get("drm_only")},isPurchasable:function(e){return e=void 0!==e&&e,this.isPaid()&&!e&&!this.isFake()},isInfoVideo:function(){return this.get("fake")&&!this.getTrailerList().length},getTrailerList:function(){return this.get("additional_data")?this.get("additional_data").filter(function(e){return"trailer"===e.data_type}):[]},getSpecificWatchLink:function(e){e=a.isUndefined(e)?this.isBought():e;var t="";return this.isInfoVideo()&&!this.isCompilation()&&!this.isSerie()&&!e||this.isPreorderable()?t="/description":this.isFake()&&this.getTrailerList().length&&(!e||this.isCompilation()||this.isSerie())&&(t="/trailers#play"),this.isCompilation()?this.getCompilationWatchLink()+t:this.isSerie()&&this.get("fake")?this.getCompilationWatchLink()+t:this.getBaseWatchLink()+t},getPosterSpecificLink:function(e,t){return this.isCompilation()||this.isSerie()||this.get("fake")&&!this.isPreorderable()||!(this.isTvod()||this.isEst()||this.isSvod()&&!e)?this.getSpecificWatchLink(t):this.getBaseWatchLink()+"/description"},getPosterSpecificLinkQuickSearch:function(e,t){return this.isCompilation()&&this.getTrailerList().length?this.getCompilationWatchLink():this.isFake()&&!this.isCompilation()?this.getBaseWatchLink()+"/description":this.getPosterSpecificLink(e,t)},getNewPriceBadgeClasses:function(e,t){void 0===e&&(e=!1),void 0===t&&(t=!1);var i="poster-badge poster-badge";if(this.isPreorderable())return i+"_pre-order";if(!this.isFake())if(this.isFree()){if(e)return i+(t?"_subscription":"_free")}else{if(this.isSvod())return i+"_subscription";if(this.isTvod()||this.isEst())return i+"_purchase"}return""},getNewPriceBadgeTitle:function(e,t){if(void 0===e&&(e=!1),void 0===t&&(t=!1),this.isPreorderable())return"Предзаказ";if(!this.isFake())if(this.isFree()){if(e)return t?"Подписка":"Бесплатно"}else{if(this.isSvod())return"Подписка";if(this.isTvod()||this.isEst())return"Покупка"}return""},getPosterSpecificCaption:function(e,t,i){void 0===t&&(t=""),void 0===i&&(i=!1),e=e||this.isBought();var n="";if(this.isInfoVideo()||this.isPreorderable())n="Описание";else if(n="Смотреть",this.isPurchasable(e)&&this.isSvod())e||(n+=" по подписке");else{if(this.isFake()&&(!this.isUsedToBePaid()||this.isUsedToBePaid()&&!e))return n+=" трейлер";!this.isFree()||i&&this.isUsedToBePaid()||(n+=" бесплатно")}return!s.default.isPaywall||this.isSvod()||e||(n="Смотреть платно"),n},getCompilationPosterSpecificCaption:function(e,t,i,n){var a;if(this.isInfoVideo())a="Описание";else if(this.isPurchasable(e)&&this.isSeasonPurchasable()&&n)a="Купить Сезон "+this.getFirstSeason()+" от "+n+" руб.";else{var s=t&&i&&t.getId()!==i.getId();a="Смотреть",this.isPurchasable(e)&&!this.isSeasonPurchasable()?a+=" по подписке":this.isFake()?a+=" трейлер":s?a="Продолжить просмотр":this.isFree()&&(a+=" бесплатно")}return a},getRestrict:function(){return this.get("restrict")},isForAdult:function(){return this.getRestrict()>=this.ageLimit},getType:function(){return this.get("type")},getHdAvailable:function(){return!!this.get("hd_available")},getYear:function(){return this.get("year")?this.get("year"):this.get("years")&&this.get("years")[0]?this.get("years")[0]:null},getCountryId:function(){return this.get("country")},getDurationPT:function(){if(this.get("duration")){var e=this.get("duration").split(":");if(3===e.length){return"PT"+parseInt(e[0])+"H"+parseInt(e[1])+"M"+parseInt(e[2])+"S"}}return null},getIviRating:function(){return this.get("ivi_rating_10")},getKpRating:function(){return this.get("kp_rating")},getImdbRating:function(){return this.get("imdb_rating")},getSynopsis:function(){return this.get("synopsis")},getDescription:function(){return this.get("description")},isPreorderable:function(){return!!this.get("preorderable")},getYearList:function(){return this.get("years")},getContentPaidTypeList:function(){return!this.isFake()&&this.get("content_paid_types")?this.get("content_paid_types"):[]},getFirstSeason:function(){return Math.min.apply(null,this.get("seasons"))},getSeasonPurchaseInfo:function(e){return this.get("seasons_extra_info")?this.get("seasons_extra_info")[e]:null},isSeasonPurchasable:function(e){if(this.getFirstSeason()){e||(e=this.getFirstSeason());var t=this.getSeasonPurchaseInfo(e);if(t)return t.purchasable}return!1}})},function(e,t,i){var n=i(0);t.default=new n.Model({})},function(e,t,i){var n=i(0);t.default=new n.Model({})},function(e,t,i){var n=i(1),a=i(0),s=a.View.extend({el:"groot",$parentEl:null,useParentGrootTag:function(){var e;try{e=window.parent.document.getElementsByTagName("groot")}catch(t){e=window.document.getElementsByTagName("groot")}e.length&&(this.$parentEl=n(e[0]))},getParam:function(e){var t=n("groot").data(e);return void 0===t&&this.$parentEl?this.$parentEl.data(e):t},getRefPage:function(){return this.getParam("ref-page")||""},getPersonId:function(){return this.getParam("person-id")},getTrialAvailability:function(){return this.getParam("is-trial-available")},getApplePayAvailability:function(){return!!this.getParam("is-apple-pay-available")},isUserPesonalizable:function(){return!!this.getParam("user-personalizable")},getSubscriptionPrice:function(){return this.getParam("subscription-price")},getUserABTests:function(){var e=this.getParam("user-ab-tests");return e?JSON.parse(e.replace(/'/g,'"')):""},getCategoryId:function(){return this.getParam("category-id")},getGenreId:function(){return this.getParam("genre-id")},getCountryCode:function(){return this.getParam("country-code")},getIp:function(){return this.getParam("ip")},getUserProperties:function(){var e=this.getParam("user-properties");return e?JSON.parse(e.replace(/'/g,'"')):{}},getReferer:function(){return this.getParam("referer")||""},getUserActiveDaysQuantity:function(){return this.getParam("user-active-days-quantity")},isMobileFullScreenBannerShown:function(){return 1===parseInt(this.getParam("fullscreen-banner-shown"))},isRenewActive:function(){return this.getParam("renew-active")},isDobillActive:function(){return this.getParam("dobill-active")},isSvodByCard:function(){return this.getParam("svod-by-card")},isInBundle:function(){return this.getParam("is-in-bundle")}});t.default=new s},function(e,t,i){var n=i(5),a=i(1),s=i(10),o=i(39),r=i(36),l=i(4),d=i(28),u=i(35),c=function(){function e(){this.VIEW_LIST_COUNT=3,this.VIEW_LIST_TRACKED_FLAG="criteo-tracked",this.TRACKING_KEY="utm_source",this.TRACKING_VALUE="criteo",this.COOKIE_KEY="from_criteo",this.COOKIE_VALUE="1",this.COOKIE_LIFETIME=2592e3,this.parseDeduplication()}return e.prototype.parseDeduplication=function(){var e=d.default.queryParams(l.default.getLocation().search);e[this.TRACKING_KEY]&&(e[this.TRACKING_KEY]===this.TRACKING_VALUE?u.set(this.COOKIE_KEY,this.COOKIE_VALUE,{expires:this.COOKIE_LIFETIME,domain:document.domain.replace(/^(.*?)(\w+\.\w+)$/,".$2")}):u.expire(this.COOKIE_KEY,{domain:document.domain.replace(/^(.*?)(\w+\.\w+)$/,".$2")}))},e.prototype.isDeduplication=function(){return u.get(this.COOKIE_KEY)===this.COOKIE_VALUE},e.prototype.viewList=function(e,t){var i=this;if(void 0===t&&(t=!1),t||!e.data(this.VIEW_LIST_TRACKED_FLAG)){e.data(this.VIEW_LIST_TRACKED_FLAG,"1");var n=[];e.find("li").each(function(e,t){if(e>=i.VIEW_LIST_COUNT)return!1;var s=a(t);if(s.data("content-id")){var o=s.data("content-type")===r.default.prototype.CONTENT_OBJECT_TYPE?"s_":"c_";n.push(o+s.data("content-id"))}}),n.length>0&&this.trackEvent("viewList",{item:n})}},e.prototype.viewBasket=function(e,t,i){this.trackEvent("viewBasket",{currency:o.default.getCurrency(),item:[this.getProfuctItemData(e,t,i)]})},e.prototype.trackTransaction=function(e){var t;e.purchaseType===r.default.prototype.SUBSCRIPTION_OBJECT_TYPE?t="svod_"+e.transactionId:"eternal"===e.purchaseOwnershipType?t="est_"+e.transactionId:"temporal"===e.purchaseOwnershipType&&(t="tvod_"+e.transactionId),this.trackEvent("trackTransaction",{id:t,deduplication:this.isDeduplication()?1:0,currency:o.default.getCurrency(),item:[this.getProfuctItemData(e.objectId,e.objectType,e.price)]})},e.prototype.getProfuctItemData=function(e,t,i){var n=t===r.default.prototype.CONTENT_OBJECT_TYPE||t===r.default.prototype.SUBSCRIPTION_OBJECT_TYPE?"s_":"c_";return"0"===i&&(i="1"),{id:n+e,price:i,quantity:1}},e.prototype.trackEvent=function(e,t){if(window.criteo_q){var i={event:e};i.user_segment=s.default.hasSubscription?1:2,n.extend(i,t);try{window.criteo_q.push(i)}catch(e){}}},e}();t.default=new c},function(e,t,i){var n=i(0);t.default=new n.Model({})},function(e,t,i){"use strict";function n(e){return function(){return e}}var a=function(){};a.thatReturns=n,a.thatReturnsFalse=n(!1),a.thatReturnsTrue=n(!0),a.thatReturnsNull=n(null),a.thatReturnsThis=function(){return this},a.thatReturnsArgument=function(e){return e},e.exports=a},function(e,t,i){var n=i(1),a=i(0),s=i(314),o=i(658),r=i(660),l=i(36),d=i(33),u=i(315),c=i(316),p=i(662),f=i(665),h=i(667),g=i(681),m=i(192),v=i(124),_=i(60),b=i(23),y=i(32),w=i(22),C=i(10),k=i(11),P=i(3),S=i(43),T=i(20),E=i(4),I=i(8),x=i(158),M=i(322),A=i(41),L=i(18),O=i(7);t.default=d.default.extend({purchaseId:null,purchaseParams:null,contentInfo:null,browserInfo:null,showDrmNotice:!1,contentEntity:null,grootParamFrom:"content",grootParamFromKey:"groot_from",model:null,fullscreenPreorderView:null,offerSubscriptionOnAvod:!1,initialize:function(){this.contentInfo=new b.default,this.browserInfo=new y.default,this.contentEntity=this.contentInfo.getContentEntity(),this.setShowDrmNotice(),this.purchaseParams=new v.default({contentInfo:this.contentInfo,contentEntity:this.contentEntity}),this.contentPurchaseOptions=new l.default,this.subscriptionPurchaseOptions=new _.default,(new M.default).render(),this.setIsInBundle(),this.offerSubscriptionOnAvod=L.default.offerSubscriptionOnAvod()&&this.contentEntity.isFree(),this.offerSubscriptionOnAvod&&(this.grootParamFrom="avod_content")},setShowDrmNotice:function(){this.showDrmNotice=this.contentInfo.isDRMOnly()&&!this.browserInfo.browserCanPlayDrm()},loadGrootParamFrom:function(){T.default.localStorage.getItem(this.grootParamFromKey)&&(this.grootParamFrom=T.default.localStorage.getItem(this.grootParamFromKey),T.default.localStorage.removeItem(this.grootParamFromKey))},afterLogin:function(){var e=this,t={purchaseParams:this.purchaseParams,contentEntity:this.contentEntity,contentInfo:this.contentInfo};if(this.loadGrootParamFrom(),this.button=new s.default(t),new c.default(t),this.model=new a.Model({user:I.default,redirectUrl:encodeURIComponent("/watch/"+this.contentEntity.getId()+"/description"),from:this.grootParamFrom,showDrmNotice:this.showDrmNotice,branchLink:x.default.createContentLink(),contentEntity:this.contentEntity,contentInfo:this.contentInfo}),this.contentEntity.isPaid()||this.contentEntity.isUsedToBePaid()&&this.contentEntity.isBought()||this.contentEntity.isPreorderable()||this.contentEntity.isFake()&&this.contentEntity.isBought()||this.offerSubscriptionOnAvod)if(this.setupPaymentModalProcessing(),this.contentEntity.isPaid()&&((this.contentEntity.isEst()||this.contentEntity.isTvod())&&(new r.default,new m.default({model:this.model}).listen(k.default)),new u.default({model:this.model}).listen(k.default)),this.contentEntity.isPreorderable()&&(new f.default({model:this.model}).listen(k.default),new p.default({model:this.model}).listen(k.default),(new g.default).render(this.contentInfo),L.default.showNewPreorderPopup()&&/\/description/.test(E.default.getLocation().href)&&(this.fullscreenPreorderView=new h.default(this.contentEntity))),C.default.isPaywall&&this.contentEntity.isSvod()){var i=this.getSpecificPurchaseOptions(this.purchaseParams);i.mapiGet(this.getSpecificPurchaseOptionsRequestData(this.purchaseParams)).done(function(){i===e.contentPurchaseOptions||i.hasSubscription()?e.showPurchaseModal(i):e.contentPurchaseOptions.mapiGet({data:{id:e.purchaseParams.getPurchaseId()}}).done(function(){e.contentPurchaseOptions.isPurchased()?e.showPurchaseModal(e.contentPurchaseOptions):e.showPurchaseModal(i)})})}else this.contentPurchaseOptions.mapiGet({data:{id:this.purchaseParams.getPurchaseId()}}).done(function(){e.showPurchaseModal(e.contentPurchaseOptions)});n("#js-not-in-subscription-remark").length&&(new o.default).render()},setupPaymentModalProcessing:function(){this.listenTo(k.default,"buy:click",this.processPurchaseModal),this.listenTo(k.default,"buy:processPurchaseClickByGuestUser",this.processPurchaseClickByGuestUser)},showPurchaseModal:function(e){k.default.trigger("buy-button:show",e),e.isPurchased()||"1"!==this.queryParams.buy_modal||this.button.triggerEvent(null),this.contentEntity.isPreorderable()&&this.fullscreenPreorderView&&(this.fullscreenPreorderView.setContentPurchaseOptions(this.contentPurchaseOptions),k.default.trigger("billing:fullscreenPreorderModal:show"))},processPurchaseModal:function(e,t){var i=this,a=this.grootParamFrom,s=this.getSpecificPurchaseOptions(t);s.mapiGet(this.getSpecificPurchaseOptionsRequestData(t)).done(function(){var o={source:t.getPurchaseSourceForGroot()||"b",from:a},r=s.getPurchaseOptionList();n.extend(o,r.getRightTypeForGroot()),I.default.isIdentified()?(P.default.track("buy_click",o),i.triggerModalShow(e,t,r,a)):w.default.registerProofOfWork().done(function(){P.default.track("buy_click",o),i.triggerModalShow(e,t,r,a)})})},setIsInBundle:function(){T.default.localStorage.removeItem("is_in_bundle"),S.default.isInBundle()&&T.default.localStorage.setItem("is_in_bundle",!0)},triggerModalShow:function(e,t,i,n){if((e.isSvod()||this.offerSubscriptionOnAvod)&&this.model.set("redirectUrl",encodeURIComponent(e.getWatchLink())),t.getPurchaseType()===l.default.prototype.SUBSCRIPTION_OBJECT_TYPE||this.offerSubscriptionOnAvod){var a=void 0,s=void 0;this.model.get("contentInfo").isCompilation()?(s=l.default.prototype.SEASON_OBJECT_TYPE,a=this.model.get("contentInfo").getCompilationId()):(s=l.default.prototype.CONTENT_OBJECT_TYPE,a=this.model.get("contentInfo").getId()),A.default.trigger("showSubscriptionLanding",n,{redirect_url:this.model.get("redirectUrl"),object_id:a,object_type:s})}else k.default.trigger(this.getRightShowPurchaseModalEventName(t),i,t.getPurchaseSourceForGroot(),n,!0)},getSpecificPurchaseOptions:function(e){return this.offerSubscriptionOnAvod?this.subscriptionPurchaseOptions:e.getPurchaseType()===l.default.prototype.SUBSCRIPTION_OBJECT_TYPE?this.subscriptionPurchaseOptions:this.contentPurchaseOptions},getSpecificPurchaseOptionsRequestData:function(e){return e.getPurchaseType()===l.default.prototype.SUBSCRIPTION_OBJECT_TYPE?{data:{with_long_subscriptions:1,with_subscription_renewals:1}}:{data:{id:e.getPurchaseId()}}},getRightShowPurchaseModalEventName:function(){return m.default.prototype.openEvent},processPurchaseClickByGuestUser:function(e){var t=this;this.redirectUrl=e.currentTarget.href,this.productIdentifier=n(e.currentTarget).data("product-identifier"),this.listenTo(O.default,"loadUser",this.processPurchaseAfterLogin),this.listenTo(O.default,"auth:modal:closed",function(){t.stopListening(O.default,"loadUser",t.processPurchaseAfterLogin)})},processPurchaseAfterLogin:function(){var e={redirectUrl:this.redirectUrl,productIdentifier:this.productIdentifier,callbackForPurchasedState:E.default.reload,contentPurchaseOptions:this.contentPurchaseOptions,contentId:this.purchaseParams.getPurchaseId()};k.default.trigger("buy:processContentPurchaseAfterLogin",e)}})},function(e,t,i){var n=i(0);t.default=new n.Model({})},function(e,t,i){var n=i(6),a=i(695);t.default=n.default.extend({run:function(){new a.default}})},function(e,t){var i=function(){function e(){}return e.prototype.getActiveElement=function(){return document.activeElement},e.prototype.addMousewheelListener=function(e){document.addEventListener?"onwheel"in document?document.addEventListener("wheel",e):"onmousewheel"in document?document.addEventListener("mousewheel",e):document.addEventListener("DOMMouseScroll",e):document.attachEvent("onmousewheel",e)},e.prototype.createElement=function(e){return document.createElement(e)},e.prototype.getScrollHeight=function(){return document.documentElement.scrollHeight},e.prototype.getReferrer=function(){return document.referrer},e.prototype.appendToBody=function(e){document.body.appendChild(e)},e.prototype.getLastAncestorOrigin=function(){var e="";try{document.location.ancestorOrigins&&document.location.ancestorOrigins.length&&(e=document.location.ancestorOrigins[document.location.ancestorOrigins.length-1])}catch(e){}return e},e.prototype.addVisibilityChangeListener=function(e){var t=function(){"function"==typeof e&&e()},i=document;"hidden"in i?i.addEventListener("visibilitychange",t):"mozHidden"in i?i.addEventListener("mozvisibilitychange",t):"webkitHidden"in i?i.addEventListener("webkitvisibilitychange",t):"msHidden"in i?i.addEventListener("msvisibilitychange",t):"onfocusin"in i?i.onfocusin=i.onfocusout=t:window.onpageshow=window.onpagehide=window.onfocus=window.onblur=t},e.prototype.toggleFullscreen=function(e){this.isFullscreen()?this.exitFullscreen():this.requestFullscreen(e)},e.prototype.isFullscreen=function(){return"webkitIsFullScreen"in document?document.webkitIsFullScreen:"mozFullScreen"in document?document.mozFullScreen:"msFullScreen"in document?document.msFullScreen:"fullscreen"in document?document.fullscreen:!!document.msFullscreenElement&&!!document.msFullscreenElement},e.prototype.requestFullscreen=function(e){var t=document.getElementById(e);t.webkitRequestFullscreen?t.webkitRequestFullscreen():t.mozRequestFullScreen?t.mozRequestFullScreen():t.msRequestFullscreen?t.msRequestFullscreen():t.requestFullscreen&&t.requestFullscreen()},e.prototype.exitFullscreen=function(){document.webkitExitFullscreen?document.webkitExitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.msExitFullscreen?document.msExitFullscreen():document.exitFullscreen&&document.exitFullscreen()},e.prototype.addFullscreenChangeListener=function(e){"onwebkitfullscreenchange"in document?document.addEventListener("webkitfullscreenchange",e):"onmozfullscreenchange"in document?document.addEventListener("mozfullscreenchange",e):"onmsfullscreenchange"in document?document.addEventListener("MSFullscreenChange",e):"onfullscreenchange"in document&&document.addEventListener("fullscreenchange",e)},e.prototype.removeFullscreenChangeListener=function(e){"onwebkitfullscreenchange"in document?document.removeEventListener("webkitfullscreenchange",e):"onmozfullscreenchange"in document?document.removeEventListener("mozfullscreenchange",e):"onmsfullscreenchange"in document?document.removeEventListener("MSFullscreenChange",e):"onfullscreenchange"in document&&document.removeEventListener("fullscreenchange",e)},e}();t.default=new i},function(e,t,i){i(76);var n=i(36),a=i(1),s=i(399),o=i(400),r=i(40),l=i(402),d=i(10),u=i(26),c=i(41),p=i(403),f=i(20),h=i(4);t.default={attachPosterPopup:function(e){e&&e.length>0&&e.posterPopup().progress(function(e,t){var i=new r.default(t.compilation?t.compilation:t.video),g=new o.default(t.directors),m=new o.default(t.actors),v=new s.default(t.singleGenre),_=new n.default,b=function(){var n="";_.isPurchased()?i.setBought():d.default.isWorld&&(i.isSvod()?i.isFake()||d.default.hasSubscription||(n="has-button"):i.isFake()?i.isPreorderable()&&(n="has-button"):n="has-button");var s={directors:g.models,actors:m.models,countryList:t.countryList,singleGenre:v},o="";t.compilation?(o=l.default,s.compilation=i):(o=p.default,s.video=i),n&&e.addClass(n),e.html(o(s)),e.find(".js-popup-subscription-link").click(function(){return c.default.trigger("showSubscriptionLanding","popup"),!1}),e.parents(".js-carousel").find(".js-collection-block").length&&h.default.isMainPage()&&e.find(".js-description-link").on("mouseup contextmenu",function(e){var t=a(e.target).attr("href").match(/\/watch\/[\w|\d|-]*/);t.length&&f.default.localStorage.setItem("main_collections_clicked",t[0])}),e.addClass("loaded"),u.default.trigger("poster:ready",e)};!d.default.isWorld||i.isFake()||i.isSvod()?b():_.mapiGet({data:{id:i.getId()}}).done(function(){b()})})}}},function(e,t,i){"use strict";function n(e){return void 0!==e.ref}function a(e){return void 0!==e.key}var s=i(24),o=i(70),r=(i(17),i(280),Object.prototype.hasOwnProperty),l="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103,d={key:!0,ref:!0,__self:!0,__source:!0},u=function(e,t,i,n,a,s,o){var r={$$typeof:l,type:e,key:t,ref:i,props:o,_owner:s};return r};u.createElement=function(e,t,i){var s,l={},c=null,p=null;if(null!=t){n(t)&&(p=t.ref),a(t)&&(c=""+t.key),void 0===t.__self?null:t.__self,void 0===t.__source?null:t.__source;for(s in t)r.call(t,s)&&!d.hasOwnProperty(s)&&(l[s]=t[s])}var f=arguments.length-2;if(1===f)l.children=i;else if(f>1){for(var h=Array(f),g=0;g<f;g++)h[g]=arguments[g+2];l.children=h}if(e&&e.defaultProps){var m=e.defaultProps;for(s in m)void 0===l[s]&&(l[s]=m[s])}return u(e,c,p,0,0,o.current,l)},u.createFactory=function(e){var t=u.createElement.bind(null,e);return t.type=e,t},u.cloneAndReplaceKey=function(e,t){return u(e.type,t,e.ref,e._self,e._source,e._owner,e.props)},u.cloneElement=function(e,t,i){var l,c=s({},e.props),p=e.key,f=e.ref,h=(e._self,e._source,e._owner);if(null!=t){n(t)&&(f=t.ref,h=o.current),a(t)&&(p=""+t.key);var g;e.type&&e.type.defaultProps&&(g=e.type.defaultProps);for(l in t)r.call(t,l)&&!d.hasOwnProperty(l)&&(void 0===t[l]&&void 0!==g?c[l]=g[l]:c[l]=t[l])}var m=arguments.length-2;if(1===m)c.children=i;else if(m>1){for(var v=Array(m),_=0;_<m;_++)v[_]=arguments[_+2];c.children=v}return u(e.type,p,f,0,0,h,c)},u.isValidElement=function(e){return"object"==typeof e&&null!==e&&e.$$typeof===l},u.REACT_ELEMENT_TYPE=l,e.exports=u},function(e,t,i){"use strict";function n(){E.ReactReconcileTransaction&&w||u("123")}function a(){this.reinitializeTransaction(),this.dirtyComponentsLength=null,this.callbackQueue=p.getPooled(),this.reconcileTransaction=E.ReactReconcileTransaction.getPooled(!0)}function s(e,t,i,a,s,o){n(),w.batchedUpdates(e,t,i,a,s,o)}function o(e,t){return e._mountOrder-t._mountOrder}function r(e){var t=e.dirtyComponentsLength;t!==v.length&&u("124",t,v.length),v.sort(o),_++;for(var i=0;i<t;i++){var n=v[i],a=n._pendingCallbacks;n._pendingCallbacks=null;var s;if(h.logTopLevelRenders){var r=n;n._currentElement.props===n._renderedComponent._currentElement&&(r=n._renderedComponent),s="React update: "+r.getName(),console.time(s)}if(g.performUpdateIfNecessary(n,e.reconcileTransaction,_),s&&console.timeEnd(s),a)for(var l=0;l<a.length;l++)e.callbackQueue.enqueue(a[l],n.getPublicInstance())}}function l(e){if(n(),!w.isBatchingUpdates)return void w.batchedUpdates(l,e);v.push(e),null==e._updateBatchNumber&&(e._updateBatchNumber=_+1)}function d(e,t){w.isBatchingUpdates||u("125"),b.enqueue(e,t),y=!0}var u=i(15),c=i(24),p=i(290),f=i(69),h=i(291),g=i(86),m=i(97),v=(i(13),[]),_=0,b=p.getPooled(),y=!1,w=null,C={initialize:function(){this.dirtyComponentsLength=v.length},close:function(){this.dirtyComponentsLength!==v.length?(v.splice(0,this.dirtyComponentsLength),S()):v.length=0}},k={initialize:function(){this.callbackQueue.reset()},close:function(){this.callbackQueue.notifyAll()}},P=[C,k];c(a.prototype,m.Mixin,{getTransactionWrappers:function(){return P},destructor:function(){this.dirtyComponentsLength=null,p.release(this.callbackQueue),this.callbackQueue=null,E.ReactReconcileTransaction.release(this.reconcileTransaction),this.reconcileTransaction=null},perform:function(e,t,i){return m.Mixin.perform.call(this,this.reconcileTransaction.perform,this.reconcileTransaction,e,t,i)}}),f.addPoolingTo(a);var S=function(){for(;v.length||y;){if(v.length){var e=a.getPooled();e.perform(r,null,e),a.release(e)}if(y){y=!1;var t=b;b=p.getPooled(),t.notifyAll(),p.release(t)}}},T={injectReconcileTransaction:function(e){e||u("126"),E.ReactReconcileTransaction=e},injectBatchingStrategy:function(e){e||u("127"),"function"!=typeof e.batchedUpdates&&u("128"),"boolean"!=typeof e.isBatchingUpdates&&u("129"),w=e}},E={ReactReconcileTransaction:null,batchedUpdates:s,enqueueUpdate:l,flushBatchedUpdates:S,injection:T,asap:d};e.exports=E},function(e,t,i){var n=i(0),a=i(314),s=i(37),o=i(32),r=i(36),l=i(315),d=i(316),u=i(124),c=i(652),p=i(161),f=i(60),h=i(47),g=i(5),m=i(11),v=i(48),_=i(3),b=i(8),y=i(158),w=i(322),C=i(44),k=i(4),P=i(7),S=i(18),T=i(208);t.default=h.default.extend({initialize:function(){this.contentInfo=new s.default,this.browserInfo=new o.default,this.contentEntity=this.contentInfo.getContentEntity(),this.setShowDrmNotice(),this.purchaseParams=new u.default({contentInfo:this.contentInfo,contentEntity:this.contentEntity}),this.seasonPurchaseOptions=new p.default,this.subscriptionPurchaseOptions=new f.default,this.contentPurchaseOptions=new r.default,this.loadGrootParamFrom(),this.listenTo(v.default,"compilation:serieListLoaded",this.loadSeasonPurchaseOptions),this.listenTo(m.default,"billing:processSeasonPurchaseModal",this.showSeasonPurchaseModal),this.listenTo(m.default,"billing:processSeasonPayment",this.processSeasonPayment),(new w.default).render(),this.offerSubscriptionOnAvod=S.default.offerSubscriptionOnAvod()&&this.contentEntity.isFree(),this.offerSubscriptionOnAvod&&(this.grootParamFrom="avod_content"),this.seasonIdToPurchaseAfterLogin=this.contentInfo.getSeasonId(this.contentEntity.getSeason())},afterLogin:function(){var e=this,t={purchaseParams:this.purchaseParams,contentEntity:this.contentEntity,contentInfo:this.contentInfo};if(this.button=new a.default(t),new d.default(t),this.model=new n.Model({user:b.default,from:this.grootParamFrom,seasonId:this.contentInfo.getSeasonId(this.contentEntity.getSeason()),showDrmNotice:this.showDrmNotice,branchLink:y.default.createContentLink(),contentEntity:this.contentEntity,contentInfo:this.contentInfo}),(this.contentInfo.isPaid()||this.contentInfo.isPartiallyFree()||this.offerSubscriptionOnAvod)&&(this.setupPaymentModalProcessing(),this.contentInfo.isEst()&&(new c.default({model:this.model}).listen(m.default),new l.default({model:this.model}).listen(m.default))),this.contentEntity.isPaid()||this.contentInfo.isSeasonUsedToBePaid(this.contentEntity.getSeason()))if(this.contentInfo.isSeasonUsedToBePaid(this.contentEntity.getSeason())&&!this.contentEntity.isEst())this.contentPurchaseOptions.mapiGet({data:{id:this.contentEntity.getId()}}).done(function(){if(e.contentPurchaseOptions.isPurchased())e.showPurchaseModal(e.contentPurchaseOptions);else{var t=e.getSpecificPurchaseOptions(e.purchaseParams);t.mapiGet(e.getSpecificPurchaseOptionsRequestData(e.purchaseParams)).done(function(){e.showPurchaseModal(t)})}});else if(this.contentEntity.isEst()&&this.contentEntity.isSvod()&&this.contentInfo.isEternalBought())this.seasonPurchaseOptions.mapiGet({data:{id:this.purchaseParams.getPurchaseId()}}).done(function(){e.showPurchaseModal(e.seasonPurchaseOptions)});else{var i=this.getSpecificPurchaseOptions(this.purchaseParams);i.mapiGet(this.getSpecificPurchaseOptionsRequestData(this.purchaseParams)).done(function(){e.showPurchaseModal(i)})}},processPurchaseModal:function(e,t){g.extend(this.model.attributes,t.getSpecificParams()),this.model.set("season",e.getSeason()),this.model.set("serieId",e.getId()),this.model.set("episode",e.getEpisode()),this.model.set("redirectUrl",encodeURIComponent(this.contentInfo.getSerieWatchLink(e.getId()))),h.default.prototype.processPurchaseModal.call(this,e,t)},loadSeasonPurchaseOptions:function(e,t,i){var n=this,a=e.getSeason(),s=this.contentInfo.getSeasonId(e.getSeason());this.contentInfo.isSeasonUsedToBePaid(e.getSeason())&&!i?this.contentPurchaseOptions.mapiGet({data:{id:e.getId()}}).done(function(e){e.error||v.default.trigger("compilation:seasonDataLoaded",a,n.contentPurchaseOptions.isPurchased()?n.contentPurchaseOptions:t)}):s&&i?this.seasonPurchaseOptions.mapiGet({data:{id:s}}).done(function(e){e.error||v.default.trigger("compilation:seasonDataLoaded",a,n.seasonPurchaseOptions)}):v.default.trigger("compilation:seasonDataLoaded",a,t)},getSpecificPurchaseOptions:function(e){return this.offerSubscriptionOnAvod?this.subscriptionPurchaseOptions:e.getPurchaseType()===r.default.prototype.SUBSCRIPTION_OBJECT_TYPE?this.subscriptionPurchaseOptions:this.seasonPurchaseOptions},getRightShowPurchaseModalEventName:function(){return c.default.prototype.openEvent},showSeasonPurchaseModal:function(e,t){var i=t.getSpecificParams(),n=i&&Object.keys(i).length>0?i.seasonPurchaseOptions:null;e.isEst()&&t.getPurchaseType()===r.default.prototype.SEASON_OBJECT_TYPE&&null!==n?(g.extend(this.model.attributes,i),this.model.set("season",e.getSeason()),this.model.set("serieId",e.getId()),this.model.set("episode",e.getEpisode()),this.model.set("redirectUrl",encodeURIComponent(this.contentInfo.getSerieWatchLink(e.getId()))),m.default.trigger("billing:purchase:seasonModal:show",n.getPurchaseOptionList())):m.default.trigger("buy:click",e,t)},processSeasonPayment:function(e,t,i){var n=this,a=t.getSpecificParams(),s=a&&Object.keys(a).length>0?a.seasonPurchaseOptions:null;if(this.seasonIdToPurchaseAfterLogin=t.getPurchaseId(),s){var o=s.getPurchaseOptionList();this.makeSeasonPayment(o,e,t,a,i)}else this.seasonPurchaseOptions.mapiGet(this.getSpecificPurchaseOptionsRequestData(t)).done(function(s){var o=s.result?n.seasonPurchaseOptions.getPurchaseOptionList():new T.default;n.makeSeasonPayment(o,e,t,a,i)})},makeSeasonPayment:function(e,t,i,n,a){var s={from:"content"},o=e.findWhere({option_hash:n.optionHash});if(o&&(g.extend(s,o.getGrootParams()),C.default.viewBasket(i.getPurchaseId(),i.getPurchaseType(),o.getMinUserPrice())),_.default.track("price_click",s),!b.default.isAuthenticated()&&S.default.showAuthBeforePurchase())return m.default.trigger("buy:processPurchaseClickByGuestUser",a),P.default.trigger("auth:showLoginModal:beforePurchase"),!1;o?m.default.trigger("purchase:personal",o.toJSON(),n.buyUrl,this.contentInfo.getWatchLink(t.getId())):m.default.trigger("purchase:personal",{},n.buyUrl)},processPurchaseAfterLogin:function(){var e={redirectUrl:this.redirectUrl,productIdentifier:this.productIdentifier,callbackForPurchasedState:k.default.reload,contentPurchaseOptions:this.seasonPurchaseOptions,contentId:this.seasonIdToPurchaseAfterLogin};m.default.trigger("buy:processContentPurchaseAfterLogin",e)}})},function(e,t,i){var n=i(0);t.default=new n.Model({})},function(e,t,i){var n=i(323),a=i(37),s=i(6),o=i(324),r=i(325),l=i(26);t.default=s.default.extend({run:function(){var e=new a.default,t=e.getCompilationId();t||(t=e.getId()),e.isFake()||(new o.default).render(),(new r.default).listen(l.default),new n.default({objectId:t,type:"compilation"}),l.default.trigger("favourite:check",{objectId:t,type:"compilation"})}})},function(e,t,i){var n=i(0);t.default=new n.Model({})},function(e,t,i){var n=i(1),a=i(0),s=i(61),o=i(117),r=i(30);t.default=a.View.extend(s.default).extend({el:".js-profile-content",selectionSize:10,template:void 0,waypointTrigger:8,mobileTabEl:"",bodyHasPaymentStatementClass:"has-receipt",contentMainNoPurchasesClass:"no-elements",initialize:function(e){this.isActivated=!1,this.isDataExists=!1,this.templateParams={selectionSize:this.selectionSize},this.initializeParams=e||{},this.initializeParams.waypoint&&window.ivi.adaptive.isMobile&&this.listenTo(o.default,"common:waypointReached",this.loadMore)},show:function(e){this.isActivated&&this.isDataExists&&this.userPurchases&&(r.default.trigger("profile:sectionOpen",this,e),n("li.js-profile-nav").removeClass("active"),n(this.tabEl).addClass("active"),window.ivi.adaptive.isMobileStyle&&n(".section-title").text(n(this.mobileTabEl||this.tabEl).text()),this.$el.html(this.template(this.templateParams)),this.$el.show(),n("body").removeClass(this.bodyHasPaymentStatementClass),n(".content-main").removeClass(this.contentMainNoPurchasesClass),this.afterShow(),r.default.trigger("profile:groot:setRefPage",this.grootRefPage))},afterShow:function(){this.initializeParams.waypoint&&window.ivi.adaptive.isMobileStyle&&this.mainCollection&&this.mainCollection.isMore()&&this.initWaypoint()},loadData:function(e,t){var i=this;e.mapiGet(t).done(function(e){e.error||(i.isDataExists=!0,i.userPurchases&&i.mainCollection&&i.prepareCollection())})},loadMore:function(){return this.mainCollection.increaseSelection(this.selectionSize),this.mainCollection.mapiGet(),!1},activate:function(){this.isActivated=!0,this.show(!0)},deactivate:function(){this.isActivated=!1},isActive:function(){return this.isActivated},setUpPurchases:function(e){this.userPurchases=e,this.isDataExists&&this.mainCollection&&this.mainCollection.mergePurchasesAndVideoEntity&&this.mainCollection.mergePurchasesAndVideoEntity(this.userPurchases)},prepareCollection:function(){this.mainCollection.mergePurchasesAndVideoEntity&&this.mainCollection.mergePurchasesAndVideoEntity(this.userPurchases),this.show(!1)},getWayPoint:function(){var e=this.$el.find("li");return e.get(e.length-this.waypointTrigger)}})},function(e,t,i){var n=i(323),a=i(6),s=i(324),o=i(325),r=i(23),l=i(26);t.default=a.default.extend({run:function(e){(new r.default).isFake()||(new s.default).render(),new n.default({objectId:e.id,type:"video"}),l.default.trigger("favourite:check",{objectId:e.id,type:"video"}),(new o.default).listen(l.default)}})},function(e,t,i){var n=i(36),a=i(10),s=i(5);t.default=n.default.extend({uri:"/billing/v1/purchase/options/",fields:"price_ranges,purchases,purchase_options",hasSubscription:function(){var e=!1;return s.each(this.get("purchases"),function(t){"subscription"===t.object_type&&(e=!0)}),e},isTrialAvailable:function(){var e=!1;return s.each(this.get("purchase_options"),function(t){"subscription"===t.object_type&&t.trial&&(e=!0)}),e},fetchChangeCardOptions:function(){return this.mapiGet({data:{with_change_card:1}})},fetchOptions:function(){return this.mapiGet({data:this.getSubscriptionOptionsRequestData()})},fetchOptionsSpasiboPayment:function(){var e=window.ivi.adaptive.isMobile?a.default.payments.spasibo_payment_mobile_app_version:a.default.payments.spasibo_payment_desktop_app_version;return this.mapiGet({data:this.getSubscriptionOptionsRequestData()},e)},fetchOptionsSpasiboScoring:function(){var e=window.ivi.adaptive.isMobile?a.default.payments.spasibo_scoring_mobile_app_version:a.default.payments.spasibo_scoring_desktop_app_version;return this.mapiGet({data:this.getSubscriptionOptionsRequestData()},e)},getSubscriptionOptionsRequestData:function(){return{with_long_subscriptions:1,with_subscription_renewals:1}},getChangeCardOption:function(){var e=this.get("purchase_options");if(e){var t=s.findWhere(e,{object_type:"subscription",change_card:!0});if(t)return this.getPurchaseOptionList().findProduct(t.option_hash)}return null}})},function(e,t,i){i(149);var n=i(1),a=i(5),s=i(50),o=i(117),r=i(267),l=i(4);t.default=a.extend(r.default,{elementsPerPage:0,elementsPerLine:0,startPage:0,strictLoadBorder:!1,wayPoint:null,scrollHeightBefore:0,pageYOffsetBefore:0,initLoadMore:function(){var e=this;this.loadDataParams.data.from=this.startPage*this.elementsPerPage,this.listenTo(o.default,"common:waypointReached",function(t){t.data("waypoint-loaded")||(e.loadData(e.collection),t.data("waypoint-loaded",!0))}),(!this.totalCount||this.totalCount>this.getElements().length)&&(this.incrementFromTo(),this.initWaypoint()),n("#js-pagination").hide()},incrementFromTo:function(){this.loadDataParams.data.from+=this.elementsPerPage,this.loadDataParams.data.to=this.loadDataParams.data.from+this.elementsPerPage,this.strictLoadBorder||(this.loadDataParams.data.to-=1)},initWaypoint:function(){var e=this.getWayPoint();if(e){var t=n(e),i=this.loadDataParams.data?this.loadDataParams.data.from:0,a=i/this.elementsPerPage+1;t.data("waypoint-page",a);var s=t.waypoint({enabled:t.is(":visible"),handler:function(e){"down"===e&&(this.destroy(),o.default.trigger("common:waypointReached",t))}});s.length&&(this.wayPoint=s[0])}},getWayPoint:function(){var e=this.getElements(),t=e.length-this.elementsPerLine*(this.elementsPerPage/this.elementsPerLine-2);return e.get(t)},getElements:function(){return this.$el.find("li")},disableWayPoint:function(){this.wayPoint&&this.wayPoint.disable()},enableWayPoint:function(){this.wayPoint&&this.wayPoint.enable()},checkScroll:function(){this.scrollHeightBefore<=l.default.getPageYOffset()&&n(window).scrollTop(this.pageYOffsetBefore)},afterRender:function(){this.checkScroll(),this.collection.length===this.elementsPerPage&&(!this.totalCount||this.totalCount>this.loadDataParams.data.to)&&(this.incrementFromTo(),this.initWaypoint())},reload:function(){this.loadDataParams.data.from=0,this.loadDataParams.data.to=this.elementsPerPage,this.strictLoadBorder||(this.loadDataParams.data.to-=1),this.wayPoint&&this.wayPoint.destroy(),this.loadData(this.collection)},render:function(){this.scrollHeightBefore=s.default.getScrollHeight(),this.pageYOffsetBefore=l.default.getPageYOffset()}})},function(e,t,i){"use strict";var n=i(118),a=n({bubbled:null,captured:null}),s=n({topAbort:null,topAnimationEnd:null,topAnimationIteration:null,topAnimationStart:null,topBlur:null,topCanPlay:null,topCanPlayThrough:null,topChange:null,topClick:null,topCompositionEnd:null,topCompositionStart:null,topCompositionUpdate:null,topContextMenu:null,topCopy:null,topCut:null,topDoubleClick:null,topDrag:null,topDragEnd:null,topDragEnter:null,topDragExit:null,topDragLeave:null,topDragOver:null,topDragStart:null,topDrop:null,topDurationChange:null,topEmptied:null,topEncrypted:null,topEnded:null,topError:null,topFocus:null,topInput:null,topInvalid:null,topKeyDown:null,topKeyPress:null,topKeyUp:null,topLoad:null,topLoadedData:null,topLoadedMetadata:null,topLoadStart:null,topMouseDown:null,topMouseMove:null,topMouseOut:null,topMouseOver:null,topMouseUp:null,topPaste:null,topPause:null,topPlay:null,topPlaying:null,topProgress:null,topRateChange:null,topReset:null,topScroll:null,topSeeked:null,topSeeking:null,topSelectionChange:null,topStalled:null,topSubmit:null,topSuspend:null,topTextInput:null,topTimeUpdate:null,topTouchCancel:null,topTouchEnd:null,topTouchMove:null,topTouchStart:null,topTransitionEnd:null,topVolumeChange:null,topWaiting:null,topWheel:null}),o={topLevelTypes:s,PropagationPhases:a};e.exports=o},function(e,t,i){"use strict";function n(e,t,i,n){this.dispatchConfig=e,this._targetInst=t,this.nativeEvent=i;var a=this.constructor.Interface;for(var s in a)if(a.hasOwnProperty(s)){var r=a[s];r?this[s]=r(i):"target"===s?this.target=n:this[s]=i[s]}var l=null!=i.defaultPrevented?i.defaultPrevented:!1===i.returnValue;return this.isDefaultPrevented=l?o.thatReturnsTrue:o.thatReturnsFalse,this.isPropagationStopped=o.thatReturnsFalse,this}var a=i(24),s=i(69),o=i(46),r=(i(17),["dispatchConfig","_targetInst","nativeEvent","isDefaultPrevented","isPropagationStopped","_dispatchListeners","_dispatchInstances"]),l={type:null,target:null,currentTarget:o.thatReturnsNull,eventPhase:null,bubbles:null,cancelable:null,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:null,isTrusted:null};a(n.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():e.returnValue=!1,this.isDefaultPrevented=o.thatReturnsTrue)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():e.cancelBubble=!0,this.isPropagationStopped=o.thatReturnsTrue)},persist:function(){this.isPersistent=o.thatReturnsTrue},isPersistent:o.thatReturnsFalse,destructor:function(){var e=this.constructor.Interface;for(var t in e)this[t]=null;for(var i=0;i<r.length;i++)this[r[i]]=null}}),n.Interface=l,n.augmentClass=function(e,t){var i=this,n=function(){};n.prototype=i.prototype;var o=new n;a(o,e.prototype),e.prototype=o,e.prototype.constructor=e,e.Interface=a({},i.Interface,t),e.augmentClass=i.augmentClass,s.addPoolingTo(e,s.fourArgumentPooler)},s.addPoolingTo(n,s.fourArgumentPooler),e.exports=n},function(e,t,i){var n=i(0);t.default=new n.Model({})},function(e,t,i){var n=i(35);t.default={cookieName:"sessivi",cookieIsVerimatrix:"isVerimatrix",options:{domain:document.domain.replace(/^(.*?)(\w+\.\w+)$/,".$2")},setTime:864e5,set:function(e){this.options.expires=this.setTime,n.set(this.cookieName,e,this.options)},expire:function(){n.expire(this.cookieName,this.options),n.expire(this.cookieIsVerimatrix,this.options)},get:function(){return n.get(this.cookieName)},setVerimatrix:function(e){this.options.expires=this.setTime,e?n.set(this.cookieIsVerimatrix,1,this.options):n.expire(this.cookieIsVerimatrix,this.options)},isVerimatrix:function(){return n.get(this.cookieIsVerimatrix)}}},function(e,t){var i=["рубль","рубля","рублей"],n=["день","дня","дней"],a=["час","часа","часов"],s=["минута","минуты","минут"],o=["секунда","секунды","секунд"],r=["месяц","месяца","месяцев"],l=["фильм","фильма","фильмов"],d={series:["сериал","сериала","сериалу","сериал","сериалом","сериале","сериалы","сериалов","сериалам","сериалы","сериалами","сериалах"],movies:["фильм","фильма","фильму","фильм","фильмом","фильме","фильмы","фильмов","фильмам","фильмы","фильмами","фильмах"],animation:["мультфильм","мультфильма","мультфильму","мультфильм","мультфильмом","мультфильме","мультфильмы","мультфильмов","мультфильмам","мультфильмы","мультфильмами","мультфильмах"],programs:["программа","программы","программе","программу","программой","программе","программы","программ","программам","программы","программами","программах"],season:["сезон","сезона","сезону","сезон","сезоном","сезоне","сезоны","сезонов","сезонам","сезоны","сезонами","сезонах"]},u={gen:["января","февраля","марта","апреля","мая","июня","июля","августа","сентября","октября","ноября","декабря"],pre:["январе","феврале","марте","апреле","мае","июне","июле","августе","сентябре","октябре","ноябре","декабре"]},c={};c.getEnding=function(e,t){var i;if((e%=100)>=11&&e<=19)i=t[2];else switch(e%10){case 1:i=t[0];break;case 2:case 3:case 4:i=t[1];break;default:i=t[2]}return i},c.currency=function(e){return this.getEnding(e,i)},c.days=function(e){return this.getEnding(e,n)},c.hours=function(e){return this.getEnding(e,a)},c.minutes=function(e){return this.getEnding(e,s)},c.seconds=function(e){return this.getEnding(e,o)},c.month=function(e){return this.getEnding(e,r)},c.movies=function(e){return this.getEnding(e,l)},c.number=function(e,t){return this.getEnding(e,t)},c.getCase=function(e,t){return d[e]&&d[e][t]?d[e][t]:e},c.getAcc=function(e){return this.getCase(e,3)},c.getGen=function(e){return this.getCase(e,1)},c.getNom=function(e){return this.getCase(e,0)},c.getPreCaseMonth=function(e){return u.pre[e]},c.getGenCaseMonth=function(e){return u.gen[e]},t.default=c},function(e,t,i){var n=i(226),a=i(29),s=i(40),o=i(5),r=i(75);t.default=a.default.extend(n.default).extend({uri:"/collection/catalog/v5/",model:s.default,requestParams:{withpreorderable:1},VIDEO_COUNT:50,VIDEO_PERSONALIZABLE_COUNT:25,COLLECTION_CATALOG_FIELDS:"id,title,fake,preorderable,available_in_countries,hru,poster_originals,content_paid_types,compilation_hru,kind,additional_data,restrict,hd_available,3d_available,uhd_available,hdr10_available,has_5_1,seasons_count,seasons_content_total,seasons,episodes,seasons_description,ivi_rating_10_count,seasons_extra_info,count",getVideoList:function(){return this.models},deleteFromWatched:function(e){var t=this;if(e){var i=this.findWhere({id:e});this.mapiPost({uri:"/watchhistory/delete",data:{content_id:e}}).done(function(){t.mapiGet().done(function(e){e.error?r.default.trigger("collection:deleteWatchedError",i):r.default.trigger("collection:deleteWatchedSuccess",i)})})}},mergePurchasesAndVideoEntity:function(e){var t=this;e&&e.models&&o.each(e.models,function(e){if(e.isEternalBought()){var i=t.findWhere({id:e.get("object_id")});i&&i.setBought()}})}})},function(e,t,i){var n=i(1),a=i(0),s=i(3),o=i(20);t.default=a.View.extend({grootCollectionSectionPosition:null,GROOT_SUPER_PROPERTIES_TO_CLEAN:["content_id","compilation_id","collection_id"],blockId:"",setLocalBlockId:function(e,t){if(t=t||!1)this.blockId=e;else{var i=s.default.getRefPageFromGrootView();this.blockId="collection"===i?i:s.default.getRefPageFromGrootView()+"_"+e}},getLocalBlockId:function(){return this.blockId},setGrootParams:function(){this.getLocalBlockId()&&s.default.setBlockId(this.getLocalBlockId())},trackCollectionContentAction:function(e,t){if(t&&t.length){var i=t.data("content-id"),n=t.closest(".js-collection-block"),a=n.data("collection-id");if(i){i=i.toString();var o={section_position:this.getGrootCollectionPosition(),content_position:t.data("content-position"),position:n.data("collection-position")||1};a&&(a=a.toString(),o.collection_id=a,s.default.setCollectionId(a)),"compilation"===t.data("content-type")?o.compilation_id=i:o.content_id=i,s.default.updatePromoAndCollectionParams(o),o.block_id=this.getLocalBlockId(),s.default.clearSuperProperties(this.GROOT_SUPER_PROPERTIES_TO_CLEAN),s.default.rewriteSuperProperties(o),s.default.track(e,o)}}},trackCollectionAction:function(e,t){if(t&&t.length){var i=t.data("collection-id");if(i){i=i.toString();var n={section_position:this.getGrootCollectionPosition(),collection_id:i,position:t.data("collection-position")};s.default.updatePromoAndCollectionParams(n),n.block_id=this.getLocalBlockId(),s.default.clearSuperProperties(this.GROOT_SUPER_PROPERTIES_TO_CLEAN),s.default.rewriteSuperProperties(n),s.default.setCollectionId(i),s.default.track(e,n)}}},storeHydraCollectionView:function(e){var t=o.default.sessionStorage.getItem("collections-view");null!==t?t+=";"+e:t=e,o.default.sessionStorage.setItem("collections-view",t)},getGrootCollectionPosition:function(){var e=n(".promo");return e.length&&e.is(":visible")?2:1}})},function(e,t,i){"use strict";var n=i(15),a=(i(13),function(e){var t=this;if(t.instancePool.length){var i=t.instancePool.pop();return t.call(i,e),i}return new t(e)}),s=function(e,t){var i=this;if(i.instancePool.length){var n=i.instancePool.pop();return i.call(n,e,t),n}return new i(e,t)},o=function(e,t,i){var n=this;if(n.instancePool.length){var a=n.instancePool.pop();return n.call(a,e,t,i),a}return new n(e,t,i)},r=function(e,t,i,n){var a=this;if(a.instancePool.length){var s=a.instancePool.pop();return a.call(s,e,t,i,n),s}return new a(e,t,i,n)},l=function(e,t,i,n,a){var s=this;if(s.instancePool.length){var o=s.instancePool.pop();return s.call(o,e,t,i,n,a),o}return new s(e,t,i,n,a)},d=function(e){var t=this;e instanceof t||n("25"),e.destructor(),t.instancePool.length<t.poolSize&&t.instancePool.push(e)},u=a,c=function(e,t){var i=e;return i.instancePool=[],i.getPooled=t||u,i.poolSize||(i.poolSize=10),i.release=d,i},p={addPoolingTo:c,oneArgumentPooler:a,twoArgumentPooler:s,threeArgumentPooler:o,fourArgumentPooler:r,fiveArgumentPooler:l};e.exports=p},function(e,t,i){"use strict";var n={current:null};e.exports=n},function(e,t,i){"use strict";var n=function(e){var t;for(t in e)if(e.hasOwnProperty(t))return t;return null};e.exports=n},function(e,t,i){var n,a=i(21),s=i(31);!function(e){e[e.LEFT=0]="LEFT",e[e.CENTER=1]="CENTER",e[e.RIGHT=2]="RIGHT"}(n=t.FullscreenPopupBlockPosition||(t.FullscreenPopupBlockPosition={}));var o=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a.__extends(t,e),t.prototype.render=function(){var e=[this.props.addClasses,"modal-view"];switch(this.props.position){case n.RIGHT:e.push("modal-view_start");break;case n.CENTER:e.push("modal-view_finish");break;case n.LEFT:e.push("modal-view_end")}return s.createElement("div",{className:e.join(" ")},this.props.children)},t}(s.Component);t.default=o},function(e,t,i){var n=i(0);t.default=new n.Model({})},function(e,t,i){var n=i(0),a=i(35),s=i(8);t.default=n.Model.extend({ageLimit:18,cookieName:"18plus",cookieLifetime:7776e3,getAgeLimit:function(){return this.ageLimit},canWatchAdultContent:function(){var e=s.default.isIdentified()?s.default.getAge():0;return!(!a.get(this.cookieName)&&e<this.ageLimit)},allowToWatchAdultContent:function(){a.set(this.cookieName,"1",{expires:this.cookieLifetime})}})},function(e,t,i){var n=i(0);t.default=new n.Model({})},function(e,t){e.exports=window},function(e,t,i){var n=i(5),a=i(3),s=i(50),o=function(){};n.extend(o.prototype,{refsQuick:"quick",refsFull:"full",query:"",session:0,resultList:[],setQuery:function(e){this.query=e},getQuery:function(){return this.query},increaseSession:function(){this.session+=1},getSession:function(){return this.session},setResultList:function(e){var t=this;this.resultList=[],e.each(function(e){var i={};i[e.get("id")]=e.get("kind"),t.resultList.push(i)})},setResultListFromObject:function(e){this.resultList=e},getTitles:function(e){var t={};return void 0!==e?this.resultList[e]&&(t=this.resultList[e]):n.each(this.resultList,function(e){t=n.extend(t,e)}),t},sendSearchStat:function(e){this.send("w",e)},sendAllResultsStat:function(e){this.send("c",e)},sendResultChoiceStat:function(e,t){this.send("e",e,t)},send:function(e,t,i){var n=this.getTitles(i);a.default.trackSearch(e,{query:this.getQuery(),refs:t,s_session:this.getSession(),mapi_ans:this.resultList.length,referrer_full:s.default.getReferrer(),title:n})}}),t.default=new o},function(e,t,i){var n=i(1),a=i(0),s=i(479);t.default=a.View.extend({el:"#js-pay-content",render:function(){this.$el.html(this.getErrorText()),n(".pay-block").addClass("error"),n("#form-nav").hide()},getErrorText:function(){return s.default()}})},function(e,t,i){var n=i(0),a=i(5);t.default=n.Collection.extend({isSpasibo:!1,psList:[{ps_method:"card",ps_display_name:"Банковская карта",commission:!1,index:0},{ps_method:"sms",ps_display_name:"SMS",commission:!0,index:1},{ps_method:"qiwi",ps_display_name:"QIWI-кошелек",commission:!0,index:2},{ps_method:"yandex",ps_display_name:"Яндекс.Деньги",commission:!1,index:3},{ps_method:"certificate",ps_display_name:"Подарочный сертификат",commission:!0,index:4},{ps_method:"tap_to_pay",ps_display_name:"tap to pay",commission:!1,index:5}],savedCardsLimit:5,formatCardNumber:/(\d{4})(\d\dxx)(x{4})(\d{4})/,constructor:function(){var e=arguments[0];arguments[0]=this.sortByIndex(this.filterUnsupportedMethods(e)),n.Collection.prototype.constructor.apply(this,arguments)},filterUnsupportedMethods:function(e){var t=this,i=e.get("payment_options"),n=0,s=i.filter(function(i){var s=a.findWhere(t.psList,{ps_method:i.ps_method});return!!s&&(a.extend(i,s),a.extend(i,e.pick("ownership_type")),a.extend(i,e.pick("bonus_info")),a.extend(i,t.getParamsForGroot(e,i)),1===i.groot.hascard&&(n=1),!0)});return a.each(s,function(e){e.groot.hascard=n}),s},sortByIndex:function(e){return a.sortBy(e,function(e){return e.index})},getPsMethodList:function(){return a.keys(this.groupBy("ps_method"))},getByPsMethod:function(e){return this.where({ps_method:e})},getByPsAccountId:function(e){return a.find(this.models,function(t){return t.get("payment_system_account")&&t.get("payment_system_account").id===e})},getParamsForGroot:function(e,t){var i=e.getGrootParams();return i.payment_method="tap_to_pay"===t.ps_method?t.ps_key:t.ps_method,this.isSpasibo&&"card"===t.ps_method&&(i.payment_method="spasibo"),"card"===t.ps_method&&t.payment_system_account&&(i.hascard=1),{groot:i}},getSavedCards:function(){for(var e=this.filter(function(e){return"cards"===e.get("ps_key")&&e.get("payment_system_account")}).slice(0,this.savedCardsLimit),t=[],i=0;i<e.length;i++){var n=e[i].get("payment_system_account").title.replace(this.formatCardNumber,"$1 $2 $3 $4").replace(/x/g,"*"),a=n.charAt(0),s="";switch(a){case"4":s="visa";break;case"5":case"6":s="mastercard"}t.push({id:e[i].get("payment_system_account").id,number:n,type:s})}return t},checkIfPsMethodIsAvailable:function(e){return a.indexOf(this.getPsMethodList(),e)>=0},isCardAvailable:function(){return this.getByPsMethod("card").length>0},isSmsAvailable:function(){return this.getByPsMethod("sms").length>0},setIsSpasibo:function(e){this.isSpasibo=!!e},getAllDiscountProgramFinishTimeIsoStrings:function(){return this.map(function(e){return e.get("discount_program_finish_time")})}})},function(e,t,i){var n=i(29),a=i(106),s=i(210),o=i(40),r=i(107),l=i(5);t.default=n.default.extend({model:a.default,uri:"/billing/v1/purchases/",videoOptionsTypes:["content","season","collection"],subscriptionPurchase:null,set:function(e,t){var i=n.default.prototype.set.call(this,e,t);return this.addVideoEntityToContentPurchase(i),i},addVideoEntityToContentPurchase:function(e){l.each(e,function(e){var t=e.get("object_type"),i=e.get("object_info");if(i)switch(t){case"season":var n=i.compilation;n&&(n.season=i.season,e.set("videoEntity",new o.default(n)));break;case"content":e.set("videoEntity",new o.default(i));break;case"collection":e.set("collectionEntity",new r.default(i))}})},getPurchaseVideoOptions:function(){var e=this,t=l.filter(this.models,function(t){return-1!==e.videoOptionsTypes.indexOf(t.get("object_type"))});return this.availableOptions=t.length,t.slice(this.videoOptionsSelectionFrom,this.videoOptionsSelectionTo)},hasPurchaseVideoOptions:function(){var e=this;return l.filter(this.models,function(t){return-1!==e.videoOptionsTypes.indexOf(t.get("object_type"))}).length>0},increaseVideoOptionsSelection:function(e){"number"==typeof e&&(this.videoOptionsSelectionTo+=e)},setVideoOptionsSelectionFrom:function(e){"number"==typeof e&&(this.videoOptionsSelectionFrom=e)},setVideoOptionsSelectionTo:function(e){"number"==typeof e&&(this.videoOptionsSelectionTo=e)},getVideoOptionsSelectionTo:function(){return this.videoOptionsSelectionTo},isMore:function(){return this.availableOptions>this.videoOptionsSelectionTo},createSubscriptionPurchaseObject:function(){if(null===this.subscriptionPurchase){var e=l.filter(this.models,function(e){return e.get("object_type")===s.default.prototype.subscriptionObjectType});e=l.sortBy(e,function(e){return!e.get("renew_enabled")}),this.subscriptionPurchase=e.length?new s.default(e[0].toJSON()):new s.default}return this.subscriptionPurchase}})},function(e,t,i){var n=i(1),a=null,s=function(){this.checkStarted=!1,this.detected=null,this.detectedDeferred=n.Deferred(),this._options={loopCheckTime:50,loopMaxNumber:5,baitClass:"pub_300x250 pub_300x250m pub_728x90 text-ad textAd text_ad text_ads text-ads text-ad-links",baitStyle:"width: 1px !important; height: 1px !important; position: absolute !important; left: -10000px !important; top: -1000px !important;"},this._var={bait:null,checking:!1,loop:null,loopNumber:0}};s.prototype._options=null,s.prototype._var=null,s.prototype._createBait=function(){var e=document.createElement("div");e.setAttribute("class",this._options.baitClass),e.setAttribute("style",this._options.baitStyle),this._var.bait=window.document.body.appendChild(e)},s.prototype._destroyBait=function(){this._var.bait.parentNode&&window.document.body.removeChild(this._var.bait),this._var.bait=null},s.prototype.check=function(e){if(!this.checkStarted){if(this.checkStarted=!0,void 0===e&&(e=!0),!0===this._var.checking)return!1;this._var.checking=!0,null===this._var.bait&&this._createBait();var t=this;return this._var.loopNumber=0,!0===e&&(this._var.loop=setInterval(function(){t._checkBait(e)},this._options.loopCheckTime)),setTimeout(function(){t._checkBait(e)},1),!0}},s.prototype._checkBait=function(e){var t=!1;if(null===this._var.bait&&this._createBait(),null===window.document.body.getAttribute("abp")&&null!==this._var.bait.offsetParent&&0!==this._var.bait.offsetHeight&&0!==this._var.bait.offsetLeft&&0!==this._var.bait.offsetTop&&0!==this._var.bait.offsetWidth&&0!==this._var.bait.clientHeight&&0!==this._var.bait.clientWidth||(t=!0),void 0!==window.getComputedStyle){var i=window.getComputedStyle(this._var.bait,null);"none"!==i.getPropertyValue("display")&&"hidden"!==i.getPropertyValue("visibility")||(t=!0)}!0===e&&++this._var.loopNumber>=this._options.loopMaxNumber&&this._stopLoop(),!0===t?(this._stopLoop(),this._destroyBait(),this.detected=!0,this.detectedDeferred.resolve(),!0===e&&(this._var.checking=!1)):null!==this._var.loop&&!1!==e||(this._destroyBait(),this.detected=!1,this.detectedDeferred.resolve(),!0===e&&(this._var.checking=!1))},s.prototype._stopLoop=function(){clearInterval(this._var.loop),this._var.loop=null,this._var.loopNumber=0},null===a&&(a=new s),t.default=a},function(e,t,i){var n=i(0);t.default=new n.Model({})},function(e,t){var i=function(){function e(){}return e.getKeyCode=function(t){var i;switch(t.code||t.key||t.keyCode){case" ":case"Space":case"Spacebar":case e.KEY_SPACE:i=e.KEY_SPACE;break;case"Up":case"ArrowUp":case e.KEY_ARROW_UP:i=e.KEY_ARROW_UP;break;case"Down":case"ArrowDown":case e.KEY_ARROW_DOWN:i=e.KEY_ARROW_DOWN;break;case"Left":case"ArrowLeft":case e.KEY_ARROW_LEFT:i=e.KEY_ARROW_LEFT;break;case"Right":case"ArrowRight":case e.KEY_ARROW_RIGHT:i=e.KEY_ARROW_RIGHT;break;case"Esc":case"Escape":case e.KEY_ESCAPE:i=e.KEY_ESCAPE;break;case"Enter":case e.KEY_ENTER:i=e.KEY_ENTER}return i},e.KEY_ESCAPE=27,e.KEY_SPACE=32,e.KEY_ARROW_UP=38,e.KEY_ARROW_DOWN=40,e.KEY_ARROW_LEFT=37,e.KEY_ARROW_RIGHT=39,e.KEY_ENTER=13,e}();t.default=i},function(e,t,i){var n=i(1),a=i(474),s=i(36),o=i(476),r=i(251),l=i(78),d=i(252),u=i(79),c=i(139),p=i(161),f=i(60),h=i(480),g=i(253),m=i(484),v=i(256),_=i(486),b=i(162),y=i(500),w=i(23),C=i(5),k=i(22),P=i(7),S=i(11),T=i(3),E=i(39),I=i(20),x=i(91),M=i(8),A=i(4),L=i(44),O=i(223),j=i(10),D=i(19);t.default=O.default.extend({isTrial:!1,videoInfo:null,loaderView:null,promoActionService:null,promoActions:[m.default,g.default],paymentFormShown:!1,gtmScriptUrl:"//www.googletagmanager.com/gtm.js?id=GTM-TK47DZ",supportPhone:"",initialize:function(){var e=this;this.videoInfo=new w.default,this.mapiInfo=new D.default,this.listenToOnce(x.default,"support:phoneLoaded",this.showSupportPhone),(new a.default).listen(S.default),(new o.default).listen(S.default),this.loaderView=new r.default,this.promoActionService=new h.default;var t=null;this.promoActions.forEach(function(i){if(null===t)t=new i,e.promoActionService.setFirstPromoAction(t);else{var n=new i;t.setNext(n),t=n}})},showSupportPhone:function(e){this.supportPhone=e,n(".js-support-phone").length&&n(".js-support-phone").text(e)},afterLogin:function(){this.queryParams.redirect_url=E.default.getRightHostOrigin()+decodeURIComponent(this.queryParams.redirect_url),this.from=this.queryParams.from,new d.default,M.default.isIdentified()?this.doIt():k.default.registerProofOfWork().done(this.doIt.bind(this)),this.listenTo(S.default,"purchase:sms",this.purchaseSMS),this.listenTo(S.default,"purchase:card",this.purchaseCard),this.listenTo(S.default,"purchase:spasibo",this.purchaseSpasibo),this.listenTo(S.default,"purchase:applePay",this.purchaseApplePay),this.listenTo(S.default,"purchase:success",this.success),n(y.default.prototype.el).length&&(new y.default).render()},doIt:function(){var e=this;if("subscription"===this.queryParams.object_type){var t=new f.default;t.fetchOptions().done(function(){e.showPayment(e.queryParams.option_hash,t)})}else if("season"===this.queryParams.object_type){var i=new p.default;i.mapiGet({data:{id:this.queryParams.object_id}}).done(function(){e.showPayment(e.queryParams.option_hash,i)})}else if("collection"===this.queryParams.object_type){var n=new v.default;n.mapiGet({data:{id:this.queryParams.object_id}}).done(function(){e.showPayment(e.queryParams.option_hash,n)})}else{var a=new s.default;a.mapiGet({data:{id:this.queryParams.object_id}}).done(function(){e.showPayment(e.queryParams.option_hash,a)})}},showPayment:function(e,t){var i=t.getPurchaseOptionList().findProduct(e);if(i){this.paymentOptionList=new u.default(i),this.listenTo(S.default,"payment:option:select",this.paymentTabChange);var n=i.getMinUserPrice();new b.default({paymentOptionList:this.paymentOptionList,queryParams:this.queryParams,price:n,currency:i.getCurrency(),payType:this.getPayType()}),S.default.trigger("payment:show",this.paymentOptionList)}else(new l.default).render()},paymentTabChange:function(e){var t="spasibo"===e;if(this.paymentFormShown){var i=this.paymentOptionList.getByPsMethod(t?"card":e);if(i.length>0){var a=C.first(i).get("groot");t&&(a.payment_method="spasibo"),n("#js-pay-block").toggleClass("pay-block_spasibo-active",t),this.from&&(a.from=this.from),T.default.track("payment_form_select_click",a),S.default.trigger("payment:payment_groot_params_ready",a)}}this.paymentFormShown=!0},purchaseSMS:function(e,t){var i=t.groot||t.get("groot");this.from&&(i.from=this.from),T.default.track("payment_initiated",i),S.default.trigger("purchase:initiated");var a=window.ivi.adaptive.isMobile?j.default.payments.spasibo_scoring_mobile_app_version:j.default.payments.spasibo_scoring_desktop_app_version,s=new c.default;s.mapiPost({data:n.extend(t.purchase_params,{ps_account:e})},this.mapiInfo.isEnableSubscriptionSpasiboScoringCapability()?a:null).done(function(){S.default.trigger("purchase:sms:status",s,t)}).fail(function(){S.default.trigger("purchase:sms:status","error",t)})},purchaseCard:function(e){this.loaderView.render();var t=window.ivi.adaptive.isMobile?j.default.payments.spasibo_scoring_mobile_app_version:j.default.payments.spasibo_scoring_desktop_app_version,i=new c.default;i.mapiPost({data:e.get("purchase_params")},this.mapiInfo.isEnableSubscriptionSpasiboScoringCapability()?t:null).done(function(){S.default.trigger("purchase:card:status",i,e)}).fail(function(){S.default.trigger("purchase:card:status","error")})},purchaseSpasibo:function(e){this.loaderView.render();var t=window.ivi.adaptive.isMobile?j.default.payments.spasibo_payment_mobile_app_version:j.default.payments.spasibo_payment_desktop_app_version,i=new c.default;i.mapiPost({data:e.get("purchase_params")},t).done(function(){S.default.trigger("purchase:spasibo:status",i,e)}).fail(function(){S.default.trigger("purchase:spasibo:status","error")})},purchaseApplePay:function(e,t){var i=new c.default,n=e.get("purchase_params");n.ps_extra_device_token=t,i.mapiPost({data:n}).done(function(){S.default.trigger("purchase:applePay:status",i,e)}).fail(function(){S.default.trigger("purchase:applePay:status","error")})},success:function(e,t,i){void 0===i&&(i=!1);var n,a,s,o,r;t.toJSON&&t.get?(t.get("groot")&&(n=t.get("groot")),a=t.get("purchase_params")._object_type||"",o=t.get("purchase_params")._object_id||"",s=t.get("purchase_params")._ownership_type||"",r=t.get("user_price")||"",this.sendToGABuyEvent(t.toJSON())):t.groot?(n=t.groot,a=t.purchase_params._object_type||"",s=t.purchase_params._ownership_type||"",o=t.purchase_params._object_id||"",r=t.user_price||"",this.sendToGABuyEvent(t)):n={},n.credit_id=e.get("credit_id"),n.purchase_id=e.get("purchase_id"),n.source="b",this.from&&(n.from=this.from),T.default.track("payment_confirmed",n),S.default.trigger("purchase:finished_success"),e.get("purchase_id")&&L.default.trackTransaction({transactionId:e.get("purchase_id"),objectId:o,objectType:a,purchaseType:a,purchaseOwnershipType:s,price:r}),this.afterSuccess(e,t,i,n)},afterSuccess:function(e,t,i,n){var a=this,s=(t.toJSON&&t.get?t.get("purchase_params")._object_type:t.purchase_params._object_type)||"";this.promoActionService.preparePromoActions().done(function(){var t=a.promoActionService.applyPromoAction({purchase:e,redirectUrl:a.queryParams.redirect_url,grootParams:n});M.default.isAuthenticated()?t||A.default.redirect(a.queryParams.redirect_url):((new _.default).render({user:M.default.toJSON(),objectType:s,redirectUrl:a.queryParams.redirect_url,isTrial:a.isTrial}),a.listenTo(P.default,"user:login",function(){A.default.redirect(a.queryParams.redirect_url)}),a.initSuccessGTM())})},initSuccessGTM:function(){window.dataLayer=[{ivi_subs:"success",event:"ivi_subs"},{user_id:I.default.localStorage.getItem("ivi_user_id")}];var e=E.default.getRightHostOrigin();this.queryParams.redirect_url!==e+"/plus"&&this.queryParams.redirect_url!==e+"/"||window.dataLayer.push({plus_ivi_subs:"success",event:"plus_ivi_subs"}),n.getScript(this.gtmScriptUrl)},getPayType:function(){return"collection"===this.queryParams.object_type?"collection":this.videoInfo.isAnimation()?"animation":this.videoInfo.isCompilation()?"compilation":"video"}})},function(e,t,i){"use strict";function n(e,t){return(e&t)===t}var a=i(15),s=(i(13),{MUST_USE_PROPERTY:1,HAS_BOOLEAN_VALUE:4,HAS_NUMERIC_VALUE:8,HAS_POSITIVE_NUMERIC_VALUE:24,HAS_OVERLOADED_BOOLEAN_VALUE:32,injectDOMPropertyConfig:function(e){var t=s,i=e.Properties||{},o=e.DOMAttributeNamespaces||{},l=e.DOMAttributeNames||{},d=e.DOMPropertyNames||{},u=e.DOMMutationMethods||{};e.isCustomAttribute&&r._isCustomAttributeFunctions.push(e.isCustomAttribute);for(var c in i){r.properties.hasOwnProperty(c)&&a("48",c);var p=c.toLowerCase(),f=i[c],h={attributeName:p,attributeNamespace:null,propertyName:c,mutationMethod:null,mustUseProperty:n(f,t.MUST_USE_PROPERTY),hasBooleanValue:n(f,t.HAS_BOOLEAN_VALUE),hasNumericValue:n(f,t.HAS_NUMERIC_VALUE),hasPositiveNumericValue:n(f,t.HAS_POSITIVE_NUMERIC_VALUE),hasOverloadedBooleanValue:n(f,t.HAS_OVERLOADED_BOOLEAN_VALUE)};if(h.hasBooleanValue+h.hasNumericValue+h.hasOverloadedBooleanValue<=1||a("50",c),l.hasOwnProperty(c)){var g=l[c];h.attributeName=g}o.hasOwnProperty(c)&&(h.attributeNamespace=o[c]),d.hasOwnProperty(c)&&(h.propertyName=d[c]),u.hasOwnProperty(c)&&(h.mutationMethod=u[c]),r.properties[c]=h}}}),o=":A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD",r={ID_ATTRIBUTE_NAME:"data-reactid",ROOT_ATTRIBUTE_NAME:"data-reactroot",ATTRIBUTE_NAME_START_CHAR:o,ATTRIBUTE_NAME_CHAR:o+"\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040",properties:{},getPossibleStandardName:null,_isCustomAttributeFunctions:[],isCustomAttribute:function(e){for(var t=0;t<r._isCustomAttributeFunctions.length;t++){if((0,r._isCustomAttributeFunctions[t])(e))return!0}return!1},injection:s};e.exports=r},function(e,t,i){"use strict";function n(){a.attachRefs(this,this._currentElement)}var a=i(556),s=(i(38),i(17),{mountComponent:function(e,t,i,a,s){var o=e.mountComponent(t,i,a,s);return e._currentElement&&null!=e._currentElement.ref&&t.getReactMountReady().enqueue(n,e),o},getHostNode:function(e){return e.getHostNode()},unmountComponent:function(e,t){a.detachRefs(e,e._currentElement),e.unmountComponent(t)},receiveComponent:function(e,t,i,s){var o=e._currentElement;if(t!==o||s!==e._context){var r=a.shouldUpdateRefs(o,t);r&&a.detachRefs(e,o),e.receiveComponent(t,i,s),r&&e._currentElement&&null!=e._currentElement.ref&&i.getReactMountReady().enqueue(n,e)}},performUpdateIfNecessary:function(e,t,i){e._updateBatchNumber===i&&e.performUpdateIfNecessary(t)}});e.exports=s},function(e,t,i){"use strict";function n(e){if(h){var t=e.node,i=e.children;if(i.length)for(var n=0;n<i.length;n++)g(t,i[n],null);else null!=e.html?c(t,e.html):null!=e.text&&f(t,e.text)}}function a(e,t){e.parentNode.replaceChild(t.node,e),n(t)}function s(e,t){h?e.children.push(t):e.node.appendChild(t.node)}function o(e,t){h?e.html=t:c(e.node,t)}function r(e,t){h?e.text=t:f(e.node,t)}function l(){return this.node.nodeName}function d(e){return{node:e,children:[],html:null,text:null,toString:l}}var u=i(181),c=i(120),p=i(182),f=i(295),h="undefined"!=typeof document&&"number"==typeof document.documentMode||"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent&&/\bEdge\/\d/.test(navigator.userAgent),g=p(function(e,t,i){11===t.node.nodeType||1===t.node.nodeType&&"object"===t.node.nodeName.toLowerCase()&&(null==t.node.namespaceURI||t.node.namespaceURI===u.html)?(n(t),e.insertBefore(t.node,i)):(e.insertBefore(t.node,i),n(t))});d.insertTreeBefore=g,d.replaceChildWithTree=a,d.queueChild=s,d.queueHTML=o,d.queueText=r,e.exports=d},function(e,t,i){var n=i(0);t.default=new n.Model({})},function(e,t,i){var n=i(0);t.default=new n.Model({})},function(e,t,i){var n=i(5),a=i(10);t.default={pullType:54,transportType:"pull",url:function(){var e=this.uriAddition?this.uriAddition:"",t=n.isFunction(this.uri)?this.uri()+e:this.uri+e;return(a.default.pullworker.url?a.default.pullworker.url:"")+t},parse:function(e){return e}}},function(e,t,i){var n=i(0);t.default=new n.Model({})},function(e,t,i){var n=i(0);t.default=new n.Model({})},function(e,t,i){var n=i(0),a=i(1),s=i(10),o=i(39),r=i(8),l=i(19);t.default=n.View.extend({el:"#js-pay-content",payType:"buy",price:null,currency:null,isActive:!0,mapiInfo:null,isLongSubscription:!1,isSpasiboAvailable:!1,payButtonTitle:{trial:"Подключить",balance:"Пополнить счет",subscription:"Подключить",buy:"Оплатить",changeCard:"Сменить карту",bindCard:"Привязать карту"},worldPayButtonTitle:{trial:"Стать подписчиком",balance:"Пополнить счет",subscription:"Стать подписчиком",buy:"Оплатить",changeCard:"Сменить карту",bindCard:"Привязать карту"},initialize:function(e){this.mapiInfo=new l.default,this.parseOptions(e)},parseOptions:function(e){this.paymentOption=e.paymentOptionList,this.queryParams=e.queryParams,this.price=e.price,this.currency=e.currency,this.isLongSubscription=e.isLongSubscription,this.isSpasiboAvailable=e.isSpasiboAvailable,e.payType&&(this.payType=e.payType)},getPaymentOption:function(){return this.paymentOption},render:function(e){var t=e||{};t.user=r.default.toJSON(),t.request=this.queryParams,t.price=this.price,this.$el.html(this.getTpl()(t))},reset:function(){},getPaymentIframePostMessageObject:function(e,t){return{message:e,data:t}},getPayButtonTitle:function(){if("subscription"===this.payType&&s.default.hasSubscription)return"Продлить";var e="";return e=s.default.isWorld?this.worldPayButtonTitle[this.payType]?this.worldPayButtonTitle[this.payType]:this.worldPayButtonTitle.buy:this.payButtonTitle[this.payType]?this.payButtonTitle[this.payType]:this.payButtonTitle.buy,"video"!==this.payType&&"animation"!==this.payType&&"collection"!==this.payType||(e+=" "+o.default.getPriceWithCurrency(this.price)),e},extendTemplateParams:function(e){return e||(e={}),e.trialData=this.trialData,e.trial=this.trialData&&Object.getOwnPropertyNames(this.trialData).length,e.payButtonTitle=this.getPayButtonTitle(),e},setActive:function(e){this.isActive=e},removePostMessageListener:function(){this.postMessageHandlerBinded&&a(window).off("message",this.postMessageHandlerBinded)},addPostMessageListener:function(){this.postMessageHandlerBinded&&a(window).on("message",this.postMessageHandlerBinded)}})},function(e,t,i){"use strict";var n={};e.exports=n},function(e,t,i){"use strict";function n(e,t,i){var n=t.dispatchConfig.phasedRegistrationNames[i];return b(e,n)}function a(e,t,i){var a=t?_.bubbled:_.captured,s=n(e,i,a);s&&(i._dispatchListeners=m(i._dispatchListeners,s),i._dispatchInstances=m(i._dispatchInstances,e))}function s(e){e&&e.dispatchConfig.phasedRegistrationNames&&g.traverseTwoPhase(e._targetInst,a,e)}function o(e){if(e&&e.dispatchConfig.phasedRegistrationNames){var t=e._targetInst,i=t?g.getParentInstance(t):null;g.traverseTwoPhase(i,a,e)}}function r(e,t,i){if(i&&i.dispatchConfig.registrationName){var n=i.dispatchConfig.registrationName,a=b(e,n);a&&(i._dispatchListeners=m(i._dispatchListeners,a),i._dispatchInstances=m(i._dispatchInstances,e))}}function l(e){e&&e.dispatchConfig.registrationName&&r(e._targetInst,null,e)}function d(e){v(e,s)}function u(e){v(e,o)}function c(e,t,i,n){g.traverseEnterLeave(i,n,r,e,t)}function p(e){v(e,l)}var f=i(62),h=i(96),g=i(175),m=i(287),v=i(288),_=(i(17),f.PropagationPhases),b=h.getListener,y={accumulateTwoPhaseDispatches:d,accumulateTwoPhaseDispatchesSkipTarget:u,accumulateDirectDispatches:p,accumulateEnterLeaveDispatches:c};e.exports=y},function(e,t,i){"use strict";var n=i(15),a=i(174),s=i(175),o=i(176),r=i(287),l=i(288),d=(i(13),{}),u=null,c=function(e,t){e&&(s.executeDispatchesInOrder(e,t),e.isPersistent()||e.constructor.release(e))},p=function(e){return c(e,!0)},f=function(e){return c(e,!1)},h=function(e){return"."+e._rootNodeID},g={injection:{injectEventPluginOrder:a.injectEventPluginOrder,injectEventPluginsByName:a.injectEventPluginsByName},putListener:function(e,t,i){"function"!=typeof i&&n("94",t,typeof i);var s=h(e);(d[t]||(d[t]={}))[s]=i;var o=a.registrationNameModules[t];o&&o.didPutListener&&o.didPutListener(e,t,i)},getListener:function(e,t){var i=d[t],n=h(e);return i&&i[n]},deleteListener:function(e,t){var i=a.registrationNameModules[t];i&&i.willDeleteListener&&i.willDeleteListener(e,t);var n=d[t];if(n){delete n[h(e)]}},deleteAllListeners:function(e){var t=h(e);for(var i in d)if(d.hasOwnProperty(i)&&d[i][t]){var n=a.registrationNameModules[i];n&&n.willDeleteListener&&n.willDeleteListener(e,i),delete d[i][t]}},extractEvents:function(e,t,i,n){for(var s,o=a.plugins,l=0;l<o.length;l++){var d=o[l];if(d){var u=d.extractEvents(e,t,i,n);u&&(s=r(s,u))}}return s},enqueueEvents:function(e){e&&(u=r(u,e))},processEventQueue:function(e){var t=u;u=null,e?l(t,p):l(t,f),u&&n("95"),o.rethrowCaughtError()},__purge:function(){d={}},__getListenerBank:function(){return d}};e.exports=g},function(e,t,i){"use strict";var n=i(15),a=(i(13),{reinitializeTransaction:function(){this.transactionWrappers=this.getTransactionWrappers(),this.wrapperInitData?this.wrapperInitData.length=0:this.wrapperInitData=[],this._isInTransaction=!1},_isInTransaction:!1,getTransactionWrappers:null,isInTransaction:function(){return!!this._isInTransaction},perform:function(e,t,i,a,s,o,r,l){this.isInTransaction()&&n("27");var d,u;try{this._isInTransaction=!0,d=!0,this.initializeAll(0),u=e.call(t,i,a,s,o,r,l),d=!1}finally{try{if(d)try{this.closeAll(0)}catch(e){}else this.closeAll(0)}finally{this._isInTransaction=!1}}return u},initializeAll:function(e){for(var t=this.transactionWrappers,i=e;i<t.length;i++){var n=t[i];try{this.wrapperInitData[i]=s.OBSERVED_ERROR,this.wrapperInitData[i]=n.initialize?n.initialize.call(this):null}finally{if(this.wrapperInitData[i]===s.OBSERVED_ERROR)try{this.initializeAll(i+1)}catch(e){}}}},closeAll:function(e){this.isInTransaction()||n("28");for(var t=this.transactionWrappers,i=e;i<t.length;i++){var a,o=t[i],r=this.wrapperInitData[i];try{a=!0,r!==s.OBSERVED_ERROR&&o.close&&o.close.call(this,r),a=!1}finally{if(a)try{this.closeAll(i+1)}catch(e){}}}this.wrapperInitData.length=0}}),s={Mixin:a,OBSERVED_ERROR:{}};e.exports=s},function(e,t,i){"use strict";function n(e,t,i,n){return a.call(this,e,t,i,n)}var a=i(63),s=i(177),o={view:function(e){if(e.view)return e.view;var t=s(e);if(t.window===t)return t;var i=t.ownerDocument;return i?i.defaultView||i.parentWindow:window},detail:function(e){return e.detail||0}};a.augmentClass(n,o),e.exports=n},function(e,t,i){"use strict";var n={remove:function(e){e._reactInternalInstance=void 0},get:function(e){return e._reactInternalInstance},has:function(e){return void 0!==e._reactInternalInstance},set:function(e,t){e._reactInternalInstance=t}};e.exports=n},function(e,t,i){var n=i(1),a=i(0),s=i(3);t.default=a.View.extend({el:".top-link",activationOffset:50,scrollTopPosition:0,events:{click:"up"},initialize:function(){var e=this;n(window).on("scroll",function(){var t=n(".top-link-wrapper"),i=n(".ivi-footer").height(),a=n(document).height()-n(window).height()-i,s=n(window).scrollTop();s>e.activationOffset?e.$el.addClass("active"):e.$el.removeClass("active"),s>a?t.addClass("stopped"):t.removeClass("stopped")})},up:function(){s.default.track("top_button_clicked"),n("html, body").animate({scrollTop:this.scrollTopPosition},"slow")}})},function(e,t,i){var n=i(327),a=i(29);t.default=a.default.extend({model:n.default,initialize:function(e){this.uri="/"+e.contentType+"/comments/v6/"},buildRequestParams:function(e){var t=a.default.prototype.buildRequestParams.call(this,e);return t.data||(t.data={}),t.data.sort="desc",t}})},function(e,t,i){var n=i(0),a=i(327),s=i(5),o=i(7),r=i(88),l=i(3),d=i(689),u=i(690),c=i(691),p=i(692),f=i(8),h=i(1);t.default=n.View.extend({el:".js-comment-form",minTextLength:10,maxTextLength:500,events:{submit:"send",click:"expand","keyup textarea":"keyUpHandler"},initialize:function(e){s.extend(this,s.pick(e,"itemId","contentType","season","parentId","trackGroot")),this.$textarea=this.$el.find("textarea"),this.$message=this.$el.find(".js-symbols"),this.$button=this.$el.find(":submit"),this.createNewComment(),this.listenTo(r.default,"comment:added",this.collapse),this.listenTo(r.default,"comment:error",this.errorHandler),this.listenTo(r.default,"comment:expand",this.expand),this.listenTo(o.default,"auth:removePopup",this.expand)},send:function(){return this.model.add({subject:this.$el.find('textarea[name="subject"]').val()}),!1},expand:function(){if(!f.default.isAuthenticated())return o.default.trigger("auth:showLoginModal","comment"),!1;!this.$el.hasClass("expanded")&&this.trackGroot&&l.default.track("review_comment_click"),this.$el.addClass("expanded")},collapse:function(e){this.$el.removeClass("expanded"),this.$button.prop("disabled",!0),this.$textarea.val(""),this.$message.html("");var t=h(".js-more-comment");if(e&&t.length){var i=t.text(),n=i.match(/(\d+)/g);t.text(i.replace(/(\d+)/,++n))}},createNewComment:function(){this.collapse();var e={itemId:this.itemId,contentType:this.contentType,parentId:this.parentId};this.season&&(e.season=this.season),this.model=new a.default(e)},keyUpHandler:function(){var e=this.$textarea.val().length;e<this.minTextLength?(this.$message.html(c.default({length:e})).addClass("error"),this.$button.prop("disabled",!0)):e>this.maxTextLength?(this.$message.html(u.default()).addClass("error"),this.$button.prop("disabled",!0)):(this.$message.html(p.default({length:this.maxTextLength-e})).removeClass("error"),this.$button.prop("disabled",!1))},errorHandler:function(){this.$message.html(d.default()).addClass("error"),this.$button.prop("disabled",!0)},setParentId:function(e){this.parentId=e,this.model.setParentId(e)}})},function(e,t,i){var n=i(29),a=i(75);t.default={appendModels:!1,selectionPrefix:"",mapiGet:function(e){var t=e||{};return t.data||(t.data={}),t.data.from||"number"!=typeof this.selectionFrom||(t.data.from=this.selectionFrom),t.data.to||"number"!=typeof this.selectionTo||(t.data.to=this.selectionTo),n.default.prototype.mapiGet.call(this,t)},increaseSelection:function(e){this.selectionFrom+=e,this.selectionTo+=e},set:function(e,t){t=t||{},t.add=!0,t.merge=!0,t.remove=!1;var i=this.models.length,s=n.default.prototype.set.call(this,e,t);return s&&s.length&&(i>0?a.default.trigger("collection:"+this.selectionPrefix+"MoreDataIsAvailable"):a.default.trigger("collection:"+this.selectionPrefix+"DataListIsAvailable")),s},setSelectionFrom:function(e){"number"==typeof e&&(this.selectionFrom=e)},setSelectionTo:function(e){"number"==typeof e&&(this.selectionTo=e)},isMore:function(e){var t=this.models.length;return"number"==typeof e&&(t-=e),"number"==typeof this.selectionFrom&&(t-=this.selectionFrom),t>0},getSelectionTo:function(){return this.selectionTo}}},function(e,t,i){var n=i(21),a=i(31),s=i(201),o=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t.prototype.onClick=function(){this.props.onClick&&this.props.onClick()},t.prototype.render=function(){var e=[this.props.addClasses,"ivi-button js-ivi-button",this.props.size];return this.props.disabled&&e.push("disabled"),this.props.loading&&e.push("loading"),a.createElement("button",{className:e.join(" "),disabled:this.props.disabled,type:this.props.type,onClick:this.onClick},this.props.children)},t.SIZES={large:"large"},n.__decorate([s.default.bindThis],t.prototype,"onClick",null),t}(a.PureComponent);t.default=o},function(e,t,i){var n=i(0);t.default=new n.Model({})},function(e,t,i){var n=i(0),a=i(5),s=i(3),o=i(20);t.default=n.Model.extend({hdQuality:"HD",sdQuality:"SD",psMethodCard:"card",mastercardPsType:"mastercard",STANDARD_SUBSCRIPTION_DURATION:2592e3,DAY:86400,getVideoEntity:function(){return this.get("videoEntity")},getCollectionEntity:function(){return this.get("collectionEntity")},isEternalBought:function(){return"eternal"===this.getOwnershipType()},getOwnershipType:function(){return this.get("ownership_type")},getUserPrice:function(){return this.get("user_price")},getPrice:function(){return parseFloat(this.get("price"))},getPurchaseParams:function(){return this.get("purchase_params")},getObjectId:function(){return this.get("object_id")},getOptionHash:function(){return this.get("option_hash")},getProductIdentifier:function(){return this.get("product_identifier")},getQuality:function(){return this.get("quality")},isHDQuality:function(){return this.getQuality()===this.hdQuality},isSDQuality:function(){return this.getQuality()===this.sdQuality},getMinUserPrice:function(){return this.get("price_ranges").user_price.min},getMinPrice:function(){return this.get("price_ranges").price.min},getMaxUserPrice:function(){return this.get("price_ranges").user_price.max},getMaxPrice:function(){return this.get("price_ranges").price.max},getDiscountOnCheapestPrice:function(){var e=this.get("price_ranges").discount_on_cheapest_price;return e||0},isContent:function(){return"content"===this.getObjectType()},isSeason:function(){return"season"===this.getObjectType()},isCollection:function(){return"collection"===this.getObjectType()},isSubscription:function(){return"subscription"===this.getObjectType()&&!this.get("trial")},isLongSubscription:function(){return this.isSubscription()&&this.get("duration")>this.STANDARD_SUBSCRIPTION_DURATION},getPaidType:function(){var e=this.getObjectType();return"content"===e||"season"===e||"collection"===e?this.isEternalBought()?"est":"tvod":"subscription"===e?"svod":""},isSvod:function(){return"svod"===this.getPaidType()},isEst:function(){return"est"===this.getPaidType()},isTvod:function(){return"tvod"===this.getPaidType()},getCurrency:function(){return this.get("currency")},getObjectType:function(){return this.get("object_type")},getPaymentOptions:function(){return this.get("payment_options")},isPreorderable:function(){return this.get("preorder")||this.get("is_preorder")},getPaymentInfo:function(){return this.get("payment_info")},isPaidByMastercard:function(){var e=this.getPaymentInfo();return!!e&&e.ps_type===this.mastercardPsType},isPaidByCard:function(){var e=this.getPaymentInfo();return!!e&&e.ps_method===this.psMethodCard},getDurationInDay:function(){return this.get("duration")/this.DAY},getDurationInMonth:function(){return this.get("duration")/this.STANDARD_SUBSCRIPTION_DURATION},getBonusInfo:function(){return this.get("bonus_info")||""},getGrootParams:function(){var e={};this.isSvod()&&s.default.isTrialAvailable()&&(e.is_trybuy=1),this.isSubscription()&&(e.svod_period=this.getDurationInDay()),e["m_"+this.getPaidType()]=1;var t="price_"+this.getPaidType();return this.getQuality()&&!this.isSvod()&&(t+="_"+this.getQuality()),e[t.toLowerCase()]=parseFloat(this.getMinUserPrice()),this.isPreorderable()&&(e.is_preorder=1),e.object_type=this.getObjectType(),e.currency=this.getCurrency(),e.hascard=0,a.each(this.getPaymentOptions(),function(t){"card"===t.ps_method&&t.payment_system_account&&(e.hascard=1)}),o.default.localStorage.getItem("is_in_bundle")&&(e.is_in_bundle=1),e}})},function(e,t,i){var n=i(0);t.default=n.Model.extend({getId:function(){return this.get("id")},getGenre:function(){return this.get("genre")},getCategory:function(){return this.get("category")},getPaidType:function(){return this.get("paidType")},getTitle:function(){return this.get("title")},getHru:function(){return this.get("hru")},getHruCanonical:function(){return this.get("hru_canonical")},getVideoList:function(){return this.get("videos").models},getLink:function(){return this.getHruCanonical()?"/"+String(this.getHruCanonical()).replace(/^[\s\/]+/g,""):"/collections/"+this.getHru()},getPreviewPath:function(){for(var e in this.get("images"))if("PreviewImage"===this.get("images")[e].type)return this.get("images")[e].path.replace("http:","");return""},getPosterPath:function(){return this.get("poster")?this.get("poster").path.replace("http:",""):""}})},function(e,t,i){var n=i(1),a=i(5),s=i(370),o=i(142),r=i(8),l=i(145),d=i(215),u=i(16),c=i(146),p=i(19),f=i(32),h=i(375),g=i(376),m=i(216),v=i(217),_=i(377),b=i(378),y=i(379),w=i(380),C=i(381),k=i(218),P=i(219),S=i(382),T=i(383),E=i(7),I=i(82),x=i(10),M=i(3),A=i(39),L=i(4),O=i(50),j=i(140),D=i(83);t.default=u.default.extend({RESEND_TIME:60,VERIFY_CODE_LENGTH:6,PHONE_NOTIFICATIONS_MESSAGE_CATEGORY_ID:1,PHONE_NOTIFICATIONS_DELIVERY_CATEGORY_IDS:[2],HOLD_TIME_AFTER_SUCCESS:700,MOBILE_VISIBLE_AREA_TOP_OFFSET:80,PASSWORD_HOLD_TIME:2e3,LOGIN_CODE_MAX_LENGTH:6,LOGIN_CODE_NOT_FOUND_ERROR:136,LOGIN_CODE_EXPIRED_ERROR:138,regionEnabled:!0,mobileScroll:!0,modalId:"guest-modal",renderAnimationDuration:300,closeAnimationDuration:300,wrapper:u.default.prototype.wrapper+"-auth",statuses:{STATUS_AUTH_TOKEN:1,STATUS_EMAIL_AUTH:2,STATUS_EMAIL_REGISTRATION:3,STATUS_PHONE_AUTH:4,STATUS_PHONE_REGISTRATION:5,STATUS_AUTH_SUCCESS:6,STATUS_PASSWORD_RECOVERY:7,STATUS_PASSWORD_CHANGE:8,STATUS_PASSWORD_RECOVERY_LINK_NOT_VALID:9,STATUS_OAUTH2_ACCESS:10,STATUS_REGISTRATION_PRIVACY_POLICY:11,STATUS_ERROR_ACTION:12,STATUS_LOGIN_BY_CODE:13,STATUS_LOGIN_BY_CODE_SUCCESS:14},grootPageStatusRel:{1:"auth_reg",2:"auth_mail",3:"reg_mail",4:"auth_phone",5:"reg_phone",7:"change_password",8:"change_password",9:"change_password",11:"confidentional",13:"login_code",14:"login_code"},inputModelRelation:{".js-auth-token":{field:"authToken"},".js-password":{field:"password"},".js-password-repeat":{field:"passwordRepeat"},".js-sms-verify-code":{field:"smsVerifyCode",rule:/^\d*$/},".js-login-code":{field:"loginCode",rule:/^\d*$/}},baseFormsToRender:[g.default,m.default,v.default,_.default,b.default,y.default,P.default,k.default],template:h.default,openEvent:"auth:showAuthModal",events:{"click .js-back-button":"moveToPrevStep","submit form#jsAuthToken":"handleAuthToken","submit form#jsEmailAuth":"handleEmailAuth","submit form#jsEmailRegistration":"handleEmailRegistration","input .js-ivi-textfield__input":"handleInput","focus .js-ivi-textfield":"inputFocused","blur .js-ivi-textfield":"blurInput","input .js-sms-verify-code":"inputSmsCode","input .js-login-code":"inputLoginCode","focus .js-sms-verify-code":"moveContentToVisibleArea","click #fb-auth":"fbAuth","click #vk-auth":"vkAuth","click #ya-auth":"yaAuth","click #ya-click":"yaClick","click .js-update-user-news-subscription":"subscribeUser","click .js-recovery-password-link":"recoveryPassword","click .js-recovery-password-repeat":"recoveryPasswordRepeat","click .js-recovery-password-success-button":"onRecoveryPasswordSuccessButtonClick","click .js-modal-close":"onCloseClick","click .js-send-sms-verify-code":"handlePhoneRegistration","click .js-oauth2-select":"oauth2Select","click .js-oauth2-access":"oauth2Access","click .js-registration-privacy-policy-accept":"acceptRegistrationPrivacyPolicy","click .js-login-by-code-another-device":"moveToPrevStep","click .js-privacy-policy-link":"onPrivacyPolicyLinkClick"},errorsText:{generalAuthError:"К сожалению, произошла ошибка. Попробуйте позже",smsRegistrationDisallow:"К сожалению, в вашей стране нет возможности регистрации по SMS. Пожалуйста, используйте для регистрации ваш email"},specialEventParamTexts:{invalidSession:"время вашей сессии истекло. Для продолжения вам необходимо авторизоваться",certificate:"для активации сертификата",funds:"войдите или зарегистрируйтесь перед пополнением личного счета",sber:"для участия в акции от Сбербанка",preorder:"для отмены предзаказа",newSeriesAddNotification:"чтобы получать уведомления о выходе новых серий"},modalHash:"#auth",mobileModal:!0,socialNetworkAuthPopupWidth:870,socialNetworkAuthPopupHeight:670,resendTimer:null,isInputSmsCodeGrootSent:!1,SMS_RATE_LIMIT_EXCEEDED_CODE:122,isSmsVerifyCodeSent:!1,browserInfo:null,mapiInfo:null,phoneNumberHelper:null,bodyClass:"has-auth-modal",onHashChangeCloseModalBinded:null,passwordHoldTimer:null,isLoginByCodePage:!1,isOauth2Page:!1,isLoginModalBeforePurchase:!1,initialize:function(e){this.setViewInitialStatus(),u.default.prototype.initialize.call(this,e),this.listenTo(E.default,"auth:showRegModal",this.open),this.listenTo(E.default,"auth:showLoginModal",this.open),this.listenTo(E.default,"auth:showLoginModal:beforePurchase",this.showLoginModalBeforePurchase),window.ivi.adaptive.isMobile&&(this.onHashChangeCloseModalBinded=this.onHashChangeCloseModal.bind(this)),this.browserInfo=new f.default,this.mapiInfo=new p.default,this.phoneNumberHelper=new j.default,this.errorActionsModel=new d.default,this.notificationModel=new l.default,this.model.set("smsRegistrationCapability",this.mapiInfo.isSMSRegistrationCapability()),this.model.set("yandexOauthCapability",this.mapiInfo.isYandexOauthCapability()),this.model.set("passwordRules",this.mapiInfo.getPasswordRules()),this.model.set("socialButtonsCapability",this.mapiInfo.isSocialButtonsCapability()),this.initReloadSubscriber()},listenModalEvents:function(){this.listenTo(E.default,"auth:request:success",this.onSuccess),this.listenTo(E.default,"auth:request:error",this.showError),this.listenTo(E.default,"oauth2:get:userInfo",this.onGetOauth2UserInfo),this.listenTo(E.default,"auth:phoneConfirmation",this.onSMSVerifyCodeSent),this.listenTo(E.default,"auth:validateAuthToken:success",this.validateAuthTokenSuccess),this.listenTo(E.default,"auth:passReset:success",this.moveToNextStep),this.listenTo(E.default,"auth:passReset:error",this.onPasswordRecoveryError),this.listenTo(E.default,"auth:loginByCode:success",this.onSuccess),this.listenTo(E.default,"auth:loginByCode:error",this.showError),this.listenTo(E.default,"auth:mergeError",this.showError)},stopListeningModalEvents:function(){this.stopListening(E.default,"auth:request:success",this.onSuccess),this.stopListening(E.default,"auth:request:error",this.showError),this.stopListening(E.default,"oauth2:get:userInfo",this.onGetOauth2UserInfo),this.stopListening(E.default,"auth:phoneConfirmation",this.onSMSVerifyCodeSent),this.stopListening(E.default,"auth:validateAuthToken:success",this.validateAuthTokenSuccess),this.stopListening(E.default,"auth:passReset:success",this.moveToNextStep),this.stopListening(E.default,"auth:passReset:error",this.onPasswordRecoveryError),this.stopListening(E.default,"auth:loginByCode:success",this.onSuccess),this.stopListening(E.default,"auth:loginByCode:error",this.showError),this.stopListening(E.default,"auth:mergeError",this.showError)},onGetOauth2UserInfo:function(e,t){this.$el.empty(),this.stopListeningModalEvents(),this.setStatus(this.statuses.STATUS_OAUTH2_ACCESS),this.model.set("session",e),this.model.set("oauthUserToken",t),this.open()},moveToPrevStep:function(){if(this.model.get("yandexToken"))this.oauth2Select();else{switch(this.model.get("status")){case this.statuses.STATUS_PASSWORD_RECOVERY:this.resetData(),this.model.set("status",this.statuses.STATUS_EMAIL_AUTH);break;case this.statuses.STATUS_LOGIN_BY_CODE_SUCCESS:this.resetData(),this.model.set("status",this.statuses.STATUS_LOGIN_BY_CODE);break;case this.statuses.STATUS_PHONE_AUTH:case this.statuses.STATUS_PHONE_REGISTRATION:this.$el.find(".circle-textfield").attr("class","circle-textfield");default:this.resetData(),this.model.set("status",this.statuses.STATUS_AUTH_TOKEN)}M.default.rewriteSuperProperties({block_id:"back"}),n(".modal-view_finish").removeClass("modal-view_finish"),this.update(),this.afterStepChanged()}return!1},showLoginModalBeforePurchase:function(){M.default.track("auth_payment_reg_show"),this.isLoginModalBeforePurchase=!0,this.setAnimation(!1),this.open()},moveToNextStep:function(){n(".modal-view_finish").removeClass("modal-view_finish").addClass("modal-view_end"),this.resetLoadings(),this.update(),this.afterStepChanged()},afterStepChanged:function(){switch(clearInterval(this.resendTimer),this.blurAllInputs(),this.model.get("status")){case this.statuses.STATUS_REGISTRATION_PRIVACY_POLICY:this.focusFirstButton();break;default:this.focusCurrentInput()}this.setModalControls(),this.changeGrootPageParam()},resetBlockPosition:function(){setTimeout(function(){n(".modal-view_end").not(".js-auth-token-block").removeClass("modal-view_end")},600)},moveContentToVisibleArea:function(){var e=this;if(this.browserInfo.isAndroid()&&window.ivi.adaptive.isMobileStyle){var t=this.$el.find(".fullscreen-popup__scroll-wrapper"),i=this.$el.find(".modal-view_finish .js-ivi-textfield__input").first(),n=t.scrollTop();i.length>0&&setTimeout(function(){var a=i.offset().top+n-e.MOBILE_VISIBLE_AREA_TOP_OFFSET;t.scrollTop(a)},500)}},setModalControls:function(){var e=this.$el.find(".fullscreen-popup");switch(e.removeClass("fullscreen-popup_has-close-view-button fullscreen-popup_has-previous-view-button"),this.model.get("status")){case this.statuses.STATUS_AUTH_TOKEN:case this.statuses.STATUS_AUTH_SUCCESS:case this.statuses.STATUS_PASSWORD_RECOVERY_LINK_NOT_VALID:case this.statuses.STATUS_OAUTH2_ACCESS:this.isLoginByCodePage||e.addClass("fullscreen-popup_has-close-view-button");break;case this.statuses.STATUS_EMAIL_AUTH:case this.statuses.STATUS_EMAIL_REGISTRATION:case this.statuses.STATUS_PHONE_AUTH:case this.statuses.STATUS_PHONE_REGISTRATION:case this.statuses.STATUS_PASSWORD_RECOVERY:case this.statuses.STATUS_REGISTRATION_PRIVACY_POLICY:case this.statuses.STATUS_ERROR_ACTION:case this.statuses.STATUS_LOGIN_BY_CODE_SUCCESS:e.addClass("fullscreen-popup_has-previous-view-button")}},inputFocused:function(e){var t=this,i=n(e.currentTarget);n.each(this.inputModelRelation,function(e,n){i.children(e).length>0&&t.model.set(n.field+"InputFocused",!0)}),this.resetErrors(),this.update(),this.moveContentToVisibleArea()},focusCurrentInput:function(){var e=this;window.ivi.adaptive.isMobile||setTimeout(function(){e.$(".modal-view_finish").not(".modal-view_end").find(".js-ivi-textfield__input").first().focus()},600)},focusFirstButton:function(){var e=this;window.ivi.adaptive.isMobile||setTimeout(function(){e.$(".modal-view_finish").not(".modal-view_end").find(".js-ivi-privacy-policy-button").first().focus()},600)},blurInput:function(e){var t=this,i=n(e.currentTarget);n.each(this.inputModelRelation,function(e,n){i.children(e).length>0&&t.model.set(n.field+"InputFocused",!1)}),this.update()},blurAllInputs:function(){var e=this;n.each(this.model.attributes,function(t){-1!==t.indexOf("InputFocused")&&(e.model.attributes[t]=!1)}),n(".modal-view_end .js-ivi-textfield__input").blur()},handleInput:function(e){var t=n(e.currentTarget),i=t.val(),a=null;n.each(this.inputModelRelation,function(e,n){!t.hasClass(e.replace(".",""))||n.rule&&!n.rule.test(i)||(a=n)}),null!==a&&(this.model.set(a.field,t.val().replace(/"/g,"&quot;")),this.model.get("status")===this.statuses.STATUS_EMAIL_REGISTRATION||this.model.get("status")===this.statuses.STATUS_PASSWORD_CHANGE?this.applyPasswordRules():this.resetErrors()),this.update()},applySimplePasswordRules:function(){this.model.set("passwordFillingPercent",0),this.model.set("passwordRepeatCorrect",this.model.get("password")===this.model.get("passwordRepeat")),this.update()},applyPasswordRules:function(){var e=this;if(this.model&&this.update){if(!this.model.get("passwordRules"))return void this.applySimplePasswordRules();this.model.set("passwordFillingPercent",0);var t=this.model.get("password");if(t)if(this.model.set("passwordFillingPercent",100),t.length<this.model.get("passwordRules").min_length){var i=L.default.mathTrunc(t.length/this.model.get("passwordRules").min_length*100);i<100&&this.model.set("passwordFillingPercent",i),this.model.unset("passwordRepeat"),this.model.set("passwordError",this.model.get("passwordRules").min_length_user_message)}else t.length>this.model.get("passwordRules").max_length?(this.model.unset("passwordRepeat"),this.model.set("passwordError",this.model.get("passwordRules").max_length_user_message)):this.model.unset("passwordError");else this.model.unset("passwordRepeat"),this.model.unset("passwordError");this.model.set("passwordRepeatCorrect",!1);var n=this.model.get("passwordRepeat");!this.model.get("passwordError")&&t&&n&&t!==n?this.model.set("passwordRepeatError",this.model.get("passwordRules").password_repeat_user_message):(this.model.unset("passwordRepeatError"),t&&n&&t===n&&this.model.set("passwordRepeatCorrect",!0)),this.model.get("passwordError")||this.model.get("passwordRepeatError")||this.model.set("passwordHoldTimeReached",!1),clearTimeout(this.passwordHoldTimer),this.model.get("passwordRepeatCorrect")||(this.passwordHoldTimer=setTimeout(function(){e.model.set("passwordHoldTimeReached",!0),e.update()},this.PASSWORD_HOLD_TIME))}},resetPasswords:function(){this.model.unset("password"),this.model.unset("passwordRepeat")},resetData:function(){this.isLoginModalBeforePurchase=!1,this.eventParams&&this.eventParams.isOauth2Page||(this.eventParams={}),this.model.attributes={authToken:this.model.get("authToken"),email:this.model.get("email"),session:this.model.get("session"),phone:this.model.get("phone"),formattedPhone:this.model.get("formattedPhone"),smsRegistrationCapability:this.mapiInfo.isSMSRegistrationCapability(),yandexOauthCapability:this.mapiInfo.isYandexOauthCapability(),socialButtonsCapability:this.mapiInfo.isSocialButtonsCapability(),authTokenInputFocused:!0,privacyPolicyAcceptedToken:this.model.get("privacyPolicyAcceptedToken"),passwordRules:this.model.get("passwordRules")}},resetLoadings:function(){this.model.set({isAuthTokenChecking:!1,isEmailAuthChecking:!1,isEmailRegistrationChecking:!1,isSMSVerifyCodeChecking:!1,isLoginCodeChecking:!1})},resetErrors:function(){this.model.unset("code")},inputSmsCode:function(e){this.isInputSmsCodeGrootSent||(M.default.track("phone_code_input"),this.isInputSmsCodeGrootSent=!0),e.currentTarget.value&&6===e.currentTarget.value.length&&(this.model.loginBySMS(),this.model.unset("smsVerifyCode"),this.model.set("isSMSVerifyCodeChecking",!0))},inputLoginCode:function(e){var t=this.$(e.currentTarget).val();return t.length===this.LOGIN_CODE_MAX_LENGTH&&(this.model.loginByCode(t),this.model.set("isLoginCodeChecking",!0),this.model.unset("loginCode")),!1},onOpen:function(){return this.isLoginByCodePage?(this.resetBlockPosition(),this.setViewInitialStatus(),this.model.set("isLoginByCodePage",!0),void this.moveToPrevStep()):(this.listenModalEvents(),this.isLoginByCodePage?(this.resetBlockPosition(),void this.moveToPrevStep()):(this.eventParams&&(this.priorityModal=this.eventParams.priorityModal,this.processEventParams()),this.isOauth2Page||this.isLoginByCodePage||this.model.get("status")===this.statuses.STATUS_PASSWORD_CHANGE||this.model.get("status")===this.statuses.STATUS_PASSWORD_RECOVERY_LINK_NOT_VALID||this.setViewInitialStatus(),u.default.prototype.onOpen.apply(this,arguments),new c.default({handleOnlyResize:!0}),void this.pausePlayer()))},processEventParams:function(){if(this.eventParams.isLoginByCodePage)this.isLoginByCodePage=!0,this.bodyClass=null,r.default.isAuthenticated()&&(this.model.set("status",this.statuses.STATUS_LOGIN_BY_CODE),this.trackLoginByCodePageView()),this.listenTo(E.default,"user:logout",this.handleUserLogout);else if(this.eventParams.passwordChange)this.eventParams.oldPassword?(this.model.set("status",this.statuses.STATUS_PASSWORD_CHANGE),this.listenTo(E.default,"user:setPasswordError",this.showError),this.listenTo(E.default,"user:setPasswordSuccess",this.onSuccess)):this.model.set("status",this.statuses.STATUS_PASSWORD_RECOVERY_LINK_NOT_VALID);else if(this.eventParams.isOauth2Page)this.isOauth2Page=!0;else{var e="";if(this.specialEventParamTexts[this.eventParams])e=this.specialEventParamTexts[this.eventParams];else if(this.eventParams.length>1&&"wantToWatch"===this.eventParams[0]){var t="",i=this.eventParams[1];switch(i){case"movies":t="выбранный фильм";break;case"animation":t="выбранный мультфильм";break;case"series":t="выбранный сериал";break;case"programs":t="выбранная программа";break;default:t="выбранный фильм"}e="и мы оповестим вас, когда "+t+" появится на ivi"}else{var n=void 0;"comment"===this.eventParams?n="оставить отзыв":"review"===this.eventParams?n="оставить рецензию":"like"===this.eventParams&&(n="поставить лайк"),e="чтобы "+n}this.model.set("tokenFormNotice",e)}},onRender:function(){this.undelegateModalEvents(),this.changeGrootPageParam();var e=this.serializeData(),t=this.$el.find(".js-auth-wrapper");switch(this.model.get("status")){case this.statuses.STATUS_PASSWORD_CHANGE:return void t.append(v.default(e));case this.statuses.STATUS_PASSWORD_RECOVERY_LINK_NOT_VALID:t.append(w.default(e));break;case this.statuses.STATUS_OAUTH2_ACCESS:t.append(C.default(e));break;case this.statuses.STATUS_LOGIN_BY_CODE:break;default:M.default.track("auth_reg_show")}this.baseFormsToRender.forEach(function(i){t.append(i(e))}),this.isLoginByCodePage&&(t.append(S.default(e)),t.append(T.default(e))),this.setModalControls()},onRenderAnimation:function(){this.animate?(this.$el.css({display:"none",position:"absolute","z-index":9999}),this.$el.fadeIn({duration:this.renderAnimationDuration,complete:this.rendererCompleted})):this.rendererCompleted()},rendererCompleted:function(){u.default.prototype.rendererCompleted.apply(this,arguments),this.$el.removeAttr("style"),this.isOauth2Page||this.isLoginByCodePage?(this.isLoginByCodePage&&r.default.isAuthenticated()&&this.$el.find(".js-auth-token-block").addClass("modal-view_finish modal-view_end"),this.focusCurrentInput()):this.$el.find(".modal-view_finish .js-ivi-textfield__input").first().focus()},update:function(){var e,t,i=this.serializeData();switch(this.model.get("status")){case this.statuses.STATUS_AUTH_TOKEN:e=this.$(".js-auth-token-block").get(0),t=g.default(i);break;case this.statuses.STATUS_EMAIL_AUTH:e=this.$(".js-email-auth-block").get(0),t=m.default(i);break;case this.statuses.STATUS_EMAIL_REGISTRATION:case this.statuses.STATUS_PASSWORD_CHANGE:e=this.$(".js-email-registration-block").get(0),t=v.default(i);break;case this.statuses.STATUS_PHONE_AUTH:case this.statuses.STATUS_PHONE_REGISTRATION:e=this.$(".js-sms-verify-code-block").get(0),t=_.default(i);break;case this.statuses.STATUS_AUTH_SUCCESS:e=this.$(".js-success-block").get(0),t=b.default(i);break;case this.statuses.STATUS_PASSWORD_RECOVERY:e=this.$(".js-recovery-password-block").get(0),t=y.default(i);break;case this.statuses.STATUS_REGISTRATION_PRIVACY_POLICY:e=this.$(".js-registration-privacy-policy-block").get(0),t=P.default(i);break;case this.statuses.STATUS_ERROR_ACTION:e=this.$(".js-error-actions-block").get(0),t=k.default(i);break;case this.statuses.STATUS_LOGIN_BY_CODE:e=this.$(".js-login-by-code-block").get(0),t=S.default(i);break;case this.statuses.STATUS_LOGIN_BY_CODE_SUCCESS:e=this.$(".js-login-by-code-success-block").get(0),t=T.default(i);break;case this.statuses.STATUS_OAUTH2_ACCESS:e=this.$(".js-oauth-access-block").get(0),t=C.default(i)}return this.updateHtml(e,t)},updateHtml:function(e,t){if(!t)return!1;var i=O.default.createElement("div");i.innerHTML=t,s(e,i.children[0]);var n=this.$el.find(".modal-view_finish .js-ivi-textfield__input").first();return n.length>0&&this.setPositionTooltip(n.get()),!0},beforeCancel:function(){this.resetData(),this.afterStepChanged(),this.model.unset("authToken"),this.model.set("status",this.statuses.STATUS_AUTH_TOKEN),this.isInputSmsCodeGrootSent=!1,u.default.prototype.beforeCancel.call(this),window.ivi.adaptive.isMobile&&window.removeEventListener("hashchange",this.onHashChangeCloseModalBinded)},triggerCancel:function(e){e&&this.resumePlayer(),u.default.prototype.triggerCancel.call(this,e)},onDestroy:function(){var e=this;this.isLoginByCodePage||(this.active=!1,this.stopListeningModalEvents(),this.$el.css({position:"absolute","z-index":9999}),this.animate?this.$el.fadeOut({duration:this.closeAnimationDuration,complete:function(){e.triggerOnDestroyEvents(),e.$el.empty()}}):(this.triggerOnDestroyEvents(),u.default.prototype.onDestroy.apply(this)))},triggerOnDestroyEvents:function(){E.default.trigger("auth:modal:closed"),r.default.isAuthenticated()&&E.default.trigger("user:login")},beforeSubmit:function(){return!1},handleAuthToken:function(){return this.model.set("isAuthTokenChecking",!0),this.model.validateAuthToken(),M.default.track("continue_click"),this.update(),!1},handleEmailAuth:function(){return this.model.set("isEmailAuthChecking",!0),this.model.loginByEmail(this.isOauth2Page),M.default.track("sign_in_click"),this.update(),!1},handleEmailRegistration:function(){return this.model.set("isEmailRegistrationChecking",!0),this.model.get("status")===this.statuses.STATUS_PASSWORD_CHANGE?(M.default.track("change_password_submit"),r.default.setPassword(this.eventParams.oldPassword,this.model.get("password"),this.model.get("passwordRepeat"))):(M.default.track("sign_up_click"),this.model.registerByEmail(this.isOauth2Page)),this.update(),!1},handlePhoneRegistration:function(){return this.model.get("currentResendTime")||(this.model.set("isPhoneRegistrationChecking",!0),this.model.registerBySMS(),M.default.track("repeat_code")),this.update(),!1},recoveryPassword:function(){return this.model.resetPassByEmail(),this.model.set("status",this.statuses.STATUS_PASSWORD_RECOVERY),this.resetErrors(),M.default.track("restore_password_click"),!1},recoveryPasswordRepeat:function(){return this.resetData(),this.model.set("status",this.statuses.STATUS_AUTH_TOKEN),M.default.track("change_password_click"),this.moveToNextStep(),!1},validateAuthTokenSuccess:function(){var e=this.model.get("status");!this.mapiInfo.showPrivacyPolicy()||"register"!==this.model.get("action")||this.model.get("privacyPolicyAcceptedToken")&&this.model.get("privacyPolicyAcceptedToken")===this.model.get("authToken")?"email"===this.model.get("what")?(this.model.set("email",this.model.get("authToken")),"register"===this.model.get("action")?this.model.set("status",this.statuses.STATUS_EMAIL_REGISTRATION):"login"===this.model.get("action")&&this.model.set("status",this.statuses.STATUS_EMAIL_AUTH)):"phone"===this.model.get("what")&&(this.model.get("phone")&&this.model.get("phone")!==this.model.get("authToken")&&(this.isSmsVerifyCodeSent=!1),this.model.set("phone",this.model.get("authToken")),this.model.set("formattedPhone",this.phoneNumberHelper.getFormattedRussianPhone(this.model.get("phone"))),this.model.set("isPhoneRegistrationChecking",!0),this.model.registerBySMS(),"register"===this.model.get("action")?this.model.set("status",this.statuses.STATUS_PHONE_REGISTRATION):"login"===this.model.get("action")&&this.model.set("status",this.statuses.STATUS_PHONE_AUTH)):this.model.set("status",this.statuses.STATUS_REGISTRATION_PRIVACY_POLICY),e!==this.model.get("status")&&this.moveToNextStep()},acceptRegistrationPrivacyPolicy:function(){this.model.set("privacyPolicyAcceptedToken",this.model.get("authToken")),M.default.track("agree_click"),this.validateAuthTokenSuccess(),this.resetBlockPosition()},onPrivacyPolicyLinkClick:function(){M.default.track("policy_click")},onSMSVerifyCodeSent:function(){this.model.set("currentResendTime",this.RESEND_TIME),this.isSmsVerifyCodeSent=!0,this.model.set("isPhoneRegistrationChecking",!1),this.runResendTimer(),this.update()},runResendTimer:function(){var e=this;this.resendTimer&&clearInterval(this.resendTimer),this.resendTimer=setInterval(function(){e.model.set("currentResendTime",e.model.get("currentResendTime")-1),0===e.model.get("currentResendTime")&&(clearInterval(e.resendTimer),e.resendTimer=null),e.update()},1e3)},handleUserLogout:function(){this.resetBlockPosition(),this.moveToPrevStep()},serializeData:function(){var e,t=this.model.get("status"),i="";this.model.get("oauthUserToken")?i=this.model.get("oauthUserToken"):this.model.get("user")?e=this.model.get("user"):this.eventParams&&this.eventParams.user&&(e=this.eventParams.user),e&&(i=e.getEmail()||e.getFormattedPhoneNumber());var a={VERIFY_CODE_LENGTH:this.VERIFY_CODE_LENGTH,isFirstStep:t===this.statuses.STATUS_AUTH_TOKEN,isSecondStep:t===this.statuses.STATUS_EMAIL_AUTH||t===this.statuses.STATUS_EMAIL_REGISTRATION||t===this.statuses.STATUS_PHONE_AUTH||t===this.statuses.STATUS_PHONE_REGISTRATION||t===this.statuses.STATUS_PASSWORD_CHANGE,isLastStep:t===this.statuses.STATUS_AUTH_SUCCESS||t===this.statuses.STATUS_PASSWORD_RECOVERY,isRegistrationPrivacyPolicyStep:t===this.statuses.STATUS_REGISTRATION_PRIVACY_POLICY,isErrorActionsStep:t===this.statuses.STATUS_ERROR_ACTION,errorActionsModel:this.errorActionsModel,loadedYandexUserInfo:!!this.model.get("yandexToken"),oauthUserToken:i,isOauth2Page:this.isOauth2Page,isLoginByCodePage:this.isLoginByCodePage,isLoginModalBeforePurchase:this.isLoginModalBeforePurchase};return this.isLoginByCodePage&&(a.LOGIN_CODE_MAX_LENGTH=this.LOGIN_CODE_MAX_LENGTH,a.isLoginByCodeStep=t===this.statuses.STATUS_LOGIN_BY_CODE,a.isLoginByCodeSuccessStep=t===this.statuses.STATUS_LOGIN_BY_CODE_SUCCESS,t===this.statuses.STATUS_LOGIN_BY_CODE&&(a.visibleLoginCode=this.model.get("loginCode")?this.model.get("loginCode").split(""):[])),t!==this.statuses.STATUS_PHONE_AUTH&&t!==this.statuses.STATUS_PHONE_REGISTRATION||(a.visibleSMSVerifyCode=this.model.get("smsVerifyCode")?this.model.get("smsVerifyCode").split(""):[],a.isPhoneRegistrationStep=t===this.statuses.STATUS_PHONE_REGISTRATION,a.SMS_RATE_LIMIT_EXCEEDED_CODE=this.SMS_RATE_LIMIT_EXCEEDED_CODE,a.isSmsVerifyCodeSent=this.isSmsVerifyCodeSent,this.model.get("sms_left")&&(this.model.set("smsLeft",parseInt(this.model.get("sms_left"),10)),this.model.unset("sms_left"))),n.extend(a,this.eventParams,this.model.attributes)},showError:function(e,t,i){if(void 0===i&&(i=null),this.resetLoadings(),this.resetPasswords(),this.model.set("isPhoneRegistrationChecking",!1),this.model.set("code",t),e?this.model.set("userMessage",e):this.errorsText[t]?this.model.set("userMessage",this.errorsText[t]):(this.model.set("code",-1),this.model.set("userMessage",this.errorsText.generalAuthError)),null!==i)return void this.showErrorActions(i);this.model.get("status")===this.statuses.STATUS_LOGIN_BY_CODE&&t!==this.LOGIN_CODE_NOT_FOUND_ERROR&&t!==this.LOGIN_CODE_EXPIRED_ERROR&&this.model.set("disableLoginByCode",!0),this.onErrorGroot(),this.update()},showErrorActions:function(e){this.errorActionsModel.clear(),this.errorActionsModel.set(e),this.model.set("status",this.statuses.STATUS_ERROR_ACTION),this.moveToNextStep(),this.resetBlockPosition()},onPasswordRecoveryError:function(e,t){this.moveToNextStep(),this.showError(e,t)},onErrorGroot:function(){var e={};switch(e.exception_code=this.model.get("code"),e.exception_text=this.model.get("userMessage"),this.model.get("status")){case this.statuses.STATUS_AUTH_TOKEN:M.default.track("auth_reg_error",e);break;case this.statuses.STATUS_EMAIL_AUTH:M.default.track("email_auth_error",e);break;case this.statuses.STATUS_EMAIL_REGISTRATION:M.default.track("email_reg_error",e);break;case this.statuses.STATUS_PHONE_AUTH:M.default.track("phone_auth_error",e);break;case this.statuses.STATUS_PHONE_REGISTRATION:M.default.track("phone_reg_error",e);break;case this.statuses.STATUS_PASSWORD_RECOVERY:M.default.track("restore_password_error",e);break;case this.statuses.STATUS_LOGIN_BY_CODE:M.default.track("login_code_error",e)}},onSuccess:function(){switch(this.onSuccessGroot(),this.model.get("status")){case this.statuses.STATUS_PHONE_REGISTRATION:this.model.set("status",this.statuses.STATUS_AUTH_SUCCESS),this.moveToNextStep();break;case this.statuses.STATUS_LOGIN_BY_CODE:this.model.set("status",this.statuses.STATUS_LOGIN_BY_CODE_SUCCESS),this.moveToNextStep();break;case this.statuses.STATUS_EMAIL_AUTH:case this.statuses.STATUS_EMAIL_REGISTRATION:this.model.set("completed",!0),this.update(),setTimeout(this.afterSuccessShown.bind(this),this.HOLD_TIME_AFTER_SUCCESS);break;default:this.afterSuccessShown()}},afterSuccessShown:function(){this.isLoginByCodePage?(this.model.set("status",this.statuses.STATUS_LOGIN_BY_CODE),this.trackLoginByCodePageView(),this.moveToNextStep()):(this.resetLoadings(),this.model.unset("completed"),this.closeModal())},onSuccessGroot:function(){switch(this.model.get("status")){case this.statuses.STATUS_AUTH_TOKEN:M.default.track("auth_reg_success");break;case this.statuses.STATUS_EMAIL_AUTH:M.default.track("email_auth_success");break;case this.statuses.STATUS_EMAIL_REGISTRATION:M.default.track("email_reg_success");break;case this.statuses.STATUS_PHONE_AUTH:M.default.track("phone_auth_success");break;case this.statuses.STATUS_PHONE_REGISTRATION:M.default.track("phone_reg_success");break;case this.statuses.STATUS_PASSWORD_RECOVERY:M.default.track("restore_password_success");break;case this.statuses.STATUS_LOGIN_BY_CODE:M.default.track("login_code_success")}},closeModal:function(){this.triggerCancel(),window.ivi.adaptive.isMobile&&(L.default.getLocation().hash="",n(".js-top-menu").removeClass("top-menu_expanded"))},onCloseClick:function(){M.default.track("close_click"),this.isOauth2Page&&E.default.trigger("auth:modal:user:close",!0)},onRecoveryPasswordSuccessButtonClick:function(){M.default.track("restore_password_submit"),this.triggerCancel()},onHashChangeCloseModal:function(){L.default.getLocation().hash!==this.modalHash&&this.triggerCancel()},vkAuth:function(){var e=this.buildSocialNetworkRedirectUrl("vk"),t="https://oauth.vk.com/authorize?client_id="+x.default.vk.client_id+"&display="+(L.default.isIE11()?"page":x.default.vk.display)+"&redirect_uri="+e+"&response_type="+x.default.vk.response_type+"&scope="+x.default.vk.scope+"&v="+x.default.vk.v;window.ivi.adaptive.isMobile||L.default.isIE11()?L.default.redirect(t):this.popupCenter(t,"",this.socialNetworkAuthPopupWidth,this.socialNetworkAuthPopupHeight)},fbAuth:function(){var e=this.buildSocialNetworkRedirectUrl("fb"),t="https://www.facebook.com/dialog/oauth?client_id="+x.default.facebook.client_id+"&display="+(L.default.isIE11()?"page":x.default.facebook.display)+"&redirect_uri="+e+"&response_type="+x.default.facebook.response_type+"&scope="+x.default.facebook.scope;window.ivi.adaptive.isMobile||L.default.isIE11()?L.default.redirect(t):this.popupCenter(t,"",this.socialNetworkAuthPopupWidth,this.socialNetworkAuthPopupHeight)},yaAuth:function(){var e=this.buildSocialNetworkRedirectUrl("ya"),t="https://oauth.yandex.ru/authorize?client_id="+x.default.yandex.client_id+"&display="+(L.default.isIE11()?"page":x.default.yandex.display)+"&redirect_uri="+e+"&response_type="+x.default.yandex.response_type;window.ivi.adaptive.isMobile||L.default.isIE11()?L.default.redirect(t):this.popupCenter(t,"",this.socialNetworkAuthPopupWidth,this.socialNetworkAuthPopupHeight)},buildSocialNetworkRedirectUrl:function(e){var t={},i="https://www."+A.default.getRightHost();switch(e){case"vk":i+=x.default.vk.redirect_uri,M.default.track("vk_click");break;case"fb":i+=x.default.facebook.redirect_uri,M.default.track("fb_click");break;case"ya":i+=x.default.yandex.redirect_uri,M.default.track("ya_click");break;default:return i}return(window.ivi.adaptive.isMobile||L.default.isIE11())&&("sber"===this.eventParams?t.initialUri="sber":"mcdonalds.ivi.ru"===L.default.getLocation().host?t.initialUri="mcdonalds":t.initialUri=encodeURIComponent(L.default.getPathname())),a.isEmpty(t)||(i+="ya"===e?"&state=":"?",i+=a.map(t,function(e,t){return t+"="+e}).join("&")),i},popupCenter:function(e,t,i,n){var a=L.default.getScreenLeft(),s=L.default.getScreenTop(),o=L.default.getViewPort().width,r=L.default.getViewPort().height,l=o/2-i/2+a,d=r/2-n/2+s,u=L.default.open(e,t,"scrollbars=yes, width="+i+", height="+n+", top="+d+", left="+l);L.default.hasFocus()&&u.focus()},initReloadSubscriber:function(){n(window).on("message",this.onReloadMessage)},onReloadMessage:function(e){"window:reload"===e.originalEvent.data&&o.default.checkWantToWatchAfterLogin(function(){L.default.reload()})},onShow:function(){window.ivi.adaptive.isMobile&&(I.default.trigger("mobile:removeBranchLinkBlock"),window.addEventListener("hashchange",this.onHashChangeCloseModalBinded,!1))},subscribeUser:function(){this.notificationModel.setAuthParams(),this.notificationModel.setState(this.PHONE_NOTIFICATIONS_MESSAGE_CATEGORY_ID,this.PHONE_NOTIFICATIONS_DELIVERY_CATEGORY_IDS,n(".js-news-subscribe").prop("checked")),this.afterSuccessShown()},changeGrootPageParam:function(){this.grootPageStatusRel[this.model.get("status")]&&M.default.rewriteSuperProperties({page:this.grootPageStatusRel[this.model.get("status")]})},setViewInitialStatus:function(){this.model.set("status",this.statuses.STATUS_AUTH_TOKEN)},setStatus:function(e){this.model.set("status",e)},setYandexUserInfo:function(e,t){this.model.set("yandexToken",e),this.model.set("oauthUserToken",t)},oauth2Select:function(){this.model.set("status",this.statuses.STATUS_AUTH_TOKEN),this.moveToNextStep(),this.model.logout()},oauth2Access:function(){this.model.get("yandexToken")?(this.model.loginByYandex(this.model.get("yandexToken")),this.listenToOnce(E.default,"merge",this.triggerOauth2AccessEvent),this.listenToOnce(E.default,"auth:yandex:error",this.onAuthYandexError)):this.model.get("session")?(this.listenToOnce(E.default,"loadUser",this.triggerOauth2AccessEvent),this.model.saveAndMergeSessionWithLoadUser(this.model.get("session"))):this.triggerOauth2AccessEvent()},onAuthYandexError:function(e){this.stopListening(E.default,"merge",this.triggerOauth2AccessEvent),this.model.set("userMessage",e||this.errorsText.generalAuthError),this.setStatus(this.statuses.STATUS_ERROR_ACTION),this.open()},triggerOauth2AccessEvent:function(){this.stopListening(E.default,"auth:yandex:error",this.onAuthYandexError),E.default.trigger("auth:modal:oauth2Access")},yaClick:function(){return this.setStatus(this.statuses.STATUS_OAUTH2_ACCESS),this.open(),!1},checkKey:function(e){D.default.getKeyCode(e)===D.default.KEY_ESCAPE&&this.active&&M.default.track("close_click"),u.default.prototype.checkKey.call(this,e)},trackLoginByCodePageView:function(){M.default.rewriteSuperProperties({page:"login_code"}),M.default.track("page_view")},setPositionTooltip:c.default.prototype.setPositionTooltip})},function(e,t,i){var n,a=i(1),s=i(32),o=i(6),r=i(143),l=i(19),d=i(108),u=i(22),c=i(7),p=i(41),f=i(11),h=i(26),g=i(110),m=i(212),v=i(213),_=i(3),b=i(214),y=i(43),w=i(73),C=i(65),k=i(20),P=i(144),S=i(8),T=i(373),E=i(4),I=i(89),x=i(74),M=function(){function e(){this.playerVolumeBlockHovered=!1,this.adultModel=new x.default,m.default.init(),v.default.init()}return e.prototype.getAgeLimit=function(){return this.adultModel.getAgeLimit()},e.prototype.canWatchAdultContent=function(){return this.adultModel.canWatchAdultContent()},e.prototype.showModalForAdultContent=function(){g.default.trigger("showEroticModal",{videoFromEndScreen:!0})},e.prototype.onSite=function(){return!0},e.prototype.getCookieForPlayer=function(){return C.default.get()},e.prototype.onPlayerLoad=function(){a(".js-player-controls").remove(),a(".js-player-wrapper").removeClass("loading"),g.default.trigger("onPlayerLoad")},e.prototype.favouriteAdd=function(e,t){var i=a.Deferred();return h.default.trigger("favourite:add",{objectId:e,type:t}),h.default.listenTo(h.default,"favourites:added",function(n){n.objectId===e&&n.type===t&&i.resolve()}),i.promise()},e.prototype.favouriteDelete=function(e,t){var i=a.Deferred();return h.default.trigger("favourite:delete",{objectId:e,type:t}),h.default.listenTo(h.default,"favourites:deleted",function(n){n.objectId===e&&n.type===t&&i.resolve()}),i.promise()},e.prototype.userRate=function(e,t,i){var n=a.Deferred();return w.default.trigger("api:user:grade",e,t,i),w.default.listenToOnce(w.default,"have:grade",function(e,t,i){n.resolve(e,t,i)}),n.promise()},e.prototype.favouriteCheck=function(e,t){var i=a.Deferred();return h.default.listenTo(h.default,"favourite:have",function(n,a){n.objectId===e&&n.type===t&&i.resolve(a)}),h.default.trigger("favourite:check",{objectId:e,type:t}),i.promise()},e.prototype.getUser=function(){var e=a.Deferred();return u.default.deferred.done(function(){e.resolve(S.default)}),e.promise()},e.prototype.logout=function(){u.default.logout()},e.prototype.onUserLogin=function(){var e=a.Deferred();return c.default.listenToOnce(c.default,"user:login",function(){e.resolve()}),c.default.listenToOnce(c.default,"isUser",function(){e.resolve()}),e.promise()},e.prototype.onUserLogout=function(){var e=a.Deferred();return c.default.listenToOnce(c.default,"user:logout",function(){e.resolve()}),e.promise()},e.prototype.purchasePersonal=function(e,t,i){f.default.trigger("purchase:personal",e,t,i)},e.prototype.showLoginModal=function(){c.default.trigger("auth:showLoginModal")},e.prototype.showSubscriptionLanding=function(e,t,i,n){void 0===e&&(e=""),void 0===t&&(t=""),void 0===i&&(i=null),void 0===n&&(n=null),p.default.trigger("showSubscriptionLanding",e,t,i,n)},e.prototype.rocketTrack=function(e,t){void 0===t&&(t={}),b.default.track(e,t)},e.prototype.grootTrack=function(e,t,i){if("player"===i){t.has_adblock=!!t.hasAdBlock,delete t.hasAdBlock,t.is_mobile=!!(new s.default).isMobile();var n=new l.default,a=n.getAppVersion();o.default.prototype.isEmbed()&&(t.ref_page=_.default.getPrevRefPage(),y.default.getReferer()&&_.default.rewriteAutoProperties({$url:y.default.getReferer()}),t.app_version&&t.app_version!==a&&_.default.setAppVersion(t.app_version)),_.default.rewriteSuperProperties(t),_.default.track(e,t),_.default.setAppVersion(a),I.default.trigger("player:grootEvent",e)}else _.default.rewriteSuperProperties(t),_.default.track(e,t)},e.prototype.grootSetBlockId=function(e){_.default.setBlockId(e)},e.prototype.grootSetRecContentId=function(e){_.default.setRecContentId(e)},e.prototype.grootSetRecCompilationId=function(e){_.default.setRecCompilationId(e)},e.prototype.setInLocalStorage=function(e,t,i){void 0===i&&(i=!0),k.default.localStorage.setItem(e,i?JSON.stringify(t)+"":t)},e.prototype.grootGetRecContentId=function(){return _.default.getRecContentId()},e.prototype.grootGetRecCompilationId=function(){return _.default.getRecCompilationId()},e.prototype.grootRewriteSuperProperties=function(e){_.default.rewriteSuperProperties(e)},e.prototype.getGutmCookieForPlayer=function(){var e=_.default.loadGutmCookie();return"cpa"===e.g_medium&&e.g_term.length>1?e.g_term:""},e.prototype.addSuperPreroll=function(e,t,i,n,s){var o={id:"flash-video-adv",src:s,allowScriptAccess:"always",allowFullScreen:"true",wmode:"transparent",bgcolor:"#000000",quality:"high",version:[11,0]};P.default.createPlayer(o,{}),a("#video-flack").show()},e.prototype.removeSuperPreroll=function(){a("#flash-video-adv").attr("data",""),a("#video-flack").hide();var e=a("#js-player").get(0);e&&e.handleSuperrollEnd(),a("#superpreroll").remove()},e.prototype.showVpaid=function(e,t){T.default.init(e,t)},e.prototype.hideVpaid=function(){T.default.hide()},e.prototype.getFlashPlayerVersion=function(){return P.default.getFlashPlayerVersion()},e.prototype.setPlayerVolumeBlockHover=function(e){this.playerVolumeBlockHovered=e},e.prototype.isPlayerVolumeBlockHovered=function(){return this.playerVolumeBlockHovered},e.prototype.runHtmlController=function(){(new r.default).execute()},e.prototype.isTrialAvailable=function(){return y.default.getTrialAvailability()},e.prototype.isTryAndBuyAvailable=function(){return this.isTrialAvailable()},e.prototype.setRefPage=function(e){_.default.setRefPage(e)},e.prototype.saveLog=function(){var e=document.getElementById("player-iframe");e?E.default.postMessageToIframe(e,{type:"player",message:"saveLog"},"*"):E.default.postMessage({type:"player",message:"saveLog"},"*")},e.prototype.isAuthenticated=function(){return S.default.isAuthenticated()},e.prototype.isAuthModalVisible=function(){return a("body").hasClass(d.default.prototype.bodyClass)},e}();try{n=window.parent.gambitApi}catch(e){n=window.gambitApi}t.default=n||new M},function(e,t,i){var n=i(0);t.default=new n.Model},function(e,t,i){var n=i(0),a=i(5);t.default=n.View.extend({data:{},initialize:function(){this.data=this.$el.data()||{}},getId:function(){return this.data.collectionId?parseInt(this.data.collectionId,10):0},getHru:function(){return this.data.hru||""},getPoster:function(){return this.data.poster||""},getCategory:function(){return this.data.collectionCategory?this.data.collectionCategory:""},getPosition:function(){return this.data.collectionPosition?parseInt(this.data.collectionPosition,10):0},getTitle:function(){return this.data.collectionTitle?this.data.collectionTitle:""},getLink:function(){return this.data.collectionLink?this.data.collectionLink:""},getPaidTypes:function(){return this.data.collectionPaidType?this.data.collectionPaidType.toString().split(","):[]},getGenres:function(){return this.data.collectionGenre?this.data.collectionGenre.toString().split(","):[]},isPurchasable:function(){return!!this.data.purchasable},getCount:function(){return this.data.count?parseInt(this.data.count,10):0},getContentIds:function(){return a.isString(this.data.contentIds)&&this.data.contentIds?this.data.contentIds.split(",").map(function(e){return parseInt(e,10)}).filter(function(e){return!isNaN(e)}):[]}})},function(e,t,i){var n=i(14);t.default=n.default.extend({uri:"/collectioninfo/v5/",fields:"id,title,images,hru,hru_canonical,description,collection_category_id,abstract,count,branding.px_audit,branding.brand_web_js,branding.brand_web_css,branding.link,poster",getPreviewPath:function(){for(var e in this.get("images"))if("PreviewImage"===this.get("images")[e].type)return this.get("images")[e].path.replace("http:","");return""}})},function(e,t,i){var n=i(40),a=i(66);t.default=n.default.extend({NEW_SERIE_DAYS_PERIOD:7,firstSerieFilterRegexp:/^(.* )?((?:Серия|серия) (?:\d+))( .*)?$/,secondSerieFilterRegexp:/^(.* )?((?:\d+) (?:Серия|серия))( .*)?$/,SEASON_CATEGORY:"season",getSerieName:function(){return this.get("title").replace(this.firstSerieFilterRegexp,"$1$3").replace(this.secondSerieFilterRegexp,"$1$3").trim()},getCompilationId:function(){return this.get("compilation")},getPosterSpecificCaption:function(e,t,i,n){if(void 0===i&&(i=""),void 0===n&&(n=!1),t&&e)return"Продолжить просмотр";var a="Смотреть";if(!e&&this.isSvod())a+=" по подписке";else if(!this.isFree()||n&&this.isUsedToBePaid()){if(this.isEst()&&!e)return"Купить"}else a+=" бесплатно";return a},getSeason:function(){return this.get("season")},getIviReleaseInfo:function(){return this.get("ivi_release_info")||{}},getDateIntervalMin:function(){var e=this.getIviReleaseInfo();return e.date_interval_min?new Date(e.date_interval_min):null},getDateIntervalMax:function(){var e=this.getIviReleaseInfo();return e.date_interval_max?new Date(e.date_interval_max):null},hasFutureReleaseDate:function(){var e=new Date;e.setDate(e.getDate()-1);var t=this.getDateIntervalMin(),i=this.getDateIntervalMax();if(i){var n=e.getDate()===i.getDate()&&e.getMonth()===i.getMonth()&&e.getFullYear()===i.getFullYear();return e<i||n}if(t){var n=e.getDate()===t.getDate()&&e.getMonth()===t.getMonth()&&e.getFullYear()===t.getFullYear();return e<t||n}return!1},getDateOutCaption:function(){var e=new Date,t=this.getDateIntervalMin(),i=this.getDateIntervalMax();if(i){return 6===i.getDate()-t.getDate()&&e>=t&&e<=i?"На этой неделе":(t.setDate(t.getDate()+3),"В "+a.default.getPreCaseMonth(t.getMonth()))}if(t){var n=new Date;n.setDate(n.getDate()-1);var s=t.getDate()===e.getDate()&&t.getMonth()===e.getMonth()&&t.getFullYear()===e.getFullYear(),o=t.getDate()===n.getDate()&&t.getMonth()===n.getMonth()&&t.getFullYear()===n.getFullYear();if(s||o)return"Сегодня";var r=new Date;r.setDate(r.getDate()+1);return t.getDate()===r.getDate()&&t.getMonth()===r.getMonth()&&t.getFullYear()===r.getFullYear()?"Завтра":[t.getDate(),a.default.getGenCaseMonth(t.getMonth())]}},isNewSerie:function(){var e=this.get("ivi_pseudo_release_date");if(e){var t=new Date;return t.setDate(t.getDate()-this.NEW_SERIE_DAYS_PERIOD),t<=new Date(e)}return!1}})},function(e,t,i){var n=i(14),a=i(5),s=i(35),o=n.default.extend({uri:"/billing/v1/certificate/activate",checkUri:"/billing/v1/certificate/check",status:"new",message:"",cardBindErrorCode:1221,baseErrors:{empty:{code:1,message:"Вы не ввели сертификат"},symbols:{code:2,message:"Сертификат может содержать только буквы латинского алфавита и цифры."},server:{code:3,message:"Извините, произошел сбой. Пожалуйста, введите сертификат еще раз."}},validate:function(e){return this.set("status","new"),this.set("message",""),e?/[А-ЯЁ]/gi.test(e)&&(this.set("status","error"),this.set(this.baseErrors.symbols)):(this.set("status","error"),this.set(this.baseErrors.empty)),this.get("status")},activate:function(e){return this.mapiPost({data:{key:e}})},check:function(e){return this.mapiGet({uri:this.checkUri,data:{key:e}})},isSubscriptionBuy:function(){return"subscription"===this.get("object_type")&&null===this.get("discount_program")},isPersonalBalance:function(){return null===this.get("object_type")&&null===this.get("discount_program")},isContent:function(){return"content"===this.get("object_type")&&null===this.get("discount_program")},isDiscount:function(){return null!==this.get("discount_program")},isDiscountSubscription:function(){var e=this.get("discount_program");return!(!e||!e.additional_info)&&"subscription"===e.additional_info.object_type},isSubscription:function(){return"subscription"===this.get("object_type")},isCollection:function(){return"collection"===this.get("object_type")},parse:function(e){var t={};if(e.error)e.error.code===this.cardBindErrorCode?t.status="cardBind":t.status="error",t.code=e.error.code,t.message=e.error.message;else{if("subscription"===e.result.object_type){var i=new Date;i.setDate(i.getDate()+parseInt(e.result.duration_days)),e.result.subscriptionExpirationDate=i}t.status="success",a.extend(t,e.result)}return t},getCertificateKeyFromStorage:function(){return s.get("certificate_key")},setCertificateKeyInStorage:function(e){s.set("certificate_key",e,{expires:864e5,domain:document.domain.replace(/^(.*?)(\w+\.\w+)$/,".$2")})},removeCertificateKeyFromStorage:function(){s.expire("certificate_key")},getMessage:function(){return this.get("message")},getDurationDays:function(){return this.get("duration_days")},getControl:function(e){return this.get("controls")[e]},getObjectType:function(){return this.get("object_type")},getObjectId:function(){return this.get("object_id")},getDiscountProgram:function(){return this.get("discount_program")}});t.default=o},function(e,t,i){var n=i(1),a=i(0),s=i(6),o=i(163),r=i(93),l=i(78),d=i(23),u=i(5),c=i(488),p=i(11),f=i(3),h=i(164),g=i(489),m=i(257),v=i(258);t.default=r.default.extend({name:"card",currentTpl:h.default,options:null,trialData:null,events:{"click #js-change-card":"changeFreeCardClick","click #change-sms":"changeSmsClick","click #js-buy":"buyClick"},savedCards:null,cardsToTake:5,videoInfo:null,cardSelectShows:!1,selectedOptions:null,purchaseData:{},applePayButton:null,timer:null,initialize:function(e){this.videoInfo=new d.default,r.default.prototype.initialize.call(this,e),this.listenTo(p.default,"purchase:card:status",this.checkStatus),this.listenTo(p.default,"billing:payment:addNewCard",this.changeFreeCardClick),this.listenTo(p.default,"billing:payment:changeCard",this.cardChange),this.postMessageHandlerBinded=this.postMessageHandler.bind(this),this.addPostMessageListener()},getTpl:function(){return this.currentTpl},render:function(){if(null!==this.currentTpl&&this.isActive){var e=this.extendTemplateParams(this.options.toJSON());(this.currentTpl!==h.default||e.redirect_url)&&r.default.prototype.render.call(this,e)}},reset:function(){this.savedCards=this.getSavedCards(),this.selectedOptions?this.options=this.selectedOptions:this.options=this.getFreeCard(),this.savedCards.length&&!this.cardSelectShows?(this.cardSelectShows=!0,window.ivi.adaptive.isMobile&&this.options.set("noFocus",!0),f.default.track("open_cardchoice",this.options.get&&this.options.get("groot")),this.showCardSelectModal()):this.showFreeCard(),this.timer&&(clearTimeout(this.timer),this.timer=null)},getSavedCards:function(){return new a.Collection(this.getPaymentOption().filter(function(e){return"cards"===e.get("ps_key")&&e.get("payment_system_account")},this).slice(0,this.cardsToTake))},getFreeCard:function(){return this.getPaymentOption().findWhere({ps_key:"cards",payment_system_account:null})},showFreeCard:function(){this.currentTpl=h.default,p.default.trigger("purchase:card",this.options)},showError:function(){var e={reason:this.name};this.options.get&&u.extend(e,this.options.get("groot")),f.default.track("payment_error",e),p.default.trigger("purchase:finished_error"),this.isActive&&(new l.default).render()},showLanding:function(){this.currentTpl!==g.default&&(this.currentTpl=g.default,this.render(),this.$el.removeClass().addClass("pay-success"))},changeFreeCardClick:function(){this.selectedOptions=null,this.options=this.getFreeCard(),this.options.set("noFocus",!1),f.default.track("cardchoice_addnew",this.options.get&&this.options.get("groot")),this.currentTpl=h.default,this.render(),p.default.trigger("purchase:card",this.options)},checkStatus:function(e,t){this.purchaseData.purchase=e,this.purchaseData.purchaseOption=t,"error"===e?this.showError():"new"===e.get("status")?(this.options=e,this.options.set("purchaseOption",t.toJSON()),this.currentTpl=h.default,this.render(),this.$el.addClass("loading"),n("#js-buy-iframe").load(function(){n(".js-loader").removeClass("loader-block")})):"ok"===e.get("status")?p.default.trigger("purchase:success",e,t):this.showError()},postMessageHandler:function(e){var t=null;try{t=JSON.parse(e.originalEvent.data)}catch(e){}if("purchase:card:success"===e.originalEvent.data){var i=function(){var e=this,t=new o.default;t.mapiGet({data:{id:this.purchaseData.purchase.get("credit_id")}}).done(function(i){i.result&&"fail"!==i.result.status?"ok"===i.result.status?(clearTimeout(e.timer),p.default.trigger("purchase:success",e.purchaseData.purchase,e.purchaseData.purchaseOption,t.hasApprovedBonus())):"new"===i.result.status&&e.showLanding():(e.showError(),clearTimeout(e.timer),e.timer=null)})};this.timer=setInterval(i.bind(this),1e4),i.call(this)}else if("purchase:card:fail"===e.originalEvent.data)this.showError();else if("groot:payment_sb_error"===e.originalEvent.data){var a=this.purchaseData.purchaseOption.get("groot");a.payment_method="spasibo";var r=s.default.prototype.queryParams;r.from&&(a.from=r.from),u.extend(a,this.options.get&&this.options.get("groot")),f.default.track("payment_sb_error",a)}else if("groot:payment_initiate_click"===e.originalEvent.data){var a=this.purchaseData.purchaseOption.get("groot");a.credit_id=this.purchaseData.purchase.get("credit_id"),a.purchase_id=this.purchaseData.purchase.get("purchase_id"),a.source="b";var r=s.default.prototype.queryParams;r.from&&(a.from=r.from),u.extend(a,this.options.get&&this.options.get("groot")),f.default.track("payment_initiated",a),p.default.trigger("purchase:initiated"),n("#sms").prop("disabled","disabled"),"card"===this.name?n("#spasibo").prop("disabled","disabled"):"spasibo"===this.name&&n("#card").prop("disabled","disabled"),n(".js-pay-header").replaceWith(m.default({isCardAvailable:"card"===this.name,isSmsAvailable:!1,isSpasiboAvailable:"spasibo"===this.name&&this.isSpasiboAvailable,isLongSubscription:this.isLongSubscription,subscriptionSpasiboPaymentCapability:this.mapiInfo.isSubscriptionSpasiboPaymentCapability()}))}else if(!t||"payment_sb_init_bonus"!==t.event&&"payment_sb_init_money"!==t.event)if("iframe:ready"===e.originalEvent.data){var l=document.getElementById("js-buy-iframe");if(l){var d=this.getPayButtonTitle(),h=this.getPaymentIframePostMessageObject("changePayButtonTitle",{payButtonTitle:d});l.contentWindow.postMessage(JSON.stringify(h),"*")}n(".js-loader").removeClass("loader-block"),n(".pay-menu").removeAttr("disabled"),n(".js-pay-header").replaceWith(m.default({isCardAvailable:!0,isSmsAvailable:this.paymentOption.isSmsAvailable(),isSpasiboAvailable:this.isSpasiboAvailable,isLongSubscription:this.isLongSubscription,subscriptionSpasiboPaymentCapability:this.mapiInfo.isSubscriptionSpasiboPaymentCapability()}))}else if("card:change"===e.originalEvent.data)f.default.track("open_cardchoice",this.options.get&&this.options.get("groot")),this.showCardSelectModal();else if("purchase:card:repeat_purchase"===e.originalEvent.data)p.default.trigger("billing:payment:errorModalOpen",c.default()),p.default.trigger("billing:purchase:get:options");else try{var g=JSON.parse(e.originalEvent.data);if("card:error"===g.message){var v={reason:g.data.text};u.extend(v,this.options.get&&this.options.get("purchaseOption").groot),f.default.track("payment_error",v),p.default.trigger("purchase:finished_error"),p.default.trigger("billing:payment:errorModalOpen",g.data.text)}}catch(e){}else{var a=this.purchaseData.purchaseOption.get("groot");a.credit_id=this.purchaseData.purchase.get("credit_id"),a.purchase_id=this.purchaseData.purchase.get("purchase_id"),a.source="b",a.payment_method="spasibo";var r=s.default.prototype.queryParams;r.from&&(a.from=r.from),u.extend(a,this.options.get&&this.options.get("groot")),"payment_sb_init_money"===t.event&&(a.enrolled=t.enrolled,a.not_enough_bonus=t.not_enough_bonus),f.default.track(t.event,a)}},changeSmsClick:function(){p.default.trigger("payment:option:select","sms")},buyClick:function(){this.$el.removeClass().html("").addClass("loading");var e={},t=s.default.prototype.queryParams;t.from&&(e.from=t.from),u.extend(e,this.options.get&&this.options.get("groot")),f.default.track("payment_initiated",e),p.default.trigger("purchase:initiated"),p.default.trigger("purchase:card",this.options)},cardChange:function(e){var t=u.first(this.savedCards.filter(function(t){return t.get("payment_system_account").id.toString()===e.toString()},this));f.default.track("cardchoice_old",t.get("groot")),f.default.track("payment_initiated",t.get("groot")),p.default.trigger("purchase:initiated"),void 0!==t?(this.selectedOptions=t,this.options=t,this.currentTpl=h.default,this.render(),p.default.trigger("purchase:card",this.options),n(".js-loader").append(g.default())):this.selectedOptions=null},showCardSelectModal:function(){var e=this,t=f.default.isApplePayAvailable();this.applePayButton instanceof v.default&&t?this.applePayButton.checkApplePayAvailability().then(function(t){p.default.trigger("billing:payment:cardSelectModalOpen",{paymentOption:e.getPaymentOption(),withApplePay:t===e.applePayButton.applePayStatuses.ready})}):p.default.trigger("billing:payment:cardSelectModalOpen",{paymentOption:this.getPaymentOption(),withApplePay:!1})}})},function(e,t){e.exports=Backbone.Validation},function(e,t,i){var n=i(0);t.default=new n.Model({})},function(e,t,i){"use strict";var n=i(13),a=function(e){var t,i={};e instanceof Object&&!Array.isArray(e)||n(!1);for(t in e)e.hasOwnProperty(t)&&(i[t]=t);return i};e.exports=a},function(e,t,i){"use strict";function n(e,t,i,n){return a.call(this,e,t,i,n)}var a=i(98),s=i(293),o=i(179),r={screenX:null,screenY:null,clientX:null,clientY:null,ctrlKey:null,shiftKey:null,altKey:null,metaKey:null,getModifierState:o,button:function(e){var t=e.button;return"which"in e?t:2===t?2:4===t?1:0},buttons:null,relatedTarget:function(e){return e.relatedTarget||(e.fromElement===e.srcElement?e.toElement:e.fromElement)},pageX:function(e){return"pageX"in e?e.pageX:e.clientX+s.currentScrollLeft},pageY:function(e){return"pageY"in e?e.pageY:e.clientY+s.currentScrollTop}};a.augmentClass(n,r),e.exports=n},function(e,t,i){"use strict";var n,a=i(34),s=i(181),o=/^[ \r\n\t\f]/,r=/<(!--|link|noscript|meta|script|style)[ \r\n\t\f\/>]/,l=i(182),d=l(function(e,t){if(e.namespaceURI!==s.svg||"innerHTML"in e)e.innerHTML=t;else{n=n||document.createElement("div"),n.innerHTML="<svg>"+t+"</svg>";for(var i=n.firstChild.childNodes,a=0;a<i.length;a++)e.appendChild(i[a])}});if(a.canUseDOM){var u=document.createElement("div");u.innerHTML=" ",""===u.innerHTML&&(d=function(e,t){if(e.parentNode&&e.parentNode.replaceChild(e,e),o.test(t)||"<"===t[0]&&r.test(t)){e.innerHTML=String.fromCharCode(65279)+t;var i=e.firstChild;1===i.data.length?e.removeChild(i):i.deleteData(0,1)}else e.innerHTML=t}),u=null}e.exports=d},function(e,t,i){"use strict";function n(e){var t=""+e,i=s.exec(t);if(!i)return t;var n,a="",o=0,r=0;for(o=i.index;o<t.length;o++){switch(t.charCodeAt(o)){case 34:n="&quot;";break;case 38:n="&amp;";break;case 39:n="&#x27;";break;case 60:n="&lt;";break;case 62:n="&gt;";break;default:continue}r!==o&&(a+=t.substring(r,o)),r=o+1,a+=n}return r!==o?a+t.substring(r,o):a}function a(e){return"boolean"==typeof e||"number"==typeof e?""+e:n(e)}var s=/["'&<>]/;e.exports=a},function(e,t,i){"use strict";function n(e){return Object.prototype.hasOwnProperty.call(e,m)||(e[m]=h++,p[e[m]]={}),p[e[m]]}var a,s=i(24),o=i(62),r=i(174),l=i(577),d=i(293),u=i(578),c=i(178),p={},f=!1,h=0,g={topAbort:"abort",topAnimationEnd:u("animationend")||"animationend",topAnimationIteration:u("animationiteration")||"animationiteration",topAnimationStart:u("animationstart")||"animationstart",topBlur:"blur",topCanPlay:"canplay",topCanPlayThrough:"canplaythrough",topChange:"change",topClick:"click",topCompositionEnd:"compositionend",topCompositionStart:"compositionstart",topCompositionUpdate:"compositionupdate",topContextMenu:"contextmenu",topCopy:"copy",topCut:"cut",topDoubleClick:"dblclick",topDrag:"drag",topDragEnd:"dragend",topDragEnter:"dragenter",topDragExit:"dragexit",topDragLeave:"dragleave",topDragOver:"dragover",topDragStart:"dragstart",topDrop:"drop",topDurationChange:"durationchange",topEmptied:"emptied",topEncrypted:"encrypted",topEnded:"ended",topError:"error",topFocus:"focus",topInput:"input",topKeyDown:"keydown",topKeyPress:"keypress",topKeyUp:"keyup",topLoadedData:"loadeddata",topLoadedMetadata:"loadedmetadata",topLoadStart:"loadstart",topMouseDown:"mousedown",topMouseMove:"mousemove",topMouseOut:"mouseout",topMouseOver:"mouseover",topMouseUp:"mouseup",topPaste:"paste",topPause:"pause",topPlay:"play",topPlaying:"playing",topProgress:"progress",topRateChange:"ratechange",topScroll:"scroll",topSeeked:"seeked",topSeeking:"seeking",topSelectionChange:"selectionchange",topStalled:"stalled",topSuspend:"suspend",topTextInput:"textInput",topTimeUpdate:"timeupdate",topTouchCancel:"touchcancel",topTouchEnd:"touchend",topTouchMove:"touchmove",topTouchStart:"touchstart",topTransitionEnd:u("transitionend")||"transitionend",topVolumeChange:"volumechange",topWaiting:"waiting",topWheel:"wheel"},m="_reactListenersID"+String(Math.random()).slice(2),v=s({},l,{ReactEventListener:null,injection:{injectReactEventListener:function(e){e.setHandleTopLevel(v.handleTopLevel),v.ReactEventListener=e}},setEnabled:function(e){v.ReactEventListener&&v.ReactEventListener.setEnabled(e)},isEnabled:function(){return!(!v.ReactEventListener||!v.ReactEventListener.isEnabled())},listenTo:function(e,t){for(var i=t,a=n(i),s=r.registrationNameDependencies[e],l=o.topLevelTypes,d=0;d<s.length;d++){var u=s[d];a.hasOwnProperty(u)&&a[u]||(u===l.topWheel?c("wheel")?v.ReactEventListener.trapBubbledEvent(l.topWheel,"wheel",i):c("mousewheel")?v.ReactEventListener.trapBubbledEvent(l.topWheel,"mousewheel",i):v.ReactEventListener.trapBubbledEvent(l.topWheel,"DOMMouseScroll",i):u===l.topScroll?c("scroll",!0)?v.ReactEventListener.trapCapturedEvent(l.topScroll,"scroll",i):v.ReactEventListener.trapBubbledEvent(l.topScroll,"scroll",v.ReactEventListener.WINDOW_HANDLE):u===l.topFocus||u===l.topBlur?(c("focus",!0)?(v.ReactEventListener.trapCapturedEvent(l.topFocus,"focus",i),v.ReactEventListener.trapCapturedEvent(l.topBlur,"blur",i)):c("focusin")&&(v.ReactEventListener.trapBubbledEvent(l.topFocus,"focusin",i),v.ReactEventListener.trapBubbledEvent(l.topBlur,"focusout",i)),a[l.topBlur]=!0,a[l.topFocus]=!0):g.hasOwnProperty(u)&&v.ReactEventListener.trapBubbledEvent(u,g[u],i),a[u]=!0)}},trapBubbledEvent:function(e,t,i){return v.ReactEventListener.trapBubbledEvent(e,t,i)},trapCapturedEvent:function(e,t,i){return v.ReactEventListener.trapCapturedEvent(e,t,i)},ensureScrollValueMonitoring:function(){if(void 0===a&&(a=document.createEvent&&"pageX"in document.createEvent("MouseEvent")),!a&&!f){var e=d.refreshScrollValues;v.ReactEventListener.monitorScrollValue(e),f=!0}}});e.exports=v},function(e,t,i){"use strict";var n={onClick:!0,onDoubleClick:!0,onMouseDown:!0,onMouseMove:!0,onMouseUp:!0,onClickCapture:!0,onDoubleClickCapture:!0,onMouseDownCapture:!0,onMouseMoveCapture:!0,onMouseUpCapture:!0},a={getHostProps:function(e,t){if(!t.disabled)return t;var i={};for(var a in t)!n[a]&&t.hasOwnProperty(a)&&(i[a]=t[a]);return i}};e.exports=a},function(e,t,i){var n=i(0),a=i(36);t.default=n.Model.extend({initialize:function(e){this.contentEntity=e.contentEntity,this.contentInfo=e.contentInfo,this.setDefaultPurchaseType(),this.setDefaultPurchaseId()},setDefaultPurchaseId:function(){this.set("purchaseId",this.contentEntity.isSerie()?this.contentInfo.getSeasonId(this.contentEntity.getSeason()):this.contentEntity.getId())},setDefaultPurchaseType:function(){(this.contentEntity.isEst()||this.contentEntity.isTvod())&&this.setPurchaseType(this.contentEntity.isSerie()?a.default.prototype.SEASON_OBJECT_TYPE:a.default.prototype.CONTENT_OBJECT_TYPE),this.contentEntity.isSvod()&&this.setPurchaseType(a.default.prototype.SUBSCRIPTION_OBJECT_TYPE)},setPurchaseType:function(e){e?this.set("purchaseType",e):this.setDefaultPurchaseType()},setPurchaseId:function(e){e?this.set("purchaseId",e):this.setDefaultPurchaseId()},getPurchaseType:function(){return this.get("purchaseType")||""},isSubscription:function(){return this.getPurchaseType()===a.default.prototype.SUBSCRIPTION_OBJECT_TYPE},getPurchaseId:function(){return this.get("purchaseId")},setPurchaseSourceForGroot:function(e){this.set("source",e)},getPurchaseSourceForGroot:function(){return this.get("source")},setSpecificParams:function(e){this.set("specificParams",e)},getSpecificParams:function(){return this.get("specificParams")}})},function(e,t,i){var n=i(1),a=i(16),s=i(6),o=i(19),r=i(193),l=i(10),d=i(680),u=i(55);t.default=a.default.extend({modalId:"js-trailer-player",template:d.default,openEvent:"trailers:player:open",regionEnabled:!0,mobileModal:!0,onShow:function(){this.player||(this.player=new r.default);var e={config:l.default.player.trailer,queryParams:s.default.prototype.queryParams,contentType:"trailer",isPaid:!1,width:"978px",height:"550px",appVersion:(new o.default).getAppVersion(),autoStart:!0,id:this.eventParams.trailerId,preorder:this.eventParams.preorder||!1};this.player.render(e)},beforeCancel:function(){a.default.prototype.beforeCancel.call(this),u.default.trigger("trailers:player:closed"),n("#js-player").empty()},beforeSubmit:function(){return!1}})},function(e,t){t.default={like:"like",dislike:"dislike",getLikesBalance:function(){return this.get("like_count")-this.get("dislike_count")},canUserRate:function(){return!!this.get("can_rate")},isLiked:function(){return this.get("like_state")===this.like},isDisliked:function(){return this.get("like_state")===this.dislike}}},function(e,t,i){var n=i(1),a=i(328),s=i(101),o=i(102),r=i(194),l=i(693),d=i(5),u=i(7),c=i(88),p=i(694),f=i(3),h=i(8);t.default=a.default.extend(r.default).extend({el:"#comment-list",defaultItemsCount:20,events:{"click .js-comment-reply":"reply","click .js-comment-show-answers":"showAnswers"},initialize:function(e){a.default.prototype.initialize.call(this,e),d.extend(this,d.pick(e,"itemId","contentType")),this.initLikes(),this.totalCount=this.$el.data("count"),this.elementsPerPage=this.itemsPerPage,this.elementsPerLine=1,this.startPage=d.isUndefined(e.page)?0:e.page-1,this.loadDataParams.data={id:e.itemId},d.isUndefined(e.season)||d.isNull(e.season)||(this.loadDataParams.data.season=e.season),e.canReply&&(this.canReply=e.canReply),e.hasAnswers&&(this.hasAnswers=e.hasAnswers),e.initWaypoint&&this.initLoadMore(),this.listenTo(u.default,"loadUser",this.expandForm)},expandForm:function(){!this.$el.find("li").length&&h.default.isAuthenticated()&&c.default.trigger("comment:expand")},reply:function(e){var t=n(e.target),i=t.closest(".js-comment-item");if(this.$el.find(".reply").removeClass("hide"),t.parent().addClass("hide"),this.$formView){i.after(this.$formView.$el);var a=i.data("parent-id");this.$formView.setParentId(a||i.data("id")),this.$formView.collapse()}else i.after(p.default({reply:!0,placeholder:"Добавить комментарий"})),this.$formView=new o.default({el:i.siblings(".js-comment-form"),itemId:this.itemId,contentType:this.contentType,parentId:i.data("id")});return f.default.track("reviews_comment_reply"),!1},showAnswers:function(e){var t=n(e.target).closest(".js-comment-show-answers"),i=t.closest(".js-comment-item"),a=i.siblings(".js-reply-list");return a.hasClass("loaded")?(c.default.trigger("comment:replies:toggle",i.data("id")),t.toggleClass("unfold")):(new l.default({el:a,collection:new s.default({contentType:this.contentType}),itemId:this.itemId,parentId:i.data("id")}).reload(),a.addClass("loaded"),t.removeClass("unfold")),!1},incrementFromTo:function(){this.loadDataParams.data.from===this.startPage*this.elementsPerPage?(this.loadDataParams.data.from=this.startPage*this.defaultItemsCount+this.defaultItemsCount,this.loadDataParams.data.to=this.loadDataParams.data.from+this.elementsPerPage):a.default.prototype.incrementFromTo.call(this)},reload:function(){a.default.prototype.reload.apply(this,arguments),this.$formView&&(this.$formView.remove(),delete this.$formView)}})},function(e,t,i){var n=i(0);t.default=new n.Model({})},function(e,t,i){var n=i(101),a=i(127),s=i(6),o=i(102),r=i(23);t.default=s.default.extend({commentCount:10,run:function(e){var t=e.hru&&!e.id?"compilation":"video",i=e.season||null,s=new r.default;new o.default({itemId:s.getId(),contentType:t,season:i}),new a.default({collection:new n.default({contentType:t}),season:i,itemsCount:this.commentCount,itemId:s.getId(),initWaypoint:!1})}})},function(e,t,i){var n=i(6),a=i(333);t.default=n.default.extend({run:function(){new a.default}})},function(e,t){t.default={transitionClass:"collapsed",isHidden:function(){return this.$el.hasClass(this.transitionClass)},transitionHide:function(e){var t=this;this.$el.addClass(this.transitionClass).one("transitionend",function(){void 0!==e&&e.apply(t)})},transitionShow:function(e){var t=this;this.$el.removeClass(this.transitionClass).one("transitionend",function(){void 0!==e&&e.apply(t)})},transitionReplace:function(e,t,i){var n=this;e.append(i),t.length&&setTimeout(function(){t.addClass(n.transitionClass).one("transitionend",function(){this.remove()}),i.removeClass(n.transitionClass)},100)},transitionRemove:function(e){e.length&&e.addClass(this.transitionClass).one("transitionend",function(){this.remove()})},transitionAdd:function(e,t,i){var n=this;!0===i?e.prepend(t):e.append(t),setTimeout(function(){t.removeClass(n.transitionClass)},100)}}},function(e,t,i){var n=i(103),a=i(29),s=i(738);t.default=a.default.extend(n.default).extend({model:s.default,initialize:function(e,t){"user"===t.contentType?this.uri="/"+t.contentType+"/reviews/v5/":this.uri="/"+t.contentType+"/reviews/v6/"},getRating:function(){return this.reduce(function(e,t){return e+t.getLikesBalance()},0)}})},function(e,t,i){var n=i(1),a=i(6),s=i(3);t.default=a.default.extend({scrollElem:".js-reviews-item",run:function(e,t){var i=n(t),a=i.data("id");s.default.track("review_short_imp",{review_id:a})}})},function(e,t,i){var n=i(740),a=i(6);t.default=a.default.extend({run:function(){new n.default}})},function(e,t,i){var n=i(332);t.default=n.default.extend({run:function(e){this.createGrade("video",e.id),this.renderBlock()}})},function(e,t,i){var n=i(6),a=i(7),s=i(3),o=i(4),r=i(359);t.default=n.default.extend({tokenKey:"access_token",authErrorEvent:"",grootAuthSuccess:"",grootAuthError:"",run:function(){var e=o.default.getLocation().hash.substr(1),t=e.substr(e.indexOf(this.tokenKey+"=")).split("&")[0].split("=")[1];t?(a.default.once("merge",this.handleAuthSuccess.bind(this)),a.default.once(this.authErrorEvent,this.handleAuthError.bind(this)),this.authLogin(t)):this.closeWindow()},handleAuthSuccess:function(){s.default.track(this.grootAuthSuccess),this.closeWindow()},handleAuthError:function(){s.default.track(this.grootAuthError),this.closeWindow()},closeWindow:function(){(window.ivi.adaptive.isMobile||o.default.isIE11())&&this.queryParams.initialUri?"sber"===this.queryParams.initialUri?o.default.redirect(r.default.prototype.BIND_CARD_URL):"mcdonalds"===this.queryParams.initialUri?o.default.redirect("https://mcdonalds.ivi.ru"):o.default.redirect(decodeURIComponent(this.queryParams.initialUri)):(o.default.postMessageToOpener("window:reload","*"),setTimeout(function(){o.default.open("","_self").close()},100))}})},function(e,t,i){var n=i(0);t.default=new n.Model({})},function(e,t,i){var n=i(1),a=i(0),s=i(10),o=i(4),r=i(8),l=i(60),d=i(36),u=i(28),c=i(19),p=i(7),f=i(209),h=i(18),g=i(11);t.default=a.View.extend({el:".page-wrapper",$scrollEl:null,SCROLL_EL_OFFSET:400,redirectUrl:null,productIdentifier:null,from:null,purchaseOption:null,objectId:null,objectType:null,events:{"click .js-login-btn":"showAuthModal","click .js-buy":"buyClick"},initialize:function(e){this.redirectUrl=e.redirectUrl||(s.default.isWorld?"/":"/plus"),this.from=e.from||"subscription_megalanding",this.objectId=parseInt(e.objectId,10),this.objectType=e.objectType||d.default.prototype.SUBSCRIPTION_OBJECT_TYPE,this.subscriptionPurchaseOptions=new l.default,this.reloadPageAfterLoginLogout()},reloadPageAfterLoginLogout:function(){var e=this;this.listenTo(p.default,"auth:showLoginModal",function(){e.listenTo(p.default,"loadUser",e.reloadPage)}),this.listenTo(p.default,"auth:modal:closed",function(){e.stopListening(p.default,"loadUser",e.reloadPage)}),this.listenTo(p.default,"user:logout",this.reloadPage)},showAuthModal:function(){if(p.default.trigger("auth:showLoginModal"),!window.ivi.adaptive.isMobile)return!1},render:function(){var e=this,t=new c.default,i=new f.default;i.setTimerAvailabilityPeriod(t.getTrialAvailabilityPeriod()),i.render();var a=new l.default;a.fetchOptions().done(function(){var t=a.getPurchaseOptionList(),i=t.findWhere({object_type:"subscription",trial:!0});i&&r.default.isTrialAvailable()?e.purchaseOption=i:e.purchaseOption=t.getStandardSubscription()}),this.$scrollEl=this.$el.find(".js-scroll-arrow"),this.$scrollEl.length>0&&(n(window).scroll(this.scroll.bind(this)),this.$scrollEl.hasClass("arrow-to-scroll_clickable")&&this.$scrollEl.click(function(){n("html, body").animate({scrollTop:e.SCROLL_EL_OFFSET+1},"slow")}))},scroll:function(){this.$scrollEl.toggleClass("arrow-to-scroll_hidden",o.default.getPageYOffset()>this.SCROLL_EL_OFFSET)},buyClick:function(e){var t=e.currentTarget;u.default.urlHasParam(t.href,"redirect_url")||(t.href=u.default.addParamsToUrl(t.href,{from:this.from,redirect_url:this.redirectUrl})),h.default.showAuthBeforePurchase()&&!r.default.isAuthenticated()&&(this.redirectUrl=t.href,this.productIdentifier=n(t).data("product-identifier"),this.showAuthPopup(e))},showAuthPopup:function(e){e.preventDefault(),p.default.trigger("auth:showLoginModal:beforePurchase"),this.addAfterLoginEventsListeners()},addAfterLoginEventsListeners:function(){var e=this;this.listenTo(p.default,"loadUser",this.processPurchaseAfterLogin),this.listenTo(p.default,"auth:modal:closed",function(){e.stopListening(p.default,"loadUser",e.processPurchaseAfterLogin)})},reloadPage:function(){o.default.getLocation().reload()},processPurchaseAfterLogin:function(){var e={redirectUrl:this.redirectUrl,productIdentifier:this.productIdentifier,callbackForPurchasedState:this.reloadPage,subscriptionPurchaseOptions:this.subscriptionPurchaseOptions};g.default.trigger("buy:processSubscriptionPurchaseAfterLogin",e)}})},function(e,t,i){var n=i(14);t.default=n.default.extend({uri:"/billing/v1/purchase",parse:function(e){return e.error?e:e.result}})},function(e,t,i){var n=i(5),a=function(){};n.extend(a.prototype,{RUSSIAN_PHONE_NUMBER_FORMATTER_REGEXP:/^(?:(\+?[7]{1})|([8]{1}))(\d{3})(\d{3})(\d{2})(\d{2})$/,PHONE_NUMBER_IMPOSSIBLE_CHARACTERS:/[^0-9+]/g,getFormattedRussianPhone:function(e){return e?(e=e.replace(this.PHONE_NUMBER_IMPOSSIBLE_CHARACTERS,""),this.RUSSIAN_PHONE_NUMBER_FORMATTER_REGEXP.test(e)?e.replace(this.RUSSIAN_PHONE_NUMBER_FORMATTER_REGEXP,"+7 $3 $4-$5-$6"):e):e}}),t.default=a},function(e,t,i){var n=i(0);t.default=n.Model.extend({SBERBANK_KEY:"sberbank",getId:function(){return this.get("id")},getTitle:function(){return this.get("title")?this.get("title").replace(/^(\d{4})(\d{2})x+(\d{4})$/,"$1 $2** **** $3"):""},isCardExpiring:function(){return this.get("expiring")},isCardExpired:function(){var e=this.getCardExpiresDate();return null!==e&&e<Date.now()},getCardExpiresDate:function(){return this.get("expires")?new Date(this.get("expires")):null},getCardBankKey:function(){return this.get("bank_key")},getPsType:function(){return this.get("ps_type")},isSberbankCard:function(){return this.getCardBankKey()===this.SBERBANK_KEY}})},function(e,t,i){var n=i(0),a=i(5),s=i(109),o=i(7),r=i(26),l=i(20),d=n.Model.extend({storageKey:"want_to_watch",wantToWatchModel:{},save:function(e,t){l.default.localStorage.setItem(this.storageKey,JSON.stringify({objectId:e,type:t}))},removeItem:function(){l.default.localStorage.removeItem(this.storageKey)},hasItem:function(){var e=this.getItem();return a.isObject(e)&&"objectId"in e&&"type"in e},getItem:function(){var e={};try{e=JSON.parse(l.default.localStorage.getItem(this.storageKey))}catch(e){}return e},checkWantToWatchAfterLogin:function(e){var t=this;if(this.hasItem()){var i=this.getItem();s.default.favouriteAdd(i.objectId,i.type).done(function(){t.removeItem(),o.default.trigger("auth:removePopup"),r.default.trigger("favourite:showSuccessWantToWatchModal"),t.listenToOnce(r.default,"favourite:wantToWatchModalClosed",function(){e()})})}else e()}});t.default=new d},function(e,t,i){var n=i(1),a=i(6),s=i(371);t.default=a.default.extend({colors:["#ff0047","#21bdf0","lightgreen","orange","gray","lavender","cyan","yellow","violet","mistyrose","#f4d006"],run:function(){var e=n(".countries .item"),t=this.fillCountriesColor(e);this.fillLegend(e,t),new s.default(t)},fillCountriesColor:function(e){for(var t=[],i=0;i<e.length;i++){var n=this.colors[i];n||(n=this.colors[this.colors.length-1]),t.push({percent:e.eq(i).data("percent"),color:n})}return t},fillLegend:function(e,t){for(var i=0;i<t.length;i++)e.eq(i).css({"border-color":t[i].color})}})},function(e,t,i){var n=i(1),a=i(5),s=i(372),o={};o.getFlashPlayerVersion=function(){var e={major:0,full:"",flashSupport:!1};return navigator.plugins["Shockwave Flash"]&&(e.flashSupport=!0,navigator.plugins["Shockwave Flash"].description&&(e.major=parseInt(navigator.plugins["Shockwave Flash"].description.replace("Shockwave Flash",""),10),e.full=navigator.plugins["Shockwave Flash"].description.replace("Shockwave Flash",""))),e},o.createPlayer=function(e,t){var i="";if(a.isObject(t))for(var o in t)i+=(i?"&amp;":"")+o+"="+t[o];e.flashvars=i,n("#"+e.id).html(s.default({params:e}))},t.default=o},function(e,t,i){var n=i(21),a=i(14),s=i(1);t.default=a.default.extend({stateListUri:"/user/notification_state/list/",uri:"/user/notification_state/",initialize:function(e){a.default.prototype.initialize.call(this),this.setAuthParams(e)},setAuthParams:function(e){if(!e){var t=(new a.default).buildParams().data;e={app_version:t.app_version,session:t.session}}this.authParams=e},getStateList:function(){var e=this;return this.mapiGet({uri:this.stateListUri,data:this.authParams}).then(function(t){return e.parseResult(t.result)},function(){return s.Deferred().resolve([]).promise()})},parseResult:function(e){void 0===e&&(e=[]);var t;return e.forEach(function(e){t=!1,e.children=e.children.filter(function(e){return null!==e.state&&(e.state&&(t=!0),!0)}),e.enabled=t}),e.filter(function(e){return!!e.children.length})},setState:function(e,t,i){var a=n.__assign({},this.authParams,{message_category_id:e,delivery_category_id:t});this.resetAdditionUriParam();for(var s in a){var o=a[s];Array.isArray(o)||(o=[o]);for(var r in o)this.addParamsToUri(encodeURIComponent(s)+"="+encodeURIComponent(o[r]))}return this.mapiPost({data:{state:i?1:0}})}})},function(e,t,i){var n=i(1),a=i(0),s=i(4);t.default=a.View.extend({el:".js-ivi-textfield",events:{},additionalEvents:{"focus .js-ivi-textfield__input":"onInputFocus","blur .js-ivi-textfield__input":"onInputBlur","keyup .js-ivi-textfield__input":"onInputKeyup"},initialize:function(e){n(window).on("resize",this.onResize.bind(this)).trigger("resize"),e&&e.handleOnlyResize||(this.events=this.additionalEvents)},onResize:function(){var e=this;this.$el.find(".js-ivi-textfield__input").each(function(t,i){e.setPositionTooltip(i)})},onInputFocus:function(e){var t=n(e.target),i=t.parent(".js-ivi-textfield");i.addClass("state_focused"),i.hasClass("state_error")&&(t.val(""),i.removeClass("state_filled"))},onInputBlur:function(e){var t=n(e.target),i=t.parent();i.removeClass("state_focused"),i.hasClass("tooltip")&&i.removeClass("tooltip"),t.val().trim()&&i.addClass("state_filled")},onInputKeyup:function(e){var t=n(e.target),i=t.parent();t.val().trim()?i.addClass("state_filled"):i.removeClass("state_filled"),i.hasClass("state_error")&&i.removeClass("state_error"),i.hasClass("tooltip")&&i.removeClass("tooltip")},setPositionTooltip:function(e){var t=n(e),i=t.parent(".js-ivi-textfield"),a=t.outerWidth(),o=i.find(".ivi-textfield__tooltip").outerWidth(!0),r=s.default.getViewPort().width,l=t.offset().left+a,d=l+o;i.toggleClass("tooltip_bottom",d>r),i.hasClass("tooltip_bottom")&&(l=t.offset().left,d=l+o,i.toggleClass("tooltip_left-bottom",d>r))}})},function(e,t,i){var n=i(392),a=i(394),s=i(395),o=i(139),r=i(5),l=i(11),d=i(4),u=i(44),c=i(223);t.default=c.default.extend({fundSuccessQueryParam:"fund_success",initialize:function(){this.listenTo(l.default,"purchase:personal",this.purchasePersonal),new a.default,(new n.default).listen(l.default)},afterLogin:function(){this.queryParams[this.fundSuccessQueryParam]&&((new s.default).listen(l.default),l.default.trigger("billing:fundSuccess"))},purchasePersonal:function(e,t,i){var n=this,a=r.findWhere(e.payment_options,{ps_key:"ivi"});if(a){var s=new o.default;s.mapiPost({data:a.purchase_params}).done(function(){if(l.default.trigger("billing:unlockPriceButton"),"ok"===s.get("status")){if(n.sendToGABuyEvent(e),s.get("purchase_id")){var a=void 0,o=void 0;e.contentInfo?(a=e.contentInfo.objectId,o=e.contentInfo.objectType):(a=e.object_id,o=e.object_type),u.default.trackTransaction({transactionId:s.get("purchase_id"),objectId:a,objectType:o,purchaseType:e.object_type,purchaseOwnershipType:e.ownership_type,price:e.price})}var r="subscription"===e.object_type?"billing:subscriptionPurchaseIviPSMethodSuccess":"billing:contentPurchaseIviPSMethodSuccess";l.default.trigger(r,s),i?setTimeout(function(){d.default.redirect(i)},0):setTimeout(function(){d.default.forceReload(!0)},0)}else setTimeout(function(){d.default.redirect(t)},0)}).fail(function(){l.default.trigger("billing:unlockPriceButton"),setTimeout(function(){d.default.redirect(t)},0)})}else l.default.trigger("billing:unlockPriceButton"),setTimeout(function(){d.default.redirect(t)},0)}})},function(e,t,i){var n=i(107),a=i(226),s=i(112),o=i(29);t.default=o.default.extend(a.default).extend({uri:"/collections/v5/",model:n.default,fields:s.default.prototype.fields})},function(e,t){e.exports=Waypoint},function(e,t,i){var n=i(0);t.default=new n.Model({})},function(e,t,i){var n=i(6),a=i(404),s=i(229),o=i(74),r=i(110);t.default=n.default.extend({run:function(){var e=new o.default;new a.default({model:e}),new s.default({model:e}).listen(r.default)}})},function(e,t,i){var n=i(6),a=i(405),s=i(26),o=i(4);t.default=n.default.extend({initialize:function(){this.listenTo(s.default,"poster:ready",this.posterReady),this.listenTo(s.default,"favourites:added",this.favouritesAdded),this.listenTo(s.default,"favourites:deleted",this.favouritesDeleted)},favouritesAdded:function(e){e.id=e.objectId;var t=document.getElementById("player-iframe");t&&o.default.postMessageToIframe(t,{type:"player",message:"playerFavouriteAdded",params:e},"*")},favouritesDeleted:function(e){e.id=e.objectId;var t=document.getElementById("player-iframe");t&&o.default.postMessageToIframe(t,{type:"player",message:"playerFavouriteDeleted",params:e},"*")},posterReady:function(e){new a.default({el:e.find(".js-favourite-link").get(0)}).render()}})},function(e,t,i){var n=i(6),a=i(109);t.default=n.default.extend({run:function(){window.gambitApi=a.default}})},function(e,t,i){var n=i(1),a=i(35),s=i(81),o=i(37),r=i(409),l=i(33),d=i(410),u=i(411),c=i(412),p=i(413),f=i(19),h=i(414),g=i(415),m=i(155),v=i(23),_=i(5),b=i(10),y=i(105),w=i(3),C=i(214),k=i(43),P=i(20),S=i(50),T=i(8),E=i(416),I=i(32);t.default=l.default.extend({pagesToSendIsTrybuyParam:["content_watch","content_description","content_trailers","content_trailers_single","content_person","content_reviews","content_comments","content_awards","content_season","buy_page"],mapiView:null,initialize:function(){new h.default,n("body").hasClass("profile")?new g.default:new u.default,new p.default,new m.default,new c.default,new d.default,new r.default,this.listenTo(y.default,"groot:rewriteSuperProperties",this.rewriteSuperProperties)},afterLogin:function(){var e={},t=new v.default;this.mapiView=new f.default;var i={method:"post",host:String(b.default.groot.host).replace(/\/$/,"")};w.default.init(b.default.mapi.params.subsite,void 0,i,n,P.default.localStorage),w.default.setUserPesonalizable(k.default.isUserPesonalizable()),k.default.getGenreId()&&w.default.setGenreId(k.default.getGenreId()),k.default.getCategoryId()&&w.default.setCategoryId(k.default.getCategoryId()),w.default.identify(T.default.getId()),w.default.setBrowserAndOsData(),this.registerSuperProperties(t),t.getRightTypeList().map(function(t){e["m_"+t.toLowerCase()]=1}),this.mapiView.getAppVersion()&&w.default.setAppVersion(this.mapiView.getAppVersion()),y.default.trigger("groot:initialized"),k.default.getPersonId()&&(e.person_id=k.default.getPersonId()),w.default.getRecContentId()&&(e.rec_content_id=w.default.getRecContentId()),w.default.getRecCompilationId()&&(e.rec_compilation_id=w.default.getRecCompilationId()),t.isFake()&&(e.fake=1),t.isPreorderable()&&(e.preorderable=1,e.m_est=1),"buy_page"!==w.default.getRefPageFromGrootView()||t.checkIfExists()||(e.m_svod=1),this.pagesToSendIsTrybuyParam.indexOf(w.default.getRefPageFromGrootView())>-1&&w.default.isTrialAvailable()&&1===e.m_svod&&(e.is_trybuy=1),"content_description"===w.default.getRefPageFromGrootView()?"bundle"===P.default.localStorage.getItem("groot_from")&&(e.from="bundle"):P.default.localStorage.removeItem("groot_from"),P.default.sessionStorage.removeItem("collections-view"),l.default.prototype.isEmbed()||l.default.prototype.isProfile()||(s.default.detectedDeferred.done(function(){e.has_adblock=s.default.detected,w.default.track("page_view",e)}),w.default.setPrevRefPage(w.default.getRefPage()),w.default.setRefPage()),this.setupRocketParams()},setupRocketParams:function(){var e=k.default.getUserProperties();e.is_personalizable||(e.is_personalizable=T.default.isUserPersonalizable()?1:0);var t=new I.default,i={app_uuid:a.get("distinct_id"),app_version:this.mapiView.getAppVersion(),subsite_id:this.mapiView.getSubsiteId(),code_version:E.default,referer:document.referrer||"",ab_tests:[],user:{ivi_id:T.default.getId(),is_authorized:T.default.isAuthenticated(),is_personalizable:e.is_personalizable,is_buyer:!1,is_outflow:!1,svod_active:!1,has_card:!1},device:{model:t.getDeviceName(),os:t.getOsName(),os_version:t.getOsVersion(),interaction:window.ivi.adaptive.isMobile?"touch":"mouse",screen:window.screen.width+"x"+window.screen.height,browser:t.getBrowserName(),browser_version:t.getBrowserVersion()}},n=k.default.getUserABTests();n&&n.length&&_.each(n,function(e){i.ab_tests.push(e)}),C.default.setBaseUrl(b.default.rocket.host),C.default.setDefaultParams(i)},registerSuperProperties:function(e){var t=new o.default,i={};t.isCompilation()?i.compilation_id=t.getId():(e.getCompilationId()&&(i.compilation_id=e.getCompilationId()),i.content_id=e.getId()),i.compilation_id||i.content_id||(w.default.getCompilationId()&&(i.compilation_id=parseInt(w.default.getCompilationId(),10)),w.default.getContentId()&&(i.content_id=parseInt(w.default.getContentId(),10))),w.default.setContentId(i.content_id),w.default.setCompilationId(i.compilation_id),i.authorizeduser=T.default.isAuthenticated()?1:0,i.referrer_full=S.default.getReferrer(),i.svod_active=T.default.hasSubscription()?1:0,w.default.getSource()&&(i.source=w.default.getSource()),w.default.getBlockId()&&(i.block_id=w.default.getBlockId()),w.default.getPromoId()&&(i.promo_id=w.default.getPromoId()),w.default.getCollectionId()&&(i.collection_id=w.default.getCollectionId()),w.default.getRefPage()&&(i.ref_page=w.default.getRefPage()),k.default.getUserActiveDaysQuantity()&&(i.act_days_qnt=k.default.getUserActiveDaysQuantity()),k.default.getCountryCode()&&(i.country_code=k.default.getCountryCode()),k.default.getIp()&&(i.ip=k.default.getIp()),void 0!==k.default.isRenewActive()&&(i.renew_active=k.default.isRenewActive()),void 0!==k.default.isDobillActive()&&(i.dobill_active=k.default.isDobillActive()),void 0!==k.default.isSvodByCard()&&(i.svod_by_card=k.default.isSvodByCard()),i.page=w.default.getRefPageFromGrootView();var n=k.default.getUserProperties();_.each(n,function(e,t){_.isBoolean(e)&&(n[t]=e?1:0)}),n.is_personalizable||(n.is_personalizable=T.default.isUserPersonalizable()?1:0),"subscription_megalanding"===i.page&&(n.is_trial_available=w.default.isTrialAvailable()?1:0),_.extend(i,n),i.gambit_version=E.default,w.default.register_super_properties(i)},rewriteSuperProperties:function(e){void 0!==e&&w.default.register_super_properties(e)}})},function(e,t,i){var n=i(1),a=i(0),s=i(23),o=i(3);t.default=a.View.extend({el:".trailers-small",events:{"click a":"watchClick"},watchClick:function(){var e={source:"s"},t=new s.default;n.extend(e,t.getRightTypeForGroot()),o.default.track("watchtrailer_click",e)}})},function(e,t){var i=function(){function e(){this.image=null,this.image=new Image}return e.prototype.setSrc=function(e){this.image.src=e},e}();t.default=i},function(e,t,i){var n=i(422),a=i(423),s=i(6),o=i(425);t.default=s.default.extend({run:function(e){window.ivi.adaptive.isMobile&&(new n.default,new a.default({gutm:{g_term:"new_banner"},isSpecialRoute:e}),new o.default)}})},function(e,t,i){function n(e){var t=[];for(var i in e)t.push(i+"="+encodeURIComponent(e[i]));return t.join("&")}var a=i(5),s=i(424),o=i(3),r=i(23),l={},d="https://www.ivi.ru/",u="key_live_abiOjFfs4vItnFalKrKa2nedrCng5bRY";l.initSDK=function(){s.init(u)},l.sendSMS=function(e,t){s.sendSMS(e,{},{},t)},l.generateLinkParams=function(e,t,i){var s={g_source:"(direct)",g_medium:"(direct)",g_campaign:"(direct)",g_term:"(direct)"};i=a.isUndefined(i)?s:a.extend(s,i);var o={type:0,channel:"smart_banner",campaign:i.g_campaign,has_app:"yes",g_source:i.g_source,g_medium:i.g_medium,g_campaign:i.g_campaign,g_term:i.g_term,$always_deeplink:!0};if("content"===e)o.$desktop_url=d+"watch/"+(1===t.kind?t.id+"/description":t.hru)+"?"+n(i),o.$deeplink_path=(1===t.kind?"movie/open/"+t.id:"compilation/open/"+t.id)+"/?referrer="+encodeURIComponent(n(i));else switch(e){case"movies":case"series":o.$desktop_url=d+e+"?"+n(i),o.$deeplink_path=e+"/open/?referrer="+encodeURIComponent(n(i));break;case"animation":o.$desktop_url=d+e+"?"+n(i),o.$deeplink_path="cartoons/open/?referrer="+encodeURIComponent(n(i));break;case"collection":t.collectionId&&t.collectionHru&&(o.$desktop_url=d+"collections/"+t.collectionHru+"?"+n(i),o.$deeplink_path="collection/open/"+t.collectionId+"/?referrer="+encodeURIComponent(n(i)));break;case"blockbuster_movies":o.$desktop_url=d+"movies/blockbusters?"+n(i),o.$deeplink_path="premieres/open/?referrer="+encodeURIComponent(n(i));break;case"blockbuster_animation":o.$desktop_url=d+"animation/blockbusters?"+n(i),o.$deeplink_path="cartoons/open/?referrer="+encodeURIComponent(n(i));break;case"subscription":o.$desktop_url=d+"plus?"+n(i),o.$deeplink_path="subscription/open/?referrer="+encodeURIComponent(n(i));break;case"subscription_movies":o.$desktop_url=d+"movies/plus?"+n(i),o.$deeplink_path="subscription/open/?referrer="+encodeURIComponent(n(i));break;case"subscription_series":o.$desktop_url=d+"series/plus?"+n(i),o.$deeplink_path="subscription/open/?referrer="+encodeURIComponent(n(i));break;case"subscription_animation":o.$desktop_url=d+"animation/plus?"+n(i),o.$deeplink_path="subscription/open/?referrer="+encodeURIComponent(n(i));break;case"subscription_erotika":o.$desktop_url=d+"plus/erotica?"+n(i),o.$deeplink_path="subscription/open/?referrer="+encodeURIComponent(n(i));break;default:o.$desktop_url=d+"?"+n(i),o.$deeplink_path="index/?referrer="+encodeURIComponent(n(i))}return o},l.createRedirectLink=function(e,t,i){var n=this.generateLinkParams(e,t,i),a=[];for(var s in n)a.push(encodeURIComponent(s)+"="+encodeURIComponent(n[s]));return"https://bnc.lt/a/"+u+"/?"+a.join("&")},l.setBranchViewData=function(e,t,i){s.setBranchViewData({data:this.generateLinkParams(e,t,i)})},l.createContentLink=function(e){var t=new r.default,i={},n=e||o.default.loadGutmCookie();return t.getCompilationId()?(i.id=t.getCompilationId(),i.kind=2,i.hru=t.getHru()):(t.isCompilation(),i.id=t.getId(),i.kind=1),this.createRedirectLink("content",i,n)},t.default=l},function(e,t,i){var n=i(14);t.default=n.default.extend({CONTENT_TYPE:"compilation",uri:"/compilationinfo/v5/",fields:"id,title,fake,preorderable,available_in_countries,hru,poster_originals,content_paid_types,compilation_hru,kind,additional_data,restrict,branding.px_audit,branding.brand_web_js,branding.brand_web_css,branding.link,artists,budget,categories,country,description,synopsis,duration,duration_minutes,genres,gross_russia,gross_usa,gross_world,imdb_rating,ivi_rating_10,kp_rating,season,thumb_originals,orig_title,year,years,restrict,episode,subsites_availability,subtitles,hd_available,compilation,compilation_title,drm_only,has_awards,seasons_count,seasons_content_total,seasons,episodes,seasons_description,season_extra_info,has_comments,has_reviews,has_upcoming_episodes",parse:function(e){e=e.result?e.result:e;var t=e;return t.link="/watch/"+e.hru,t.year=e.year||(e.years&&e.years.length?e.years[0]:""),e.poster_originals&&e.poster_originals[0]&&(t.poster=e.poster_originals[0].path.replace("http:","")),t},getPosterPath:function(){return this.get("poster")}})},function(e,t,i){var n=i(1),a=i(0),s=i(32),o=i(6),r=i(146),l=i(5),d=i(45),u=i(3),c=i(77);t.default=a.View.extend({el:"#search-text",resultBox:"#js-result-box",events:{keyup:"triggerKeyUp",keydown:"triggerKeyDown"},mobileEvents:{change:"triggerKeyUp"},selector:"",isIe:!1,isMobile:!1,previousQuery:"",formIsEmpty:!1,classSelected:"top-search__results-link_selected",initialize:function(e){var t=this;e&&"isMobile"in e&&(this.isMobile=e.isMobile,this.formIsEmpty=!!n("#js-search-page-query").val(),setInterval(function(){if(t.formIsEmpty){var e=n("#js-search-page-query");e.val()&&e.change()}},300)),this.listenTo(d.default,"search:model:ready",this.modelReady),this.isMobile?l.extend(this.events,this.mobileEvents):(this.listenTo(d.default,"search:quick:reset",this.formReset),this.isIe=(new s.default).isIE(),new r.default)},modelReady:function(){void 0===o.default.prototype.queryParams.q&&n.trim(this.$el.val())&&d.default.trigger("search-query",this.$el.val())},formReset:function(){this.$el.val(""),this.doSearch()},triggerKeyUp:function(e){var t=n.trim(this.$el.val());if(this.isMobile)this.doSearchMobile();else switch(e.which){case 40:t&&this.drawSelectionDown();break;case 38:t&&this.drawSelectionUp();break;case 13:this.doClick();break;case 16:case 17:case 18:case 20:case 37:case 39:case 91:case 93:break;default:this.previousQuery!==t&&(this.previousQuery=t,this.doSearch())}},drawSelectionUp:function(){if(this.selector=n(this.resultBox+" a"),this.selector.first().toggleClass(this.classSelected,!1),0===this.selector.filter("."+this.classSelected).length)n(this.selector).last().addClass(this.classSelected);else{var e=this.selector.filter("a."+this.classSelected),t=this.selector.index(e);this.selector.eq(t-1).addClass(this.classSelected),e.removeClass(this.classSelected)}},drawSelectionDown:function(){if(this.selector=n(this.resultBox+" a"),this.selector.last().toggleClass(this.classSelected,!1),0===this.selector.filter("."+this.classSelected).length)n(this.selector).first().addClass(this.classSelected);else{var e=this.selector.filter("a."+this.classSelected),t=this.selector.index(e);this.selector.eq(t+1).addClass(this.classSelected),e.removeClass(this.classSelected)}},doSearch:function(){n.trim(this.$el.val())?(n("#js-quick-search-submit-button").prop("disabled",!1),d.default.trigger("search-query",this.$el.val())):(c.default.increaseSession(),n("#js-quick-search-submit-button").prop("disabled",!0),d.default.trigger("hide-results"))},doSearchMobile:function(){n.trim(this.$el.val())?(this.formIsEmpty=!1,d.default.trigger("search-query",this.$el.val())):(this.formIsEmpty=!0,c.default.increaseSession(),d.default.trigger("hide-results"))},doClick:function(){var e=n(this.resultBox+" a."+this.classSelected);e.length&&(u.default.setBlockId("search_short_results"),window.location.href=e.attr("href"))},triggerKeyDown:function(e){this.isIe&&13===e.which&&this.doClick(),38===e.which&&e.preventDefault()}})},function(e,t,i){var n=i(5),a=i(36);t.default=a.default.extend({uri:"/billing/v1/purchase/season/options/",getPurchaseOptionList:function(){var e=a.default.prototype.getPurchaseOptionList.call(this);return e.models&&e.models.length&&(e.models=e.models.filter(function(e){return"eternal"===e.get("ownership_type")})),e},getPurchaseOptions:function(){return this.getPurchaseOptionList().models},getPurchaseOptionsSortedByHd:function(){return n.sortBy(this.getPurchaseOptions(),function(e){return e.isHDQuality()?-1:1})}})},function(e,t,i){var n=i(0),a=i(115),s=i(494),o=i(499),r=i(258),l=i(11);t.default=n.View.extend({el:"#js-pay-content",tabList:[],initialize:function(e,t){void 0===t&&(t=!1),this.options=e;var i=new a.default(e),n=new s.default(e),d=new r.default(e);i.applePayButton=d,this.addTab(i),this.addTab(n),t&&this.addTab(new o.default(e)),d.showButtonOnMainForm(),this.listenTo(l.default,"payment:option:select",this.openTab);for(var u in this.tabList)this.tabList[u].removePostMessageListener()},addTab:function(e){this.tabList[e.name]=e},openTab:function(e){for(var t in this.tabList)this.tabList[t].setActive(!1),this.tabList[t].removePostMessageListener();this.$el.html("");var i=this.tabList[e];i.setActive(!0),i.addPostMessageListener(),i.reset(),i.render()}})},function(e,t,i){var n=i(14);t.default=n.default.extend({uri:"/billing/v2/credit/status",hasApprovedBonus:function(){return"ok"===this.get("bonus")}})},function(e,t,i){function n(e){return a.default.render('<iframe id="js-buy-iframe" src="{{ redirect_url }}{% if purchaseOption.noFocus|default(false) %}&no_focus=1{% endif %}" frameborder="0" class="pay-form"></iframe>',e)}var a=i(2);t.default=n},function(e,t,i){var n=i(14);t.default=n.default.extend({uri:"/billing/v1/psaccounts",getBindForm:function(){return this.mapiPost({data:{ps_key:"cards"}})},getPaySystemList:function(){return this.mapiGet({uri:"/billing/v1/psaccounts/"})},parse:function(e){return e.error?e:e.result}})},function(e,t,i){var n=i(6),a=i(536),s=i(537),o=i(538),r=i(276),l=i(540),d=i(18);t.default=n.default.extend({page:"",setPage:function(e){this.page=e},run:function(){if(d.default.showMultiSectionPromo()&&"start"===this.page)new l.default;else{var e="start"!==this.page?"_"+this.page:"_promo",t={};this.params&&this.params.grootId&&(t={name:this.params.grootId,grootBlockId:this.params.grootId+e}),new s.default(t),window.ivi.adaptive.isMobile?new o.default:(new r.default,new a.default)}}})},function(e,t,i){"use strict";function n(e,t){return e&&"object"==typeof e&&null!=e.key?d.escape(e.key):t.toString(36)}function a(e,t,i,s){var p=typeof e;if("undefined"!==p&&"boolean"!==p||(e=null),null===e||"string"===p||"number"===p||r.isValidElement(e))return i(s,e,""===t?u+n(e,0):t),1;var f,h,g=0,m=""===t?u:t+c;if(Array.isArray(e))for(var v=0;v<e.length;v++)f=e[v],h=m+n(f,v),g+=a(f,h,i,s);else{var _=l(e);if(_){var b,y=_.call(e);if(_!==e.entries)for(var w=0;!(b=y.next()).done;)f=b.value,h=m+n(f,w++),g+=a(f,h,i,s);else for(;!(b=y.next()).done;){var C=b.value;C&&(f=C[1],h=m+d.escape(C[0])+c+n(f,0),g+=a(f,h,i,s))}}else if("object"===p){var k="",P=String(e);o("31","[object Object]"===P?"object with keys {"+Object.keys(e).join(", ")+"}":P,k)}}return g}function s(e,t,i){return null==e?0:a(e,"",t,i)}var o=i(15),r=(i(70),i(52)),l=i(281),d=(i(13),i(168)),u=(i(17),"."),c=":";e.exports=s},function(e,t,i){"use strict";function n(e){var t={"=":"=0",":":"=2"};return"$"+(""+e).replace(/[=:]/g,function(e){return t[e]})}function a(e){var t=/(=0|=2)/g,i={"=0":"=","=2":":"};return(""+("."===e[0]&&"$"===e[1]?e.substring(2):e.substring(1))).replace(t,function(e){return i[e]})}var s={escape:n,unescape:a};e.exports=s},function(e,t,i){"use strict";function n(e,t,i){this.props=e,this.context=t,this.refs=o,this.updater=i||s}var a=i(15),s=i(170),o=(i(280),i(94));i(13),i(17);n.prototype.isReactComponent={},n.prototype.setState=function(e,t){"object"!=typeof e&&"function"!=typeof e&&null!=e&&a("85"),this.updater.enqueueSetState(this,e),t&&this.updater.enqueueCallback(this,t,"setState")},n.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this),e&&this.updater.enqueueCallback(this,e,"forceUpdate")};e.exports=n},function(e,t,i){"use strict";var n=(i(17),{isMounted:function(e){return!1},enqueueCallback:function(e,t){},enqueueForceUpdate:function(e){},enqueueReplaceState:function(e,t){},enqueueSetState:function(e,t){}});e.exports=n},function(e,t,i){"use strict";var n=i(118),a=n({prop:null,context:null,childContext:null});e.exports=a},function(e,t,i){"use strict";var n={};e.exports=n},function(e,t,i){"use strict";e.exports="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"},function(e,t,i){"use strict";function n(){if(r)for(var e in l){var t=l[e],i=r.indexOf(e);if(i>-1||o("96",e),!d.plugins[i]){t.extractEvents||o("97",e),d.plugins[i]=t;var n=t.eventTypes;for(var s in n)a(n[s],t,s)||o("98",s,e)}}}function a(e,t,i){d.eventNameDispatchConfigs.hasOwnProperty(i)&&o("99",i),d.eventNameDispatchConfigs[i]=e;var n=e.phasedRegistrationNames;if(n){for(var a in n)if(n.hasOwnProperty(a)){var r=n[a];s(r,t,i)}return!0}return!!e.registrationName&&(s(e.registrationName,t,i),!0)}function s(e,t,i){d.registrationNameModules[e]&&o("100",e),d.registrationNameModules[e]=t,d.registrationNameDependencies[e]=t.eventTypes[i].dependencies}var o=i(15),r=(i(13),null),l={},d={plugins:[],eventNameDispatchConfigs:{},registrationNameModules:{},registrationNameDependencies:{},possibleRegistrationNames:null,injectEventPluginOrder:function(e){r&&o("101"),r=Array.prototype.slice.call(e),n()},injectEventPluginsByName:function(e){var t=!1;for(var i in e)if(e.hasOwnProperty(i)){var a=e[i];l.hasOwnProperty(i)&&l[i]===a||(l[i]&&o("102",i),l[i]=a,t=!0)}t&&n()},getPluginModuleForEvent:function(e){var t=e.dispatchConfig;if(t.registrationName)return d.registrationNameModules[t.registrationName]||null;for(var i in t.phasedRegistrationNames)if(t.phasedRegistrationNames.hasOwnProperty(i)){var n=d.registrationNameModules[t.phasedRegistrationNames[i]];if(n)return n}return null},_resetEventPlugins:function(){r=null;for(var e in l)l.hasOwnProperty(e)&&delete l[e];d.plugins.length=0;var t=d.eventNameDispatchConfigs;for(var i in t)t.hasOwnProperty(i)&&delete t[i];var n=d.registrationNameModules;for(var a in n)n.hasOwnProperty(a)&&delete n[a]}};e.exports=d},function(e,t,i){"use strict";function n(e){return e===_.topMouseUp||e===_.topTouchEnd||e===_.topTouchCancel}function a(e){return e===_.topMouseMove||e===_.topTouchMove}function s(e){return e===_.topMouseDown||e===_.topTouchStart}function o(e,t,i,n){var a=e.type||"unknown-event";e.currentTarget=b.getNodeFromInstance(n),t?m.invokeGuardedCallbackWithCatch(a,i,e):m.invokeGuardedCallback(a,i,e),e.currentTarget=null}function r(e,t){var i=e._dispatchListeners,n=e._dispatchInstances;if(Array.isArray(i))for(var a=0;a<i.length&&!e.isPropagationStopped();a++)o(e,t,i[a],n[a]);else i&&o(e,t,i,n);e._dispatchListeners=null,e._dispatchInstances=null}function l(e){var t=e._dispatchListeners,i=e._dispatchInstances;if(Array.isArray(t)){for(var n=0;n<t.length&&!e.isPropagationStopped();n++)if(t[n](e,i[n]))return i[n]}else if(t&&t(e,i))return i;return null}function d(e){var t=l(e);return e._dispatchInstances=null,e._dispatchListeners=null,t}function u(e){var t=e._dispatchListeners,i=e._dispatchInstances;Array.isArray(t)&&h("103"),e.currentTarget=t?b.getNodeFromInstance(i):null;var n=t?t(e):null;return e.currentTarget=null,e._dispatchListeners=null,e._dispatchInstances=null,n}function c(e){return!!e._dispatchListeners}var p,f,h=i(15),g=i(62),m=i(176),v=(i(13),i(17),{injectComponentTree:function(e){p=e},injectTreeTraversal:function(e){f=e}}),_=g.topLevelTypes,b={isEndish:n,isMoveish:a,isStartish:s,executeDirectDispatch:u,executeDispatchesInOrder:r,executeDispatchesInOrderStopAtTrue:d,hasDispatches:c,getInstanceFromNode:function(e){return p.getInstanceFromNode(e)},getNodeFromInstance:function(e){return p.getNodeFromInstance(e)},isAncestor:function(e,t){return f.isAncestor(e,t)},getLowestCommonAncestor:function(e,t){return f.getLowestCommonAncestor(e,t)},getParentInstance:function(e){return f.getParentInstance(e)},traverseTwoPhase:function(e,t,i){return f.traverseTwoPhase(e,t,i)},traverseEnterLeave:function(e,t,i,n,a){return f.traverseEnterLeave(e,t,i,n,a)},injection:v};e.exports=b},function(e,t,i){"use strict";function n(e,t,i,n){try{return t(i,n)}catch(e){return void(null===a&&(a=e))}}var a=null,s={invokeGuardedCallback:n,invokeGuardedCallbackWithCatch:n,rethrowCaughtError:function(){if(a){var e=a;throw a=null,e}}};e.exports=s},function(e,t,i){"use strict";function n(e){var t=e.target||e.srcElement||window;return t.correspondingUseElement&&(t=t.correspondingUseElement),3===t.nodeType?t.parentNode:t}e.exports=n},function(e,t,i){"use strict";/**
 * Checks if an event is supported in the current execution environment.
 *
 * NOTE: This will not work correctly for non-generic events such as `change`,
 * `reset`, `load`, `error`, and `select`.
 *
 * Borrows from Modernizr.
 *
 * @param {string} eventNameSuffix Event name, e.g. "click".
 * @param {?boolean} capture Check if the capture phase is supported.
 * @return {boolean} True if the event is supported.
 * @internal
 * @license Modernizr 3.0.0pre (Custom Build) | MIT
 */
function n(e,t){if(!s.canUseDOM||t&&!("addEventListener"in document))return!1;var i="on"+e,n=i in document;if(!n){var o=document.createElement("div");o.setAttribute(i,"return;"),n="function"==typeof o[i]}return!n&&a&&"wheel"===e&&(n=document.implementation.hasFeature("Events.wheel","3.0")),n}var a,s=i(34);s.canUseDOM&&(a=document.implementation&&document.implementation.hasFeature&&!0!==document.implementation.hasFeature("","")),e.exports=n},function(e,t,i){"use strict";function n(e){var t=this,i=t.nativeEvent;if(i.getModifierState)return i.getModifierState(e);var n=s[e];return!!n&&!!i[n]}function a(e){return n}var s={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};e.exports=a},function(e,t,i){"use strict";function n(e,t){return Array.isArray(t)&&(t=t[1]),t?t.nextSibling:e.firstChild}function a(e,t,i){u.insertTreeBefore(e,t,i)}function s(e,t,i){Array.isArray(t)?r(e,t[0],t[1],i):m(e,t,i)}function o(e,t){if(Array.isArray(t)){var i=t[1];t=t[0],l(e,t,i),e.removeChild(i)}e.removeChild(t)}function r(e,t,i,n){for(var a=t;;){var s=a.nextSibling;if(m(e,a,n),a===i)break;a=s}}function l(e,t,i){for(;;){var n=t.nextSibling;if(n===i)break;e.removeChild(n)}}function d(e,t,i){var n=e.parentNode,a=e.nextSibling;a===t?i&&m(n,document.createTextNode(i),a):i?(g(a,i),l(n,a,t)):l(n,e,t)}var u=i(87),c=i(561),p=i(296),f=(i(27),i(38),i(182)),h=i(120),g=i(295),m=f(function(e,t,i){e.insertBefore(t,i)}),v=c.dangerouslyReplaceNodeWithMarkup,_={dangerouslyReplaceNodeWithMarkup:v,replaceDelimitedText:d,processUpdates:function(e,t){for(var i=0;i<t.length;i++){var r=t[i];switch(r.type){case p.INSERT_MARKUP:a(e,r.content,n(e,r.afterNode));break;case p.MOVE_EXISTING:s(e,r.fromNode,n(e,r.afterNode));break;case p.SET_MARKUP:h(e,r.content);break;case p.TEXT_CONTENT:g(e,r.content);break;case p.REMOVE_NODE:o(e,r.fromNode)}}}};e.exports=_},function(e,t,i){"use strict";var n={html:"http://www.w3.org/1999/xhtml",mathml:"http://www.w3.org/1998/Math/MathML",svg:"http://www.w3.org/2000/svg"};e.exports=n},function(e,t,i){"use strict";var n=function(e){return"undefined"!=typeof MSApp&&MSApp.execUnsafeLocalFunction?function(t,i,n,a){MSApp.execUnsafeLocalFunction(function(){return e(t,i,n,a)})}:e};e.exports=n},function(e,t,i){"use strict";function n(e){null!=e.checkedLink&&null!=e.valueLink&&r("87")}function a(e){n(e),(null!=e.value||null!=e.onChange)&&r("88")}function s(e){n(e),(null!=e.checked||null!=e.onChange)&&r("89")}function o(e){if(e){var t=e.getName();if(t)return" Check the render method of `"+t+"`."}return""}var r=i(15),l=i(283),d=i(171),u=i(173),c=(i(13),i(17),{button:!0,checkbox:!0,image:!0,hidden:!0,radio:!0,reset:!0,submit:!0}),p={value:function(e,t,i){return!e[t]||c[e.type]||e.onChange||e.readOnly||e.disabled?null:new Error("You provided a `value` prop to a form field without an `onChange` handler. This will render a read-only field. If the field should be mutable use `defaultValue`. Otherwise, set either `onChange` or `readOnly`.")},checked:function(e,t,i){return!e[t]||e.onChange||e.readOnly||e.disabled?null:new Error("You provided a `checked` prop to a form field without an `onChange` handler. This will render a read-only field. If the field should be mutable use `defaultChecked`. Otherwise, set either `onChange` or `readOnly`.")},onChange:l.func},f={},h={checkPropTypes:function(e,t,i){for(var n in p){if(p.hasOwnProperty(n))var a=p[n](t,n,e,d.prop,null,u);if(a instanceof Error&&!(a.message in f)){f[a.message]=!0;o(i)}}},getValue:function(e){return e.valueLink?(a(e),e.valueLink.value):e.value},getChecked:function(e){return e.checkedLink?(s(e),e.checkedLink.value):e.checked},executeOnChange:function(e,t){return e.valueLink?(a(e),e.valueLink.requestChange(t.target.value)):e.checkedLink?(s(e),e.checkedLink.requestChange(t.target.checked)):e.onChange?e.onChange.call(void 0,t):void 0}};e.exports=h},function(e,t,i){"use strict";var n=i(15),a=(i(13),!1),s={unmountIDFromEnvironment:null,replaceNodeWithMarkup:null,processChildrenUpdates:null,injection:{injectEnvironment:function(e){a&&n("104"),s.unmountIDFromEnvironment=e.unmountIDFromEnvironment,s.replaceNodeWithMarkup=e.replaceNodeWithMarkup,s.processChildrenUpdates=e.processChildrenUpdates,a=!0}}};e.exports=s},function(e,t){function i(){throw new Error("setTimeout has not been defined")}function n(){throw new Error("clearTimeout has not been defined")}function a(e){if(u===setTimeout)return setTimeout(e,0);if((u===i||!u)&&setTimeout)return u=setTimeout,setTimeout(e,0);try{return u(e,0)}catch(t){try{return u.call(null,e,0)}catch(t){return u.call(this,e,0)}}}function s(e){if(c===clearTimeout)return clearTimeout(e);if((c===n||!c)&&clearTimeout)return c=clearTimeout,clearTimeout(e);try{return c(e)}catch(t){try{return c.call(null,e)}catch(t){return c.call(this,e)}}}function o(){g&&f&&(g=!1,f.length?h=f.concat(h):m=-1,h.length&&r())}function r(){if(!g){var e=a(o);g=!0;for(var t=h.length;t;){for(f=h,h=[];++m<t;)f&&f[m].run();m=-1,t=h.length}f=null,g=!1,s(e)}}function l(e,t){this.fun=e,this.array=t}function d(){}var u,c,p=e.exports={};!function(){try{u="function"==typeof setTimeout?setTimeout:i}catch(e){u=i}try{c="function"==typeof clearTimeout?clearTimeout:n}catch(e){c=n}}();var f,h=[],g=!1,m=-1;p.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var i=1;i<arguments.length;i++)t[i-1]=arguments[i];h.push(new l(e,t)),1!==h.length||g||a(r)},l.prototype.run=function(){this.fun.apply(null,this.array)},p.title="browser",p.browser=!0,p.env={},p.argv=[],p.version="",p.versions={},p.on=d,p.addListener=d,p.once=d,p.off=d,p.removeListener=d,p.removeAllListeners=d,p.emit=d,p.prependListener=d,p.prependOnceListener=d,p.listeners=function(e){return[]},p.binding=function(e){throw new Error("process.binding is not supported")},p.cwd=function(){return"/"},p.chdir=function(e){throw new Error("process.chdir is not supported")},p.umask=function(){return 0}},function(e,t,i){"use strict";function n(e,t){d[e]||(d[e]={element:null,parentID:null,ownerID:null,text:null,childIDs:[],displayName:"Unknown",isMounted:!1,updateCount:0}),t(d[e])}function a(e){var t=d[e];if(t){var i=t.childIDs;delete d[e],i.forEach(a)}}function s(e,t,i){return"\n    in "+e+(t?" (at "+t.fileName.replace(/^.*[\\\/]/,"")+":"+t.lineNumber+")":i?" (created by "+i+")":"")}function o(e){var t,i=p.getDisplayName(e),n=p.getElement(e),a=p.getOwnerID(e);return a&&(t=p.getDisplayName(a)),s(i,n&&n._source,t)}var r=i(15),l=i(70),d=(i(13),i(17),{}),u={},c={},p={onSetDisplayName:function(e,t){n(e,function(e){return e.displayName=t})},onSetChildren:function(e,t){n(e,function(i){i.childIDs=t,t.forEach(function(t){var i=d[t];i||r("68"),null==i.displayName&&r("69"),null==i.childIDs&&null==i.text&&r("70"),i.isMounted||r("71"),null==i.parentID&&(i.parentID=e),i.parentID!==e&&r("72",t,i.parentID,e)})})},onSetOwner:function(e,t){n(e,function(e){return e.ownerID=t})},onSetParent:function(e,t){n(e,function(e){return e.parentID=t})},onSetText:function(e,t){n(e,function(e){return e.text=t})},onBeforeMountComponent:function(e,t){n(e,function(e){return e.element=t})},onBeforeUpdateComponent:function(e,t){n(e,function(e){return e.element=t})},onMountComponent:function(e){n(e,function(e){return e.isMounted=!0})},onMountRootComponent:function(e){c[e]=!0},onUpdateComponent:function(e){n(e,function(e){return e.updateCount++})},onUnmountComponent:function(e){n(e,function(e){return e.isMounted=!1}),u[e]=!0,delete c[e]},purgeUnmountedComponents:function(){if(!p._preventPurging){for(var e in u)a(e);u={}}},isMounted:function(e){var t=d[e];return!!t&&t.isMounted},getCurrentStackAddendum:function(e){var t="";if(e){var i=e.type,n="function"==typeof i?i.displayName||i.name:i,a=e._owner;t+=s(n||"Unknown",e._source,a&&a.getName())}var o=l.current,r=o&&o._debugID;return t+=p.getStackAddendumByID(r)},getStackAddendumByID:function(e){for(var t="";e;)t+=o(e),e=p.getParentID(e);return t},getChildIDs:function(e){var t=d[e];return t?t.childIDs:[]},getDisplayName:function(e){var t=d[e];return t?t.displayName:"Unknown"},getElement:function(e){var t=d[e];return t?t.element:null},getOwnerID:function(e){var t=d[e];return t?t.ownerID:null},getParentID:function(e){var t=d[e];return t?t.parentID:null},getSource:function(e){var t=d[e],i=t?t.element:null;return null!=i?i._source:null},getText:function(e){var t=d[e];return t?t.text:null},getUpdateCount:function(e){var t=d[e];return t?t.updateCount:0},getRootIDs:function(){return Object.keys(c)},getRegisteredIDs:function(){return Object.keys(d)}};e.exports=p},function(e,t,i){"use strict";function n(e,t){return e===t?0!==e||0!==t||1/e==1/t:e!==e&&t!==t}function a(e,t){if(n(e,t))return!0;if("object"!=typeof e||null===e||"object"!=typeof t||null===t)return!1;var i=Object.keys(e),a=Object.keys(t);if(i.length!==a.length)return!1;for(var o=0;o<i.length;o++)if(!s.call(t,i[o])||!n(e[i[o]],t[i[o]]))return!1;return!0}var s=Object.prototype.hasOwnProperty;e.exports=a},function(e,t,i){"use strict";function n(e,t){var i=null===e||!1===e,n=null===t||!1===t;if(i||n)return i===n;var a=typeof e,s=typeof t;return"string"===a||"number"===a?"string"===s||"number"===s:"object"===s&&e.type===t.type&&e.key===t.key}e.exports=n},function(e,t,i){"use strict";function n(e){l.enqueueUpdate(e)}function a(e){var t=typeof e;if("object"!==t)return t;var i=e.constructor&&e.constructor.name||t,n=Object.keys(e);return n.length>0&&n.length<20?i+" (keys: "+n.join(", ")+")":i}function s(e,t){var i=r.get(e);if(!i){return null}return i}var o=i(15),r=(i(70),i(99)),l=(i(38),i(53)),d=(i(13),i(17),{isMounted:function(e){var t=r.get(e);return!!t&&!!t._renderedComponent},enqueueCallback:function(e,t,i){d.validateCallback(t,i);var a=s(e);if(!a)return null;a._pendingCallbacks?a._pendingCallbacks.push(t):a._pendingCallbacks=[t],n(a)},enqueueCallbackInternal:function(e,t){e._pendingCallbacks?e._pendingCallbacks.push(t):e._pendingCallbacks=[t],n(e)},enqueueForceUpdate:function(e){var t=s(e,"forceUpdate");t&&(t._pendingForceUpdate=!0,n(t))},enqueueReplaceState:function(e,t){var i=s(e,"replaceState");i&&(i._pendingStateQueue=[t],i._pendingReplaceState=!0,n(i))},enqueueSetState:function(e,t){var i=s(e,"setState");if(i){(i._pendingStateQueue||(i._pendingStateQueue=[])).push(t),n(i)}},enqueueElementInternal:function(e,t,i){e._pendingElement=t,e._context=i,n(e)},validateCallback:function(e,t){e&&"function"!=typeof e&&o("122",t,a(e))}});e.exports=d},function(e,t,i){"use strict";var n=(i(24),i(46)),a=(i(17),n);e.exports=a},function(e,t,i){"use strict";function n(e){var t,i=e.keyCode;return"charCode"in e?0===(t=e.charCode)&&13===i&&(t=13):t=i,t>=32||13===t?t:0}e.exports=n},function(e,t,i){var n=i(1),a=i(0),s=i(653),o=i(5),r=i(11),l=i(654),d=i(3),u=i(44),c=i(4),p=i(655),f=i(18),h=i(7),g=i(8);t.default=s.default.extend({modalId:"js-price-select-modal-wrapper",wrapper:"-fullscreen-modal",bodyClass:"ivi-page_fullscreen-popup_shown has-fullscreen-popup",mobileScroll:!0,events:{"click .js-buy":"buyClick"},template:l.default,buttonClicked:!1,purchaseFormCollectionView:null,cheapestCollectionPurchaseOptions:null,initialize:function(){this.listenToOnce(r.default,"billing:contentPurchaseIviPSMethodSuccess",this.trackSuccessIviBuy),this.listenTo(r.default,"billing:unlockPriceButton",this.unlockPriceButton)},onRender:function(){this.model.get("showDrmNotice")&&d.default.track("modal_no_drm_on")},onShow:function(){this.purchaseFormCollectionView&&(this.purchaseFormCollectionView.setElement(n(p.default.prototype.el)),this.purchaseFormCollectionView.render())},beforeRender:function(e){this.model.set("purchaseOptionList",e.getContentOptionsGroupedByOwnershipType()),f.default.canSellBundles()&&(this.setCheapestCollectionPurchaseOptions(e),this.cheapestCollectionPurchaseOptions&&!this.purchaseFormCollectionView&&(this.purchaseFormCollectionView=new p.default({cheapestCollectionPurchaseOptions:this.cheapestCollectionPurchaseOptions}))),this.setModelAndGrootParams(e),this.trackCriteo(e.getContentOptions())},setModelAndGrootParams:function(e){this.model.set("host",c.default.getLocation().host);var t=this.getAdditionalGrootParams();o.extend(t,e.getRightTypeForGroot()),d.default.track("price_selection",t)},setCheapestCollectionPurchaseOptions:function(e){if(!this.cheapestCollectionPurchaseOptions){var t=e.getCollectionOptions();if(!o.isEmpty(t)){var i=o.groupBy(t,function(e){return e.getObjectId()}),n=o.chain(t).sortBy(function(e){return e.getPrice()}).first().value(),a=i[n.getObjectId()];this.model.set("cheapestCollectionPurchaseOptions",a),this.cheapestCollectionPurchaseOptions=a}}},buyClick:function(e){var t=this;e.preventDefault(),!1===this.buttonClicked&&(this.buttonClicked=!0,o.each(this.model.get("purchaseOptionList"),function(i){var s=new a.Collection(i).findWhere({option_hash:n(e.currentTarget).data("option_hash")});if(s){var l=t.getAdditionalGrootParams();if(o.extend(l,s.getGrootParams()),"content"===s.get("object_type")||"season"===s.get("object_type")||"collection"===s.get("object_type")?(l.quality=s.get("quality"),"eternal"===s.get("ownership_type")?l.m_est=1:"temporal"===s.get("ownership_type")&&(l.m_tvod=1),s.get("preorder")&&(l.preorderable=1)):"subscription"===s.get("object_type")&&(l.m_svod=1),l.price=s.getMinUserPrice(),d.default.track("price_click",l),u.default.viewBasket(s.get("object_id"),s.get("object_type"),l.price),!g.default.isAuthenticated()&&f.default.showAuthBeforePurchase())return r.default.trigger("buy:processPurchaseClickByGuestUser",e),h.default.trigger("auth:showLoginModal:beforePurchase"),void(t.buttonClicked=!1);r.default.trigger("purchase:personal",s.toJSON(),e.currentTarget.href+"&from="+t.from)}}))},trackCriteo:function(e){var t=o.min(e,function(e){return parseInt(e.getMinUserPrice(),10)});u.default.viewBasket(t.getObjectId(),t.getObjectType(),t.getMinUserPrice())},unlockPriceButton:function(){this.buttonClicked=!1}})},function(e,t,i){var n=i(1),a=i(81),s=i(670),o=i(672),r=i(676),l=i(0),d=i(10),u=i(35),c=i(39),p=i(43),f=i(18),h=i(321),g=i(8),m=i(89);t.default=l.View.extend({el:"#js-player",adBlockNoticeCookieName:"adbNotice",adBlockNoticePeriod:1209600,adBlockNewNoticeView:null,adBlockModel:null,initialize:function(){var e=this;a.default.detectedDeferred.done(function(){e.processAdblockDetection(a.default.detected)})},render:function(e){if(e&&Object.keys(e).length&&!n("#player").length){var t={id:e.id,app_version:e.appVersion,autostart:e.autoStart?1:0};e.queryParams.adr_order_id&&(t.adr_order_id=e.queryParams.adr_order_id),e.queryParams.postback_url&&(t.postback_url=e.queryParams.postback_url),e.queryParams.s&&(t.start=e.queryParams.s),e.continuewatching&&(t.resume=1),"trailer"===e.contentType&&e.preorder&&(t.preorder=1),"prod"!==d.default.env&&(e.queryParams.testScenarioId&&(t.testScenarioId=e.queryParams.testScenarioId),e.queryParams.dontSaveAdvHistory&&(t.dontSaveAdvHistory=e.queryParams.dontSaveAdvHistory),e.queryParams.light&&(t.light=e.queryParams.light),e.queryParams.mapi&&(t.mapi=e.queryParams.mapi),e.queryParams.vast_url&&(t.vast_url=e.queryParams.vast_url)),t.hostname="www."+c.default.getRightHost(),t.rnd=Date.now();var i="trailer"===e.contentType?"additionaldata":"video",a=d.default.player.embed.url+i+"/?";for(var s in t)a+=s+"="+t[s]+"&";a=a.substr(0,a.length-1);var o=document.getElementsByTagName("iframe"),r=null,l=null;Array.prototype.map.call(o,function(e){-1!==e.src.indexOf("adriver")&&(r=e,l=e.parentNode,e.parentNode.removeChild(e))});var u='<iframe id="player-iframe" allowfullscreen width="100%" height="100%"scrolling="no" allow="autoplay; fullscreen" src="'+a+'"></iframe>';document.getElementById("js-player").innerHTML=u,l&&r&&(l.appendChild(r),r.contentWindow.location.href=r.src)}},showAdBlockNotice:function(){u.set(this.adBlockNoticeCookieName,1,{expires:this.adBlockNoticePeriod}),(new s.default).render()},showNewAdBlockNotice:function(e){e&&this.adBlockNewNoticeView.render(e)},onPlayerGrootEvent:function(e){!this.adBlockModel||"content_watch"!==e&&"trailer_watch"!==e||(this.adBlockModel.onWatch(),this.adBlockModel.save())},processAdblockDetection:function(e){this.isPageWithAdBlock()&&(f.default.showNewAdBlock()?(this.adBlockModel=new h.default,this.adBlockModel.load(e),this.adBlockModel.isUserAdBlocker()&&!g.default.hasSubscription()?(this.adBlockNewNoticeView=new o.default({model:this.adBlockModel}),this.adBlockModel.isNoticeShouldBeShown()&&!this.adBlockNewNoticeView.isRendered()&&this.showNewAdBlockNotice(this.adBlockModel.getMessage()),(new r.default).listen(m.default),m.default.listenTo(m.default,"player:grootEvent",this.onPlayerGrootEvent.bind(this)),this.adBlockModel.save()):this.adBlockModel.isAdBlockDisabled()&&(this.adBlockModel.setLastCommunicationNumber(null),this.adBlockModel.save())):e&&"1"!==u.get(this.adBlockNoticeCookieName)&&!window.ivi.adaptive.isMobile&&this.showAdBlockNotice())},isPageWithAdBlock:function(){return 0===p.default.getRefPage().search(/content_watch|content_trailers|trailers/)}})},function(e,t,i){var n=i(1),a=i(5),s=i(7),o=i(126),r=i(128),l=i(8);t.default={likeEvents:{"click .js-like":"like","click .js-dislike":"dislike"},initLikes:function(){this.objectType&&(this.events=a.extend(this.events||{},this.likeEvents),this.listenTo(r.default,"like:added",this.onLikeAdded),this.listenTo(r.default,"like:deleted",this.onLikeDeleted))},like:function(e){this.rate(e,"like")},dislike:function(e){this.rate(e,"dislike")},rate:function(e,t){if(l.default.isAuthenticated()){var i=n(e.target),a=i.closest(".js-votable"),o=a.data("id"),d={objectId:o,objectType:this.objectType,value:t};i.hasClass("active")?r.default.trigger("like:delete",d):r.default.trigger("like:add",d)}else s.default.trigger("auth:showLoginModal","like")},onLikeAdded:function(e){if(e.objectType===this.objectType){var t=this.getVotableElement(e);if(t.length){var i=t.find(e.value===o.default.like?".js-like":".js-dislike"),n=t.find(e.value===o.default.like?".js-dislike":".js-like");this.updateVotes(e,"add"),i.addClass("active"),n.removeClass("active")}}},onLikeDeleted:function(e){if(e.objectType===this.objectType){var t=this.getVotableElement(e);if(t.length){var i=t.find(e.value===o.default.like?".js-like":".js-dislike");this.updateVotes(e,"delete"),i.removeClass("active")}}},updateVotes:function(e,t){var i=this.getVotableElement(e),n=i.find(".js-votes"),a=parseInt(n.text(),10);"add"===t?(a+=e.value===o.default.like?1:-1,e.value===o.default.like&&i.find(".js-dislike").hasClass("active")&&(a+=1),e.value===o.default.dislike&&i.find(".js-like").hasClass("active")&&(a-=1)):a+=e.value===o.default.like?-1:1,n.text(a),0===a?n.removeClass("positive negative"):a>0?n.removeClass("negative").addClass("positive"):n.removeClass("positive").addClass("negative")},getVotableElement:function(e){return this.$el.hasClass("js-votable")&&this.$el.data("id")===e.objectId?this.$el:this.$el.find(".js-votable[data-id="+e.objectId+"]")}}},function(e,t,i){var n=i(103),a=i(67),s=i(5),o=i(57);t.default=a.default.extend(n.default).extend({uri:"/watchhistory/v5/",selectionPrefix:"watchedList",requestParams:{},set:function(e,t){var i=n.default.set.call(this,e,t);return o.default.trigger("unfinished:watchhistory:loaded"),i},parse:function(e){return e.error?[]:e.result},getWatchedListByYear:function(){var e=[],t=this.models.slice(0,this.selectionTo);return s.each(t,function(t){var i=t.getWatchYear();if(i){var n;s.each(e,function(e){e.year===i&&(n=e)}),n||(n={year:i,videoList:[]},e.push(n)),n.videoList.push(t)}}),e}})},function(e,t,i){var n=i(0),a=i(722),s=i(724),o=i(725),r=i(726),l=i(727),d=i(729),u=i(731),c=i(732),p=i(735),f=i(5),h=i(7),g=i(64),m=i(3),v=i(737),_=i(137),b=i(8);t.default=n.View.extend({el:"#review-form",textView:null,events:{submit:"addReview","click .js-close":"collapse","click .js-rules":"showRules","click .js-auth":"showAuthModal","click .js-style-bold":"makeBold","click .js-style-italic":"makeItalic"},initialize:function(e){f.extend(this,f.pick(e,"videoId","kind")),this.errorView=new o.default({el:this.$el.find(".js-message")}),this.textView=new c.default({el:this.$el.find("textarea[name=subject]")}),new l.default,new u.default({el:this.$el.find("[type=submit]")}),this.title=new p.default({el:this.$el.find("input[name=title]")}),this._createNewReview(),this.listenTo(g.default,"expand",this.expand),this.listenTo(g.default,"form:review:collapse",this.collapse),new r.default,(new d.default).listen(g.default),this.$el.find("#review-form-expander").length||this.$el.find(".form-data").prepend(v.default())},addReview:function(e){if(m.default.track("r_sub"),!b.default.isAuthenticated())return h.default.trigger("auth:showLoginModal"),!1;e.preventDefault(),this.model.add({title:this.$el.find('input[name="title"]').val(),subject:this.$el.find('textarea[name="subject"]').val()})},_createNewReview:function(){1===this.kind?this.model=new s.default({videoId:this.videoId}):2===this.kind&&(this.model=new a.default({videoId:this.videoId}))},expand:function(){this.$el.addClass("expanded"),_.default.trigger("scroll"),g.default.trigger("check"),this.title.$el.focus(),this.textView.initAutosize(),this.errorView.show()},collapse:function(e){e&&m.default.track("review_add_close"),this.$el.removeClass("expanded"),this.$el.find("input[name=title]").val(""),this.$el.find("textarea[name=subject]").val("").attr("style",""),this.errorView.hide()},showRules:function(){return g.default.trigger("review:rules:modal"),!1},showAuthModal:function(){return h.default.trigger("auth:showLoginModal"),!1},makeBold:function(){g.default.trigger("review:markText","B")},makeItalic:function(){g.default.trigger("review:markText","I")}})},function(e,t,i){var n=i(1),a=i(0),s=i(194),o=i(61),r=i(5),l=i(3),d=i(64),u=i(739),c=i(8),p=i(66);t.default=a.View.extend(o.default).extend(s.default).extend({el:"#js-review-list",defaultItemsCount:20,objectType:"review",events:{"click .js-read-more":"readMoreClick","click .js-comments":"commentsClick"},initialize:function(e){this.initLikes(),this.elementsPerPage=r.isUndefined(e.itemsCount)?this.defaultItemsCount:e.itemsCount,this.elementsPerLine=1,this.video=e.video,this.loadDataParams.data={id:this.video.getId(),limit:this.elementsPerPage,page:r.isUndefined(e.page)?1:e.page},e.initWaypoint&&this.initLoadMore(),this.listenTo(d.default,"review:added",this.reset)},render:function(){var e=this,t=n("<div/>");return o.default.render.apply(this,arguments),r.each(e.collection.models,function(i){n(u.default({review:i,video:e.video,visitor:c.default,categoryTitle:p.default.getGen(e.video.getCategoryHru())})).appendTo(t)}),e.$el.append(t.html()),e.afterRender(),this.$el},reset:function(){this.$el.html(""),this.loadDataParams.data.page=1,this.loadData(this.collection)},incrementFromTo:function(){this.loadDataParams.data.page++},getWayPoint:function(){var e=this.$el.find("li"),t=e.length-this.elementsPerLine*(this.elementsPerPage/this.elementsPerLine-6);return e.get(t)},readMoreClick:function(e){var t=n(e.target),i=t.closest(".js-reviews-item");l.default.track("review_see_more",{review_id:i.data("id")})},commentsClick:function(e){var t=n(e.target),i=t.closest(".js-reviews-item");l.default.track("review_see_comments",{review_id:i.data("id")})}})},function(e,t,i){var n=i(0),a=i(5);t.default=n.View.extend({el:"player",data:null,initialize:function(){this.data=this.$el.length?JSON.parse(this.$el.data("info").replace(/'/g,'"')):{}},getParam:function(e,t){return void 0===t&&(t=""),void 0!==this.data[e]?this.data[e]:t},isPaid:function(){return this.getParam("isPaid")},isUsedToBePaid:function(){return this.getParam("isUsedToBePaid")},isAutoStart:function(){return this.getParam("autoStart")},isResume:function(){return this.getParam("resume")},getType:function(){return this.getParam("type")},getAppVersion:function(){return this.getParam("app_version")},getPlayerAppVersion:function(){return this.getParam("playerAppVersion")},getPlayerForceHtml5:function(){return this.getParam("playerForceHtml5")},getContentType:function(){return this.getParam("contentType")},getContentId:function(){return this.getParam("contentId")},getTrailerId:function(){return this.getParam("trailerId")},getPosterPath:function(){return this.getParam("poster")},getStart:function(){return this.getParam("start")},getFinish:function(){return this.getParam("finish")},getDisableIviRedirect:function(){return this.getParam("disableIviRedirect")},isB2C:function(){return this.getParam("isB2C")},getAllowSeriesPlaylist:function(){return this.getParam("allowSeriesPlaylist")},getHostname:function(){return this.getParam("hostname")||""},getReferer:function(){return this.getParam("referer")||""},isFake:function(){return this.getParam("isFake")},isUnsupportedBrowser:function(){return!!this.getParam("isUnsupportedBrowser")},isDRMOnly:function(){return!!this.getParam("isDRMOnly")},getAdvNumberOfAttempts:function(){var e=this.getParam("advNumberOfAttempts");return a.isString(e)?null:e},getAdvWaitTime:function(){var e=this.getParam("advWaitTime");return a.isString(e)?null:e},getAdvRequestWaitTime:function(){var e=this.getParam("advRequestWaitTime");return a.isString(e)?null:e},getAdvShowWaitTime:function(){var e=this.getParam("advShowWaitTime");return a.isString(e)?null:e},isEmbeded:function(){return this.getParam("isEmbeded")},skipSplash:function(){return this.getParam("skipSplash")||!1},getCategoryHru:function(){return this.getParam("categoryHru")},getGenreHru:function(){return this.getParam("genreHru")},isBought:function(){return this.getParam("isBought")},isPostbackDisable:function(){return this.getParam("postbackDisable")||!1},isHsCursorSound:function(){return this.getParam("hsCursorSound")||!1},isHsPostMessage:function(){return this.getParam("hsPostMessage")||!1},isHsHideAnnouncement:function(){return!!this.getParam("hsHideAnnouncement")},getHsSkipBlockSeconds:function(){return this.getParam("hsSkipBlockSeconds")?parseInt(this.getParam("hsSkipBlockSeconds"),10):0},isContentDisable:function(){return this.getParam("contentDisable")||!1},isPrepareContent:function(){return this.getParam("prepareContent",!0)},isDisableEndscreen:function(){return this.getParam("disableEndscreen",!1)},isTnsOff:function(){return this.getParam("isTnsOff")||!1},getEndscreenRatingTimer:function(){return this.getParam("endscreenRatingTimer")||null},getEndscreenNextVideoTimer:function(){return this.getParam("endscreenNextVideoTimer")||null},getEndscreenVariant:function(){return this.getParam("endscreenVariant")||null},getSeriesEndscreenVariant:function(){return this.getParam("seriesEndscreenVariant")||null},getPxAuditLinks:function(){return this.getParam("pxAuditLinks")||{}},isHideRecommendations:function(){return!!this.getParam("hideRecommendations")||!1},isHideFavouriteButton:function(){return!!this.getParam("hideFavouriteButton")},isHideSubscriptionQuality:function(){return!!this.getParam("hideSubscriptionQuality")},getWeboramaDmpUrl:function(){return this.getParam("weboramaDmpUrl")||""},getDirectAdAtLastRequestEnabled:function(){return!!this.getParam("directAdAtLastRequestEnabled")},getDirectAdBeforeTimeoutInterval:function(){return parseInt(this.getParam("directAdBeforeTimeoutInterval"),10)||0},isBrainientSdk:function(){return!!this.getParam("useBrainientSdk")},isPlayerIviLogoNotClickable:function(){return!!this.getParam("playerIviLogoNotClickable")}})},function(e,t,i){var n=i(67),a=i(103),s=i(40);t.default=n.default.extend(a.default).extend({uri:"/user/favourites/v5/",model:s.default,selectionPrefix:"favoriteList",sendUserABBucket:!0,requestParams:{},getVideoList:function(){return this.models},getLimitedFavorites:function(e){return this.models.slice(0,e)},buildRequestParams:function(e){var t=n.default.prototype.buildRequestParams.call(this,e);return t.data||(t.data={}),t.data.showunavailable=1,t},deleteFromList:function(e){var t=this.findWhere({id:e.objectId});return void 0!==t&&(this.remove(t),!0)}})},function(e,t,i){var n=i(1),a=i(5),s=i(0),o=i(8),r=i(7),l=i(60),d=i(28),u=i(4),c=i(18),p=i(11);t.default=s.View.extend({el:".subscription-pack",events:{"click .js-buy":"buyClick"},subscriptionPurchaseOptions:null,subscriptionPurchaseOptionsList:null,redirectUrl:null,productIdentifier:null,url:null,paramsInUrl:{from:"from",redirectUrl:"redirect_url",landingFrom:"landing_from"},initialize:function(e){void 0===e&&(e={}),this.redirectUrl=e.redirectUrl||"/plus",this.from=e.from||"svod_period",this.landingFrom=e.landingFrom,this.subscriptionPurchaseOptions=new l.default},requestSubscriptionPurchaseOptionsList:function(){var e=this;this.subscriptionPurchaseOptions.fetchOptions().done(function(){e.subscriptionPurchaseOptionsList=e.subscriptionPurchaseOptions.getPurchaseOptionList()})},setSubscriptionPurchaseOptionsList:function(e){this.subscriptionPurchaseOptionsList=e},buyClick:function(e){var t=this,i=n(e.currentTarget);if(e.currentTarget.href=this.getUrlWithParams(e.currentTarget.href,this.paramsInUrl),null!==this.subscriptionPurchaseOptionsList){var a=this.subscriptionPurchaseOptionsList.findProduct(i.data("option-hash"));if(a&&o.default.purchasePersonal(a,i.attr("href"),this.redirectUrl))return void e.preventDefault()}!o.default.isAuthenticated()&&c.default.showAuthBeforePurchase()&&(e.preventDefault(),this.redirectUrl=e.currentTarget.href,this.productIdentifier=n(e.currentTarget).data("product-identifier"),r.default.trigger("auth:showLoginModal:beforePurchase"),this.listenTo(r.default,"loadUser",this.processPurchaseAfterLogin),this.listenTo(r.default,"auth:modal:closed",function(){t.stopListening(r.default,"loadUser",t.processPurchaseAfterLogin)}))},callbackForPurchasedAfterLogin:function(){u.default.getLocation().reload()},processPurchaseAfterLogin:function(){var e={redirectUrl:this.redirectUrl,productIdentifier:this.productIdentifier,callbackForPurchasedState:this.callbackForPurchasedAfterLogin,alwaysRedirectToPayment:!0,subscriptionPurchaseOptions:this.subscriptionPurchaseOptions};p.default.trigger("buy:processSubscriptionPurchaseAfterLogin",e)},getUrlWithParams:function(e,t){var i=this;return e?a.reduce(t,function(e,t,n){return d.default.urlHasParam(e,t)?e:d.default.addParamsToUrl(e,(a={},a[t]=i[n],a));var a},e):""}})},function(e,t){t.default={bindThis:function(e,t,i){var n=i.value;if("function"!=typeof n)throw new Error("@bindThis decorator can only be applied to methods not: "+typeof n);var a=!1;return{configurable:!0,get:function(){if(a||this===e.prototype||this.hasOwnProperty(t)||"function"!=typeof n)return n;var i=n.bind(this);return a=!0,Object.defineProperty(this,t,{configurable:!0,get:function(){return i},set:function(e){n=e,delete this[t]}}),a=!1,i},set:function(e){n=e}}}}},function(e,t,i){var n=i(16),a=i(229),s=i(55);t.default=a.default.extend({openEvent:"trailers:showEroticModal",modalId:"js-trailer-18-plus-player",confirmRedirect:function(){var e=this.eventParams&&this.eventParams.trailerId?this.eventParams.trailerId:null;e?(this.triggerCancel(),s.default.trigger("trailers:18plus:answer",!0,e)):(s.default.trigger("trailers:18plus:answer",!0),this.triggerCancel())},denyRedirect:function(){this.closeModal(),s.default.trigger("trailers:18plus:answer",!1)},beforeCancel:function(){n.default.prototype.beforeCancel.call(this),s.default.trigger("trailers:18plus:answer",!1)}})},function(e,t,i){var n=i(1),a=i(0),s=i(74),o=i(3),r=i(55);t.default=a.View.extend({el:".js-trailers-list",events:{"click .item-content-wrapper > .image":"openPlayer"},initialize:function(){this.eroticModalModel=new s.default,this.listenTo(r.default,"trailers:18plus:answer",this.processAdultModalAnswer)},openPlayer:function(e){var t=n(e.currentTarget),i=t.data("trailer-id");return o.default.setBlockId(t.closest(".gallery").data("block-id")),parseInt(t.find(".age-limit").data("value"),10)>=this.eroticModalModel.ageLimit&&!this.eroticModalModel.canWatchAdultContent()?r.default.trigger("trailers:showEroticModal",{trailerId:i}):this.triggerPlayerOpen(i),!1},processAdultModalAnswer:function(e,t){e&&t&&(this.eroticModalModel.allowToWatchAdultContent(),this.triggerPlayerOpen(t))},triggerPlayerOpen:function(e){r.default.trigger("trailers:player:open",{trailerId:e})}})},function(e,t,i){var n=i(1),a=i(357),s=i(137),o=function(){var e=function(){s.default.trigger("scroll")};this.createElement=function(e,t){return new a.default(e,t)},n(window).scroll(e)};t.default=new o},function(e,t,i){var n=i(139);t.default=n.default.extend({GET_REQUEST_URI:"/billing/v2/balance",POST_REQUEST_URI:"/billing/v1/balance",initialize:function(){n.default.prototype.initialize.apply(this,arguments),this.uri=this.GET_REQUEST_URI},mapiPost:function(){this.uri=this.POST_REQUEST_URI;var e=n.default.prototype.mapiPost.apply(this,arguments);return this.uri=this.GET_REQUEST_URI,e},getCurrency:function(){return this.get("currency")},getBalance:function(){return parseFloat(this.get("balance"))}})},function(e,t,i){var n=i(207),a=i(5),s=i(10),o=i(7),r=i(3),l=i(65),d=i(18);t.default={uri:"",prefix:s.default.mapi.url,invalidSessionCodeError:118,invalidSessionMessageError:"unauthorized",unconfirmedEmailMessageError:"action is forbidden",checkInvalidSessionMessage:!1,sendUserABBucket:!1,count:0,url:function(){var e=this.uriAddition?this.uriAddition:"",t=a.isFunction(this.uri)?this.uri()+e:this.uri+e;return this.buildUrl(t,this.protocol)},buildUrl:function(e){return this.prefix+e},buildParams:function(e){return e=e||{},e.data=e.data||{},e.data=a.extend(e.data,s.default.mapi.params),l.default.get()&&(e.data.session=l.default.get()),e},mapiGet:function(e,t,i){void 0===t&&(t=null),void 0===i&&(i=!0);var n=this.buildParams(this.buildRequestParams(e));return n.data.subsite&&delete n.data.subsite,t&&(n.data.app_version=t),i||delete n.data.session,this.fetch(n).done(this.handleSessionError.bind(this))},mapiPost:function(e,t,i){return void 0===t&&(t=null),void 0===i&&(i=!0),e=this.buildRequestParams(e),e.method="POST",this.mapiGet(e,t,i)},processMapiPost:function(e,t,i,n,a){var s=this,o=a||this.uri;return this.mapiPost({data:e,uri:o}).done(function(e){s.handleMapiPostResult(t,i,n,e)}).fail(this.raiseGeneralError)},handleMapiPostResult:function(e,t,i,n){var a=this;n&&n.error?e.trigger(t+":set"+i+"Error",n.error.code):a.mapiGet().done(function(n){n.error||e.trigger(t+":set"+i+"Success")}).fail(function(i){a.raiseGeneralError(i,e,t)})},raiseGeneralError:function(e,t,i){t.trigger(i+":generalConnectionError",e.status)},buildRequestParams:function(e){if(e=e||{},e.data=e.data||{},e.uri&&(e.url=this.buildUrl(a.isFunction(e.uri)?e.uri():e.uri,e.protocol)),!e.data.fields&&this.fields&&(e.data.fields=this.fields),this.sendUserABBucket){var t=d.default.getUserBucket();t&&(e.data.user_ab_bucket=t)}return this.requestParams&&a.extend(e.data,this.requestParams),e},parse:function(e){return e.count&&(this.count=e.count),e.result},addParamsToUri:function(e){this.uriAddition?this.uriAddition+="&"+e:this.uriAddition="?"+e},resetAdditionUriParam:function(){this.uriAddition=""},setUriParams:function(e){var t=this;this.resetAdditionUriParam(),a.each(e,function(e,i){a.isString(e)&&-1!==e.indexOf(",")?a.each(e.split(","),function(e){t.addParamsToUri(i+"="+e)}):e&&t.addParamsToUri(i+"="+e)})},handleSessionError:function(e){if(e.error&&e.error.code===this.invalidSessionCodeError){if(this.checkInvalidSessionMessage&&e.error.message!==this.invalidSessionMessageError)return;r.default.track("invalid_session"),n.prototype.disallowManyModal(),l.default.expire(),o.default.trigger("auth:showInvalidSessionModal")}}}},function(e,t){e.exports=Backbone.Modal},function(e,t,i){var n=i(0),a=i(106),s=i(5);t.default=n.Collection.extend({model:a.default,findProduct:function(e){return this.findWhere({option_hash:e})},getContentOptionsGroupedByOwnershipType:function(){return this.groupByOwnershipType(this.getContentOptions())},getSeasonOptionsGroupedByOwnershipType:function(){return this.groupByOwnershipType(this.getSeasonOptions())},getCollectionOptionsGroupedByOwnershipType:function(){return this.groupByOwnershipType(this.getCollectionOptions())},groupByOwnershipType:function(e){var t=s.chain(e).groupBy(function(e){return e.getOwnershipType()}).value(),i={},a=function(e,t){return e=parseInt(e.get("price")),t=parseInt(t.get("price")),e<t?1:e>t?-1:0};if(t.eternal){var o=new n.Collection(t.eternal);o.comparator=a,o.sort(),i.eternal=o.models}if(t.temporal){var r=new n.Collection(t.temporal);r.comparator=a,r.sort(),i.temporal=r.models}return i},getByProductIdentifier:function(e){return this.findWhere({product_identifier:e})},getEstOptions:function(){return this.filter(function(e){return e.isEternalBought()})},getContentOptions:function(){return this.filter(function(e){return e.isContent()})},getSeasonOptions:function(){return this.filter(function(e){return e.isSeason()})},getCollectionOptions:function(){return this.filter(function(e){return e.isCollection()})},getSubscriptionOptions:function(){return this.filter(function(e){return e.isSubscription()})},getStandardSubscription:function(){return this.findWhere({object_type:"subscription",trial:!1,duration:a.default.prototype.STANDARD_SUBSCRIPTION_DURATION})},getRightTypeForGroot:function(){var e={},t="collection";return this.each(function(i){t="collection"!==i.get("object_type")?i.get("object_type"):t,s.extend(e,i.getGrootParams())}),e.object_type=t,e},getMaxEstDiscount:function(){var e=[];return this.getEstOptions().forEach(function(t){e.push(t.getDiscountOnCheapestPrice())}),Math.max.apply(Math,e)},getContentMinPrice:function(){return Math.min.apply(Math,this.getContentOptions().map(function(e){return e.getMinPrice()}))},getContentMinUserPrice:function(){return Math.min.apply(Math,this.getContentOptions().map(function(e){return e.getMinUserPrice()}))}})},function(e,t,i){var n=i(0),a=i(66),s=i(4);t.default=n.View.extend({el:".js-timer",timerAvailabilityPeriod:null,timerData:{days:0,hours:0,minutes:0,seconds:0},timerInterval:null,render:function(){var e=this;this.$el.length>0&&(Object.keys(this.timerData).forEach(function(t){e.timerData[t]=e.$el.data(t)}),this.setBigCircleData("seconds",60),this.setBigCircleData("minutes",60),this.setBigCircleData("hours",24),this.timerInterval=setInterval(this.updateTimer.bind(this),1e3))},updateTimer:function(){if(--this.timerData.seconds<0){if(this.timerData.seconds=59,--this.timerData.minutes<0){if(this.timerData.minutes=59,--this.timerData.hours<0){if(this.timerData.hours=23,--this.timerData.days<0)return clearInterval(this.timerInterval),void s.default.reload();this.updateData("days")}this.updateData("hours"),this.updateDaysCircle()}this.updateData("minutes")}this.updateData("seconds")},updateData:function(e){var t=String(this.timerData[e]);this.$el.find(".js-timer-"+e+"-value").text(this.timerData[e]<10?"0"+t:t),this.$el.find(".js-timer-"+e+"-unit").text(a.default[e](this.timerData[e]))},setBigCircleData:function(e,t){var i=360-360/t*this.timerData[e];this.$el.find(".js-timer-"+e+"-circle").css({"-webkit-transform":"rotate("+i+"deg)","-o-transform":"rotate("+i+"deg)",transform:"rotate("+i+"deg)"})},updateDaysCircle:function(){var e=this.$el.find(".js-timer-days-circle"),t=parseInt(e.attr("stroke-dasharray"),10),i=2*t-t/(24*this.timerAvailabilityPeriod)*(24*this.timerAvailabilityPeriod-(24*this.timerData.days+this.timerData.hours));e.attr("stroke-dashoffset",i)},setTimerAvailabilityPeriod:function(e){this.timerAvailabilityPeriod=e},clearInterval:function(){clearInterval(this.timerInterval)}})},function(e,t,i){var n=i(14),a=i(141),s=i(11),o=i(3);t.default=n.default.extend({subscriptionObjectType:"subscription",uri:"/billing/v1/purchases/",infoUri:"/billing/v1/subscription/info/",autoprolongCancelUri:"/billing/v1/purchase/autoprolong/cancel",autoprolongRenewUri:"/billing/v1/purchase/autoprolong/renew",iviPaymentType:"ivi",cardPaymentType:"card",smsPaymentType:"sms",certificatePaymentType:"certificate",androidPaymentType:"android",iosPaymentType:"ios",autoprolongRenewAction:"renew",autoprolongCancelAction:"cancel",maxBillingConnectionsRepeat:4,billingConnectionsRepeatInterval:3e3,renewDisableSuccessGrootEvent:"sub_cancel_popup_success",parse:function(e){var t=n.default.prototype.parse.call(this,e);return t?t.length?t[0]:t:{}},fetchSubscriptionInfo:function(){var e={uri:this.infoUri};return n.default.prototype.mapiGet.call(this,e)},mapiGet:function(e){return void 0===e&&(e={}),e.data||(e.data={}),e.data.object_type=this.subscriptionObjectType,n.default.prototype.mapiGet.call(this,e)},getRebillingSubscription:function(){return this.mapiGet({data:{show_overdue_renewables:1}})},hasSubscription:function(){return!!this.get("id")&&!this.isExpired()},hasExpiredSubscription:function(){return!!this.get("id")&&this.isExpired()},checkPaymentType:function(e){var t=this.get("payment_info");return t&&t.ps_method.toLowerCase()===e},isIviPayment:function(){return this.checkPaymentType(this.iviPaymentType)},isCardPayment:function(){return this.checkPaymentType(this.cardPaymentType)},isSMSPayment:function(){return this.checkPaymentType(this.smsPaymentType)},isCertificatePayment:function(){return this.checkPaymentType(this.certificatePaymentType)},isCertificatePaymentWithCard:function(){return this.isCertificatePayment()&&!!this.getAccountId()},isCertificatePaymentWithoutCard:function(){return this.isCertificatePayment()&&!this.getAccountId()},isAndroidPayment:function(){return this.checkPaymentType(this.androidPaymentType)},isIOSPayment:function(){return this.checkPaymentType(this.iosPaymentType)},isTrialSubscription:function(){return!!this.get("trial_id")},isTrialActive:function(){return!!this.get("is_trial_active")},isRenewEnabled:function(){return this.get("renew_enabled")},getNextRenewalTryTime:function(){return this.get("next_renewal_try_time")?new Date(this.get("next_renewal_try_time")):null},getRenewalPrice:function(){return this.get("renewal_price")},getSubscriptionExpireDate:function(){return this.get("finish_time")?new Date(this.get("finish_time")):null},getSubscriptionStartDate:function(){return this.get("start_time")?new Date(this.get("start_time")):null},getPaymentDisplayName:function(){var e=this.get("payment_info");return e&&e.ps_display_name?e.ps_display_name:""},disableRenew:function(){var e=this.get("id");e&&this.mapiPost({data:{id:e},uri:this.autoprolongCancelUri}).done(this.checkDisableRenewResult.bind(this))},enableRenew:function(){var e=this.get("id");e&&this.mapiPost({data:{id:e},uri:this.autoprolongRenewUri}).done(this.checkEnableRenewResult.bind(this))},checkDisableRenewResult:function(){var e=this,t=this.maxBillingConnectionsRepeat,i=setInterval(function(){e.hasSubscription()&&t&&e.isRenewEnabled()?(--t,e.clear(),e.mapiGet()):(clearInterval(i),e.isRenewEnabled()?s.default.trigger("billing:setAutoprolongError",e.autoprolongCancelAction):(o.default.track(e.renewDisableSuccessGrootEvent),s.default.trigger("billing:setAutoprolongSuccess",e.autoprolongCancelAction)))},1e3)},checkEnableRenewResult:function(){var e=this,t=this.maxBillingConnectionsRepeat,i=setInterval(function(){e.hasSubscription()&&t&&!e.isRenewEnabled()?(--t,e.clear(),e.mapiGet()):(clearInterval(i),e.isRenewEnabled()?s.default.trigger("billing:setAutoprolongSuccess",e.autoprolongRenewAction):s.default.trigger("billing:setAutoprolongError",e.autoprolongRenewAction))},1e3)},getAccountId:function(){var e=this.get("payment_info");return e?e.account_id:null},getTitle:function(){var e=this.get("payment_info");return e&&e.title?e.title.replace(/^(\d{4})(\d{2})x+(\d{4})$/,"$1 $2** **** $3"):""},isCardExpiring:function(){var e=this.get("payment_info");return e&&e.expiring},isCardExpired:function(){var e=this.getCardExpiresDate();return null!==e&&e<Date.now()},getCardExpiresDate:function(){var e=this.get("payment_info");return e&&e.expires?new Date(e.expires):null},getCardBankKey:function(){var e=this.get("payment_info");return e?e.bank_key:null},getCardPsType:function(){var e=this.get("payment_info");return e?e.ps_type:null},isRebilling:function(){var e=this.getSubscriptionExpireDate(),t=this.getNextRenewalTryTime();if(e&&t){var i=new Date;return i=new Date(i.getTime()+6e4*i.getTimezoneOffset()),e=new Date(e.getTime()+6e4*e.getTimezoneOffset()),t=new Date(t.getTime()+6e4*t.getTimezoneOffset()),this.isRenewEnabled()&&e<i&&i<t}return!1},isExpired:function(){return!!this.get("expired")},getSubscriptionDurationInDays:function(){var e=this.getSubscriptionExpireDate(),t=this.getSubscriptionStartDate();return this.isTrialActive()&&e&&t?Math.floor((e-t)/864e5):this.get("renew_period_seconds")?parseInt(this.get("renew_period_seconds")/86400,10):0},getSubscriptionDurationInMonths:function(){return Math.floor(this.getSubscriptionDurationInDays()/30)},getPaymentPsAccount:function(){var e=new a.default(this.get("payment_info"));return e.set("id",this.getAccountId()),e}})},function(e,t,i){(function(e){var n=i(367),a=i(6),s=i(108),o=i(384),r=i(220),l=i(221),d=i(22),u=i(7),c=i(3),p=i(20),f=i(8),h=i(142),g=i(4),m=i(39),v=a.default.extend({reloadPagePaths:["/watch/"],reloadPageAfterLoginLogout:!0,run:function(){new s.default({model:d.default}).listen(u.default),(new r.default).listen(u.default),new l.default,(new n.default).listen(u.default),new o.default({model:f.default}).listen(u.default),d.default.autoLogin(),this.listenTo(u.default,"user:login",this.afterUserLoginLogout),this.listenTo(u.default,"user:logout",this.afterUserLoginLogout),this.listenTo(u.default,"loadUser",this.afterLoadUser),this.listenTo(u.default,"auth:setReloadPageAfterLoginLogout",this.setReloadPageAfterLoginLogout),this.listenToOnce(u.default,"autologin",this.showAuthFollowingModal)},afterLoadUser:function(){c.default.identify(f.default.get("id")),setTimeout(function(){p.default.localStorage.setItem("ivi_user_id",f.default.get("id"))},100)},afterUserLoginLogout:function(){var t=this;c.default.rewriteSuperProperties({authorizeduser:f.default.isAuthenticated()?1:0}),h.default.checkWantToWatchAfterLogin(function(){t.reloadPagePaths.some(function(e){return 0===g.default.getLocation().pathname.indexOf(e)})&&t.reloadPageAfterLoginLogout&&g.default.redirect(g.default.getLocation().pathname)}),m.default.isDefaultCurrency()||e(".js-spasibo-enter-point").hide()},showAuthFollowingModal:function(){if(this.queryParams.registration_completed)u.default.trigger("auth:registrationCompleted",this.queryParams),this.emptyQueryParams();else if(!f.default.isAuthenticated()&&this.queryParams.login_modal)this.queryParams.invalid_session?u.default.trigger("auth:showLoginModal","invalidSession"):u.default.trigger("auth:showLoginModal");else if(this.queryParams.change_password){var e={passwordChange:!0,email:f.default.getEmail()};this.queryParams.temp_password?(e.oldPassword=this.queryParams.temp_password,u.default.trigger("auth:showLoginModal",e)):this.queryParams.error&&(e.errorCode=this.queryParams.error,u.default.trigger("auth:showLoginModal",e)),this.emptyQueryParams()}},setReloadPageAfterLoginLogout:function(e){this.reloadPageAfterLoginLogout=e}});t.default=v}).call(t,i(1))},function(e,t,i){var n=i(14),a=i(22),s=i(26),o=i(8),r=i(3),l=i(50),d=i(20),u=i(4),c=n.default.extend({FAVOURITE_ADD_PATHNAME:"/favourite/v5/add",FAVOURITE_DELETE_PATHNAME:"/favourite/v5/delete",preventDoubleClick:!1,mainPromoItemClickedStorageKey:"main_promo_clicked",mainCollectionsItemClickedStorageKey:"main_collections_clicked",init:function(){var e=this;this.listenTo(s.default,"favourite:add",function(t){e.favouriteAdd(t)}),this.listenTo(s.default,"favourite:delete",function(t){e.favouriteDelete(t)}),this.listenTo(s.default,"favourite:check",function(t){e.check(t)})},favouriteAdd:function(e){var t=this;this.valid(e)&&(o.default.isIdentified()||this.preventDoubleClick?this.preventDoubleClick||this.add(this.addBlockId(e)):(this.preventDoubleClick=!0,a.default.registerProofOfWork().done(function(){t.preventDoubleClick=!1,t.add(t.addBlockId(e))})))},favouriteDelete:function(e){this.valid(e)&&this.delete(this.addBlockId(e))},addUsingSign:function(e,t){return this.sendRequestUsingSign(e,t,this.FAVOURITE_ADD_PATHNAME)},deleteUsingSign:function(e,t){return this.sendRequestUsingSign(e,t,this.FAVOURITE_DELETE_PATHNAME)},sendRequestUsingSign:function(e,t,i){return this.mapiPost({uri:"/"+e+i,data:t},t.app_version,!1)},addBlockId:function(e){var t=d.default.localStorage.getItem(this.mainPromoItemClickedStorageKey),i=d.default.localStorage.getItem(this.mainCollectionsItemClickedStorageKey),n=u.default.getPathname().indexOf(t)>=0?t:i;return(l.default.getReferrer()===u.default.getOrigin()+"/"||l.default.getReferrer().indexOf(n)>=0)&&u.default.getPathname().indexOf(n)>=0?(n===t?e.blockId="main_promo":n===i&&(e.blockId="main_collections"),r.default.rewriteSuperProperties({block_id:e.blockId})):e.blockId=r.default.getBlockId(),e},delete:function(e){return this.mapiPost({uri:"/"+e.type+this.FAVOURITE_DELETE_PATHNAME,data:{id:e.objectId}}).done(function(t){"ok"===t.result&&s.default.trigger("favourites:deleted",e)})},add:function(e){return this.mapiPost({uri:"/"+e.type+this.FAVOURITE_ADD_PATHNAME,data:{id:e.objectId}}).done(function(t){"ok"===t.result&&s.default.trigger("favourites:added",e)})},check:function(e){if(this.valid(e))return this.mapiGet({uri:"/"+e.type+"/favourite/check",data:{id:parseInt(e.objectId,10)}}).done(function(t){s.default.trigger("favourite:have",e,t.ok)})},valid:function(e){return e.objectId&&e.type}});t.FavouriteModel=c;var p=new c;t.default=p},function(e,t,i){var n=i(14),a=i(22),s=i(73),o=i(65),r=i(8),l=n.default.extend({preventDoubleClick:!1,uri:function(){return"/"+this.get("type")+"/user/rate/v5/"},parse:function(e){return n.default.prototype.parse.call(this,e),{value:e.result}},init:function(){this.listenTo(s.default,"user:grade",this.userGrade),this.listenTo(s.default,"api:user:grade",this.userGrade)},userGrade:function(e,t,i){var n=this;r.default.isIdentified()||this.preventDoubleClick?this.preventDoubleClick||this.doMapiRateRequest(e,t,i):(this.preventDoubleClick=!0,a.default.registerProofOfWork().done(function(){n.preventDoubleClick=!1,n.doMapiRateRequest(e,t,i)}))},doMapiRateRequest:function(e,t,i){this.set("type",t),this.mapiPost({data:{id:e,rate:i}}).done(function(){s.default.trigger("have:grade",e,t,i)})},getUserRating:function(e,t){var i=this;if(r.default.isFreshStoragelessSession())return void s.default.trigger("get:grade",0);var n=o.default.get();this.set("type",t),this.mapiGet({data:{id:e,session:n}}).done(function(e){var t=e.error?0:e.result;i.set("value",t),s.default.trigger("get:grade",t)})}});t.default=new l},function(e,t,i){var n=i(21),a=i(1),s=function(){function e(){this.baseUrl="",this.defaultParams={app_version:0,subsite_id:0,code_version:"",format_version:"v4",client:"web",message_category:"client",ab_tests:[],user:{ivi_id:0,is_authorized:!1,is_personalizable:!1,is_buyer:!1,is_outflow:!1,svod_active:!1,has_card:!1},app_uuid:""},this.clientEventIndex=0}return e.prototype.setBaseUrl=function(e){this.baseUrl=e},e.prototype.setDefaultParams=function(e){this.defaultParams=e},e.prototype.getWatchId=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)})},e.prototype.track=function(e,t){void 0===t&&(t={}),t={timestamp_client:1496681648e3,timestamp_server:1496681585493,client_event_index:this.clientEventIndex++,name:e,initiator:{ui_type:"tv_player",content_id:4445,epg_id:"123321"},parents:[{ui_type:"tv_player_page"}],details:{watch_id:this.getWatchId(),content_format:"MP4-SHQ"}};var i=n.__assign({},this.defaultParams,t);a.ajax({url:this.baseUrl+"/event/",type:"POST",contentType:"application/json",data:JSON.stringify(i)})},e}();t.default=new s},function(e,t,i){var n=i(0);t.default=n.Model.extend({HELP_ACTION:"/help",CANCEL_ACTION:"/cancel",getAction:function(e){var t=this,i=null;return Object.keys(this.attributes).forEach(function(n){t.attributes[n].action===e&&(i=t.attributes[n])}),i},hasAction:function(e){return null!==this.getAction(e)},getActionCaption:function(e){var t=this.getAction(e);return null!==t?t.caption:""}})},function(e,t,i){function n(e){return a.default.render('<div class="auth-password-block modal-view modal-view_start {% if isSecondStep %}modal-view_finish {% elseif isLastStep %}modal-view_end {% endif %}js-email-auth-block"> <div class="auth-password-block__grid-container"> <div class="auth-password-block__container auth-password-block__grid-container-inner"> <div class="user-badge user-badge_full-width user-badge_depicts-authorized-user"> <div class="user-badge__icon"></div> <div class="user-badge__information-type"> {{ email }} </div> </div> <h3 class="fullscreen-popup__title"> Здравствуйте <span class="fullscreen-popup__title-mark">Введите пароль, чтобы войти</span> </h3> <form id="jsEmailAuth" class="auth-password-block__form" action="#"> <div class="auth-password-block__group-fields"> <div class="ivi-textfield style_default size_large icon_password js-ivi-textfield{% if passwordInputFocused or password %} state_focused{% endif %}{% if code %} state_error tooltip{% endif %}{% if password %} state_filled{% endif %}"> <input type="password" class="ivi-textfield__input js-ivi-textfield__input js-auth-password js-password" placeholder="Пароль для входа" value="{% if password %}{{ password }}{% endif %}"{% if completed %} disabled="disabled"{% endif %} name="emailPassword"> <label class="ivi-textfield__label"> <span class="ivi-textfield__label-value">Пароль для входа</span> </label> <div class="ivi-textfield__tooltip-wrapper"> <div class="ivi-textfield__tooltip">{{ userMessage|default("") }}</div> </div> </div> <div class="auth-password-block__state-container state-container{% if completed %} auth-password-block__state_active{% endif %}"> <button type="submit" class="auth-password-block__form-button ivi-button large{% if isEmailAuthChecking %} loading{% endif %}{% if not password or isEmailAuthChecking %} disabled{% endif %}"{% if not password or isEmailAuthChecking %} disabled="disabled"{% endif %}>Продолжить</button> <div class="auth-password-block__state-wrapper"> <svg class="auth-password-block__state-icon" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="32" height="32" viewBox="0 0 32 32"> <defs> <path id="a" d="M0 0h32v32H0z"></path> </defs> <g fill="none" fill-rule="evenodd"> <path fill="#645ba3" fill-rule="nonzero" d="M8.777 9.692a1.094 1.094 0 0 1-1.437.075c-.42-.338-.456-.92-.082-1.3 1.71-1.736 3.994-2.945 6.506-3.445.55-.11 1.09.204 1.212.7.12.497-.226.988-.775 1.097-2.09.412-3.993 1.42-5.42 2.87z" mask="url(#b)"></path> <path fill="#ec174f" fill-rule="nonzero" d="M16 0c8.837 0 16 7.163 16 16s-7.163 16-16 16S0 24.837 0 16 7.163 0 16 0zm0 2C8.268 2 2 8.268 2 16s6.268 14 14 14 14-6.268 14-14S23.732 2 16 2z" mask="url(#b)"></path> <path fill="#ec174f" d="M14.43 18.53l6.903-7.23c.38-.4 1-.4 1.38 0 .382.4.382 1.046 0 1.446L15.12 20.7c-.19.2-.44.3-.69.3-.25 0-.5-.1-.69-.3l-3.454-3.615a1.057 1.057 0 0 1 0-1.447c.38-.4 1-.4 1.38 0l2.763 2.893z" mask="url(#b)"></path> </g> </svg> </div> </div> </div> </form> {% if not isOauth2Page and not isLoginByCodePage and showRecoveryPassword|default(true) %} <div class="auth-password-block__link-button js-recovery-password-link"> <a href="#" title="Нажмите, чтобы восстановить пароль"> Восстановить пароль </a> </div> {% endif %} </div> </div></div>',e)}var a=i(2);t.default=n},function(e,t,i){function n(e){return a.default.render('{# Дизейблим второй инпут с повтором пароля, если не ввели пароль или пароль не соответствует минимальным требованиям #}{% if not password or passwordError %} {% set disablePasswordRepeatInput = true %}{% else %} {% set disablePasswordRepeatInput = false %}{% endif %}{% set inputClasses = "" %}{% if passwordInputFocused or password %} {% set inputClasses = " state_focused" ~ inputClasses %}{% endif %}{# Показываем тултип с текстом ошибки, если в ответе запроса получили ошибку #}{% if code %} {% set inputClasses = " state_error tooltip" ~ inputClasses %}{% endif %}{# Если начали вводить пароль, то заполняем прогресс бар #}{% if password %} {# Если прошло 2 секунды после последнего ввода и пароль не соответствует минимальным требованиям, #} {# то показываем ошибку, иначе просто заполняем прогресс #} {% if passwordError and passwordHoldTimeReached %} {% set inputClasses = " progress-bar_warning show-error-message" ~ inputClasses %} {% else %} {% set inputClasses = " progress-bar_optimally" ~ inputClasses %} {% endif %}{% endif %}{# Дизейблим кнопку регистрации, если запрос на регистрацию был отправлен или #}{# была получена ошибка на сделанный запрос или #}{# повтор пароля не корректен (меньше/больше/не соответствует паролю) или #}{# пароль стерли и он перестал соответствовать минимальным требованиям #}{% if isEmailRegistrationChecking or code or not passwordRepeatCorrect or passwordError %} {% set disableRegistrationButton = true %}{% else %} {% set disableRegistrationButton = false %}{% endif %}{# Нужно ли показать ошибку повтора пароля #}{% if passwordRepeatError and passwordHoldTimeReached %} {% set showPasswordRepeatError = true %}{% else %} {% set showPasswordRepeatError = false %}{% endif %}<div class="auth-registration-block modal-view modal-view_start {% if isSecondStep %}modal-view_finish {% elseif isLastStep %}modal-view_end {% endif %} js-email-registration-block{% if showPasswordRepeatError %} show-password-error-message{% endif %}"> <div class="auth-registration-block__grid-container"> <div class="auth-registration-block__container auth-registration-block__grid-container-inner"> <div class="user-badge user-badge_full-width user-badge_depicts-not-authorized"> <div class="user-badge__icon"></div> <div class="user-badge__information-type"> {{ email }} </div> </div> <h3 class="fullscreen-popup__title"> {% if oldPassword %}Придумайте пароль{% else %}Вы регистрируетесь на&nbsp;ivi{% endif %} <span class="fullscreen-popup__title-mark">{% if oldPassword %}Введите новый пароль и нажмите на кнопку &laquo;Установить пароль&raquo;{% else %}Придумайте пароль для входа на всех устройствах{% endif %}</span> </h3> <form id="jsEmailRegistration" class="auth-registration-block__form" action="#"> <div class="auth-registration-block__group-fields"> <div class="ivi-textfield style_default size_large icon_password js-ivi-textfield progress-bar error-message {{ inputClasses }}{% if password %} state_filled{% endif %}"> <input type="password" class="ivi-textfield__input js-ivi-textfield__input js-password" placeholder="Придумайте пароль" value="{% if password %}{{ password }}{% endif %}" name="emailPassword"> <label class="ivi-textfield__label"> <span class="ivi-textfield__label-value">Придумайте пароль</span> </label> <div class="ivi-textfield__tooltip-wrapper"> <div class="ivi-textfield__tooltip">{{ userMessage|default("") }}</div> </div> <div class="ivi-textfield__progress-bar"> <div class="ivi-textfield__progress-line" style="width: {% if password %}{{ passwordFillingPercent }}{% else %}0{% endif %}%;"></div> </div> <div class="ivi-textfield__error-message">{{ passwordError }}</div> </div> <div class="ivi-textfield ivi-textfield_margin style_default size_large icon_password js-ivi-textfield{% if passwordRepeatInputFocused or passwordRepeat %} state_focused{% endif %}{% if code %} state_error{% endif %}{% if disablePasswordRepeatInput %} state_disabled{% endif %}{% if passwordRepeat %} state_filled{% endif %}"> <input type="password" class="ivi-textfield__input js-ivi-textfield__input js-password-repeat" placeholder="Повторите пароль" value="{% if passwordRepeat %}{{ passwordRepeat }}{% endif %}" name="emailPasswordRepeat" {% if disablePasswordRepeatInput %} disabled="disabled"{% endif %}> <label class="ivi-textfield__label"> <span class="ivi-textfield__label-value">Повторите пароль</span> </label> </div> </div> <div class="auth-registration-block__state-container state-container{% if completed %} auth-registration-block__state_active{% endif %}"> <button class="auth-registration-block__form-button ivi-button large {% if isEmailRegistrationChecking %}loading {% endif %}{% if disableRegistrationButton %}disabled{% endif %}"{% if disableRegistrationButton %} disabled="disabled"{% endif %}>{% if oldPassword %}Установить пароль{% else %}Зарегистрироваться{% endif %}</button> <div class="auth-registration-block__state-wrapper"> <svg class="auth-registration-block__state-icon" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="32" height="32" viewBox="0 0 32 32"> <defs> <path id="a" d="M0 0h32v32H0z"></path> </defs> <g fill="none" fill-rule="evenodd"> <path fill="#645ba3" fill-rule="nonzero" d="M8.777 9.692a1.094 1.094 0 0 1-1.437.075c-.42-.338-.456-.92-.082-1.3 1.71-1.736 3.994-2.945 6.506-3.445.55-.11 1.09.204 1.212.7.12.497-.226.988-.775 1.097-2.09.412-3.993 1.42-5.42 2.87z" mask="url(#b)"></path> <path fill="#ec174f" fill-rule="nonzero" d="M16 0c8.837 0 16 7.163 16 16s-7.163 16-16 16S0 24.837 0 16 7.163 0 16 0zm0 2C8.268 2 2 8.268 2 16s6.268 14 14 14 14-6.268 14-14S23.732 2 16 2z" mask="url(#b)"></path> <path fill="#ec174f" d="M14.43 18.53l6.903-7.23c.38-.4 1-.4 1.38 0 .382.4.382 1.046 0 1.446L15.12 20.7c-.19.2-.44.3-.69.3-.25 0-.5-.1-.69-.3l-3.454-3.615a1.057 1.057 0 0 1 0-1.447c.38-.4 1-.4 1.38 0l2.763 2.893z" mask="url(#b)"></path> </g> </svg> </div> </div> <div class="auth-registration-block__error-message">{% if showPasswordRepeatError %}{{ passwordRepeatError }}{% endif %}</div> </form> </div> </div></div>',e)}var a=i(2);t.default=n},function(e,t,i){function n(e){return a.default.render('<div class="auth-special-error modal-view modal-view_start {% if isErrorActionsStep %}modal-view_finish {% endif %} js-error-actions-block"> <div class="auth-special-error__grid-container"> <div class="auth-special-error__container auth-special-error__grid-container-inner"> <h3 class="fullscreen-popup__title"> Ошибка <span class="fullscreen-popup__title-mark"> {{ userMessage }} </span> </h3> <div class="auth-special-error__button-wrapper"> {% if errorActionsModel.hasAction(errorActionsModel.HELP_ACTION) %} <a href="http://ask.ivi.ru/" class="auth-special-error__button ivi-button large">{{ errorActionsModel.getActionCaption(errorActionsModel.HELP_ACTION) }}</a> {% endif %} {% if errorActionsModel.hasAction(errorActionsModel.CANCEL_ACTION) %} <button class="auth-special-error__button ivi-button outline large js-modal-close">{{ errorActionsModel.getActionCaption(errorActionsModel.CANCEL_ACTION) }}</button> {% endif %} </div> </div> </div></div>',e)}var a=i(2);t.default=n},function(e,t,i){function n(e){return a.default.render('<div class="auth-privacy-policy modal-view modal-view_start {% if isRegistrationPrivacyPolicyStep %}modal-view_finish {% endif %}js-registration-privacy-policy-block"> <div class="auth-privacy-policy__grid-container"> <div class="auth-privacy-policy__container auth-password-recovery-block__grid-container-inner"> <div class="user-badge user-badge_full-width user-badge_depicts-not-authorized"> <div class="user-badge__icon"></div> <div class="user-badge__information-type"> {{ authToken }} </div> </div> <h3 class="fullscreen-popup__title"> Вы регистрируетесь на&nbsp;ivi <span class="fullscreen-popup__title-mark"> Регистрируясь, вы соглашаетесь с нашей <a class="auth-privacy-policy__link js-privacy-policy-link" href="{% if isWorld %}https://www.ivi.ru/pages/policy/policy_world_html.html{% else %}https://www.ivi.ru/info/confidential{% endif %}" target="_blank" title="Нажмите, чтобы посмотреть политику конфиденциальности">Политикой конфиденциальности</a> и подтверждаете использование ваших данных для создания аккаунта и взаимодействия с вами </span> </h3> <div class="auth-privacy-policy__button-wrapper js-registration-privacy-policy-accept"> <button class="js-ivi-privacy-policy-button auth-privacy-policy__button ivi-button large">Продолжить</button> </div> <div class="auth-privacy-policy__mark"> <p>Вы можете получать уведомления от ivi или отказаться от них в любой момент в своём профиле</p> </div> </div> </div></div>',e)}var a=i(2);t.default=n},function(e,t,i){var n=i(16),a=i(22),s=i(7),o=i(388),r=i(8);t.default=n.default.extend({modalId:"js-auth-invalid-session",template:o.default,cancelEl:".js-modal-close",openEvent:"auth:showInvalidSessionModal",regionEnabled:!0,priorityModal:!0,open:function(e,t,i){this.opened||a.default.isUserBlocked()||(this.$el.empty(),n.default.prototype.open.call(this,e,t,i),this.opened=!0)},serializeData:function(){return{userCanAuthenticate:r.default.canAuthenticate()}},beforeCancel:function(){this.opened=!1,s.default.trigger("auth:processInvalidSession")}})},function(e,t,i){var n=i(1),a=i(0),s=i(389),o=i(22),r=i(8),l=i(10),d=i(7),u=i(26),c=i(41),p=i(390),f=i(391),h=i(4),g=i(222),m=i(80),v=i(19),_=i(3),b=i(39);t.default=a.View.extend(g.default).extend({favouritesCountModel:new s.default,favouritesCount:0,ADAPTIVE_MAX_WIDTH:1019,el:".js-menu-block",events:{"click #add-subscription":"showSubscriptionLanding","click .js-feedback-click-animation":"feedbackClickAnimation","click .js-login-btn":"showLoginModal","click .js-logout-button":"logout","click .js-login-by-code-link":"onLoginByCodeClick"},mapiInfo:null,initialize:function(){this.listenTo(u.default,"favourites:added",this.incrementFavourites),this.listenTo(u.default,"favourites:deleted",this.decrementFavourites),this.listenTo(d.default,"user:setNameSuccess",this.drawDropDownMenu),this.listenTo(d.default,"user:setEmailSuccess",this.drawDropDownMenu),this.listenTo(d.default,"isGuest",this.prepareUserDataGuest),this.listenTo(d.default,"isUser",this.prepareUserDataUser),window.ivi.adaptive.isMobile&&this.addTabletSubMenu(),this.mapiInfo=new v.default},prepareUserDataGuest:function(){var e=this;r.default.isIdentified()?this.favouritesCountModel.mapiGet().done(function(t){e.favouritesCount=t.result?t.result:0,r.default.set("favCount",e.favouritesCount),e.render()}):(this.favouritesCount=0,r.default.set("favCount",0),this.render())},prepareUserDataUser:function(){var e=this;this.favouritesCountModel.mapiGet().done(function(t){if(e.favouritesCount=t.result?t.result:0,r.default.set("favCount",e.favouritesCount),o.default.get("purchases"))e.render();else{var i=new m.default;i.mapiGet().done(function(){o.default.set("purchases",i),o.default.fillUserSubscriptionData(i,r.default),r.default.setIsBuyerCookie(i),e.render()})}})},render:function(){r.default.isAuthenticated()&&this.updateSsoToken(),this.drawDropDownMenu()},incrementFavourites:function(){this.favouritesCountUpdate(++this.favouritesCount)},decrementFavourites:function(){this.favouritesCountUpdate(--this.favouritesCount)},drawDropDownMenu:function(){var e={user:r.default,external:l.default.external,showLoginByCode:this.mapiInfo.showLoginByCode(),currentUrl:h.default.getLocation().origin+h.default.getLocation().pathname,showSubscriptionSpasiboEnterPoint:this.mapiInfo.showSubscriptionSpasiboEnterPoint()&&b.default.isDefaultCurrency()};this.$el.find(".js-auth-info").replaceWith(f.default(e)),this.$(".js-mobile-profile-block").html(p.default(e)),d.default.trigger("auth:userProfileBlockIsReady")},showSubscriptionLanding:function(){c.default.trigger("showSubscriptionLanding","quick_profile")},favouritesCountUpdate:function(e){e<=0?this.$el.find("#user-menu-favourites-count").hide():this.$el.find("#user-menu-favourites-count").show(),this.$el.find("#user-menu-favourites-count span").text(e),r.default.set("favCount",e)},tabletSubMenu:function(e){if(window.ivi.adaptive.isTablet()&&!n(e.target).closest(".top-profile__dropdown").get(0)){var t=n(".top-profile__dropdown");e.target!==n(".js-profile-link").get(0)||t.hasClass("top-profile__dropdown_active")?t.toggleClass("top-profile__dropdown_active",!1):t.toggleClass("top-profile__dropdown_active",!0)}},addTabletSubMenu:function(){n("body").on("click",this.tabletSubMenu)},logout:function(e){e.preventDefault(),o.default.logout(),n("#bottom_support_link").attr("data-token","")},showLoginModal:function(){if(d.default.trigger("auth:showLoginModal"),d.default.trigger("auth:profileBlockLoginButtonClicked"),!window.ivi.adaptive.isMobile)return!1},updateSsoToken:function(){var e=n("#bottom_support_link");if(!e.attr("data-token")){var t=l.default.external?l.default.host:"";n.ajax({url:t+"/ajax/userecho",type:"GET",dataType:"json",success:function(t){t.error||e.attr("data-token",t)}})}},onLoginByCodeClick:function(e){return _.default.track("login_code_click"),h.default.redirect(e.currentTarget.href),!1}})},function(e,t){t.default={feedbackClickAnimation:function(e){if(!window.ivi.adaptive.isMobileStyle)return!0;var t=e.target;if(t.classList.contains("animating"))return!1;t.classList.add("animating"),t.addEventListener("animationend",this.removeAnimation)},removeAnimation:function(e){if("feedbackClickAnimation"===e.animationName)return e.target.classList.remove("animating"),!0}}},function(e,t,i){var n=i(33),a=i(4);t.default=n.default.extend({sendToGABuyEvent:function(e){var t,i;(i=e.object_type?e.object_type:e.groot?e.groot.object_type:null)&&(t="subscription"===i?e.trial||e.groot&&e.groot.is_trybuy?"buy_trial":"buy_svod":"temporal"===e.ownership_type?"buy_tvod":"buy_est",a.default.pushToDataLayer({event:t}))}})},function(e,t,i){var n=i(6),a=i(397);t.default=n.default.extend({run:function(){new a.default}})},function(e,t,i){var n=i(1),a=i(111),s=i(148),o=i(398),r=i(107),l=i(67),d=i(227),u=i(6),c=i(42),p=i(3);t.default=u.default.extend({videoCount:l.default.prototype.VIDEO_COUNT,run:function(){p.default.isUserPesonalizable()&&(this.videoCount=l.default.prototype.VIDEO_PERSONALIZABLE_COUNT),this.listenTo(c.default,"loader.point:reached",this.showBlock),new o.default},showBlock:function(){var e=this,t=n(".js-collections-delimiter:first");if(t.length>0){var i=new s.default;t.nextUntil(".js-collections-delimiter").find("ul").map(function(e,t){var n=new a.default({el:t}),s=n.getPaidTypes(),o=s.shift();if(s.length)for(var l in s)o+="&paid_type="+s[l];var d=n.getGenres(),u=d.shift();if(d.length)for(var c in d)u+="&genre="+d[c];var p=new r.default({id:n.getId(),category:n.getCategory(),genre:u,paidType:o});i.add(p)}),t.remove();var u=[];i.models.forEach(function(t){var i=new l.default,n={id:t.getId(),from:0,to:e.videoCount-1,sort:"relevance",fields:l.default.prototype.COLLECTION_CATALOG_FIELDS},a=new d.default({el:"#collection-"+t.getId(),model:t});t.getCategory()&&(n.category=t.getCategory()),t.getGenre()&&i.addParamsToUri("genre="+t.getGenre()),t.getPaidType()&&i.addParamsToUri("paid_type="+t.getPaidType());var s=i.mapiGet({data:n}).done(function(e){e.error||(t.set({videos:i}),a.render(),a.show(),a.enableGallery(),a.enablePosters())});u.push(s)}),n.when.apply(n,u).done(function(){var e=n(".waypoint:first");e.parent().hasClass("hidden")&&(e=n(".js-collection-header:visible:last").addClass("waypoint")),e.length&&new o.default({el:e.get(0),className:"waypoint"})})}}})},function(e,t,i){var n=i(29),a=i(18);t.default={mapiGet:function(e){return n.default.prototype.mapiGet.call(this,e)},buildRequestParams:function(e){var t=n.default.prototype.buildRequestParams.call(this,e);if("relevance"===t.data.sort){var i=a.default.getUserBucket();i&&(t.data.user_ab_bucket=i)}return t}}},function(e,t,i){var n=i(1),a=i(0),s=i(51),o=i(228),r=i(150);t.default=a.View.extend(s.default).extend({render:function(){var e=this,t=this.$el.find(".js-collection-block");return t.html(""),this.model.get("videos").each(function(i,n){t.append(o.default({video:i,collection:e.model,loop:{index:n+1}}))}),this.$el},show:function(){this.$el.removeClass("hidden")},enableGallery:function(){var e=this.$el.find("ul");void 0!==this.model.get("videos")&&this.model.get("videos").length>5&&e.find(".control").removeClass("hidden"),this.$el.find(".carousel").addClass("js-carousel"),r.default.trigger("gallery:init",this.$el.find(".js-carousel"))},enablePosters:function(){var e=this;this.$el.find(".js-popups-block").each(function(){e.attachPosterPopup(n(this).children("li"))})}})},function(e,t,i){function n(e){return a.default.render('{% set hiddenStartIndex = hiddenStartIndex|default(6) %}{% set posterSize = currentPage == "collectionItem" ? "/234x360/" : "/172x264/" %}<li class="{% if video.isInfoVideo() or video.isPreorderable() %}info {% endif %} {% if abExperiment.useNewPriceBadges() %}{{ video.getNewPriceBadgeClasses(abExperiment.showFreeBadge(), hasSubscription) }}{% else %}{{ video.getPaidIcon() }}{% endif %}" {% if collection|default(0) %}data-collection-id="{{ collection.getId() }}"{% endif %} data-content-id="{{ video.getId() }}" data-content-type="{% if video.isCompilation() %}compilation{% else %}content{% endif %}" data-content-position="{{ loop.index }}"> <a tabindex="-1" href="{{ video.getPosterSpecificLink(hasSubscription, false) }}" class="item-content-wrapper js-collection-content{% if video.isForAdult() %} js-adult{% endif %}"> <span class="image" data-caption="{% if video.isSvod() and not video.isFake() %}{{ video.getPosterSpecificCaption(hasSubscription, false) }}{% else %}{{ video.getPosterSpecificCaption(false, false) }}{% endif %}"> <img {% if not hidden|default(false) and loop.index < hiddenStartIndex %}src={% else %}data-src={% endif %}"{{ video.getPosterPath(posterSize) }}" alt="{{ video.getTitle() }}"> <span class="age-limit" data-value="{{ video.getRestrict()|default(0) }}+"></span> {% if abExperiment.useNewPriceBadges() %} <div class="badge"> <div class="badge__content" data-badge-content="{{ video.getNewPriceBadgeTitle(abExperiment.showFreeBadge(), hasSubscription) }}"></div> </div> {% endif %} </span> <span class="title"><span>{{ video.getTitle() }}</span></span> </a> <div class="popup-wrapper-container"> <div class="popup-wrapper" data-hru="{% if video.isCompilation() %}{{ video.getHru() }}{% else %}{{ video.getId() }}{% endif %}"></div> </div></li>',e)}var a=i(2);t.default=n},function(e,t,i){var n=i(1),a=i(16),s=i(230),o=i(4);t.default=a.default.extend({template:s.default,cancelEl:".js-modal-close",openEvent:"showEroticModal",regionEnabled:!0,events:{"click #js-erotic-confirm":"confirmRedirect","click #js-erotic-deny":"denyRedirect"},mobileModal:!0,confirmRedirect:function(){var e=this.eventParams&&this.eventParams.videoFromEndScreen;this.model.allowToWatchAdultContent(),this.model.get("targetBlank")&&!e?(n(this.cancelEl).click(),o.default.open(this.model.get("href"))):e?(n(this.cancelEl).click(),this.playFromEndScreen()):o.default.redirect(this.model.get("href"))},denyRedirect:function(){this.eventParams&&this.eventParams.videoFromEndScreen?o.default.redirect("/"):n(this.cancelEl).click()}})},function(e,t,i){function n(e){return a.default.render('<div class="ivi-modal-wrapper-content adult wider"> <h1 class="ivi-modal-title">Доступ в раздел ограничен</h1> <div class="ivi-modal-content"> <div class="button-wrapper"> <span class="ivi-button large" id="js-erotic-confirm">Да, мне есть 18 лет</span> <span class="ivi-button large pale" id="js-erotic-deny">Нет, мне менее 18 лет</span> </div> <p>Нажав «Да», вы заявляете, что вам исполнилось 18 лет и эта информация является достоверной, вы предприняли все необходимые действия для ограничения доступа детей к просмотру данного фильма посредством вашего компьютера или мобильного устройства.</p> </div> <span class="ivi-modal-close js-modal-close">Закрыть</span></div>',e)}var a=i(2);t.default=n},function(e,t,i){var n=i(1),a=i(6),s=i(4);t.default=a.default.extend({facebookLink:"https://apps.facebook.com/ivi.ru?crc=833098b284dff153f0e47cba195a4bd7",vkontakteLink:"https://vk.com/iviru?crc=fa4448c13e06e69ba9e814e8743c7e2e",run:function(){var e=this;n(".js-vkontakte").click(function(t){s.default.open(e.vkontakteLink),t.preventDefault()}),n(".js-facebook").click(function(t){s.default.open(e.facebookLink),t.preventDefault()})}})},function(e,t,i){var n=i(1),a=i(6),s=i(406),o=i(51);t.default=a.default.extend(o.default).extend({run:function(){var e=this;new s.default,n(".js-popups-block").each(function(){e.attachPosterPopup(n(this).children("li"))})}})},function(e,t,i){var n=i(234),a=i(6);t.default=a.default.extend({scrollElem:".js-collection-block",run:function(e,t){(new n.default).afterInitialize(t)}})},function(e,t,i){var n=i(1),a=i(68),s=i(3);t.default=a.default.extend({afterInitialize:function(e){var t=n(e),i=t.data("collection-id");i&&(i=i.toString(),s.default.setBlockId(s.default.getBlockIds().collectionsBlockId),this.trackCollectionAction("hydra.collections.view",t),s.default.setCollectionId(i),this.storeHydraCollectionView(i))}})},function(e,t,i){var n=i(407),a=i(408),s=i(6);t.default=s.default.extend({run:function(){new a.default,new n.default}})},function(e,t,i){var n=i(21),a=i(1),s=i(0),o=i(6),r=i(36),l=i(417),d=i(418),u=i(22),c=i(7),p=i(10),f=i(41),h=i(3),g=i(8),m=i(4),v=i(28),_=i(44),b=i(420);t.default=o.default.extend({moviesMetricsSent:!1,initialize:function(){var e=new s.Model({user:g.default});"true"===this.queryParams.plus_popup&&e.set("redirectUrl",encodeURIComponent(window.location.pathname)),this.listenTo(f.default,"showSubscriptionLanding",this.showSubscriptionLanding),this.listenTo(c.default,"user:hasSubscription",this.hasSubscription),this.listenTo(c.default,"user:logout",this.logout),this.listenTo(c.default,"user:hasNotSubscription",this.hasNotSubscription),new b.default},run:function(){var e=this;new d.default,new l.default;var t=a(".js-disable-ads");t.length&&t.one("click",function(){window.ivi.adaptive.isMobile&&f.default.trigger("menu:mobile:close",{}),h.default.setBlockId("menu_button"),e.showSubscriptionLanding("top_menu")}),this.startMoviesPromo()},generateRandomNumber:function(){return(new Date).getTime()},sendNevestaCounter:function(){(new Image).src="https://ad.adriver.ru/cgi-bin/rle.cgi?sid=1&ad=612979&bt=21&bid=4853833&bn=4853833&rnd="+this.generateRandomNumber(),this.moviesGatherMetricsSent=!0},startMoviesPromo:function(){var e=this;window.ivi.adaptive.isMobileStyle?(a(".js-top-menu").click(function(){a(this).hasClass("top-menu_expanded")&&a("#movies_link").closest("li").hasClass("expanded")&&!e.moviesGatherMetricsSent?e.sendNevestaCounter():e.moviesGatherMetricsSent=!1}),a("#movies_link").click(function(){a(this).closest("li").hasClass("expanded")&&!e.moviesGatherMetricsSent?e.sendNevestaCounter():e.moviesGatherMetricsSent=!1})):(a("#movies_link").mouseenter(function(){e.moviesGatherMetricsSent||e.sendNevestaCounter()}),a("#movies_submenu").mouseleave(function(){var e=this;setTimeout(function(){a(e).is(":visible")||(e.moviesGatherMetricsSent=!1)},100)}),a("#movies_link").mouseleave(function(){var e=this;setTimeout(function(){a(e).next().is(":visible")||(e.moviesGatherMetricsSent=!1)},100)})),a("#nevesta_link").click(function(){window.open("https://ad.adriver.ru/cgi-bin/click.cgi?sid=1&ad=612979&bt=21&bid=4853833&bn=4853833&rnd="+e.generateRandomNumber())})},showSubscriptionLanding:function(e,t){g.default.isIdentified()?m.default.redirect(v.default.addParamsToUrl("/subscribe",n.__assign({},t,{from:e}))):u.default.registerProofOfWork().done(function(){m.default.redirect(v.default.addParamsToUrl("/subscribe",n.__assign({},t,{from:e})))});var i=t&&t.object_id||r.default.prototype.SUBSCRIPTION_OBJECT_ID,a=t&&t.object_type||r.default.prototype.SUBSCRIPTION_OBJECT_TYPE;_.default.viewBasket(i,a,"1")},logout:function(){a("#iviplus-button").hide(),a("body").hasClass("landing-iviplus")||(a(".js-disable-ads").css("display",""),a(".js-top-search").addClass("top-search_has-button"),a("body").data("update-subscription-class")&&a("body").toggleClass("has-subscription-button",!0)),p.default.hasSubscription=!1},hasSubscription:function(){a(".js-disable-ads").hide(),a("#iviplus-button").css("display",""),a(".js-top-search").removeClass("top-search_has-button"),a("body").data("update-subscription-class")&&a("body").toggleClass("has-subscription-button",!1),p.default.hasSubscription=!0},hasNotSubscription:function(){this.logout()}})},function(e,t,i){var n=i(0),a=i(4);t.default=n.View.extend({ADAPTIVE_MAX_WIDTH:1019,isMobile:function(){return a.default.matchMedia("(max-width: "+this.ADAPTIVE_MAX_WIDTH+"px)")}})},function(e,t,i){var n=i(6),a=i(426),s=i(427),o=i(430),r=i(431),l=i(7),d=i(433);t.default=n.default.extend({run:function(){window.ivi.adaptive.isMobileStyle||(this.countModel=new o.default,new s.default({collection:new r.default,countModel:this.countModel,readModel:new a.default}),this.listenTo(l.default,"user:login",this.startCountPolling),this.listenTo(l.default,"user:logout",this.startCountPolling),this.listenTo(d.default,"pull:get:count",this.getCount),this.startCountPolling())},startCountPolling:function(){this.countModel.startPolling()},getCount:function(){this.countModel.poll()}})},function(e,t,i){var n=i(6),a=i(160),s=i(436),o=i(437),r=i(438),l=i(447),d=i(4),u=i(10);t.default=n.default.extend({SEARCH_PAGE_PATHNAME:/^\/search\//,enablePseudoRoute:!0,ADAPTIVE_MAX_WIDTH:979,run:function(){window.ivi.adaptive.isMobile||u.default.external&&d.default.matchMedia("(max-width: "+this.ADAPTIVE_MAX_WIDTH+"px)")?this.isSearchPage()||(this.quickMobileView=new r.default):(new a.default,new l.default,new o.default,new s.default)},pseudoRouter:function(e){window.ivi.adaptive.isMobile&&!this.isSearchPage()&&("#search"===e?this.quickMobileView.showSearchForm():this.quickMobileView.hideSearchForm())},isSearchPage:function(){return this.SEARCH_PAGE_PATHNAME.test(d.default.getLocation().pathname)}})},function(e,t,i){var n=i(1),a=i(160),s=i(241),o=i(242);t.default=s.default.extend({initialize:function(){this.change(),this.formSearchFieldView=new a.default({isMobile:!0}),this.formSearchFieldView.setElement(n("#js-search-page-query")),new o.default,this.sendResultStat()},clickResult:function(){}})},function(e,t,i){var n=i(1),a=i(0),s=i(6),o=i(3),r=i(77);t.default=a.View.extend({el:".content-main",events:{"change #js-search-page-query":"change","keydown #js-search-page-query":"change","keyup #js-search-page-query":"change","click #js-search-page-query":"change","click section a":"clickResult"},initialize:function(){this.change(),this.sendResultStat()},change:function(){var e=n("#js-search-page-query").val();n("#js-search-page-button").prop("disabled",n.trim(e)?"":"disabled")},sendResultStat:function(){if(s.default.prototype.queryParams.q){var e=[];this.$el.find(".js-content-li").each(function(t,i){var a={},s=n(i);a[s.data("content-id")]="content"===s.data("content-type")?1:2,e.push(a)}),r.default.setQuery(decodeURIComponent(s.default.prototype.queryParams.q)),r.default.setResultListFromObject(e),r.default.sendAllResultsStat(r.default.refsFull)}},clickResult:function(e){r.default.sendResultChoiceStat(r.default.refsFull,n(e.target).parents(".js-content-li").data("content-position")-1),o.default.setBlockId("search_full_results")}})},function(e,t,i){var n=i(1),a=i(0),s=i(439),o=i(442),r=i(246),l=i(45),d=i(445),u=i(77),c=i(4);t.default=a.View.extend({el:"#js-result-box-search",events:{"click .js-more-results":"clickAllResults","click .js-content-result li":"clickResultChoice"},initialize:function(){this.movieListView=new s.default,this.personListView=new o.default,this.listenTo(l.default,"search:result:movieReady",this.showResult),this.listenTo(l.default,"search:result:personReady",this.showResult),this.listenTo(l.default,"hide-results",this.hide)},showResult:function(){var e="";""!==this.movieListView.$el.html()&&(e+=this.movieListView.$el.get(0).outerHTML),""!==this.personListView.$el.html()&&(e+=this.personListView.$el.get(0).outerHTML),""!==e?(e+=d.default({searchQuery:encodeURI(n("#js-search-page-query").val())}),this.$el.html(e).show()):this.$el.html(r.default()).show()},hide:function(){this.$el.hide()},clickAllResults:function(e){return u.default.sendAllResultsStat(u.default.refsQuick),c.default.redirect(e.currentTarget.querySelector("a").getAttribute("href")),!1},clickResultChoice:function(e){return u.default.sendResultChoiceStat(u.default.refsQuick,n(e.target).data("index")),c.default.redirect(e.currentTarget.querySelector("a").getAttribute("href")),!1}})},function(e,t,i){var n=i(244),a=i(40);t.default=n.default.extend({uri:"/search/v5/?fields=title,id,year,years,poster_originals,used_to_be_paid,country,hru,additional_data,preorderable,content_paid_types,drm_only,compilation_hru,available_in_countries,fake,restrict,kind,episodes&fake=1&withpreorderable=1",model:a.default})},function(e,t,i){var n=i(29),a=i(45),s=i(77);t.default=n.default.extend({to:2,initialize:function(){this.listenTo(a.default,"search-query",this.fill),a.default.trigger("search:model:ready")},fill:function(e){s.default.setQuery(e),this.mapiGet({reset:!0,data:{query:e,from:0,to:this.to}})}})},function(e,t,i){var n=i(443),a=i(244);t.default=a.default.extend({uri:"/persons/search/v5/?fields=name,id,hru,is_temporary&withpreorderable=1",model:n.default})},function(e,t,i){function n(e){return a.default.render('\x3c!-- Результаты поиска в шапке: ничего не найдено --\x3e<div class="top-search__no-results"> <p>К сожалению, по введенному вами запросу ничего не найдено.</p> <p>Попробуйте ввести другой запрос.</p></div>',e)}var a=i(2);t.default=n},function(e,t,i){var n=i(6),a=i(453);t.default=n.default.extend({run:function(){new a.default}})},function(e,t,i){var n=i(455),a=i(33),s=i(456),o=i(250);t.default=a.default.extend({supportContactsModel:null,initialize:function(){this.supportContactsModel=new s.default,this.supportView=new o.default,this.buyerSupportPhoneView=new n.default},afterLogin:function(){this.supportContactsModel.requestSupportPhone()}})},function(e,t,i){function n(e){return a.default.render('{# &#8209; - неразрывный дефис #}<div class="phone">Круглосуточная поддержка: {% if isMobile %} <a href="tel:{{ phone|replace({"-":""}) }}" rel="nofollow">{{ phone|replace({"-":"&#8209;"}) }}</a> {% else %} <span>{{ phone|replace({"-":"&#8209;"}) }}</span> {% endif %}</div>',e)}var a=i(2);t.default=n},function(e,t,i){var n=i(1),a=i(0),s=i(10),o=i(91),r=i(249),l=i(28),d=i(4);t.default=a.View.extend({el:".js-footer",supportSite:"https://ivi.userecho.com/",worldSupportSite:"https://ivi.userecho.com/forums/6-mezhdunarodnaya-versiya/?category=0",events:{"click #bottom_support_link":"supportLinkClick"},initialize:function(){this.listenToOnce(o.default,"support:phoneLoaded",this.placeSupportPhone)},placeSupportPhone:function(e){s.default.isWorld?this.$el.find(".js-user-support-phone").html(r.default({phone:e})):this.$el.find(".js-user-support-phone").html(e),this.$el.find(".js-user-support-phone").parent().css("display",""),window.ivi.adaptive.isMobile&&this.$el.find(".js-user-support-phone").attr("href","tel:"+e)},supportLinkClick:function(e){var t=n(e.target),i=t.attr("data-token"),a=s.default.isWorld?this.worldSupportSite:this.supportSite;d.default.open(l.default.addParamsToUrl(a,{sso_token:i,show_feedback_form_private:!!t.attr("data-show-form")&&"true"})),e.preventDefault()}})},function(e,t,i){var n=i(0),a=i(478);t.default=n.View.extend({el:"#js-pay-content",render:function(){this.$el.html(a.default())}})},function(e,t,i){var n=i(1),a=i(0),s=i(6),o=i(5),r=i(11),l=i(3),d=i(4);t.default=a.View.extend({el:"#js-pay-block",events:{"click .js-pay-reload":"reload","click .js-ps-method":"click"},initialize:function(){this.listenTo(r.default,"payment:show",this.show),this.listenTo(r.default,"payment:option:select",this.setActive)},click:function(e){var t=n(e.target).parents("li"),i=t.data("method"),a=n("#"+i);return!a.prop("checked")&&!a.prop("disabled")&&(r.default.trigger("payment:option:select",i),"card"===i&&n(".pay-menu").prop("disabled","disabled"),!0)},reload:function(){d.default.reload()},show:function(e,t){void 0===t&&(t=!1),this.paymentOptionList=e;var i=this.getAvailableMethod();if(i){var n=e.getByPsMethod(i);if(n.length>0){var a=o.first(n).get("groot");a||(a={});var d=s.default.prototype.queryParams;d.from&&(a.from=d.from),d.landing_from&&(a.landing_from=d.landing_from),l.default.track("payment_form_open",a),r.default.trigger("payment:payment_groot_params_ready",a)}r.default.trigger("payment:option:select",t?"spasibo":i,!0)}},getAvailableMethod:function(){var e;return n("#card").length?e="card":n("#sms").length&&(e="sms"),e},setActive:function(e){n(".pay-block").removeClass("error"),n("#"+e).prop("checked",!0)}})},function(e,t,i){var n=i(21),a=i(254),s=i(10),o=i(20),r=i(255),l=i(80),d=i(210),u=i(19),c=i(3),p=i(11),f=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.showModalInterval=null,t.purchaseList=null,t.rebillingSubscription=null,t}return n.__extends(t,e),t.prototype.getTrialType=function(){return"trialforbuyers"},t.prototype.prepare=function(t,i){e.prototype.prepare.call(this,t,i),t.purchaseList||(t.purchaseList=new l.default,i.push(t.purchaseList.mapiGet())),t.rebillingSubscription||(t.rebillingSubscription=new d.default,s.default.hasSubscription||i.push(t.rebillingSubscription.getRebillingSubscription())),this.purchaseList=t.purchaseList,this.rebillingSubscription=t.rebillingSubscription,this.prepareView()},t.prototype.loadMapiParams=function(){var e=new u.default;this.showModalInterval=e.getTrialForBuyersPopupShowInterval(),this.certificateDuration=e.getTrialForBuyersDuration(),e.isTrialForBuyersActive()&&(this.certificateKey="trial_for_buyers")},t.prototype.prepareView=function(){new r.default({model:this}).listen(p.default)},t.prototype.execute=function(t){if(t.purchase){var i=this.purchaseList.findWhere({id:t.purchase.get("purchase_id")});if(this.check(i))return p.default.trigger("billing:longTrial:modal",{redirectUrl:t.redirectUrl,grootParams:t.grootParams,grootPageOnClose:c.default.getSuperProperty("page")}),o.default.setLongTrialModalShowTime(Date.now()),c.default.rewriteSuperProperties({page:this.getTrialType()}),c.default.track("page_view",t.grootParams),!0}return e.prototype.execute.call(this,t)},t.prototype.check=function(e){if(e&&!s.default.hasSubscription&&!this.rebillingSubscription.hasSubscription()){return"content"===e.getObjectType()&&e.isPaidByCard()&&this.isCertificateCanBeActivated&&this.canShowModal()}return!1},t.prototype.canShowModal=function(){var e=this.getLastModalShowTime();return null!==this.showModalInterval&&null!==this.certificateKey&&(!e||Date.now()>e+1e3*this.showModalInterval)},t.prototype.getLastModalShowTime=function(){return o.default.getLongTrialModalShowTime()},t}(a.default);t.default=f},function(e,t){var i=function(){function e(){this.next=null,this.certificateModel=null,this.certificateKey=null,this.certificateDuration="",this.isCertificateCanBeActivated=!1}return e.prototype.setNext=function(e){this.next=e},e.prototype.getNext=function(){return this.next},e.prototype.loadMapiParams=function(){},e.prototype.prepare=function(e,t){var i=this;this.certificateModel=e.certificate,this.loadMapiParams(),this.certificateKey&&t.push(this.certificateModel.check(this.certificateKey).done(function(e){i.isCertificateCanBeActivated="ok"===e.result}))},e.prototype.getCertificateModel=function(){return this.certificateModel},e.prototype.getCertificateKey=function(){return this.certificateKey},e.prototype.getCertificateDuration=function(){return this.certificateDuration},e.prototype.getPurchaseList=function(){return this.purchaseList},e.prototype.execute=function(e){return null!==this.next&&this.next.execute(e)},e}();t.default=i},function(e,t,i){var n=i(16),a=i(8),s=i(4),o=i(3),r=i(482),l=i(483);t.default=n.default.extend({modalId:"js-long-trial",template:r.default,openEvent:"billing:longTrial:modal",regionEnabled:!0,mobileModal:!0,events:{"click .js-activate":"activate","click .js-cancel":"cancel","click .js-close":"exit"},activate:function(){var e=this;o.default.track(this.model.getTrialType()+"_ok",this.eventParams.grootParams),this.$el.find(".js-activate").addClass("disabled loading"),this.model.getCertificateModel().activate(this.model.getCertificateKey()).done(function(){switch(e.model.getCertificateModel().get("status")){case"success":var t=e.model.getPurchaseList();t.mapiGet().done(function(){t.createSubscriptionPurchaseObject().hasSubscription()?(o.default.rewriteSuperProperties({page:e.model.getTrialType()+"_success"}),o.default.track("popup_show",e.eventParams.grootParams),e.template=l.default,e.render()):e.fail()});break;default:e.fail()}})},serializeData:function(){var e={duration:this.model.getCertificateDuration(),type:this.model.getTrialType()};return this.template===l.default&&(e.subscriptionPurchase=this.model.getPurchaseList().createSubscriptionPurchaseObject()),e},fail:function(){this.model.getCertificateModel().setCertificateKeyInStorage(this.model.getCertificateKey()),s.default.redirect("/cert")},cancel:function(){o.default.track(this.model.getTrialType()+"_cancel",this.eventParams.grootParams),this.exit()},exit:function(){return o.default.rewriteSuperProperties({page:this.eventParams.grootPageOnClose}),a.default.isAuthenticated()?s.default.redirect(this.eventParams.redirectUrl):this.trigger("modal:destroy"),!1}})},function(e,t,i){var n=i(5),a=i(36);t.default=a.default.extend({uri:"/billing/v1/purchase/collection/options/",getPriceForQuality:function(e){var t=n.find(this.get("purchase_options"),function(t){return t.quality===e});return t&&parseFloat(t.price)}})},function(e,t,i){function n(e){return a.default.render('{% set cardTitle = "Банковская карта" %}{% if subscriptionSpasiboPaymentCapability|default(false) and isMobile %} {% set cardTitle = "Карта" %}{% endif %}{% set smsTitle = "Оплатить по SMS" %}{% if isMobile %} {% set smsTitle = "SMS" %}{% endif %}<div class="pay-header js-pay-header"> <ul id="form-nav" class="nav"> <li class="nav-card{% if not isCardAvailable %} disabled{% endif %}" data-method="card"> <label for="card" class="js-ps-method"> {{ cardTitle }} </label> </li> {# на длиных подписках нет смс оплаты #} {% if not isLongSubscription %} <li class="nav-sms{% if not isSmsAvailable %} disabled{% endif %}" data-method="sms"> <label for="sms" class="js-ps-method"> {{ smsTitle }} </label> </li> {% endif %} {% if subscriptionSpasiboPaymentCapability|default(false) %} <li class="nav-spasibo{% if not isSpasiboAvailable %} disabled{% endif %}" data-method="spasibo"> <label for="spasibo" class="js-ps-method"> <img src="{{ app.config.static.host }}/images/pay/spasibo.png" class="spasibo-img" alt="Спасибо"> </label> </li> {% endif %} </ul></div>',e)}var a=i(2);t.default=n},function(e,t,i){var n=i(21),a=i(1),s=i(93),o=i(3),r=i(43),l=i(11),d=i(163),u=i(490),c=i(491),p=i(492),f=i(493),h=i(251),g=i(10);t.default=s.default.extend({APPLE_PAY_JS_API_VERSION:1,MERCHANT_IDENTIFIER:"merchant.com.payture.applepay.ivi",SESSION_VALIDATION_URL:"/ajax/applePay",CREDIT_STATUS_CHECK_INTERVAL:1e4,PAYMENT_COMPLETED_WAIT_TIME:29e3,timeoutPaymentCompleted:null,paymentCompleted:!1,hasPendingPayment:!1,enabled:!0,$elReady:null,$elSetup:null,name:"applePay",applePayPaymentOption:null,cardPaymentOption:null,applePaySession:null,applePayStatus:null,timer:null,grootParams:{},applePayStatuses:{ready:1,needToSetUp:2,notAvailable:3},initialize:function(e){s.default.prototype.initialize.call(this,e),this.listenTo(l.default,"purchase:applePay:status",this.checkStatus),this.listenTo(l.default,"purchase:initiated",this.disableButton),this.listenTo(l.default,"purchase:finished_success",this.hideButton),this.listenTo(l.default,"purchase:finished_error",this.enableButton),this.applePayPaymentOption=this.getPaymentOption().findWhere({ps_method:"tap_to_pay",ps_key:"apple_pay",payment_system_account:null}),this.cardPaymentOption=this.getPaymentOption().findWhere({ps_key:"cards",payment_system_account:null}),this.applePayPaymentOption&&(this.grootParams=this.applePayPaymentOption.get("groot")),this.grootParams.from=this.queryParams.from,this.$elReady=a(".js-apple-pay-ready"),this.$elSetup=a(".js-apple-pay-setup"),a(".page-wrapper, .modal-container").on("click",".js-apple-pay-button",this.showPaymentSheet.bind(this))},canShowApplePay:function(){return!!(this.applePayPaymentOption&&this.cardPaymentOption&&o.default.isApplePayAvailable()&&this.$elReady.length&&this.$elSetup.length)},showButtonOnMainForm:function(){var e=this;this.canShowApplePay()&&this.checkApplePayAvailability().then(function(t){switch(t){case e.applePayStatuses.ready:e.$elReady.html(u.default()),o.default.track("payment_applepay_show",n.__assign({},e.grootParams,{enabled:1}));break;case e.applePayStatuses.needToSetUp:e.$elSetup.html(c.default()),o.default.track("payment_applepay_show",n.__assign({},e.grootParams,{enabled:0}))}})},checkApplePayAvailability:function(){var e=this,t=a.Deferred();if(null!==this.applePayStatus)t.resolve(this.applePayStatus);else if(window.ApplePaySession){var i=window.ApplePaySession.canMakePaymentsWithActiveCard(this.MERCHANT_IDENTIFIER);i.then(function(i){i?(e.applePayStatus=e.applePayStatuses.ready,t.resolve(e.applePayStatuses.ready)):(e.applePayStatus=e.applePayStatuses.needToSetUp,t.resolve(e.applePayStatuses.needToSetUp))},function(){e.applePayStatus=e.applePayStatuses.notAvailable,t.resolve(e.applePayStatuses.notAvailable)})}else this.applePayStatus=this.applePayStatuses.notAvailable,t.resolve(this.applePayStatuses.notAvailable);return t.promise()},showPaymentSheet:function(){var e=this;if(this.enabled){this.paymentCompleted=!1,this.applePayStatus===this.applePayStatuses.ready?o.default.track("payment_initiated",this.grootParams):o.default.track("payment_applepay_setup",this.grootParams);var t={total:{label:g.default.isWorld?"ivi.tv":"ivi.ru",amount:this.price},countryCode:r.default.getCountryCode(),currencyCode:this.currency,merchantCapabilities:["supports3DS"],supportedNetworks:["masterCard","visa"]};this.applePaySession=new window.ApplePaySession(this.APPLE_PAY_JS_API_VERSION,t),this.applePaySession.onvalidatemerchant=function(t){e.performValidation(t.validationURL).done(function(t){e.applePaySession.completeMerchantValidation(t)}).fail(function(){e.applePaySession.abort(),o.default.track("payment_error",n.__assign({},e.grootParams,{reason:e.name})),l.default.trigger("billing:payment:errorModalOpen",p.default())})},this.applePaySession.onpaymentauthorized=function(t){o.default.track("payment_authorized",e.grootParams),e.makePurchase(t),e.timeoutPaymentCompleted=setTimeout(function(){e.paymentCompleted||(o.default.track("payment_apple_pay_timeout",e.grootParams),e.showLoadingState())},e.PAYMENT_COMPLETED_WAIT_TIME)},this.applePaySession.oncancel=function(){if(e.hasPendingPayment)o.default.track("payment_apple_pay_cancel_approved",e.grootParams),e.showLoadingState();else{e.clearPaymentCompletedTimeout();try{e.applePaySession.abort()}catch(e){}e.paymentCompleted=!1}e.applePayStatus===e.applePayStatuses.ready&&o.default.track("payment_cancel",e.grootParams)},this.applePaySession.begin()}},completePayment:function(e){this.clearPaymentCompletedTimeout(),this.paymentCompleted=!0;try{this.applePaySession.completePayment(e?window.ApplePaySession.STATUS_SUCCESS:window.ApplePaySession.STATUS_FAILURE)}catch(e){}},performValidation:function(e){return a.ajax({method:"GET",url:this.SESSION_VALIDATION_URL,dataType:"json",data:{validationURL:e}})},makePurchase:function(e){var t=JSON.stringify(e.payment.token.paymentData),i=window.btoa(t);l.default.trigger("purchase:applePay",this.applePayPaymentOption,i),this.hasPendingPayment=!0},checkStatus:function(e,t){var i=this;"new"===e.get("status")?this.timer=setInterval(function(){(new d.default).mapiGet({data:{id:e.get("credit_id")}}).done(function(n){"ok"===n.result.status?(i.processPaymentSuccess(e,t),clearTimeout(i.timer),i.timer=null):"fail"===n.result.status&&(i.processPaymentError(),clearTimeout(i.timer),i.timer=null)})},this.CREDIT_STATUS_CHECK_INTERVAL):"ok"===e.get("status")?this.processPaymentSuccess(e,t):this.processPaymentError()},processPaymentError:function(){l.default.trigger("billing:payment:cardSelectModalClose"),this.hasPendingPayment=!1,this.completePayment(!1),o.default.track("payment_error",n.__assign({},this.grootParams,{reason:this.name})),setTimeout(function(){l.default.trigger("billing:payment:errorModalOpen",p.default())},1e3)},processPaymentSuccess:function(e,t){l.default.trigger("billing:payment:cardSelectModalClose"),this.hasPendingPayment=!1,this.hideButton(),this.completePayment(!0),l.default.trigger("purchase:success",e,t)},clearPaymentCompletedTimeout:function(){clearTimeout(this.timeoutPaymentCompleted),this.timeoutPaymentCompleted=null},showLoadingState:function(){l.default.trigger("billing:payment:cardSelectModalClose"),this.$elReady.html(f.default()),(new h.default).render(),a("#js-buy-iframe").hide(),a(".js-pay-header").hide()},hideButton:function(){this.$elReady.hide()},enableButton:function(){this.enabled=!0},disableButton:function(){this.enabled=!1}})},function(e,t,i){var n=i(84),a=i(260),s=i(252),o=i(11),r=i(4);t.default=n.default.extend({doIt:function(){this.listenTo(o.default,"cardbind:success",this.cardBindSuccess),new s.default,this.showPayment()},showPayment:function(){var e=this.getCardBindView(),t=this.queryParams;t.code_from&&e.setCodeFrom(t.code_from),e.checkStatus(),e.reset(),e.render()},getCardBindView:function(){return new a.default},cardBindSuccess:function(){r.default.redirect(this.queryParams.redirect_url)}})},function(e,t,i){var n=i(1),a=i(165),s=i(93),o=i(78),r=i(11),l=i(3),d=i(164),u=i(4),c=i(261);t.default=s.default.extend({name:"card",currentTpl:d.default,options:null,codeFrom:null,successEvent:"cardbind:success",payButtonTitle:"Подтвердить",events:{"click #js-buy":"buyClick"},checker:null,getTpl:function(){return this.currentTpl},initialize:function(){this.checker=new c.default(this.successEvent)},setCodeFrom:function(e){this.codeFrom=e},getCodeFrom:function(){return this.codeFrom},render:function(){var e=this,t=new a.default;t.getBindForm().done(function(){t.get("redirect_url")?e.$el.html(e.getTpl()(e.extendTemplateParams({redirect_url:t.get("redirect_url")}))):e.showError()}).error(function(){e.showError()})},reset:function(){this.timer&&(clearInterval(this.timer),this.timer=null)},showError:function(){l.default.track("payment_error",{reason:"card",hascard:0}),r.default.trigger("purchase:finished_error"),this.renderPaymentError()},renderPaymentError:function(){(new o.default).render()},checkStatus:function(){this.checker.check(),this.addPostMessageHandler()},addPostMessageHandler:function(){n(window).on("message",this.postMessage.bind(this))},postMessage:function(e){if("purchase:card:success"===e.originalEvent.data)this.checker.run();else if("purchase:card:fail"===e.originalEvent.data)this.showError();else if("groot:payment_initiate_click"===e.originalEvent.data){var t={};this.getCodeFrom()&&(t.code_from=this.getCodeFrom()),l.default.track("activatecode_withcard_submit",t)}else if("iframe:ready"===e.originalEvent.data){var i=document.getElementById("js-buy-iframe");if(i){var a=this.getPaymentIframePostMessageObject("changePayButtonTitle",{payButtonTitle:this.payButtonTitle});u.default.postMessageToIframe(i,JSON.stringify(a),"*")}n(".js-loader").removeClass("loader-block")}else try{var s=JSON.parse(e.originalEvent.data);"card:error"===s.message&&(l.default.track("payment_error",{reason:s.data.text,hascard:0}),r.default.trigger("purchase:finished_error"),r.default.trigger("billing:payment:errorModalOpen",s.data.text))}catch(e){}},buyClick:function(){this.$el.removeClass().html("").addClass("loading"),r.default.trigger("purchase:card",this.options)}})},function(e,t,i){var n=i(165),a=i(11),s=function(){function e(e){this.timer=null,this.successEvent=e}return e.prototype.run=function(){this.timer=setInterval(this.check.bind(this),e.PS_ACCOUNT_TIME_INTERVAL),this.check()},e.prototype.check=function(){var e=this;(new n.default).getPaySystemList().done(function(t){if(t.result&&t.result.length){var i=!1;t.result.forEach(function(e){"cards"===e.ps_key&&(i=!0)}),i&&(clearInterval(e.timer),e.timer=null,a.default.trigger(e.successEvent))}})},e.PS_ACCOUNT_TIME_INTERVAL=1e4,e}();t.default=s},function(e,t,i){var n=i(259);t.default=n.default.extend({showPayment:function(){var e=this.getCardBindView();this.queryParams.code_from&&e.setCodeFrom(this.queryParams.code_from),e.addPostMessageHandler(),e.reset(),e.render()}})},function(e,t,i){var n=i(29),a=i(141);t.default=n.default.extend({uri:"/billing/v1/psaccounts/",deactivateUri:"/billing/v1/psaccounts/deactivate/",model:a.default,promise:null,load:function(){return null===this.promise&&(this.promise=this.mapiGet()),this.promise},getCards:function(){return this.where({ps_key:"cards"})},getActiveCards:function(){return this.getCards().filter(function(e){return!e.isCardExpired()})},getExpiredCards:function(){return this.getCards().filter(function(e){return e.isCardExpired()})},findById:function(e){return this.findWhere({id:e})},deactivate:function(e){return this.mapiPost({uri:this.deactivateUri,data:{id:e}})}})},function(e,t,i){var n=i(5),a=i(14),s=i(510);t.default=a.default.extend({uri:"/cardsinfo/v5/",promise:null,load:function(){return null===this.promise&&(this.promise=this.mapiGet()),this.promise},parse:function(e){return e.result.banks=n.mapObject(e.result.banks,function(e){return new s.default(e)}),e.result},getBankInfo:function(e){return this.get("banks")&&(e||(e="default"),this.get("banks").hasOwnProperty(e))?this.get("banks")[e]:null},getPsTypeInfo:function(e){return this.get("types")&&this.get("types").hasOwnProperty(e)?this.get("types")[e]:null}})},function(e,t,i){var n=i(1),a=i(0),s=i(266),o=i(269),r=i(270),l=i(271),d=i(272),u=i(40),c=i(19),p=i(5),f=i(117),h=i(268),g=i(3),m=i(92),v=i(4),_=i(10);t.default=a.View.extend({el:".js-catalog",videoListView:null,fixedFilterInitialized:!1,pushHistory:!1,headerTotal:0,baseUrl:"",baseFilterModelParams:null,mapiView:null,events:{"click .js-catalog-filter a":"filter","click .js-catalog-filter-paidtypes a":"filterPaidTypes","click .js-catalog-filter-year a":"handleStateMutableFilterClick","click .js-catalog-filter-country a":"handleStateMutableFilterClick","click .genre-filter a":"trackGenreClickEvent","click .js-catalog-suggestions a":"trackQuicklinkClickEvent","change .filters-container select":"handleSelect","change .js-catalog-checkbox-online":"handleCheckboxOnline","change .js-catalog-checkbox":"handleCheckbox","click .show-filters":"toggleMobileFilter","click .filters-close":"toggleMobileFilter","click .filters-wrapper-container > .overlay":"toggleMobileFilter","click .js-catalog-reset-filters":"resetFilters"},initialize:function(e){this.videoYearsModel=new l.default,this.videoCountriesModel=new r.default,this.country=new o.default,this.years=new d.default,this.mapiView=new c.default,this.parseDefaultParams(),this.replaceHistoryState(),this.model=e.filterModel,this.baseFilterModelParams=p.clone(this.model.defaults);var t={year_from:this.years.getYearFrom(),year_to:this.years.getYearTo(),country:this.country.getId()};this.genre?(t.genre=this.genre,this.baseFilterModelParams.genre=this.genre):(t.category=this.category,this.baseFilterModelParams.category=this.category),this.model.set(t),this.videoListView=new s.default({model:this.model,collection:this.collection,category:this.category,genre:this.genre,page:e.page}),this.$el.is(":hidden")?this.videoListView.disableWayPoint():this.fixFilters(),n("#js-pagination").hide(),this.listenTo(h.default,"catalog:content:filtered",this.scrollToTopPosters),this.listenTo(h.default,"catalog:content:added",this.nextPage),this.listenTo(h.default,"catalog:activeTab:catalogue",this.replaceHistoryState),this.listenTo(f.default,"common:waypointReached",this.setPage),this.listenTo(m.default,"topline:show",this.countHeaderOptions),this.listenTo(m.default,"topline:hide",this.changeFilterPosition),this.model.on("change",this.handleFilterChange,this),p.isUndefined(window.onpopstate)||(window.onpopstate=this.popHistoryState.bind(this)),this.collectMobileFiltersInfo(),this.$el.find(".js-expandable").on("mouseenter mouseleave",this.toggleMenu.bind(this))},countHeaderOptions:function(){var e=n(".js-menu-block"),t=n(".UnlaijzwEDOPxlfpqKfI").height()||0;this.headerTotal=e.height()+e.position().top,this.filtersFixedScrollMin=this.$el.find(".filters-common-wrapper").offset().top-this.headerTotal-t},changeFilterPosition:function(){var e=this.$el.find(".filters");this.countHeaderOptions(),e.length&&!window.ivi.adaptive.isMobileStyle&&e.hasClass("fixed")&&e.css({top:this.headerTotal})},parseDefaultParams:function(){this.$el.data("years-url")&&(this.years.set("url",this.$el.data("years-url")||""),this.years.set("yearFrom",this.$el.data("years-from")||""),this.years.set("yearTo",this.$el.data("years-to")||"")),this.$el.data("country-id")&&(this.country.set("id",this.$el.data("country-id")||""),this.country.set("code",this.$el.data("country-code")||""));var e=this.$el.data("category-hru")||"",t=this.$el.data("genre-hru")||"";this.category=this.$el.data("category")||"",this.genre=this.$el.data("genre")||"",this.baseUrl="/"+e,t&&(this.baseUrl+="/"+t)},fixFilters:function(){var e=this,t=this.$el.find(".filters-common-wrapper"),i=this.$el.find(".filters-common"),a=this.$el.find(".filters-extra-wrapper");if(t.length){this.countHeaderOptions();var s=0;n(".js-expand-block").on("transitionend",function(){e.filtersFixedScrollMin=t.offset().top-e.headerTotal}),n(window).scroll(function(){var o=n(".posters-block .gallery-wrapper").offset().top,r=i.offset().top+i.height(),l=n(window,"body").scrollTop();l>=e.filtersFixedScrollMin?(i.css({top:e.headerTotal}),t.addClass("fixed"),v.default.isIE11()?(t.addClass("full-shadow"),a.addClass("fixed")):(s<=l?(a.removeClass("fixed"),o<r&&(a.addClass("hidden"),t.removeClass("full-shadow"))):(a.removeClass("hidden"),o<r&&(t.addClass("full-shadow"),a.addClass("fixed"))),s=l)):(i.css({top:""}),t.removeClass("fixed full-shadow"),a.removeClass("fixed"))}).trigger("scroll"),this.fixedFilterInitialized=!0}},handleSelect:function(e){var t=n(e.target);this.pushHistory=!0,this.getFilterSelectValue(t)},handleCheckboxOnline:function(e){var t=n(e.target),i=t.data("key"),a=t.data("value"),s=t.data("last-value")||"watchall";i&&(this.applyFilter(i,t.is(":checked")?a:s),this.changeFiltersUIValues(i,t.is(":checked")?a:s),this.collectMobileFiltersInfo())},handleCheckbox:function(e){var t=n(e.target),i=t.data("key");i&&this.applyFilter(i,t.is(":checked")?1:0),this.$el.find('input[data-key="'+i+'"]').prop("checked",t.is(":checked"))},getFilterSelectValue:function(e){var t=e.find(":selected");switch(e.blur(),e.closest("li").find("span").html(t.text()),e.attr("name")){case"main-genre":this.trackEvents("genre",e.val());var i=t.data("url");i&&v.default.open(i,"_self");break;case"country":this.filterCountry(t);break;case"year":this.filterYear(t);break;default:this.changeFiltersUIValues(e.attr("name"),e.val(),n.trim(t.text())||n.trim(t.data("caption"))),this.applyFilter(e.attr("name"),e.val()),this.collectMobileFiltersInfo()}},scrollToTopPosters:function(){this.fixedFilterInitialized&&this.collection.length&&n.when(n("html, body").animate({scrollTop:this.filtersFixedScrollMin-1},"slow")).then(function(){h.default.trigger("catalog:scrolled")})},filter:function(e){var t=n(e.target).closest("a"),i=t.closest(".js-catalog-filter");return this.changeFiltersUIValues(i.data("key"),t.data("value"),n.trim(t.text())||n.trim(t.data("caption"))),this.applyFilter(i.data("key"),t.data("value")),this.collectMobileFiltersInfo(),!1},paidTypesInit:function(e){if(window.ivi.adaptive.isMobileStyle||_.default.isWorld||e===u.default.prototype.paidTypeAvod.toLowerCase()&&this.mapiView.isPaywall())return!1;n('.js-catalog-filter-paidtypes a[data-type="'+e+'"]').trigger("click")},filterPaidTypes:function(e){var t=n(e.target).closest("a"),i=this.$el.find('input[data-key="paid_type"]'),a=t.data("type")?t.data("type"):"";i.data("last-value",t.data("value")),i.prop("checked",!1),this.changeFiltersUIValues("paid_type",t.data("value")),this.applyFilter("paid_type",t.data("value")),v.default.getLocation().hash=a,this.collectMobileFiltersInfo()},applyFilter:function(e,t){var i={};i[e]=t,this.model.apply(i,this.mapiView.isPaywall()),this.trackEvents(e,t)},applyYearFilter:function(e,t,i){this.years.set({yearFrom:e,yearTo:t,url:i}),this.model.apply({year_from:e,year_to:t});var n=e+"-"+t;e||t?e?t||(n="after_"+e):n="before_"+t:n="all_years",this.trackEvents("year",n)},applyCountryFilter:function(e,t){this.country.set({code:t,id:e}),this.model.apply({country:e}),this.trackEvents("country",t)},handleStateMutableFilterClick:function(e){var t=n(e.target).closest("a");return!t.hasClass("disabled")&&(this.pushHistory=!0,t.closest(".js-catalog-filter-year").length?this.filterYear(t):this.filterCountry(t),!1)},filterYear:function(e){var t=e.data("year-from"),i=e.data("year-to"),a=e.data("year-url");this.changeFiltersUIValues("year",a,n.trim(e.text())||n.trim(e.data("caption"))),this.applyYearFilter(t,i,a),this.collectMobileFiltersInfo()},filterCountry:function(e){var t=e.data("country-code"),i=e.data("value");this.changeFiltersUIValues("country",i,n.trim(e.text())||n.trim(e.data("caption"))),this.applyCountryFilter(i,t),this.collectMobileFiltersInfo()},show:function(){this.$el.show(),this.videoListView.enableWayPoint(),this.fixedFilterInitialized||this.fixFilters()},hide:function(){this.$el.hide(),this.videoListView.disableWayPoint()},trackEvents:function(e,t){if("paid_type"===e)g.default.track("filter_"+t);else{var i=p.isNumber(t)||t?{filter_value:t}:{},n="filter_"+e;g.default.track(n,i)}},trackGenreClickEvent:function(e){this.trackEvents("genre",n(e.target).data("hru"))},trackQuicklinkClickEvent:function(e){g.default.track("fast_link_click",{fast_link_value:n(e.target).attr("href")})},handleFilterChange:function(){var e=!1;this.model.shouldCountriesUpdate()&&(e=!0,this.refreshCountries()),this.model.shouldYearsUpdate()&&(e=!0,this.refreshYears()),e?this.pushHistoryState():this.replaceHistoryState(this.getCatalogUrl())},refreshCountries:function(){this.disableCountries(this.prepareDataForDisableCountries())},prepareDataForDisableCountries:function(){var e={genre_operator:"and"};return this.model.getGenre()?e.genre_id=this.model.getGenre():e.category_id=this.model.getCategory(),this.model.getYearFrom()&&(e.year_from=this.model.getYearFrom()),this.model.getYearTo()&&(e.year_to=this.model.getYearTo()),e},disableCountries:function(e){this.videoCountriesModel.setUriParams(e),this.videoCountriesModel.mapiGet().done(function(e){e.result&&(n('select[name="country"] option').each(function(){var t=n(this),i=t.val();i&&p.isUndefined(e.result[i])?t.attr("disabled","disabled"):t.removeAttr("disabled")}),n(".js-catalog-filter-country li a").each(function(){var t=n(this),i=t.data("value");i&&p.isUndefined(e.result[i])?t.addClass("disabled"):t.removeClass("disabled")}))})},refreshYears:function(){this.disableYears(this.prepareDataForDisableYears())},prepareDataForDisableYears:function(){var e={genre_operator:"and"};return this.model.getGenre()?e.genre_id=this.model.getGenre():e.category_id=this.model.getCategory(),this.model.getCountry()&&(e.country_id=this.model.getCountry()),e},disableYears:function(e){var t=this;this.videoYearsModel.setUriParams(e),this.videoYearsModel.mapiGet().done(function(e){if(e.result){var i=t;n('select[name="year"] option').removeAttr("disabled"),n('select[name="year"] option').each(function(){var t=n(this),a=t.data("year-from"),s=t.data("year-to");i.isYearsInList(a,s,e.result)||t.attr("disabled","disabled")}),n(".js-catalog-filter-year li a").removeClass("disabled"),n(".js-catalog-filter-year li a").each(function(){var t=n(this),a=n(this).data("year-from"),s=n(this).data("year-to");i.isYearsInList(a,s,e.result)||t.addClass("disabled")})}})},isYearsInList:function(e,t,i){if(!e&&!t)return!0;if(e===t)return p.indexOf(i,e)>=0;if(!e)return t>=i[0];if(!t)return e<=p.last(i);var n=p.range(e,t+1);return p.intersection(i,n).length>0},pushHistoryState:function(e){if(this.pushHistory){var t={years:this.years.attributes,country:this.country.attributes};v.default.pushHistoryState(t,null,e||this.getCatalogUrl())}},replaceHistoryState:function(e){var t={years:this.years.attributes,country:this.country.attributes};v.default.replaceHistoryState(t,null,e||v.default.getLocation().pathname+v.default.getLocation().search+v.default.getLocation().hash)},popHistoryState:function(e){if(e.state){if(v.default.getLocation().pathname.indexOf("/page")>0)return v.default.reload(),!1;this.pushHistory=!1,e.state.country&&!p.isEqual(e.state.country,this.country.attributes)&&this.filterCountry(this.$el.find('a[data-country-code="'+e.state.country.code+'"]:first')),e.state.years&&!p.isEqual(e.state.years,this.years.attributes)&&this.filterYear(this.$el.find('a[data-year-url="'+e.state.years.url+'"]'))}},getCatalogUrl:function(){var e=this.baseUrl;return this.years.getUrl()&&(e+="/"+this.years.getUrl()),this.country.getCode()&&(e+="/"+this.country.getCode()),e+=v.default.getLocation().hash},setPage:function(e){this.page=e.data("waypoint-page")},nextPage:function(){if(this.page&&this.page>1){var e=this.getCatalogUrl(),t="";-1!==e.indexOf("#")?(i=e.split("#"),e=i[0],t=i[1],e+="/page"+this.page+"#"+t):e+="/page"+this.page,this.pushHistory=!0,this.replaceHistoryState(e)}var i},toggleMenu:function(e){var t=n(e.target).closest(".js-expandable");if(t.length){var i=t.find(".js-catalog-filter-item");i.hasClass("disabled")||this.toggleExpand(i)}else this.toggleExpand()},toggleExpand:function(e){if(void 0===e)this.$el.find(".js-expandable").removeClass("expanded");else{var t=e.closest(".js-expandable");t.hasClass("expanded")?t.removeClass("expanded"):(t.siblings().removeClass("expanded"),t.addClass("expanded"))}},toggleMobileFilter:function(){n(".filters-wrapper-container").toggleClass("expanded")},changeFiltersUIValues:function(e,t,i){var n=this.$el.find("li[data-key="+e+"] .js-catalog-filter-item"),a=this.$el.find("[data-key="+e+"]");a.find("a").removeClass("active");var s=a.find('a[data-value="'+t+'"]');s.addClass("active"),a.find('option[value="'+t+'"]').prop("selected",!0),s.hasClass("js-catalog-default-value")?n.removeClass("selected"):n.addClass("selected"),void 0!==typeof i&&n.find(".js-catalog-filter-value").text(i)},resetFilters:function(){var e=this;this.$el.find('input[data-key="paid_type"]').prop("checked",!0),this.$el.find('input[type="checkbox"]').not('input[data-key="paid_type"]').prop("checked",!1),v.default.getLocation().hash="",this.$el.find(".js-expandable a.js-catalog-default-value").each(function(t,i){var a=n(i),s=a.closest(".js-expandable").data("key");void 0!==s&&e.changeFiltersUIValues(s,a.data("value"),n.trim(a.text()))}),this.collectMobileFiltersInfo(),this.years.clear().set(this.years.defaults),this.country.clear().set(this.country.defaults),this.model.set(this.baseFilterModelParams)},collectMobileFiltersInfo:function(){var e=this.$el.find(".js-catalog-show-filters"),t=[];this.$el.find(".filters-wrapper-container .js-catalog-filter-item.selected .js-catalog-filter-value").each(function(e,i){t.push(i.outerText)}),t.length?e.hasClass("two-line")?e.find(".ivi-button__secondary-text").text(t.join(", ")):e.addClass("two-line").append(n("<span/>").addClass("ivi-button__secondary-text").text(t.join(", "))):this.$el.find(".js-catalog-show-filters").removeClass("two-line").find(".ivi-button__secondary-text").remove()}})},function(e,t,i){var n=i(1),a=i(0),s=i(532),o=i(51),r=i(61),l=i(5),d=i(534),u=i(268),c=i(3),p=i(44);t.default=a.View.extend(o.default).extend(r.default).extend(s.default).extend({el:".js-catalog-list",noResultsClass:"no-results",$videosContainer:null,filtered:!1,events:{"click li > a":"contentClick"},initialize:function(e){this.elementsPerPage=30,this.elementsPerLine=6,this.startPage=e.page?e.page-1:0,this.$videosContainer=this.$el.find(".gallery"),this.loadDataParams.data={fields:this.collection.fields},this.collection.setUriParams(this.model.attributes),this.model.on("change",this.filter,this),this.listenTo(u.default,"catalog:scrolled",this.afterRender),this.attachPosterPopup(this.$videosContainer.children("li")),this.initLoadMore()},render:function(){var e=n("<div/>"),t=this.loadDataParams.data.from-this.startPage*this.elementsPerPage,i=this.model.getPaidType()?this.model.getPaidType().split(","):[];r.default.render.apply(this,arguments),l.each(this.collection.models,function(t,a){i.length&&t.setContentPaidTypes(i),n(d.default({video:t,loop:{index:a+1}})).appendTo(e)}),this.filtered?(this.$videosContainer.html(e.html()),u.default.trigger("catalog:content:filtered"),p.default.viewList(this.$el.find(".js-criteo-gallery"),!0)):this.collection.length&&(u.default.trigger("catalog:content:added"),this.$videosContainer.append(e.html())),!this.collection.length&&this.filtered&&this.$el.addClass(this.noResultsClass),this.hideLoader(this.$el),this.attachPosterPopup(this.$videosContainer.children("li:nth-child(n + "+t+")")),this.filtered||this.afterRender(),this.filtered=!1},filter:function(e){this.collection.setUriParams(e.attributes),this.filtered=!0,this.startPage=0,this.showLoader(this.$el),this.$el.removeClass(this.noResultsClass),this.reload()},contentClick:function(){c.default.setBlockId(c.default.getRefPageFromGrootView()+"_catalog")}})},function(e,t,i){var n=i(5);t.default={loadDataParams:{},loadData:function(e,t){var i=this;t||(t=this.loadDataParams),e.mapiGet(t).done(function(e){e.error||i.render()})},prepareRepeatingUrlParameter:function(e,t){var i=t?t.toString().split(","):[];if(!n.isEmpty(i)){var a=e+"="+i.shift();if(i.length)for(var s in i)a+="&"+e+"="+i[s];return a}return null}}},function(e,t,i){var n=i(0);t.default=new n.Model({})},function(e,t,i){var n=i(0);t.default=n.Model.extend({defaults:{code:"",id:""},getCode:function(){return this.get("code")},getId:function(){return this.get("id")}})},function(e,t,i){var n=i(14);t.default=n.default.extend({uri:"/videos/countries/v5/"})},function(e,t,i){var n=i(14);t.default=n.default.extend({uri:"/videos/years/v5/"})},function(e,t,i){var n=i(0);t.default=n.Model.extend({defaults:{url:"",yearFrom:"",yearTo:""},getUrl:function(){return this.get("url")},getYearFrom:function(){return this.get("yearFrom")},getYearTo:function(){return this.get("yearTo")}})},function(e,t,i){var n=i(0),a=i(5);t.default=n.Model.extend({countriesDependencies:["genre","year_to","year_from"],yearsDependencies:["genre","country"],defaults:{country:"",year_from:"",year_to:"",sort:"pop",paid_type:"",fake:0,withpreorderable:0,genre:"",genre_operator:"and",category:"",has_localization:!1,has_subtitles:!1},apply:function(e,t){if(void 0===t&&(t=!1),e.paid_type)switch("watchall"===e.paid_type?(e.fake=1,e.withpreorderable=1):(e.fake="",e.withpreorderable=""),e.paid_type){case"watchonline":e.paid_type="";break;case"watchfree":e.paid_type="AVOD";break;case"watchpaid":e.paid_type="TVOD,EST";break;case"watchsvod":e.paid_type="SVOD",t&&(e.paid_type+=",AVOD");break;case"watchall":e.paid_type=""}this.set(e)},getCountry:function(){return this.get("country")||""},getYearFrom:function(){return this.get("year_from")||""},getYearTo:function(){return this.get("year_to")||""},getSort:function(){return this.get("sort")||""},getPaidType:function(){return this.get("paid_type")||""},getGenre:function(){return this.get("genre")||""},getCategory:function(){return this.get("category")||""},isFiltered:function(){return this.getCountry()||this.getYearFrom()||this.getYearTo()},shouldCountriesUpdate:function(){return a.intersection(Object.keys(this.changed),this.countriesDependencies).length>0},shouldYearsUpdate:function(){return a.intersection(Object.keys(this.changed),this.yearsDependencies).length>0}})},function(e,t,i){var n=i(29),a=i(40);t.default=n.default.extend({uri:"/catalogue/v5/",fields:"id,title,fake,preorderable,available_in_countries,hru,poster_originals,content_paid_types,compilation_hru,kind,additional_data,restrict,hd_available,3d_available,uhd_available,hdr10_available,has_5_1,seasons_count,seasons_content_total,seasons,episodes,seasons_description,ivi_rating_10_count,seasons_extra_info,count,used_to_be_paid",model:a.default})},function(e,t,i){var n=i(1),a=i(535),s=i(6),o=i(74),r=i(7),l=i(110);t.default=s.default.extend({run:function(){this.listenToOnce(r.default,"autologin",this.showNoticeModal),this.listenTo(l.default,"onPlayerLoad",function(){return l.default.trigger("erotic:showContentForAdultModal")})},showNoticeModal:function(){var e=new o.default;e.canWatchAdultContent()||n("body").hasClass("notfound")||new a.default({model:e}).listen(l.default)}})},function(e,t,i){var n=i(1),a=i(0),s=i(277),o=i(7),r=i(26),l=i(3),d=i(105),u=i(278),c=i(8),p=i(50);t.default=a.View.extend({el:".promo",events:{keyup:"keyEvent","click .control.prev":"showPreviousClicked","click .control.next":"showNextElementClicked","mouseenter .promo-content":"enterEvent","mouseleave .promo-content":"leaveEvent","click .js-favourite-button":"triggerFavourite"},activeClassName:"active",formerClassName:"former",scrollTimeOut:8e3,clicked:!1,timeout:null,savedPromo:null,promoType:"",isDocumentVisible:!0,initialize:function(){this.loadSavedPromo(),p.default.addVisibilityChangeListener(this.onDocumentVisibilityChanged.bind(this)),this.listenTo(r.default,"favourite:have",this.setDefaultActive),this.listenToOnce(u.default,"promo:stopAutoScroll",this.stopScrolling),this.listenTo(u.default,"promo:hide",this.hide),this.listenTo(u.default,"promo:show",this.show),this.listenTo(r.default,"favourites:added",this.updateFavouriteStatus),this.listenTo(r.default,"favourites:deleted",this.updateFavouriteStatus),this.listenTo(o.default,"loadUser",this.checkFavourites),this.$el.find(".promo-content").delay(100).removeClass("persistent-controls"),this.setScrolling()},onDocumentVisibilityChanged:function(){this.isDocumentVisible="visible"===document.visibilityState},loadSavedPromo:function(){this.savedPromo=new s.default,this.promoType=this.$el.data("promo-type");var e=this.savedPromo.getPromoId(this.promoType);e&&this.changeContent(!0,e)},setScrolling:function(){var e=this;!1===this.clicked&&null===this.timeout&&(this.timeout=window.setInterval(function(){e.showNext()},this.scrollTimeOut))},stopScrolling:function(){window.clearInterval(this.timeout),this.timeout=null},show:function(){this.$el.show()},hide:function(){this.$el.hide()},loadImage:function(e){var t=e.find("img");void 0===t.attr("src")&&t.attr("src",t.data("src"))},showPreviousClicked:function(){this.clicked=!0,this.stopScrolling(),this.showPrevious()},showNextElementClicked:function(){this.clicked=!0,this.stopScrolling(),this.showNext()},showPrevious:function(){this.changeContent(!1)},showNext:function(){this.changeContent(!0),!1===this.clicked&&this.isDocumentVisible&&d.default.trigger("promo:scrolling")},keyEvent:function(e){switch(e.which){case 37:this.showPrevious();break;case 39:this.showNext()}},enterEvent:function(){this.stopScrolling()},leaveEvent:function(){this.clicked=!1,this.setScrolling()},changeContent:function(e,t){var i,n,a=this.$el.find("ul"),s=a.children("li."+this.activeClassName),o=a.children("li."+this.formerClassName);t?t!==s.data("promo-id")&&(i=a.find('li[data-promo-id="'+t+'"]'),i.length&&(n=i.next().length?i.next():a.children().first(),this.applyPromo(o,s,i,n))):(!0===e?(i=s.next().length?s.next():a.children().first(),n=i.next().length?i.next():a.children().first()):(i=s.prev().length?s.prev():a.children().last(),n=i.next().length?i.next():a.children().first()),this.applyPromo(o,s,i,n))},applyPromo:function(e,t,i,n){e.length&&e.removeClass(this.formerClassName),t.addClass(this.formerClassName),t.removeClass(this.activeClassName),i.addClass(this.activeClassName),this.savedPromo.savePromoId(this.promoType,i.data("promo-id")),this.loadImage(i),this.loadImage(n)},triggerFavourite:function(e){var t=n(e.target||e.originalEvent.target);return t.hasClass("active")?r.default.trigger("favourite:delete",{objectId:t.data("object-id"),type:t.data("object-type"),blockId:l.default.getBlockIds().promoBlockId}):r.default.trigger("favourite:add",{objectId:t.data("object-id"),type:t.data("object-type"),blockId:l.default.getBlockIds().promoBlockId}),!1},setDefaultActive:function(e,t){var i=this.$el.find("a[data-object-id="+e.objectId+"]");t&&i.data("object-type")===e.type&&i.addClass("active")},checkFavourites:function(){c.default.isFreshStoragelessSession()||this.$el.find(".js-favourite-button").each(function(){r.default.trigger("favourite:check",{objectId:n(this).data("object-id"),type:n(this).data("object-type")})})},updateFavouriteStatus:function(e){var t=this.$el.find("a[data-object-id="+e.objectId+"]");t.data("object-type")===e.type&&t.toggleClass("active")}})},function(e,t,i){var n=i(5),a=i(35),s=function(){function e(){this.COOKIE_NAME="saved_promo",this.COOKIE_EXPIRES=86400,this.savedPromo={},this.load()}return e.prototype.load=function(){var e=a.get(this.COOKIE_NAME);if(e&&n.isString(e)){try{e=JSON.parse(e)}catch(t){e={}}Object.keys(e).length&&(this.savedPromo=e)}},e.prototype.save=function(){var e=JSON.stringify(this.savedPromo);a.set(this.COOKIE_NAME,e,{expires:this.COOKIE_EXPIRES})},e.prototype.savePromoId=function(e,t){this.savedPromo[e]=t,this.save()},e.prototype.getPromoId=function(e){return this.savedPromo[e]?parseInt(this.savedPromo[e],10):0},e}();t.default=s},function(e,t,i){var n=i(0);t.default=new n.Model({})},function(e,t,i){"use strict";function n(e){return(""+e).replace(y,"$&/")}function a(e,t){this.func=e,this.context=t,this.count=0}function s(e,t,i){var n=e.func,a=e.context;n.call(a,t,e.count++)}function o(e,t,i){if(null==e)return e;var n=a.getPooled(t,i);v(e,s,n),a.release(n)}function r(e,t,i,n){this.result=e,this.keyPrefix=t,this.func=i,this.context=n,this.count=0}function l(e,t,i){var a=e.result,s=e.keyPrefix,o=e.func,r=e.context,l=o.call(r,t,e.count++);Array.isArray(l)?d(l,a,i,m.thatReturnsArgument):null!=l&&(g.isValidElement(l)&&(l=g.cloneAndReplaceKey(l,s+(!l.key||t&&t.key===l.key?"":n(l.key)+"/")+i)),a.push(l))}function d(e,t,i,a,s){var o="";null!=i&&(o=n(i)+"/");var d=r.getPooled(t,o,a,s);v(e,l,d),r.release(d)}function u(e,t,i){if(null==e)return e;var n=[];return d(e,n,null,t,i),n}function c(e,t,i){return null}function p(e,t){return v(e,c,null)}function f(e){var t=[];return d(e,t,null,m.thatReturnsArgument),t}var h=i(69),g=i(52),m=i(46),v=i(167),_=h.twoArgumentPooler,b=h.fourArgumentPooler,y=/\/+/g;a.prototype.destructor=function(){this.func=null,this.context=null,this.count=0},h.addPoolingTo(a,_),r.prototype.destructor=function(){this.result=null,this.keyPrefix=null,this.func=null,this.context=null,this.count=0},h.addPoolingTo(r,b);var w={forEach:o,map:u,mapIntoWithKeyPrefixInternal:d,count:p,toArray:f};e.exports=w},function(e,t,i){"use strict";var n=!1;e.exports=n},function(e,t,i){"use strict";function n(e){var t=e&&(a&&e[a]||e[s]);if("function"==typeof t)return t}var a="function"==typeof Symbol&&Symbol.iterator,s="@@iterator";e.exports=n},function(e,t,i){"use strict";function n(e,t){var i=C.hasOwnProperty(t)?C[t]:null;P.hasOwnProperty(t)&&i!==y.OVERRIDE_BASE&&c("73",t),e&&i!==y.DEFINE_MANY&&i!==y.DEFINE_MANY_MERGED&&c("74",t)}function a(e,t){if(t){"function"==typeof t&&c("75"),h.isValidElement(t)&&c("76");var i=e.prototype,a=i.__reactAutoBindPairs;t.hasOwnProperty(b)&&k.mixins(e,t.mixins);for(var s in t)if(t.hasOwnProperty(s)&&s!==b){var o=t[s],d=i.hasOwnProperty(s);if(n(d,s),k.hasOwnProperty(s))k[s](e,o);else{var u=C.hasOwnProperty(s),p="function"==typeof o,f=p&&!u&&!d&&!1!==t.autobind;if(f)a.push(s,o),i[s]=o;else if(d){var g=C[s];(!u||g!==y.DEFINE_MANY_MERGED&&g!==y.DEFINE_MANY)&&c("77",g,s),g===y.DEFINE_MANY_MERGED?i[s]=r(i[s],o):g===y.DEFINE_MANY&&(i[s]=l(i[s],o))}else i[s]=o}}}else;}function s(e,t){if(t)for(var i in t){var n=t[i];if(t.hasOwnProperty(i)){var a=i in k;a&&c("78",i);var s=i in e;s&&c("79",i),e[i]=n}}}function o(e,t){e&&t&&"object"==typeof e&&"object"==typeof t||c("80");for(var i in t)t.hasOwnProperty(i)&&(void 0!==e[i]&&c("81",i),e[i]=t[i]);return e}function r(e,t){return function(){var i=e.apply(this,arguments),n=t.apply(this,arguments);if(null==i)return n;if(null==n)return i;var a={};return o(a,i),o(a,n),a}}function l(e,t){return function(){e.apply(this,arguments),t.apply(this,arguments)}}function d(e,t){var i=t.bind(e);return i}function u(e){for(var t=e.__reactAutoBindPairs,i=0;i<t.length;i+=2){var n=t[i],a=t[i+1];e[n]=d(e,a)}}var c=i(15),p=i(24),f=i(169),h=i(52),g=(i(171),i(172),i(170)),m=i(94),v=(i(13),i(118)),_=i(71),b=(i(17),_({mixins:null})),y=v({DEFINE_ONCE:null,DEFINE_MANY:null,OVERRIDE_BASE:null,DEFINE_MANY_MERGED:null}),w=[],C={mixins:y.DEFINE_MANY,statics:y.DEFINE_MANY,propTypes:y.DEFINE_MANY,contextTypes:y.DEFINE_MANY,childContextTypes:y.DEFINE_MANY,getDefaultProps:y.DEFINE_MANY_MERGED,getInitialState:y.DEFINE_MANY_MERGED,getChildContext:y.DEFINE_MANY_MERGED,render:y.DEFINE_ONCE,componentWillMount:y.DEFINE_MANY,componentDidMount:y.DEFINE_MANY,componentWillReceiveProps:y.DEFINE_MANY,shouldComponentUpdate:y.DEFINE_ONCE,componentWillUpdate:y.DEFINE_MANY,componentDidUpdate:y.DEFINE_MANY,componentWillUnmount:y.DEFINE_MANY,updateComponent:y.OVERRIDE_BASE},k={displayName:function(e,t){e.displayName=t},mixins:function(e,t){if(t)for(var i=0;i<t.length;i++)a(e,t[i])},childContextTypes:function(e,t){e.childContextTypes=p({},e.childContextTypes,t)},contextTypes:function(e,t){e.contextTypes=p({},e.contextTypes,t)},getDefaultProps:function(e,t){e.getDefaultProps?e.getDefaultProps=r(e.getDefaultProps,t):e.getDefaultProps=t},propTypes:function(e,t){e.propTypes=p({},e.propTypes,t)},statics:function(e,t){s(e,t)},autobind:function(){}},P={replaceState:function(e,t){this.updater.enqueueReplaceState(this,e),t&&this.updater.enqueueCallback(this,t,"replaceState")},isMounted:function(){return this.updater.isMounted(this)}},S=function(){};p(S.prototype,f.prototype,P);var T={createClass:function(e){var t=function(e,i,n){this.__reactAutoBindPairs.length&&u(this),this.props=e,this.context=i,this.refs=m,this.updater=n||g,this.state=null;var a=this.getInitialState?this.getInitialState():null;("object"!=typeof a||Array.isArray(a))&&c("82",t.displayName||"ReactCompositeComponent"),this.state=a};t.prototype=new S,t.prototype.constructor=t,t.prototype.__reactAutoBindPairs=[],w.forEach(a.bind(null,t)),a(t,e),t.getDefaultProps&&(t.defaultProps=t.getDefaultProps()),t.prototype.render||c("83");for(var i in C)t.prototype[i]||(t.prototype[i]=null);return t},injection:{injectMixin:function(e){w.push(e)}}};e.exports=T},function(e,t,i){"use strict";function n(e,t){return e===t?0!==e||1/e==1/t:e!==e&&t!==t}function a(e){function t(t,i,n,a,s,o,r){a=a||C,o=o||n;if(null==i[n]){var l=_[s];return t?new Error("Required "+l+" `"+o+"` was not specified in `"+a+"`."):null}return e(i,n,a,s,o)}var i=t.bind(null,!1);return i.isRequired=t.bind(null,!0),i}function s(e){function t(t,i,n,a,s,o){var r=t[i];if(h(r)!==e){var l=_[a],d=g(r);return new Error("Invalid "+l+" `"+s+"` of type `"+d+"` supplied to `"+n+"`, expected `"+e+"`.")}return null}return a(t)}function o(e){function t(t,i,n,a,s){if("function"!=typeof e)return new Error("Property `"+s+"` of component `"+n+"` has invalid PropType notation inside arrayOf.");var o=t[i];if(!Array.isArray(o)){var r=_[a],l=h(o);return new Error("Invalid "+r+" `"+s+"` of type `"+l+"` supplied to `"+n+"`, expected an array.")}for(var d=0;d<o.length;d++){var u=e(o,d,n,a,s+"["+d+"]",b);if(u instanceof Error)return u}return null}return a(t)}function r(e){function t(t,i,n,a,s){if(!(t[i]instanceof e)){var o=_[a],r=e.name||C,l=m(t[i]);return new Error("Invalid "+o+" `"+s+"` of type `"+l+"` supplied to `"+n+"`, expected instance of `"+r+"`.")}return null}return a(t)}function l(e){function t(t,i,a,s,o){for(var r=t[i],l=0;l<e.length;l++)if(n(r,e[l]))return null;var d=_[s],u=JSON.stringify(e);return new Error("Invalid "+d+" `"+o+"` of value `"+r+"` supplied to `"+a+"`, expected one of "+u+".")}return Array.isArray(e)?a(t):y.thatReturnsNull}function d(e){function t(t,i,n,a,s){if("function"!=typeof e)return new Error("Property `"+s+"` of component `"+n+"` has invalid PropType notation inside objectOf.");var o=t[i],r=h(o);if("object"!==r){var l=_[a];return new Error("Invalid "+l+" `"+s+"` of type `"+r+"` supplied to `"+n+"`, expected an object.")}for(var d in o)if(o.hasOwnProperty(d)){var u=e(o,d,n,a,s+"."+d,b);if(u instanceof Error)return u}return null}return a(t)}function u(e){function t(t,i,n,a,s){for(var o=0;o<e.length;o++){if(null==(0,e[o])(t,i,n,a,s,b))return null}var r=_[a];return new Error("Invalid "+r+" `"+s+"` supplied to `"+n+"`.")}return Array.isArray(e)?a(t):y.thatReturnsNull}function c(e){function t(t,i,n,a,s){var o=t[i],r=h(o);if("object"!==r){var l=_[a];return new Error("Invalid "+l+" `"+s+"` of type `"+r+"` supplied to `"+n+"`, expected `object`.")}for(var d in e){var u=e[d];if(u){var c=u(o,d,n,a,s+"."+d,b);if(c)return c}}return null}return a(t)}function p(e){switch(typeof e){case"number":case"string":case"undefined":return!0;case"boolean":return!e;case"object":if(Array.isArray(e))return e.every(p);if(null===e||v.isValidElement(e))return!0;var t=w(e);if(!t)return!1;var i,n=t.call(e);if(t!==e.entries){for(;!(i=n.next()).done;)if(!p(i.value))return!1}else for(;!(i=n.next()).done;){var a=i.value;if(a&&!p(a[1]))return!1}return!0;default:return!1}}function f(e,t){return"symbol"===e||("Symbol"===t["@@toStringTag"]||"function"==typeof Symbol&&t instanceof Symbol)}function h(e){var t=typeof e;return Array.isArray(e)?"array":e instanceof RegExp?"object":f(t,e)?"symbol":t}function g(e){var t=h(e);if("object"===t){if(e instanceof Date)return"date";if(e instanceof RegExp)return"regexp"}return t}function m(e){return e.constructor&&e.constructor.name?e.constructor.name:C}var v=i(52),_=i(172),b=i(173),y=i(46),w=i(281),C=(i(17),"<<anonymous>>"),k={array:s("array"),bool:s("boolean"),func:s("function"),number:s("number"),object:s("object"),string:s("string"),symbol:s("symbol"),any:function(){return a(y.thatReturns(null))}(),arrayOf:o,element:function(){function e(e,t,i,n,a){var s=e[t];if(!v.isValidElement(s)){var o=_[n],r=h(s);return new Error("Invalid "+o+" `"+a+"` of type `"+r+"` supplied to `"+i+"`, expected a single ReactElement.")}return null}return a(e)}(),instanceOf:r,node:function(){function e(e,t,i,n,a){if(!p(e[t])){var s=_[n];return new Error("Invalid "+s+" `"+a+"` supplied to `"+i+"`, expected a ReactNode.")}return null}return a(e)}(),objectOf:d,oneOf:l,oneOfType:u,shape:c};e.exports=k},function(e,t,i){"use strict";e.exports="15.3.0"},function(e,t,i){"use strict";e.exports=i(549)},function(e,t,i){"use strict";var n={hasCachedChildNodes:1};e.exports=n},function(e,t,i){"use strict";function n(e,t){return null==t&&a("30"),null==e?t:Array.isArray(e)?Array.isArray(t)?(e.push.apply(e,t),e):(e.push(t),e):Array.isArray(t)?[e].concat(t):[e,t]}var a=i(15);i(13);e.exports=n},function(e,t,i){"use strict";function n(e,t,i){Array.isArray(e)?e.forEach(t,i):e&&t.call(i,e)}e.exports=n},function(e,t,i){"use strict";function n(){return!s&&a.canUseDOM&&(s="textContent"in document.documentElement?"textContent":"innerText"),s}var a=i(34),s=null;e.exports=n},function(e,t,i){"use strict";function n(){this._callbacks=null,this._contexts=null}var a=i(15),s=i(24),o=i(69);i(13);s(n.prototype,{enqueue:function(e,t){this._callbacks=this._callbacks||[],this._contexts=this._contexts||[],this._callbacks.push(e),this._contexts.push(t)},notifyAll:function(){var e=this._callbacks,t=this._contexts;if(e){e.length!==t.length&&a("24"),this._callbacks=null,this._contexts=null;for(var i=0;i<e.length;i++)e[i].call(t[i]);e.length=0,t.length=0}},checkpoint:function(){return this._callbacks?this._callbacks.length:0},rollback:function(e){this._callbacks&&(this._callbacks.length=e,this._contexts.length=e)},reset:function(){this._callbacks=null,this._contexts=null},destructor:function(){this.reset()}}),o.addPoolingTo(n),e.exports=n},function(e,t,i){"use strict";var n={logTopLevelRenders:!1};e.exports=n},function(e,t,i){"use strict";function n(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!a[e.type]:"textarea"===t}var a={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};e.exports=n},function(e,t,i){"use strict";var n={currentScrollLeft:0,currentScrollTop:0,refreshScrollValues:function(e){n.currentScrollLeft=e.x,n.currentScrollTop=e.y}};e.exports=n},function(e,t,i){"use strict";var n=i(180),a=i(565),s={processChildrenUpdates:a.dangerouslyProcessChildrenUpdates,replaceNodeWithMarkup:n.dangerouslyReplaceNodeWithMarkup,unmountIDFromEnvironment:function(e){}};e.exports=s},function(e,t,i){"use strict";var n=i(34),a=i(121),s=i(120),o=function(e,t){if(t){var i=e.firstChild;if(i&&i===e.lastChild&&3===i.nodeType)return void(i.nodeValue=t)}e.textContent=t};n.canUseDOM&&("textContent"in document.documentElement||(o=function(e,t){s(e,a(t))})),e.exports=o},function(e,t,i){"use strict";var n=i(118),a=n({INSERT_MARKUP:null,MOVE_EXISTING:null,REMOVE_NODE:null,SET_MARKUP:null,TEXT_CONTENT:null});e.exports=a},function(e,t,i){"use strict";function n(e){try{e.focus()}catch(e){}}e.exports=n},function(e,t,i){"use strict";function n(e,t){return e+t.charAt(0).toUpperCase()+t.substring(1)}var a={animationIterationCount:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridRow:!0,gridColumn:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},s=["Webkit","ms","Moz","O"];Object.keys(a).forEach(function(e){s.forEach(function(t){a[n(t,e)]=a[e]})});var o={background:{backgroundAttachment:!0,backgroundColor:!0,backgroundImage:!0,backgroundPositionX:!0,backgroundPositionY:!0,backgroundRepeat:!0},backgroundPosition:{backgroundPositionX:!0,backgroundPositionY:!0},border:{borderWidth:!0,borderStyle:!0,borderColor:!0},borderBottom:{borderBottomWidth:!0,borderBottomStyle:!0,borderBottomColor:!0},borderLeft:{borderLeftWidth:!0,borderLeftStyle:!0,borderLeftColor:!0},borderRight:{borderRightWidth:!0,borderRightStyle:!0,borderRightColor:!0},borderTop:{borderTopWidth:!0,borderTopStyle:!0,borderTopColor:!0},font:{fontStyle:!0,fontVariant:!0,fontWeight:!0,fontSize:!0,lineHeight:!0,fontFamily:!0},outline:{outlineWidth:!0,outlineStyle:!0,outlineColor:!0}},r={isUnitlessNumber:a,shorthandPropertyExpansions:o};e.exports=r},function(e,t,i){"use strict";function n(e){return!!d.hasOwnProperty(e)||!l.hasOwnProperty(e)&&(r.test(e)?(d[e]=!0,!0):(l[e]=!0,!1))}function a(e,t){return null==t||e.hasBooleanValue&&!t||e.hasNumericValue&&isNaN(t)||e.hasPositiveNumericValue&&t<1||e.hasOverloadedBooleanValue&&!1===t}var s=i(85),o=(i(27),i(575),i(38),i(576)),r=(i(17),new RegExp("^["+s.ATTRIBUTE_NAME_START_CHAR+"]["+s.ATTRIBUTE_NAME_CHAR+"]*$")),l={},d={},u={createMarkupForID:function(e){return s.ID_ATTRIBUTE_NAME+"="+o(e)},setAttributeForID:function(e,t){e.setAttribute(s.ID_ATTRIBUTE_NAME,t)},createMarkupForRoot:function(){return s.ROOT_ATTRIBUTE_NAME+'=""'},setAttributeForRoot:function(e){e.setAttribute(s.ROOT_ATTRIBUTE_NAME,"")},createMarkupForProperty:function(e,t){var i=s.properties.hasOwnProperty(e)?s.properties[e]:null;if(i){if(a(i,t))return"";var n=i.attributeName;return i.hasBooleanValue||i.hasOverloadedBooleanValue&&!0===t?n+'=""':n+"="+o(t)}return s.isCustomAttribute(e)?null==t?"":e+"="+o(t):null},createMarkupForCustomAttribute:function(e,t){return n(e)&&null!=t?e+"="+o(t):""},setValueForProperty:function(e,t,i){var n=s.properties.hasOwnProperty(t)?s.properties[t]:null;if(n){var o=n.mutationMethod;if(o)o(e,i);else{if(a(n,i))return void this.deleteValueForProperty(e,t);if(n.mustUseProperty)e[n.propertyName]=i;else{var r=n.attributeName,l=n.attributeNamespace;l?e.setAttributeNS(l,r,""+i):n.hasBooleanValue||n.hasOverloadedBooleanValue&&!0===i?e.setAttribute(r,""):e.setAttribute(r,""+i)}}}else if(s.isCustomAttribute(t))return void u.setValueForAttribute(e,t,i)},setValueForAttribute:function(e,t,i){if(n(t)){null==i?e.removeAttribute(t):e.setAttribute(t,""+i)}},deleteValueForAttribute:function(e,t){e.removeAttribute(t)},deleteValueForProperty:function(e,t){var i=s.properties.hasOwnProperty(t)?s.properties[t]:null;if(i){var n=i.mutationMethod;if(n)n(e,void 0);else if(i.mustUseProperty){var a=i.propertyName;i.hasBooleanValue?e[a]=!1:e[a]=""}else e.removeAttribute(i.attributeName)}else s.isCustomAttribute(t)&&e.removeAttribute(t)}};e.exports=u},function(e,t,i){"use strict";function n(){if(this._rootNodeID&&this._wrapperState.pendingUpdate){this._wrapperState.pendingUpdate=!1;var e=this._currentElement.props,t=l.getValue(e);null!=t&&a(this,Boolean(e.multiple),t)}}function a(e,t,i){var n,a,s=d.getNodeFromInstance(e).options;if(t){for(n={},a=0;a<i.length;a++)n[""+i[a]]=!0;for(a=0;a<s.length;a++){var o=n.hasOwnProperty(s[a].value);s[a].selected!==o&&(s[a].selected=o)}}else{for(n=""+i,a=0;a<s.length;a++)if(s[a].value===n)return void(s[a].selected=!0);s.length&&(s[0].selected=!0)}}function s(e){var t=this._currentElement.props,i=l.executeOnChange(t,e);return this._rootNodeID&&(this._wrapperState.pendingUpdate=!0),u.asap(n,this),i}var o=i(24),r=i(123),l=i(183),d=i(27),u=i(53),c=(i(17),!1),p={getHostProps:function(e,t){return o({},r.getHostProps(e,t),{onChange:e._wrapperState.onChange,value:void 0})},mountWrapper:function(e,t){var i=l.getValue(t);e._wrapperState={pendingUpdate:!1,initialValue:null!=i?i:t.defaultValue,listeners:null,onChange:s.bind(e),wasMultiple:Boolean(t.multiple)},void 0===t.value||void 0===t.defaultValue||c||(c=!0)},getSelectValueContext:function(e){return e._wrapperState.initialValue},postUpdateWrapper:function(e){var t=e._currentElement.props;e._wrapperState.initialValue=void 0;var i=e._wrapperState.wasMultiple;e._wrapperState.wasMultiple=Boolean(t.multiple);var n=l.getValue(t);null!=n?(e._wrapperState.pendingUpdate=!1,a(e,Boolean(t.multiple),n)):i!==Boolean(t.multiple)&&(null!=t.defaultValue?a(e,Boolean(t.multiple),t.defaultValue):a(e,Boolean(t.multiple),t.multiple?[]:""))}};e.exports=p},function(e,t,i){"use strict";function n(e){if(e){var t=e.getName();if(t)return" Check the render method of `"+t+"`."}return""}function a(e){return"function"==typeof e&&void 0!==e.prototype&&"function"==typeof e.prototype.mountComponent&&"function"==typeof e.prototype.receiveComponent}function s(e,t){var i;if(null===e||!1===e)i=d.create(s);else if("object"==typeof e){var r=e;(!r||"function"!=typeof r.type&&"string"!=typeof r.type)&&o("130",null==r.type?r.type:typeof r.type,n(r._owner)),"string"==typeof r.type?i=u.createInternalComponent(r):a(r.type)?(i=new r.type(r),i.getHostNode||(i.getHostNode=i.getNativeNode)):i=new c(r)}else"string"==typeof e||"number"==typeof e?i=u.createInstanceForText(e):o("131",typeof e);i._mountIndex=0,i._mountImage=null;return i}var o=i(15),r=i(24),l=i(585),d=i(303),u=i(304),c=(i(38),i(13),i(17),function(e){this.construct(e)});r(c.prototype,l.Mixin,{_instantiateReactComponent:s});e.exports=s},function(e,t,i){"use strict";var n=i(15),a=i(52),s=(i(13),{HOST:0,COMPOSITE:1,EMPTY:2,getType:function(e){return null===e||!1===e?s.EMPTY:a.isValidElement(e)?"function"==typeof e.type?s.COMPOSITE:s.HOST:void n("26",e)}});e.exports=s},function(e,t,i){"use strict";var n,a={injectEmptyComponentFactory:function(e){n=e}},s={create:function(e){return n(e)}};s.injection=a,e.exports=s},function(e,t,i){"use strict";function n(e){return l||o("111",e.type),new l(e)}function a(e){return new u(e)}function s(e){return e instanceof u}var o=i(15),r=i(24),l=(i(13),null),d={},u=null,c={injectGenericComponentClass:function(e){l=e},injectTextComponentClass:function(e){u=e},injectComponentClasses:function(e){r(d,e)}},p={createInternalComponent:n,createInstanceForText:a,isTextComponent:s,injection:c};e.exports=p},function(e,t,i){"use strict";var n=i(46),a={listen:function(e,t,i){return e.addEventListener?(e.addEventListener(t,i,!1),{remove:function(){e.removeEventListener(t,i,!1)}}):e.attachEvent?(e.attachEvent("on"+t,i),{remove:function(){e.detachEvent("on"+t,i)}}):void 0},capture:function(e,t,i){return e.addEventListener?(e.addEventListener(t,i,!0),{remove:function(){e.removeEventListener(t,i,!0)}}):{remove:n}},registerDefault:function(){}};e.exports=a},function(e,t,i){"use strict";function n(e){return s(document.documentElement,e)}var a=i(598),s=i(600),o=i(297),r=i(307),l={hasSelectionCapabilities:function(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&"text"===e.type||"textarea"===t||"true"===e.contentEditable)},getSelectionInformation:function(){var e=r();return{focusedElem:e,selectionRange:l.hasSelectionCapabilities(e)?l.getSelection(e):null}},restoreSelection:function(e){var t=r(),i=e.focusedElem,a=e.selectionRange;t!==i&&n(i)&&(l.hasSelectionCapabilities(i)&&l.setSelection(i,a),o(i))},getSelection:function(e){var t;if("selectionStart"in e)t={start:e.selectionStart,end:e.selectionEnd};else if(document.selection&&e.nodeName&&"input"===e.nodeName.toLowerCase()){var i=document.selection.createRange();i.parentElement()===e&&(t={start:-i.moveStart("character",-e.value.length),end:-i.moveEnd("character",-e.value.length)})}else t=a.getOffsets(e);return t||{start:0,end:0}},setSelection:function(e,t){var i=t.start,n=t.end;if(void 0===n&&(n=i),"selectionStart"in e)e.selectionStart=i,e.selectionEnd=Math.min(n,e.value.length);else if(document.selection&&e.nodeName&&"input"===e.nodeName.toLowerCase()){var s=e.createTextRange();s.collapse(!0),s.moveStart("character",i),s.moveEnd("character",n-i),s.select()}else a.setOffsets(e,t)}};e.exports=l},function(e,t,i){"use strict";function n(e){if(void 0===(e=e||("undefined"!=typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(t){return e.body}}e.exports=n},function(e,t,i){"use strict";function n(e,t){for(var i=Math.min(e.length,t.length),n=0;n<i;n++)if(e.charAt(n)!==t.charAt(n))return n;return e.length===t.length?-1:i}function a(e){return e?e.nodeType===L?e.documentElement:e.firstChild:null}function s(e){return e.getAttribute&&e.getAttribute(M)||""}function o(e,t,i,n,a){var s;if(y.logTopLevelRenders){var o=e._currentElement.props,r=o.type;s="React mount: "+("string"==typeof r?r:r.displayName||r.name),console.time(s)}var l=k.mountComponent(e,i,null,v(e,t),a);s&&console.timeEnd(s),e._renderedComponent._topLevelWrapper=e,R._mountImageIntoNode(l,t,e,n,i)}function r(e,t,i,n){var a=S.ReactReconcileTransaction.getPooled(!i&&_.useCreateElement);a.perform(o,null,e,t,a,i,n),S.ReactReconcileTransaction.release(a)}function l(e,t,i){for(k.unmountComponent(e,i),t.nodeType===L&&(t=t.documentElement);t.lastChild;)t.removeChild(t.lastChild)}function d(e){var t=a(e);if(t){var i=m.getInstanceFromNode(t);return!(!i||!i._hostParent)}}function u(e){var t=a(e),i=t&&m.getInstanceFromNode(t);return i&&!i._hostParent?i:null}function c(e){var t=u(e);return t?t._hostContainerInfo._topLevelWrapper:null}var p=i(15),f=i(87),h=i(85),g=i(122),m=(i(70),i(27)),v=i(615),_=i(616),b=i(52),y=i(291),w=i(99),C=(i(38),i(617)),k=i(86),P=i(189),S=i(53),T=i(94),E=i(301),I=(i(13),i(120)),x=i(188),M=(i(17),h.ID_ATTRIBUTE_NAME),A=h.ROOT_ATTRIBUTE_NAME,L=9,O={},j=1,D=function(){this.rootID=j++};D.prototype.isReactComponent={},D.prototype.render=function(){return this.props};var R={TopLevelWrapper:D,_instancesByReactRootID:O,scrollMonitor:function(e,t){t()},_updateRootComponent:function(e,t,i,n,a){return R.scrollMonitor(n,function(){P.enqueueElementInternal(e,t,i),a&&P.enqueueCallbackInternal(e,a)}),e},_renderNewRootComponent:function(e,t,i,n){(!t||1!==t.nodeType&&t.nodeType!==L&&11!==t.nodeType)&&p("37"),g.ensureScrollValueMonitoring();var a=E(e,!1);S.batchedUpdates(r,a,t,i,n);var s=a._instance.rootID;return O[s]=a,a},renderSubtreeIntoContainer:function(e,t,i,n){return null!=e&&w.has(e)||p("38"),R._renderSubtreeIntoContainer(e,t,i,n)},_renderSubtreeIntoContainer:function(e,t,i,n){P.validateCallback(n,"ReactDOM.render"),b.isValidElement(t)||p("39","string"==typeof t?" Instead of passing a string like 'div', pass React.createElement('div') or <div />.":"function"==typeof t?" Instead of passing a class like Foo, pass React.createElement(Foo) or <Foo />.":null!=t&&void 0!==t.props?" This may be caused by unintentionally loading two independent copies of React.":"");var o,r=b(D,null,null,null,null,null,t);if(e){var l=w.get(e);o=l._processChildContext(l._context)}else o=T;var u=c(i);if(u){var f=u._currentElement,h=f.props;if(x(h,t)){var g=u._renderedComponent.getPublicInstance(),m=n&&function(){n.call(g)};return R._updateRootComponent(u,r,o,i,m),g}R.unmountComponentAtNode(i)}var v=a(i),_=v&&!!s(v),y=d(i),C=_&&!u&&!y,k=R._renderNewRootComponent(r,i,C,o)._renderedComponent.getPublicInstance();return n&&n.call(k),k},render:function(e,t,i){return R._renderSubtreeIntoContainer(null,e,t,i)},unmountComponentAtNode:function(e){(!e||1!==e.nodeType&&e.nodeType!==L&&11!==e.nodeType)&&p("40");var t=c(e);if(!t){d(e),1===e.nodeType&&e.hasAttribute(A);return!1}return delete O[t._instance.rootID],S.batchedUpdates(l,t,e,!1),!0},_mountImageIntoNode:function(e,t,i,s,o){if((!t||1!==t.nodeType&&t.nodeType!==L&&11!==t.nodeType)&&p("41"),s){var r=a(t);if(C.canReuseMarkup(e,r))return void m.precacheNode(i,r);var l=r.getAttribute(C.CHECKSUM_ATTR_NAME);r.removeAttribute(C.CHECKSUM_ATTR_NAME);var d=r.outerHTML;r.setAttribute(C.CHECKSUM_ATTR_NAME,l);var u=e,c=n(u,d),h=" (client) "+u.substring(c-20,c+20)+"\n (server) "+d.substring(c-20,c+20);t.nodeType===L&&p("42",h)}if(t.nodeType===L&&p("43"),o.useCreateElement){for(;t.lastChild;)t.removeChild(t.lastChild);f.insertTreeBefore(t,e,null)}else I(t,e),m.precacheNode(i,t.firstChild)}};e.exports=R},function(e,t,i){"use strict";function n(e){for(var t;(t=e._renderedNodeType)===a.COMPOSITE;)e=e._renderedComponent;return t===a.HOST?e._renderedComponent:t===a.EMPTY?null:void 0}var a=i(302);e.exports=n},function(e,t,i){var n=i(14),a=i(5);t.default=n.default.extend({uri:"/videoinfo/v6/",fields:"id,title,fake,preorderable,available_in_countries,hru,poster_originals,content_paid_types,compilation_hru,kind,additional_data,restrict,hd_available,3d_available,uhd_available,hdr10_available,has_5_1,branding.px_audit,branding.brand_web_js,branding.brand_web_css,branding.link,artists,budget,categories,country,description,synopsis,duration,duration_minutes,genres,gross_russia,gross_usa,gross_world,imdb_rating,ivi_rating_10,kp_rating,season,thumb_originals,orig_title,year,years,episode,subsites_availability,subtitles,compilation,compilation_title,drm_only,has_awards,used_to_be_paid,ivi_release_date,sharing_disabled,ivi_rating_10_count,has_comments,has_reviews,promo_images",parse:function(e){e=e.result;var t=e;return t.link="/watch/"+e.id,e.poster_originals&&e.poster_originals[0]&&(t.poster=e.poster_originals[0].path.replace("http:","")),t.year=e.year||(e.years&&e.years.length?e.years[0]:""),t.paidType="avod","TVOD"===e.content_paid_type?t.paidType="tvod":"EST"===e.content_paid_type&&(t.paidType="est"),t},getPosterPath:function(){return this.get("poster")},getTrailerList:function(){return a.filter(this.get("additional_data"),function(e){return"trailer"===e.data_type})}})},function(e,t,i){var n=i(0);t.default=new n.Model({})},function(e,t,i){var n=i(1),a=i(641),s=i(67),o=i(6),r=i(642),l=i(644),d=i(100),u=i(645),c=i(111),p=i(18),f=i(51),h=i(7),g=i(4);t.default=o.default.extend({run:function(e){this.collectionInfo=new c.default({el:"collection-info"}),this.collectionInfo.isPurchasable()&&p.default.canSellBundles()?this.purchasableCollectionActions(e):this.nonPurchasableCollectionActions(e)},nonPurchasableCollectionActions:function(e){var t=new a.default({collection:new s.default,page:e.page}),i=n("form.filter-wrapper");i.append(u.default({sortVariants:{relevance:"Рекомендованные вам",ivi:"По рейтингу ivi",kp:"По рейтингу КиноПоиска",imdb:"По рейтингу IMDB",pop:"По популярности",budget:"По бюджетам",boxoffice:"По сборам",year:"По новизне",new:"По дате добавления",priority_in_collection:"По умолчанию"},currentSort:t.sort})),new r.default({params:e}),new l.default,i.show(),window.ivi.adaptive.isDesktop()&&new d.default},purchasableCollectionActions:function(){this.listenTo(h.default,"user:login",g.default.reload),this.listenTo(h.default,"user:logout",g.default.reload),f.default.attachPosterPopup(n(".js-bundle-items").find("li"));var e=n(".js-movies-count"),t=n(".js-movies-title");e.text(e.data("text")),t.text(t.data("text"))}})},function(e,t,i){var n=i(1),a=i(14),s=i(36);t.default=a.default.extend({uri:"/billing/v1/purchase/content/options/multi/",MAX_IDS_COUNT:10,arrayOfContentPurchaseOptions:[],sendUserABBucket:!0,roundPrice:function(e){return Math.round(100*e)/100},requestOptions:function(){var e=this;this.arrayOfContentPurchaseOptions=[];for(var t=[],i=Array.prototype.slice.call(arguments),a=[];i.length>0;)a.push(i.splice(0,this.MAX_IDS_COUNT));return a.forEach(function(i){e.resetAdditionUriParam(),i.forEach(function(t){e.addParamsToUri("id="+t)}),t.push(e.mapiGet({data:{with_already_bought:!0}}).done(function(t){t.result&&t.result.forEach(function(t){e.arrayOfContentPurchaseOptions.push(new s.default(t))})}))}),n.when.apply(n,t)},getBundleTotalPriceByQuality:function(){var e=this,t={sd:0,hd:0},i=!1,n=!1;return this.arrayOfContentPurchaseOptions.forEach(function(a){var s=null,o=null,r=null;a.getPurchaseOptionList().forEach(function(e){e.isContent()&&e.isEternalBought()&&(e.isSDQuality()&&(o=e),e.isHDQuality()&&(s=e)),e.isSubscription()&&!e.isLongSubscription()&&(r=e)}),s&&(t.hd=e.roundPrice(t.hd+s.getPrice())),o&&(t.sd=e.roundPrice(t.sd+o.getPrice())),r&&(s||i||(t.hd+=r.getPrice(),i=!0),o||n||(t.sd+=r.getPrice(),n=!0))}),t}})},function(e,t,i){var n=i(1),a=i(0),s=i(11),o=i(3),r=i(20);t.default=a.View.extend({el:".buttons-wrapper",BUTTON_SOURCE_FOR_GROOT:"b",purchaseParams:null,contentInfo:null,contentEntity:null,events:{"click .js-buy-click":"triggerEvent","click .js-preorder-click":"preorderClick","click .js-free-click":"watchClick","click .js-preorder-cancel":"preorderCancelClick","click .js-trailers":"trailersClick"},initialize:function(e){this.purchaseParams=e.purchaseParams,this.contentEntity=e.contentEntity,this.contentInfo=e.contentInfo,this.listenTo(s.default,"buy-button:show",this.setPurchased),this.listenTo(s.default,"buy-button:popup:preorderClick",this.preorderClick),this.listenTo(s.default,"buy-button:popup:preorderCancelClick",this.preorderCancelClick)},triggerEvent:function(e,t){return!t&&e?this.purchaseParams.setPurchaseType(n(e.currentTarget).data("purchase-type")):this.purchaseParams.setPurchaseType(t),this.purchaseParams.setPurchaseSourceForGroot(this.BUTTON_SOURCE_FOR_GROOT),s.default.trigger("buy:click",this.contentEntity,this.purchaseParams),!1},watchClick:function(){this.contentEntity.isTvod()&&r.default.localStorage.setItem("autostart_"+this.contentEntity.getId(),!0);var e={source:"b"};n.extend(e,this.contentInfo.getRightTypeForGroot()),o.default.track("watchcontent_click",e)},preorderClick:function(e){o.default.track("preorder_click"),this.triggerEvent(e)},preorderCancelClick:function(){o.default.track("cancel_preorder_click"),s.default.trigger("billing:preorder:cancel:showModal")},trailersClick:function(){var e={source:"b"};n.extend(e,this.contentInfo.getRightTypeForGroot()),o.default.track("watchtrailer_click",e)},setPurchased:function(e){if(e.isPurchased()){var t=n(this.$el).find(".js-buy-click"),i=t.data("watch-link");i||(i=this.contentEntity.getWatchLink()),t.removeClass("js-buy-click"),t.addClass("js-free-click"),t.attr("href",i)}}})},function(e,t,i){var n=i(16),a=i(651);t.default=n.default.extend({modalId:"js-purchase-impossible-wrapper",template:a.default,cancelEl:".js-modal-close",regionEnabled:!0,openEvent:"purchase:impossible:show"})},function(e,t,i){var n=i(0),a=i(5),s=i(11);t.default=n.View.extend({el:".poster",POSTER_SOURCE_FOR_GROOT:"p",purchaseParams:null,contentInfo:null,contentEntity:null,events:{"click .js-buy-click":"triggerEvent"},initialize:function(e){a.extend(this,e)},triggerEvent:function(){return this.purchaseParams.setPurchaseType(),this.purchaseParams.setPurchaseSourceForGroot(this.POSTER_SOURCE_FOR_GROOT),s.default.trigger("buy:click",this.contentEntity,this.purchaseParams),!1}})},function(e,t,i){var n=i(0);t.default=n.View.extend({el:"body",styles:"<style type=\"text/css\">.UnlaijzwEDOPxlfpqKfInew .icon_snail{background-image:url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI3MiIgaGVpZ2h0PSI3MiIgdmlld0JveD0iMCAwIDcyIDcyIj48cGF0aCBmaWxsPSIjZmZmZmZmIiBkPSJNMTguOSw0NC4zbC0xLjItLjljLTctNi40LTQuOC0xOS4zLDMuMy0yMy42LDcuNy00LjEsMTYuNy0yLjUsMjIuMiw0LjQsMi43LDMuNSw0LDguOSwzLjgsMTMuNGExLjQ5LDEuNDksMCwwLDEsLjEtLjZjLjUtMy4yLDEuNi01LjQsMy43LTYuMmExMS43MSwxMS43MSwwLDAsMCwuNS01QTIuODEsMi44MSwwLDAsMSw1MCwyMy40YTIuOSwyLjksMCwwLDEsNS44LDAsMi42OSwyLjY5LDAsMCwxLTEuNCwyLjQsMTguMywxOC4zLDAsMCwxLS4zLDQuN2MuMiwwLC41LjEuNy4xYTcuNDksNy40OSwwLDAsMSwxLjYuNSwxMywxMywwLDAsMCwxLjQtNSwyLjc5LDIuNzksMCwwLDEtLjYtMS44LDIuOSwyLjksMCwxLDEsMy42LDIuOCwxOCwxOCwwLDAsMS0yLjIsNi40YzEsMi4zLjcsNS43LS43LDkuMi0yLjMsNS43LTYuOCwxMC0xMS43LDEwSDIxLjdjLTMuMywwLTUuMiwwLTYuOC0uMS0xLS4xLTEuOS0uMi0yLjUtLjMtMS4yLS4zLTItLjktMS45LTIuMUMxMC41LDQ4LjYsMTIuOCw0Ny4yLDE4LjksNDQuM1ptMy4zLDEuOGMtMywxLjQtNS40LDIuNi03LDMuNSwxLjUuMSwzLjMuMSw2LjQuMUg0NS45YzMuNCwwLDctMy40LDguOS04LjEsMS43LTQuMywxLjMtNy42LS44LTgtMi43LS41LTMuNi42LTQuMSwzLjlhMTMuMTMsMTMuMTMsMCwwLDAtLjIsMS45LDEyLjksMTIuOSwwLDAsMS0uNiwzLjJjLTEuMSwyLjMtMy42LDMuMy03LjEsMi45aC0uMmEyNCwyNCwwLDAsMS03LjEtMS4yQzMxLjYsNDYuOSwyNi43LDQ3LjcsMjIuMiw0Ni4xWm0yNC4yLTQuOWE0LjEyLDQuMTIsMCwwLDAsLjItLjlBMi45MiwyLjkyLDAsMCwxLDQ2LjQsNDEuMlpNMjEuNSwwLDUxLjIuMyw3MiwyMS41bC0uMywyOS43TDUwLjUsNzJsLTI5LjctLjNMMCw1MC41LjMsMjAuOFptMS4yLDNMMy4yLDIyLjEsMyw0OS4zLDIyLjEsNjguN2wyNy4yLjNMNjguNyw0OS45LDY5LDIyLjcsNDkuOSwzLjJabTMwLDIwLjJhLjEuMSwwLDAsMC0uMS4xbC4xLjFhLjEuMSwwLDAsMCwwLS4yWm03LjEuOWEuMS4xLDAsMCwwLS4xLjFsLjEuMWEuMS4xLDAsMCwwLDAtLjJabS0yMiwxNC4zYTEwLjA3LDEwLjA3LDAsMCwxLTEuMSwzLjIsMjQuMzIsMjQuMzIsMCwwLDAsNS42LjhjLjEsMCwuNS0uMy44LTEuMWExNS43NiwxNS43NiwwLDAsMCwuOC00LjRBMTcuOCwxNy44LDAsMCwwLDQwLjcsMjZhMTQuMjMsMTQuMjMsMCwwLDAtMTguNC0zLjZjLTYuMywzLjQtOC4xLDEzLjgtMi42LDE4LjdDMjUuMyw0Ni4yLDMzLjgsNDQsMzQuOCwzOGMuOC01LjQtMi40LTktNi44LTkuMmE0LjY1LDQuNjUsMCwwLDAtNC45LDUuOWMuNiwyLjgsMy41LDMuOCw1LjIsMi4zLDEuMS0uOS4zLTIuNy0uNi0yLjVhMS41MywxLjUzLDAsMSwxLS42LTNjNC4yLS44LDYuNSw0LjksMy4xLDcuN3MtOC45LDEtMTAuMS00YTcuNjMsNy42MywwLDAsMSw4LTkuNkMzNC40LDI2LjEsMzksMzEuMiwzNy44LDM4LjRaIi8+PC9zdmc+)}@media screen and (min-width:600px){.UnlaijzwEDOPxlfpqKfInew .content>.ivi-link{margin-bottom:8px}.UnlaijzwEDOPxlfpqKfInew .icon{margin-top:4px}}.UnlaijzwEDOPxlfpqKfInew .ivi-link:focus _:-ms-lang(x)::after,.UnlaijzwEDOPxlfpqKfInew .ivi-link:focus::after,.UnlaijzwEDOPxlfpqKfInew .ivi-link:hover _:-ms-lang(x)::after,.UnlaijzwEDOPxlfpqKfInew .ivi-link:hover::after{background-color:rgba(255,255,255,.3);-webkit-transition:background-color .08s;-o-transition:background-color .08s;transition:background-color .08s}body.certificate.has-topline.has-UnlaijzwEDOPxlfpqKfI .ivi-top,body.has-UnlaijzwEDOPxlfpqKfI.has-topline .ivi-top{top:205px}.UnlaijzwEDOPxlfpqKfInew .ivi-button{font-size:14px;line-height:18px;height:32px;border-radius:3px;padding:5px 10px;text-align:center}.UnlaijzwEDOPxlfpqKfInew .ivi-button.loading{position:relative;color:transparent!important}@keyframes loader{0%{-webkit-transform:rotate(0deg);-o-transform:rotate(0deg);transform:rotate(0deg)}to{-webkit-transform:rotate(360deg);-o-transform:rotate(360deg);transform:rotate(360deg)}}body.brand.start.has-UnlaijzwEDOPxlfpqKfI.has-topline{background-position:50% 773px}.UnlaijzwEDOPxlfpqKfInew .ivi-link:active _:-ms-lang(x)::after,.UnlaijzwEDOPxlfpqKfInew .ivi-link:active::after{background-color:rgba(237,237,237,.3);-webkit-transition:background-color .08s;-o-transition:background-color .08s;transition:background-color .08s}.UnlaijzwEDOPxlfpqKfInew .text:not(:last-child){margin-bottom:16px}.UnlaijzwEDOPxlfpqKfInew .ivi-link:active{box-shadow:0 0 0 rgba(237,237,237,.3),inset 0 -1.5em 0 rgba(237,237,237,.3);-webkit-transition:box-shadow .08s;-o-transition:box-shadow .08s;transition:box-shadow .08s}body.certificate.has-UnlaijzwEDOPxlfpqKfI .ivi-top{top:173px}@media screen and (max-width:599px){body.has-UnlaijzwEDOPxlfpqKfI.has-topline .page-wrapper::before{height:253px}}body.has-UnlaijzwEDOPxlfpqKfI .bg-triangles{top:173px!important}@-o-keyframes loader{0%{-o-transform:rotate(0deg);transform:rotate(0deg)}to{-o-transform:rotate(360deg);transform:rotate(360deg)}}.UnlaijzwEDOPxlfpqKfInew .icon_baby{background-image:url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI3MiIgaGVpZ2h0PSI3MiIgdmlld0JveD0iMCAwIDcyIDcyIj48cGF0aCBmaWxsPSIjZmZmZmZmIiBkPSJNMjUuMiwzOUE2LjgyLDYuODIsMCwwLDAsMTksNDUuN2E2LjcxLDYuNzEsMCwwLDAsMTMuNC41Wk0zNSw0OC44YTkuNzEsOS43MSwwLDAsMS0xOC45LTMuMSw5Ljc0LDkuNzQsMCwwLDEsNi42LTkuMmwtMi0yYTQuODksNC44OSwwLDEsMSw2LjktNi45bDEuNywxLjdjMi0uNiwzLjEtMS4yLDMuMy0xLjksMS4xLTMuMiwxLjEtNS45LDMuNS04LjNBMTEuNjcsMTEuNjcsMCwwLDEsNTIuNiwzNS42Yy0yLjQsMi40LTUsMi41LTguMiwzLjctLjYuMi0xLjMsMS4zLTIsMy4yTDQ1LDQ1LjFBNC44OSw0Ljg5LDAsMSwxLDM4LjEsNTJaTTIxLjUsMCw1MS4yLjMsNzIsMjEuNWwtLjMsMjkuN0w1MC41LDcybC0yOS43LS4zTDAsNTAuNS4zLDIwLjhabTEuMiwzTDMuMiwyMi4xLDMsNDkuMywyMi4xLDY4LjdsMjcuMi4zTDY4LjcsNDkuOSw2OSwyMi43LDQ5LjksMy4yWk0zOS44LDQwLjhjMS0yLjQsMi0zLjcsMy42LTQuMy41LS4yLDEuMS0uNCwxLjctLjYuMi0uMS41LS4xLjgtLjIuMSwwLC42LS4yLjctLjIsMi4xLS42LDMtMSw0LTJBOC42Myw4LjYzLDAsMCwwLDM4LjQsMjEuM2MtLjkuOS0xLjMsMS44LTEuOSw0LjEtLjUsMS44LS42LDIuMi0uOSwzLjItLjYsMS43LTIsMi43LTQuNCwzLjVDMzAuOSwzMiwzOS43LDQwLjksMzkuOCw0MC44Wk0yMi42LDI5LjZhMiwyLDAsMCwwLC4yLDIuOEw0MC4zLDQ5LjlhMS44NiwxLjg2LDAsMSwwLDIuNi0yLjZMMjUuNCwyOS44QTIsMiwwLDAsMCwyMi42LDI5LjZaTTQ4LDMxYTEuOCwxLjgsMCwwLDEtMi42LjIsMS44OSwxLjg5LDAsMCwxLC4yLTIuNiwxLjcsMS43LDAsMCwwLC4yLTEuOCwxLjksMS45LDAsMCwxLDAtMi43LDEuODIsMS44MiwwLDAsMSwyLjYuNEE1LDUsMCwwLDEsNDgsMzFaIi8+PC9zdmc+)}.UnlaijzwEDOPxlfpqKfI .content .text+.buttons-wrapper{margin-top:16px}.UnlaijzwEDOPxlfpqKfI .content .title{display:block;color:#ec174f;font-size:18px;line-height:22px}body.has-UnlaijzwEDOPxlfpqKfI .ivi-top{top:173px}.UnlaijzwEDOPxlfpqKfInew{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;font-family:Roboto,iviextras,Arial,Helvetica,FreeSans,sans-serif;color:#fff}@media screen and (max-width:599px){body.has-UnlaijzwEDOPxlfpqKfI.has-topline .ivi-top::before,body.has-UnlaijzwEDOPxlfpqKfI.has-topline .ivi-top__menu{top:253px}}.UnlaijzwEDOPxlfpqKfInew .icon_rocket{background-image:url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI3MiIgaGVpZ2h0PSI3MiIgdmlld0JveD0iMCAwIDcyIDcyIj48cGF0aCBmaWxsPSIjZmZmZmZmIiBkPSJNMjIuNywzLDMuMiwyMi4xLDMsNDkuMywyMi4xLDY4LjdsMjcuMi4zTDY4LjcsNDkuOSw2OSwyMi43LDQ5LjksMy4yWk0yMS41LDAsNTEuMi4zLDcyLDIxLjVsLS4zLDI5LjdMNTAuNSw3MmwtMjkuNy0uM0wwLDUwLjUuMywyMC44Wm0zLjcsNDVoMGwtMSwxYTEuNDEsMS40MSwwLDAsMCwyLDJsMS0xLC45LjlhMy4xNiwzLjE2LDAsMCwwLDIuOC44LDE1LjgzLDE1LjgzLDAsMCwwLDMuNi0xLjNsLTEuMSw2LjFhMi4xMSwyLjExLDAsMCwwLC42LDEuOCwxLjkzLDEuOTMsMCwwLDAsMi44LDBsNS4xLTUuMWEyLjc1LDIuNzUsMCwwLDAsLjgtMS41TDQ0LjQsNDFhMS43LDEuNywwLDAsMCwwLTFDNTEuNiwzMi42LDU3LDE5LjMsNTUsMTcuMlMzOS42LDIwLjYsMzIuMSwyNy44YTEuNywxLjcsMCwwLDAtMSwwbC03LjcsMS43YTIuNzUsMi43NSwwLDAsMC0xLjUuOGwtNS4xLDUuMWExLjkzLDEuOTMsMCwwLDAsMCwyLjgsMiwyLDAsMCwwLDEuOC42bDYuMS0xLjFhMTUuODMsMTUuODMsMCwwLDAtMS4zLDMuNiwzLjI0LDMuMjQsMCwwLDAsLjgsMi44Wm00LjEtLjFoMGw1LTVhMS40MSwxLjQxLDAsMCwwLTItMmwtNSw1LS45LS45Yy42LTIuNiwyLjYtNi4xLDYuMi0xMC40YTM5Ljg0LDM5Ljg0LDAsMCwxLDEzLTkuM0EzNC40MiwzNC40MiwwLDAsMSw1MS43LDIwYy4yLDAsLjMtLjEuNS0uMSwwLC4yLS4xLjMtLjEuNWEzMS43NywzMS43NywwLDAsMS0yLjMsNi4xYy0yLjUsNS4yLTUuOSwxMC4xLTkuMywxMy00LjIsMy42LTcuNyw1LjctMTAuNCw2LjJabTguMywxLjksMy4xLTMuMS0xLDQuMy0yLjgsMi44Wk0yNC4xLDMyLjRsNC4zLTEtMy4xLDMuMS00LjEuN1ptMTQuOC45YTMuMzIsMy4zMiwwLDEsMCwwLTQuN0EzLjMyLDMuMzIsMCwwLDAsMzguOSwzMy4zWm0xLjQtMS40YTEuMjcsMS4yNywwLDEsMSwxLjgsMEExLjI3LDEuMjcsMCwwLDEsNDAuMywzMS45Wm0tMTksMTUuMmExLjM0LDEuMzQsMCwwLDAtMiwwbC00LjEsNC4xYTEuNDEsMS40MSwwLDAsMCwyLDJsNC4xLTQuMUExLjUyLDEuNTIsMCwwLDAsMjEuMyw0Ny4xWm00LjIsNC4zYTEuMzQsMS4zNCwwLDAsMC0yLDBsLTQuMSw0LjFhMS40MSwxLjQxLDAsMCwwLDIsMmw0LjEtNC4xQTEuMzQsMS4zNCwwLDAsMCwyNS41LDUxLjRaIi8+PC9zdmc+)}.UnlaijzwEDOPxlfpqKfI .content .text span{display:block}.UnlaijzwEDOPxlfpqKfInew .icon{-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;width:72px;height:72px;margin-right:24px;background-repeat:no-repeat;background-position:50% 50%}body.catalog.has-UnlaijzwEDOPxlfpqKfI.has-topline .filters-common-wrapper.fixed .filters-common,body.catalog.has-UnlaijzwEDOPxlfpqKfI.has-topline .filters-extra-wrapper.fixed .filters-extra,body.catalog.has-UnlaijzwEDOPxlfpqKfI.has-topline .filters-extra-wrapper.hidden .filters-extra{top:265px}@media screen and (max-width:599px){body.certificate.has-UnlaijzwEDOPxlfpqKfI .ivi-top::before,body.certificate.has-UnlaijzwEDOPxlfpqKfI .ivi-top__menu{top:221px}}.UnlaijzwEDOPxlfpqKfInew .icon_stop{background-image:url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI3MiIgaGVpZ2h0PSI3MiIgdmlld0JveD0iMCAwIDcyIDcyIj48cGF0aCBmaWxsPSIjZmZmZmZmIiBkPSJNMjEuNSwwLDUxLjIuMyw3MiwyMS41bC0uMywyOS43TDUwLjUsNzJsLTI5LjctLjNMMCw1MC41LjMsMjAuOFptMS4yLDNMMy4yLDIyLjEsMyw0OS4zLDIyLjEsNjguN2wyNy4yLjNMNjguNyw0OS45LDY5LDIyLjcsNDkuOSwzLjJaTTIwLjYsMjIuNGE0Ljg0LDQuODQsMCwwLDEsMS44LjMsNS4yMiw1LjIyLDAsMCwxLDUuMy01LjQsNy4zOSw3LjM5LDAsMCwxLDIuMy40LDQuMzMsNC4zMywwLDAsMSwuMS0uNSw1LjM5LDUuMzksMCwwLDEsMTAuNy0uNiw1LjU2LDUuNTYsMCwwLDEsMi4zLS41LDUuMzUsNS4zNSwwLDAsMSw1LjUsNS4xVjMyLjhjMS4zLTIuMiwyLjktMi45LDUuOC0xLjdhNC4yNSw0LjI1LDAsMCwxLDIuNyw0LjcsMTYsMTYsMCwwLDEtMS45LDUuNmMtLjMuNi0uNiwxLjMtMSwyLS4yLjQtMSwxLjktMSwxLjktLjQuNy0uNiwxLjItLjksMS43LTMuNiw3LjQtOS4xLDEyLTE4LjUsMTJDMjMuNSw1OC45LDE2LDUxLDE2LDQwLjVWMjcuNEMxNiwyNC42LDE3LjYsMjIuNSwyMC42LDIyLjRabTEuNyw0LjJhMS4zOCwxLjM4LDAsMCwwLTEuNi0xLjJjLTEuMiwwLTEuNy42LTEuNywxLjlWNDAuNWMwLDguOCw2LjEsMTUuMywxNC44LDE1LjMsOC4xLDAsMTIuNi0zLjksMTUuOC0xMC4zLjItLjUuNS0xLC45LTEuOCwwLDAsLjgtMS41LDEtMS45LjQtLjcuNy0xLjMsMS0xLjksMS45LTMuOCwyLTUuNy44LTYuMi0xLjYtLjYtMi0uMy0yLjksMi4yLDAsLjEsMCwuMS0uMS4zYTYuNzIsNi43MiwwLDAsMS0xLjgsMy4yLDEuNDksMS40OSwwLDAsMS0xLjguMiwxLjc2LDEuNzYsMCwwLDEtLjgtLjksMywzLDAsMCwxLS4yLTEsMjUuNDYsMjUuNDYsMCwwLDEtLjEtMy4xVjIxLjFBMi40LDIuNCwwLDAsMCw0My4yLDE5LDIuMTksMi4xOSwwLDAsMCw0MSwyMC44djEzYS45NC45NCwwLDAsMS0xLDFIMzguOWEuOTQuOTQsMCwwLDEtMS0xVjE3LjRhMi4yOSwyLjI5LDAsMCwwLTIuNC0yLjMsMi4yMywyLjIzLDAsMCwwLTIuMywyLjRWMzMuOGEuOTQuOTQsMCwwLDEtMSwxSDMxLjFhLjk0Ljk0LDAsMCwxLTEtMVYyMi4zYTIuMjksMi4yOSwwLDAsMC0yLjMtMiwyLjMzLDIuMzMsMCwwLDAtMi40LDIuNVYzNi41YS45NC45NCwwLDAsMS0xLDFIMjMuMmEuOTQuOTQsMCwwLDEtMS0xVjI2LjZaIi8+PC9zdmc+)}@media screen and (min-width:600px) and (max-width:1019px){body.has-UnlaijzwEDOPxlfpqKfI.has-topline .ivi-top::before,body.has-UnlaijzwEDOPxlfpqKfI.has-topline .ivi-top__menu{top:265px}}body.brand.catalog.has-UnlaijzwEDOPxlfpqKfI.has-topline,body.brand.selections.item.has-UnlaijzwEDOPxlfpqKfI.has-topline,body.brand.start.has-UnlaijzwEDOPxlfpqKfI,body.brand.watch-common.has-UnlaijzwEDOPxlfpqKfI.has-topline{background-position:50% 265px}body.has-UnlaijzwEDOPxlfpqKfI.has-topline .UnlaijzwEDOPxlfpqKfI{top:32px}.UnlaijzwEDOPxlfpqKfInew .icon_gift{background-image:url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI3MiIgaGVpZ2h0PSI3MiIgdmlld0JveD0iMCAwIDcyIDcyIj48cGF0aCBmaWxsPSIjZmZmZmZmIiBkPSJNMjIuNCwyN0E3LjYyLDcuNjIsMCwwLDEsMjAsMjEuNGE3LjgsNy44LDAsMCwxLDE1LjYsMHYwYTcuOCw3LjgsMCwwLDEsMTUuNiwwQTcuNjIsNy42MiwwLDAsMSw0OC44LDI3aDUuOWExLjU0LDEuNTQsMCwwLDEsMS41LDEuNXYxMEExLjU0LDEuNTQsMCwwLDEsNTQuNyw0MEg1My4yVjUzLjVBMS41NCwxLjU0LDAsMCwxLDUxLjcsNTVIMTkuNGExLjU0LDEuNTQsMCwwLDEtMS41LTEuNVY0MEgxNi40YTEuNTQsMS41NCwwLDAsMS0xLjUtMS41di0xMEExLjU0LDEuNTQsMCwwLDEsMTYuNCwyN1pNMjEuNSwwLDUxLjIuMyw3MiwyMS41bC0uMywyOS43TDUwLjUsNzJsLTI5LjctLjNMMCw1MC41LjMsMjAuOFptMS4yLDNMMy4yLDIyLjEsMyw0OS4zLDIyLjEsNjguN2wyNy4yLjNMNjguNyw0OS45LDY5LDIyLjcsNDkuOSwzLjJaTTIwLjEsNDBWNTIuOEg1MC45VjQwWm0tMi45LTJINTMuOFYyOS4ySDE3LjJaTTQzLjMsMjYuOWE1LjQ4LDUuNDgsMCwwLDAsNS41LTUuNSw1LjUsNS41LDAsMSwwLTExLDB2NS41Wm0tMTAsMFYyMS40YTUuNSw1LjUsMCwxLDAtNS41LDUuNVpNMjYuMyw0OEg0NC44YTEuMSwxLjEsMCwwLDEsMCwyLjJIMjYuM2ExLjEsMS4xLDAsMSwxLDAtMi4yWiIvPjwvc3ZnPg==)}@media screen and (min-width:600px){body.certificate.has-topline.has-UnlaijzwEDOPxlfpqKfI .page-wrapper::before{height:265px}}@media screen and (min-width:600px){.UnlaijzwEDOPxlfpqKfInew .text{font-size:20px;line-height:24px;font-weight:700;font-style:normal}}.UnlaijzwEDOPxlfpqKfI .content .buttons-wrapper .extra-link:hover{color:#ec174f;background-image:-webkit-linear-gradient(left,rgba(236,23,79,.3) 50%,rgba(236,23,79,.3) 100%);background-image:-o-linear-gradient(left,rgba(236,23,79,.3) 50%,rgba(236,23,79,.3) 100%);background-image:linear-gradient(to right,rgba(236,23,79,.3) 50%,rgba(236,23,79,.3) 100%)}body.catalog.has-UnlaijzwEDOPxlfpqKfI .filters-common-wrapper.fixed .filters-common,body.catalog.has-UnlaijzwEDOPxlfpqKfI .filters-extra-wrapper.fixed .filters-extra,body.catalog.has-UnlaijzwEDOPxlfpqKfI .filters-extra-wrapper.hidden .filters-extra{top:233px}.UnlaijzwEDOPxlfpqKfI .content .title+.text{margin-top:8px}@media screen and (max-width:599px){body.has-UnlaijzwEDOPxlfpqKfI .page-wrapper::before{height:221px}}.UnlaijzwEDOPxlfpqKfI .content .text{color:#282350;font-size:14px;line-height:20px}@media screen and (max-width:599px){body.has-UnlaijzwEDOPxlfpqKfI .ivi-top::before,body.has-UnlaijzwEDOPxlfpqKfI .ivi-top__menu{top:221px}}.UnlaijzwEDOPxlfpqKfInew .ivi-button.loading::after{content:'';width:19px;height:19px;-webkit-animation:loader 1s linear infinite;-o-animation:loader 1s linear infinite;animation:loader 1s linear infinite;background-image:url(../images/_common/loader/loader-white.svg?v=cab87e15023681e5);background-size:19px 19px;position:absolute;top:50%;left:50%;margin-left:-9.5px;margin-top:-9.5px}@media screen and (max-width:599px){.UnlaijzwEDOPxlfpqKfInew .icon{display:none}.UnlaijzwEDOPxlfpqKfInew .text{font-size:16px;line-height:20px;font-weight:700;font-style:normal}}@media screen and (min-width:600px){body.certificate.has-UnlaijzwEDOPxlfpqKfI .page-wrapper::before{height:233px}}@media screen and (max-width:599px){body.certificate.has-topline.has-UnlaijzwEDOPxlfpqKfI .page-wrapper::before{height:253px}}.UnlaijzwEDOPxlfpqKfI .content .buttons-wrapper>*+*{margin-left:20px}.UnlaijzwEDOPxlfpqKfI .content .buttons-wrapper>*{font-size:14px}@media screen and (min-width:600px) and (max-width:1019px){body.certificate.has-UnlaijzwEDOPxlfpqKfI .ivi-top::before,body.certificate.has-UnlaijzwEDOPxlfpqKfI .ivi-top__menu{top:233px}}@media screen and (min-width:600px) and (max-width:1019px){body.certificate.has-topline.has-UnlaijzwEDOPxlfpqKfI .ivi-top::before,body.certificate.has-topline.has-UnlaijzwEDOPxlfpqKfI .ivi-top__menu{top:265px}}@media screen and (max-width:599px){body.certificate.has-topline.has-UnlaijzwEDOPxlfpqKfI .ivi-top::before,body.certificate.has-topline.has-UnlaijzwEDOPxlfpqKfI .ivi-top__menu{top:253px}}@-webkit-keyframes loader{0%{-webkit-transform:rotate(0deg);transform:rotate(0deg)}to{-webkit-transform:rotate(360deg);transform:rotate(360deg)}}.UnlaijzwEDOPxlfpqKfInew .ivi-link:not(:hover):not(:focus):not(:active) _:-ms-lang(x)::after,.UnlaijzwEDOPxlfpqKfInew .ivi-link:not(:hover):not(:focus):not(:active)::after{background-color:rgba(255,255,255,.3);-webkit-transition:background-color .4s;-o-transition:background-color .4s;transition:background-color .4s}@media screen and (max-width:599px){.UnlaijzwEDOPxlfpqKfInew{padding-right:32px}}.UnlaijzwEDOPxlfpqKfI .content{width:980px;height:173px;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box;padding-left:160px;margin:0 auto;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAG0AAABtCAYAAACr+O9WAAAAAXNSR0IArs4c6QAACw1JREFUeAHtnQuM3MQZgH97n7d7z4QkpUpQpQhaqUcRQipNlJaoUARtUEUhShWqiCgSpYg2qUJVtaVIqEEoggjxqIoqldKGPqISoCgqL5FckxBEgF5bAiiFFPIizV3utXu32du93e3/+9az67td79jrsWft/aU7z3hmZ/75P489Hv9jK+CxlEqlflQh7rEaVqrPKopyxMoPfJUXgW3Fv1aUrb4CwdsYJNWqwPSDLFjgfAAsWOB8BCwY4HwIzN/gfAzMn+ACAMxVcArvaM9uPgKGv32Q4/el/MF39hdPDZU48rqaRV26WImsuvQrWCmPve7C+7gdIhXkUcJ2/VaAZR975sDUtt+TYaSU5N0b9sfv/NaXUTkemwkFx6OALSP6CZhuAFnACYHmR2AygXMcmp+ByQLOUWhBACYDOMegBQmY1+AcgRZEYF6CaxpakIF5Ba4paG1gOjYAN28HbEOTGVjkuish+fMNoCzqBSiWoDRTgKnD78KZHz0KM0Nj2t1xXAlBlxIGVbFtggqxcsgtcLY0lhmYetES6D34GCjRyDyjpl9+A47fcg/bn0Ro3er8fCyDjYAb4MJW9fIaWGT15RC+4hKACKpeLEL2v6ch9cwAAPYmkq7Ll9cERmmJlV+gDZMcFFnYqUB5Ko53yutBtCdYnau0BM1rYB2bb4bET75jsG8CY9Gbr4KP1/5U2x9SSrDQkKMSUUJqJSIwJBocdyu8BkY2jm/6Rk1Td66+AqLLl9ZM82ongaNJcKyf56kF9ThunxMuaDIAI+MrC7vrMgibpNX9keAEUeAaQpMFmGD7CiteBDjTa5rfgSVWXQbJm64GpTupQcuPpWB81yuQffN9LR7Cm4ME3hqElYbHtil0p69xdaH5HtiKfli6+34auTGDxzCUXP81OHbt9yH7zjFtf6ZUgEVqDEJV+dgPLAScBFfzEPI7MLJ1zzevMgDT7a+EQ9C9ZpUexVFECaZh9naC7bQZcOpUOQ9aEICRzdUuulmoLaE5aTzDv9olzd/rBDgDtKAAm29Kd/c0C45BawNrHXAatDYwd4HptdntcWEERuvDuPwSRbq50Yx8dM0KUBKzS9UKU+chtec1nJUf1dpIs/EL9Nb6aEvgsDlW5ipfoiE/z4K+kkhg6tJF0PPyDlAXGGc8Ej9eD8euvhPyJ8/yTQa1KEyL4OLsmmbSXqHAqN7Y+mvmAaP94b5uWLDpBgr6XqycKhtCI1ft8pEgzHAqPaysI6Gerjop/ttNdiZ7N2pZQ2iu+NbjM6W2zFqAx94NoblizDYzS2aWA5ollduZ5YDWPj1aOhLlgGZJ5XZmOaC1e5qlI1EOaJZUbmeWA1p79GjpSJQCGs5/WlI66JmlgNbqEDQvsVjFU7mAB6HIA1EOaC3a02iiO/nA96Dvn09A35HfgXr9lTBWzMFQMYt/05ArOe/BTAd4XceeVj/6RepPsDq2rIXYuq+CQu7pKLTtvP82OL1nQIsX0bckXcrDQoXchZwVOaC1yiUNnX4Sd2/QPJ11WNU4Srl8dRQd8CqeXoaEJiNyQGuyEa78HB/Cdj6+FWJrVtatbmj7TkNaJ67KESFyXNO43N1FNJ+/zI4f4unQBFj26HEY/8urrEBa/xZt0smVFTYnIAc0hwYiSiIG4cX1n83NaTt3NIRr3jo2rzXNP7zjD/h0vXKeF9XLSAkx/de0eWISL3rqXgj1dtV0QGU1qgqoPZ1QnJhku3gCffdsBKVqSD/3N9MfnoSJ5/az3dTLIoJ6GVUiB7TKAcoabjVArgmNRI1F4XPv/glSfzsE0WVLGmXX0hNf6ofEDRWP41o/Gn54l6GX0QpTkSK2dJGa2yybwPXeuJrv1zj4uHDb7aZ582fOwcTufSwPXcdEXcv0Slrimhbq6wI6/SmhkK63K9vedddAx2UXm9Y18uvnoJSfYXlE9zKqSPqeFrtkGSx/9ZfcpzNmvSYDajIOS3620bSUYiYLoztfYHloaVQMxPcDOaBVjbqYBcqB5Bc/P3eXK/ELfrAOIp+qt3p7VoXxp/caBjUJvJZVL50Spaj00EQ13KzcCA5S+nAddyMZfXKPIQstQHRD5IDmRkst1NF93YqGuTODR9nCQ8rcgcCcfJGMmQLiT8BmtetpDgz59aLc2o499aKhKoLmlsgBza3WOlRP8fw0TDw7wErTBiCBg2YyEGGWkSiQeuF1KKYzTCM3exlV2u5pzPT8gYndew2ZgwmthXpaAect03vfYtBojrHZV1awwjgD7Z7GaSg9G81b6i9Po31xcG8AousgB7QWGj2m9hzUbadt4wJn8w0VVUXkgFalkMzB4lQWJv/+D6YinRbdPjVS5VJAE+luxizsQGDywCCUpit+IHGPzCcFtFZZUJ1+5bABvehHMIbKqiKSQKvSSOLg5MDbTDvytIoGuqe1wEAkd/x/kD+Bb1koC/UyN2b09fqqt+2eVm0Nk/DUoX8bUr3qZaREQ2j0wTeDtiIiLXBznXlr9h2QevMjTb5KUC9n7pbH3g2h0Rf66LXlcwt3Ml4aSTlZnJCych99YigX3+hviDsRITuXv4hoWhxPzQp9oU8kuMLJIVMlZUjMHT9jUIPHcIYfNIhYeZ8/1Z1tUB4lCwVXeP9jDhW8y1KYPA/5U8NMAZpvdHIQYgUYKpHFh63KEQzcxTSqHxAGrnhiCApnRurX7HFKhgYh+OEGXZwchFgERt8aPaL1cgzsQIU8BZffN6jbRLpt9dQVKefUTbUNYMSpcjX1Glzu+ddIH+mkiMuXxqueUuOJ0RE3ObvAyECG66mX4PIDgzBz9KR00CbwOzaF4XGmF3lcoZ1Y3E6gGWBUnwEa7fAS3PlHniYVpJESXsfO/Wo304emrpr1IG4WGCkzDxrt9Apc7tkDUPjgFKkghYyh9/D0ex8xXWj5UjNuck4AI2VqQqMET8DhkT255VGgI9xrmRmZgLPbfsvUoOdmySY8rpwCRgrVhUaJXoCbeRudQB//K1XvqZze8hAUxtNMh14lQvZgcSsBJ4FRvabQKIMX4DL37YTcvsoTYtLDTRl+ZBekX3ydVdmDXzO0u0jQaWCkVENolMl1cIUipDdth/xh4yQt6SJaxtE97uwvnmDV0HWMFlbYERHASA8uaJTRdXCZaUh9+17IH6IJG3dk7I8vwak7HmCVEbAum98MFQWMlLN8kkZ/jq34O/fe44/v7khu/y7Eb7mWGdPpAA18zt73JJzD0yIJDe3plGjXCVUksFn9NDWt/XMdHKoXxVcYJbffDuriPmvKNsg9/cEJOL35Ici8+Z6Wk6aoenDQYdfLSjQwUtJyT9Nt4AU4pScJ8TtuhPjG60Etf6hO18fqdgZnOYYf/jOM/OZ5zfmUFlF0qmHoQOdTWUaJ9dpkGxoV6AU4rSEdUe1FLLFbvw4R+nwyp9BpcGr/IIziMqU0egrTWml6fQSdBmnZrV1YVL0bPUxvZlPQqBDPwJVboH76Agiv7IfwZ5eB+pkLgV42Bt0JoPdUzYymIP/JMOTwW9jZf30IucH/AOBTcupVdBqMIKhmZjh0I7oJjOpsGhoV4jU40sErcRsYtdMRaFRQEMF5AcxRaEED5xUwx6EFBZyXwIRA8zs4r4EJg+ZXcDIAEwrNb+BkASYcmlVw9ME3nu+HUbluCrlqlz1/eUbb5OameU25qaPjddHtAP4FQWgy3T+CxPwOzl/A9EPPx+D8CczH4PwNzIfgggHMR+CCBcwH4DwFxnPfodtYyBYHJ/1YcFxI4WIKzeJ9mHveRjXa8H/zaVA21PU5cAAAAABJRU5ErkJggg==) 0 50% no-repeat;padding-top:24px}@media screen and (max-width:599px){.UnlaijzwEDOPxlfpqKfInew .icon{display:none}}.UnlaijzwEDOPxlfpqKfInew .ivi-link:not(:hover):not(:focus):not(:active){box-shadow:0 2px 0 rgba(255,255,255,.3),inset 0 0 0 rgba(255,255,255,.3);-webkit-transition:box-shadow .4s;-o-transition:box-shadow .4s;transition:box-shadow .4s}@media screen and (min-width:600px){body.has-UnlaijzwEDOPxlfpqKfI.has-topline .page-wrapper::before{height:265px}}.UnlaijzwEDOPxlfpqKfI .content .buttons-wrapper{font-size:0}.UnlaijzwEDOPxlfpqKfInew .ivi-button::before{display:inline-block;margin-right:6px;vertical-align:top;font-size:16px;line-height:16px}body.has-UnlaijzwEDOPxlfpqKfI.has-topline .bg-triangles{top:205px!important}body.certificate.has-topline.has-UnlaijzwEDOPxlfpqKfI .UnlaijzwEDOPxlfpqKfI{top:32px}@media screen and (min-width:600px) and (max-width:1019px){body.has-UnlaijzwEDOPxlfpqKfI .ivi-top::before,body.has-UnlaijzwEDOPxlfpqKfI .ivi-top__menu{top:233px}}@media screen and (max-width:599px){body.certificate.has-UnlaijzwEDOPxlfpqKfI .page-wrapper::before{height:221px}}body.brand.catalog.has-UnlaijzwEDOPxlfpqKfI,body.brand.selections.item.has-UnlaijzwEDOPxlfpqKfI,body.brand.watch-common.has-UnlaijzwEDOPxlfpqKfI{background-position:50% 233px}@media screen and (min-width:600px){.UnlaijzwEDOPxlfpqKfInew{padding-right:40px}}@media screen and (min-width:600px){body.has-UnlaijzwEDOPxlfpqKfI .page-wrapper::before{height:233px}}.UnlaijzwEDOPxlfpqKfI{background:#e3e4e8;height:173px;position:fixed;width:100%;top:0;z-index:999;font-family:Roboto,iviextras,Arial,Helvetica,FreeSans,sans-serif;-webkit-transform:translateZ(0)}.UnlaijzwEDOPxlfpqKfI .content .buttons-wrapper .extra-link{color:#282350;background-position:0 100%;background-size:1px 1px;background-repeat:repeat-x;background-image:-webkit-linear-gradient(left,rgba(40,35,80,.3) 50%,rgba(40,35,80,.3) 100%);background-image:-o-linear-gradient(left,rgba(40,35,80,.3) 50%,rgba(40,35,80,.3) 100%);background-image:linear-gradient(to right,rgba(40,35,80,.3) 50%,rgba(40,35,80,.3) 100%)}body.certificate.has-UnlaijzwEDOPxlfpqKfI .bg-triangles{top:173px!important}body.certificate.has-topline.has-UnlaijzwEDOPxlfpqKfI .bg-triangles{top:205px!important}.UnlaijzwEDOPxlfpqKfInew .ivi-link:focus,.UnlaijzwEDOPxlfpqKfInew .ivi-link:hover{box-shadow:0 0 0 rgba(255,255,255,.3),inset 0 -1.5em 0 rgba(255,255,255,.3);-webkit-transition:box-shadow .08s;-o-transition:box-shadow .08s;transition:box-shadow .08s}.UnlaijzwEDOPxlfpqKfInew .content>.ivi-link{font-size:16px;line-height:20px;font-weight:500;font-style:normal}.UnlaijzwEDOPxlfpqKfInew .icon_heart{background-image:url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI3MiIgaGVpZ2h0PSI3MiIgdmlld0JveD0iMCAwIDcyIDcyIj48cGF0aCBmaWxsPSIjZmZmZmZmIiBkPSJNMjEuNSwwLDUxLjIuMyw3MiwyMS41bC0uMywyOS43TDUwLjUsNzJsLTI5LjctLjNMMCw1MC41LjMsMjAuOFptMS4yLDNMMy4yLDIyLjEsMyw0OS4zLDIyLjEsNjguN2wyNy4yLjNMNjguNyw0OS45LDY5LDIyLjcsNDkuOSwzLjJaTTMzLjksMjMuM2MtLjEuMS0uMi4zLS4zLjRoLjhBNi45LDYuOSwwLDAsMSwzNiwyNS41YTEzLjcyLDEzLjcyLDAsMCwxLDEuNi0xLjhoLjhjLS4xLS4xLS4yLS4zLS4zLS40QTExLjMsMTEuMywwLDAsMSw0NC44LDIxLDExLjA2LDExLjA2LDAsMCwxLDU2LDMxLjlDNTYsNDAuNCwzNiw1NiwzNiw1NlMxNiw0MC40LDE2LDMxLjlBMTEuMDYsMTEuMDYsMCwwLDEsMjcuMiwyMSwxMS4zLDExLjMsMCwwLDEsMzMuOSwyMy4zWm0zLjMsMjcuOGMyLjMtMS45LDQuNi00LDYuNy02LjFhNjQuMiw2NC4yLDAsMCwwLDUuMi01LjdjMi42LTMuMiwzLjktNS45LDMuOS03LjRhOC4xNCw4LjE0LDAsMCwwLTE0LjYtNC43TDM2LDMwLjVsLTIuNC0zLjNBOC4xNCw4LjE0LDAsMCwwLDE5LDMxLjljMCwxLjYsMS40LDQuMiwzLjksNy40QTY0LjIsNjQuMiwwLDAsMCwyOC4xLDQ1YzIuMSwyLjEsNC40LDQuMiw2LjcsNi4xLjQuMy44LjcsMS4yLDFBMTAuNTksMTAuNTksMCwwLDAsMzcuMiw1MS4xWiIvPjwvc3ZnPg==)}</style>"})},function(e,t,i){var n=i(674),a=i(319),s=i(675),o=i(320),r=i(8),l=function(){function e(e){this.adBlockStorage=e}return e.prototype.setAdBlockCategoryType=function(e){this.adBlockCategoryType=e},e.prototype.getMessage=function(){return this.adBlockCategoryType===o.AdBlockCategoryType.ReAdBlock?this.getReAdBlockerMessage():this.getContentMessage()},e.prototype.getContentMessage=function(){var t=null,i=n.default.getUserRetention(this.adBlockStorage.getVisitsCount(),this.adBlockStorage.getFirstVisitDate(),this.adBlockStorage.getLastVisitDate());if(a.default.chain[this.adBlockCategoryType]&&a.default.chain[this.adBlockCategoryType][i]){var r=a.default.chain[this.adBlockCategoryType][i],l=this.adBlockStorage.getLastCommunicationNumber(),d=null===l||l>=r.length-1?0:l+1,u=r[d];e.isOldUser()&&0===d&&(this.adBlockCategoryType===o.AdBlockCategoryType.Movies?u=0:this.adBlockCategoryType===o.AdBlockCategoryType.Series?u=14:this.adBlockCategoryType===o.AdBlockCategoryType.Animation&&(u=12));var c=a.default.messages[u];c&&(t=new s.default(c[0],c[1],c[2],c[3],{id:u,num:d,segment:this.adBlockCategoryType,retention:n.default.getUserRetentionValue(this.adBlockStorage.getVisitsCount(),this.adBlockStorage.getFirstVisitDate(),this.adBlockStorage.getLastVisitDate()).toFixed(1)})),this.adBlockStorage.setLastCommunicationNumber(d)}return t},e.prototype.getReAdBlockerMessage=function(){var e=null;if(a.default.chain[this.adBlockCategoryType]){var t=this.adBlockStorage.getLastCommunicationNumber(),i=null===t||t>=a.default.chain[this.adBlockCategoryType].length-1?0:t+1,o=a.default.chain[this.adBlockCategoryType][i],r=a.default.messages[o];r&&(e=new s.default(r[0],r[1],r[2],r[3],{id:o,num:i,segment:this.adBlockCategoryType,retention:n.default.getUserRetentionValue(this.adBlockStorage.getVisitsCount(),this.adBlockStorage.getFirstVisitDate(),this.adBlockStorage.getLastVisitDate()).toFixed(1)})),this.adBlockStorage.setLastCommunicationNumber(i)}return e},e.isOldUser=function(){var t=r.default.getFirstCreatedDate();return!!t&&Date.now()-t.getTime()>e.HALF_YEAR},e.HALF_YEAR=15552e6,e}();t.default=l},function(e,t){t.default={chain:{movies:[[1,3,6,7,10,3,6,10,8,9],[1,3,6,10,5,6,7,10,6,7],[1,2,4,7,11,8,9,11,10,11],[1,2,3,6,7,9,11,8,10,11],[1,2,3,5,6,7,9,10,3,4],[1,2,3,4,5,6,7,8,9,10]],series:[[15,4,10,8,10,9,10,5,10,9],[15,25,38,5,10,8,10,9,10,38],[15,65,4,7,8,10,9,10,5,10],[15,65,38,2,4,5,9,10,8,10],[15,25,65,4,8,5,38,7,9,10],[15,2,65,4,38,5,7,8,9,10]],trailers:[[15,4,10,8,10,9,10,5,10,9],[15,25,35,5,10,8,10,9,10,35],[15,65,4,7,8,10,9,10,5,10],[15,65,35,2,4,5,9,10,8,10],[15,25,65,4,8,5,35,7,9,10],[15,2,65,4,35,5,7,8,9,10]],animation:[[13,66,7,8,9,10,12,66,12,10],[13,66,4,7,8,9,10,12,66,10],[13,2,66,4,7,12,10,12,10,66],[13,66,4,12,39,7,8,12,9,10],[13,25,66,4,8,5,35,7,9,10],[13,2,66,4,39,5,7,8,9,10]],readblock:[37,31,32,33,36]},frequency:{movies:[2,2],series:[2,3],trailers:[2,5],animation:[2,4],readblock:[1]},messages:{0:["Мы рады, что вы с нами! Наша реклама неназойлива, работает быстро и помогает показывать большинство видео бесплатно. Пожалуйста, исключите нас из Adblock.","dublin","stop","disable"],1:["ivi - крупнейший легальный онлайн-кинотеатр. Большинство наших фильмов бесплатны только благодаря неназойливой и безопасной рекламе. Пожалуйста, отключите Adblock.","dublin","stop","disable"],2:["Только благодаря рекламе вы смотрите качественное видео с профессиональной озвучкой совершенно бесплатно! Пожалуйста, отключите Adblock.","beirut","heart","disable"],3:["Только благодаря рекламе большинство видео на ivi бесплатны. Пожалуйста, отключите Adblock, и мы сможем сделать наш бесплатный каталог еще больше!","beirut","heart","disable"],4:["Благодаря рекламе мы разместили сервера по всему СНГ - это позволяет видео загружаться очень быстро. Пожалуйста, отключите Adblock, и ivi станет еще быстрее.","beirut","rocket","disable"],5:["Для корректной работы Adblock проверяет миллионы разрешенных списков, что замедляет загрузку видео. Есть способ сделать ivi быстрее и выключить всю рекламу.","hanoi","snail","subscribe"],6:["Вы знаете, что подписка не только убирает всю рекламу, но и дает доступ к расширенному каталогу, качеству Full HD и 4K и фильмам в подарок каждую неделю?","beirut","heart","subscribe"],7:["Похоже, Adblock все еще включен :( Попробуйте две недели бесплатной подписки, с ней рекламы нет вообще и доступен расширенный каталог шикарных фильмов и сериалов!","beirut","gift","subscribe"],8:['Блокировщики могут <a class="ivi-link" href="https://ru.wikipedia.org/wiki/WOT:_Web_of_Trust#Конфиденциальность_пользователей" target="blank">продавать рекламодателям</a> ваши данные! Подписка безопаснее, полностью исключает рекламу и дает еще много приятных бонусов.',"hanoi","stop","subscribe"],9:['Вы знаете, что некоторые блокировщики <a class="ivi-link" href="http://www.comss.info/page.php?al=Adblock_Plus_whitelist" target="blank">пропускают рекламу за деньги</a> рекламодателей? Подписка честно убирает всю рекламу и дает множество бонусов.',"hanoi","stop","subscribe"],10:['Adblock может тормозить сайт и <a class="ivi-link" href="https://ru.wikipedia.org/wiki/WOT:_Web_of_Trust#Конфиденциальность_пользователей" target="blank">передавать ваши данные третьим лицам</a>. Подписка убирает рекламу и дает вам шикарный расширенный каталог. Попробуйте бесплатно!',"valencia","heart","subscribe"],11:["Не забудьте отключить Adblock :) От этого выиграете не только вы, но и создатели фильмов и сериалов, которые смогут вложить больше денег в будущие проекты.","valencia","heart","disable"],12:["Детские фильмы и мультфильмы у нас бесплатны только благодаря рекламе - она безопасна и проходит очень строгий контроль. Пожалуйста, отключите Adblock.","beirut","baby","disable"],13:["ivi - крупнейший легальный онлайн-кинотеатр. Большинство наших мультиков бесплатны только благодаря неназойливой и безопасной рекламе. Пожалуйста, отключите Adblock.","beirut","baby","disable"],14:["Мы рады, что вы с нами! Наша реклама неназойлива, работает быстро и помогает нам демонстрировать большинство видео бесплатно. Пожалуйста, отключите Adblock.","dublin","stop"],15:["ivi - крупнейший легальный онлайн-кинотеатр. Большинство наших сериалов бесплатны только благодаря неназойливой и безопасной рекламе. Пожалуйста, отключите Adblock.","dublin","stop","disable"],25:["В отличие от пиратских сайтов с рекламой мошенников, мы показываем только полезную рекламу, прошедшую строгий контроль. Пожалуйста, отключите Adblock.","beirut","heart","disable"],31:['Блокировщики могут <a class="ivi-link" href="https://ru.wikipedia.org/wiki/WOT:_Web_of_Trust#Конфиденциальность_пользователей" target="blank">продавать рекламодателям</a> ваши данные! Подписка безопаснее, полностью исключает рекламу и дает еще много приятных бонусов.',"hanoi","heart","subscribe"],32:['Вы знаете, что некоторые блокировщики <a class="ivi-link" href="http://www.comss.info/page.php?al=Adblock_Plus_whitelist" target="blank">пропускают рекламу за деньги</a> рекламодателей? Подписка честно убирает всю рекламу и дает множество бонусов.',"hanoi","heart","subscribe"],33:['Adblock может тормозить сайт и <a class="ivi-link" href="https://ru.wikipedia.org/wiki/WOT:_Web_of_Trust#Конфиденциальность_пользователей" target="blank">передавать ваши данные третьим лицам</a>. Подписка убирает рекламу и дает вам шикарный расширенный каталог. Попробуйте бесплатно!',"valencia","heart","subscribe"],35:["Для корректной работы Adblock проверяет миллионы разрешенных списков, что замедляет загрузку видео. Есть способ сделать ivi быстрее и выключить всю рекламу.","hanoi","snail","subscribe"],36:["Вы знаете, что подписка не только убирает всю рекламу, но и дает доступ к расширенному каталогу, качеству Full HD и 4K и фильмам в подарок каждую неделю?","beirut","heart","subscribe"],37:["Похоже, вы снова включили Adblock :( Очень жаль! Попробуйте две недели бесплатной подписки, с ней нет рекламы и доступен расширенный каталог в отличном качестве.","valencia","heart","subscribe"],38:["Только благодаря рекламе большинство сериалов на ivi бесплатны. Пожалуйста, отключите Adblock, и мы сможем сделать наш бесплатный каталог еще больше!","beirut","heart","disable"],39:["Только благодаря рекламе большинство мультфильмов на ivi бесплатны. Пожалуйста, отключите Adblock, и мы сможем сделать наш бесплатный каталог еще больше!","beirut","heart","disable"],65:["Отключив Adblock, вы вкладываетесь в будущие работы своих любимых режиссеров и актеров - часть заработанных от рекламы денег пойдет именно им.","valencia","heart","disable"],66:["Отключив Adblock, вы становитесь спонсором будущих проектов создателей любимых мультфильмов - часть заработанных от рекламы денег идет именно им.","valencia","heart","disable"]}}},function(e,t,i){var n,a=i(4),s=i(23);!function(e){e.Movies="movies",e.Series="series",e.Trailers="trailers",e.Animation="animation",e.ReAdBlock="readblock"}(n=t.AdBlockCategoryType||(t.AdBlockCategoryType={}));var o=function(){function e(){}return e.getAdBlockCategoryType=function(e){return e?n.ReAdBlock:-1!==a.default.getPathname().indexOf("trailers")?n.Trailers:(new s.default).getCategoryHru()},e}();t.default=o},function(e,t,i){var n=i(318),a=i(679),s=i(320),o=i(319),r=function(){function e(){this.adBlockStorage=new a.default,this.adBlockCommunications=new n.default(this.adBlockStorage)}return e.prototype.isUserAdBlocker=function(){return this.adBlockStorage.isUserAdBlocker()},e.prototype.onWatch=function(){this.adBlockStorage.incrementViewsCount()},e.prototype.isAdBlockDisabled=function(){return this.adBlockStorage.isAdBlockDisabled()},e.prototype.isNoticeShouldBeShown=function(){var e=o.default.frequency[this.adBlockCategoryType];if(e){var t=e[0],i=e.length>1?o.default.frequency[this.adBlockCategoryType][1]:0;if(this.adBlockStorage.getCommunicationsCount()<t&&(null===this.adBlockStorage.getViewsCount()||this.adBlockStorage.getViewsCount()>i))return!0}return!1},e.prototype.getMessage=function(){var e=this.adBlockCommunications.getMessage();return e&&(this.adBlockStorage.incrementCommunicationsCount(),this.adBlockStorage.setViewsCount(0)),e},e.prototype.getFirstVisitDate=function(){return this.adBlockStorage.getFirstVisitDate()},e.prototype.setAdBlockStatus=function(e){this.adBlockStorage.setAdBlockStatus(e)},e.prototype.setLastCommunicationNumber=function(e){this.adBlockStorage.setLastCommunicationNumber(e)},e.prototype.save=function(){this.adBlockStorage.saveUserInfo()},e.prototype.load=function(e){this.adBlockStorage.loadUserInfo(),this.setAdBlockStatus(e),this.adBlockCategoryType=s.default.getAdBlockCategoryType(this.adBlockStorage.isUserReAdBlocker()),this.adBlockCommunications.setAdBlockCategoryType(this.adBlockCategoryType)},e}();t.default=r},function(e,t,i){var n=i(1),a=i(0),s=i(3),o=i(4);t.default=a.View.extend({el:".js-content-collections",events:{"click .js-posters-bundle-block":"bundleClick"},render:function(){var e=n(".js-block-title");e.text(e.data("text")),this.$el.find(".js-collection-title").each(function(e,t){n(t).text(n(t).data("text"))})},bundleClick:function(e){s.default.track("content_bundle_click");var t=n(e.currentTarget).data("href");t&&o.default.redirect(t)}})},function(e,t,i){var n=i(0),a=i(23),s=i(5),o=i(7),r=i(26),l=i(3),d=i(8),u=i(142),c=i(222);t.default=n.View.extend({el:".js-favourite-button",events:{click:"check"},isWantToWatchButton:!1,initialize:function(e){var t=this;s.extend(this,s.pick(e,"objectId","type")),this.listenTo(r.default,"favourite:have",function(e,i){i&&e.objectId===t.objectId&&e.type===t.type&&t.$el.addClass("active")}),this.listenTo(r.default,"favourites:added",this.updateStatus),this.listenTo(r.default,"favourites:deleted",this.updateStatus),this.listenTo(o.default,"auth:modalClosedWithoutLogin",this.authModalClosedWithoutLogin),this.$el.hasClass("js-want-to-watch-button")&&(this.isWantToWatchButton=!0),window.addEventListener("beforeunload",this.authModalClosedWithoutLogin)},updateStatus:function(e){parseInt(e.objectId,10)===parseInt(this.objectId,10)&&e.type===this.type&&this.$el.toggleClass("active")},check:function(e){var t={objectId:this.objectId,type:this.type},i="waittosee_add";if(this.$el.hasClass("active")?(i="waittosee_del",r.default.trigger("favourite:delete",t)):this.isWantToWatchButton&&!d.default.isAuthenticated()?(o.default.trigger("auth:showLoginModal",["wantToWatch",(new a.default).getCategoryHru()]),u.default.save(this.objectId,this.type)):(r.default.trigger("favourite:add",t),this.isWantToWatchButton&&this.listenToOnce(r.default,"favourites:added",function(){r.default.trigger("favourite:showSuccessWantToWatchModal")})),this.isWantToWatchButton){var n=l.default.getSuperProperty("content_id");l.default.rewriteSuperProperties({content_id:this.objectId}),l.default.track(i),l.default.rewriteSuperProperties({content_id:n})}return c.default.feedbackClickAnimation(e),e.preventDefault(),e.stopPropagation(),!1},authModalClosedWithoutLogin:function(){u.default.hasItem()&&u.default.removeItem()}})},function(e,t,i){var n=i(1),a=i(0),s=i(683);t.default=a.View.extend({el:".js-dynamic-button-wrapper",render:function(){n(".js-favourite-button").length||this.$el.prepend(s.default())}})},function(e,t,i){var n=i(16),a=i(23),s=i(66),o=i(26),r=i(684);t.default=n.default.extend({modalId:"js-success-want-to-watch",template:r.default,openEvent:"favourite:showSuccessWantToWatchModal",regionEnabled:!0,priorityModal:!0,beforeCancel:function(){o.default.trigger("favourite:wantToWatchModalClosed")},serializeData:function(){var e=(new a.default).getCategoryHru(),t=s.default.getNom(e);return t===e&&(t="фильм"),{categoryTitle:t}}})},function(e,t,i){var n=i(101),a=i(127),s=i(6),o=i(102),r=i(23);t.default=s.default.extend({run:function(e){var t=e.hru?"compilation":"video",i=new r.default;void 0===e.page&&(e.page=1),new a.default({collection:new n.default({contentType:t}),page:e.page,itemId:i.getId(),initWaypoint:!0}),new o.default({itemId:i.getId(),contentType:t})}})},function(e,t,i){var n=i(14),a=i(7),s=i(88),o=i(126),r=i(8);t.default=n.default.extend(o.default).extend({checkInvalidSessionMessage:!0,initialize:function(e){this.itemId=e.itemId,this.contentType=e.contentType,this.season=e.season,e.parentId&&this.setParentId(e.parentId)},add:function(e){var t=this;if(this.checkUrls(e.subject))return s.default.trigger("error","links"),void s.default.trigger("comment:error",this);e.id=this.itemId,this.season&&(e.season=this.season),this.getParentId()&&(e.parent_id=this.getParentId()),e.subject=e.subject.replace(/<br\s*(\/)?>/g,"/n"),this.mapiPost({uri:"/user/"+this.contentType+"/comment/v6/add",data:e}).done(function(e){e.error?e.error.code===t.invalidSessionCodeError&&e.error.message===t.unconfirmedEmailMessageError?a.default.trigger("confirm:email:show:user",r.default.get("email"),!0):900===e.error.code&&s.default.trigger("comment:error",t):e.result&&s.default.trigger("comment:added",t)})},setParentId:function(e){this.set("parent_id",e)},checkUrls:function(e){for(var t,i=new RegExp("(http|ftp|https)?(://)?([\\w-]+)(\\.[\\w-]+)([\\w.,@?^=%&amp;:/~+#-]*[\\w@?^=%&amp;/~+#-])?","g"),n=!1;null!==(t=i.exec(e));)if(!(t[3]&&"ivi"===t[3]||t[4]&&".ivi"===t[4])){n=!0;break}return n},parse:function(e){if(e.author&&-1!==e.author.indexOf("@")){var t=e.author.split("@");e.author=t[0]}else e.author||(e.author="Anonymous");return e},getAdded:function(){return new Date(this.get("added"))},getText:function(){return this.get("text")},getAuthor:function(){return this.get("author")},getId:function(){return this.get("id")},getParentId:function(){return this.get("parent_id")}})},function(e,t,i){var n=i(1),a=i(0),s=i(61),o=i(5),r=i(88),l=i(688);t.default=a.View.extend(s.default).extend({objectType:"comment",strictLoadBorder:!0,canReply:!1,hasAnswers:!1,itemsPerPage:100,itemsCount:null,initialize:function(e){this.listenTo(r.default,"comment:added",this.reset),this.itemsCount=e.itemsCount},render:function(){var e=this,t=n("<div/>"),i=this.itemsCount?this.collection.models.slice(0,this.itemsCount):this.collection.models;return s.default.render.apply(this,arguments),o.each(i,function(i,a){n(l.default({comment:i,loop:{index:e.loadDataParams.data.from+a+1},canReply:e.canReply,hasAnswers:e.hasAnswers})).appendTo(t)}),this.$el.append(t.html()),this.afterRender(),this.$el},reset:function(e){e.itemId===this.itemId&&e.getParentId()===this.parentId&&(this.$el.html(""),this.reload())},getWayPoint:function(){var e=this.$el.find("li"),t=e.length-10;return e.get(t)}})},function(e,t,i){var n=i(1),a=i(33),s=i(697),o=i(698),r=i(699),l=i(195),d=i(700),u=i(330),c=i(8),p=i(701),f=i(155),h=i(705),g=i(708),m=i(711),v=i(37),_=i(48),b=i(18);t.default=a.default.extend({compilationInfo:null,initialize:function(){var e=this;n(document).ready(function(){e.serieList=new d.default,e.compilationInfo=new v.default})},afterLogin:function(){var e=new l.default;new p.default({collection:this.serieList,hru:this.compilationInfo.getHru(),watchedListModel:e}),(new s.default).render(),this.serieList.listenTo(_.default,"compilation:change-season",this.serieList.findBySeason),this.serieList.listenTo(_.default,"compilation:change-group",this.serieList.findByGroup),n(".seasons-scroll-block li.season.active a").trigger("click"),window.ivi.adaptive.isMobile&&(new r.default,new o.default,this.serieList.listenTo(_.default,"compilation:mobile:change-season",this.serieList.findBySeason),this.serieList.listenTo(_.default,"compilation:mobile:change-group",this.serieList.findByGroup)),new h.default(e),new f.default,this.serieList.listenTo(_.default,"compilation:seasonDataLoaded",this.serieList.setUpSeasonSeriesBought),this.setNewSeriesButtons()},setNewSeriesButtons:function(){if((!c.default.isAuthenticated()||c.default.getEmail())&&this.compilationInfo.hasUpcomingEpisodes()&&b.default.showNewSeriesNotificationButton()){var e=new u.default(null,{compilationInfo:this.compilationInfo}),t=new m.default({compilationInfo:this.compilationInfo}),i=new g.default({newSeriesNotificationModel:e});t.listen(_.default),i.listenTo(_.default,"compilation:newSeriesNotificationCheck",i.renderNotificationButton),i.listenTo(_.default,"compilation:newSeriesDeleteNotificationClicked",i.deleteNewSeriesNotification),e.load()}}})},function(e,t,i){var n=i(29),a=i(48),s=n.default.extend({uri:"/favourite/v5/check",BASE_COMPILATION_URI:"/compilation/favourite/v5/",ADD_NOTIFICATION_URI_ADDITION:"add",DELETE_NOTIFICATION_URI_ADDITION:"delete",requestParams:{favourite_type:"subscribe"},checkInvalidSessionMessage:!0,compilationInfo:null,initialize:function(e,t){this.compilationInfo=t.compilationInfo},load:function(){this.mapiGet({data:{compilation_id:this.compilationInfo.getId()}}).always(function(){a.default.trigger("compilation:newSeriesNotificationCheck")})},addNotification:function(){var e=this;this.mapiPost({uri:this.BASE_COMPILATION_URI+this.ADD_NOTIFICATION_URI_ADDITION,data:{id:this.compilationInfo.getId()}}).always(function(){e.load()})},deleteNotification:function(){var e=this;this.mapiPost({uri:this.BASE_COMPILATION_URI+this.DELETE_NOTIFICATION_URI_ADDITION,data:{id:this.compilationInfo.getId()}}).always(function(){e.reset(),e.load()})},addUsingSign:function(e){return this.sendRequestUsingSign(e,this.ADD_NOTIFICATION_URI_ADDITION)},deleteUsingSign:function(e){return this.sendRequestUsingSign(e,this.DELETE_NOTIFICATION_URI_ADDITION)},sendRequestUsingSign:function(e,t){return this.mapiPost({uri:this.BASE_COMPILATION_URI+t,data:e},e.app_version,!1)},hasNotification:function(){return this.models.length>0}});t.default=s},function(e,t,i){var n=i(37),a=i(332);t.default=a.default.extend({run:function(){this.createGrade("compilation",(new n.default).getId()),this.renderBlock()}})},function(e,t,i){var n=i(713),a=i(6),s=i(73),o=i(213),r=i(4);t.default=a.default.extend({scrollElem:".js-grade-block",id:null,type:null,created:!1,createGrade:function(e,t){var i=this;this.created||(this.id=parseInt(t,10),this.type=e,this.created=!0,this.listenTo(s.default,"rate:view:grade",function(e){s.default.trigger("user:grade",i.id,i.type,e)}),this.listenTo(s.default,"check:grade",function(){s.default.trigger("have:grade",i.id,e,o.default.get("value"))}),this.listenTo(s.default,"have:grade",this.userHasRated))},userHasRated:function(e,t,i){var n=document.getElementById("player-iframe");n&&r.default.postMessageToIframe(n,{type:"player",message:"playerUserHasRated",params:{id:e,type:t,value:i}},"*")},renderBlock:function(){var e=this;this.listenTo(s.default,"get:grade",function(t){new n.default(e.id,e.type).render(t)}),o.default.getUserRating(this.id,this.type)}})},function(e,t,i){var n=i(1),a=i(68),s=i(718),o=i(51),r=i(5),l=i(26),d=i(3),u=i(334),c=i(719),p=i(720),f=i(42),h=i(131);t.default=a.default.extend(h.default).extend(o.default).extend({el:".js-related-block",$titleEl:null,relatedTitle:"",events:{"click li > a":"contentClick"},maxElementsCount:5,expansionTitleElementCount:2,compressionTitleElementCount:1,initialize:function(e){void 0!==e&&void 0!==e.favouritesCollection?(this.$el=n(".js-posters-similar"),this.favouritesCollection=e.favouritesCollection,this.relatedTitle=r.first(this.favouritesCollection.models).getTitle(),this.listenTo(l.default,"start:favorite:itemRemoved",this.showElement),this.listenTo(l.default,"start:favorite:itemPrepended",this.hideElement),this.listenToOnce(f.default,"start:personalBlock:clear",this.hideBlock),u.default.trigger("related:block:loaded")):(this.setLocalBlockId("content_similar",!0),new s.default({el:".js-related-block .js-groot-popup",blockId:this.getLocalBlockId()}))},changeTitle:function(e){e?(this.$titleEl.html(c.default({visible:e,relatedName:this.relatedTitle})),this.$titleEl.show()):this.$titleEl.hide()},hideBlock:function(){this.stopListening(l.default),this.$el.addClass(this.transitionClass)},showElement:function(){this.$el.find("li."+this.transitionClass+":first").removeClass(this.transitionClass),this.$el.find("li").not("."+this.transitionClass).length===this.expansionTitleElementCount&&this.changeTitle(this.expansionTitleElementCount)},hideElement:function(){this.$el.find("li").not("."+this.transitionClass).last().addClass(this.transitionClass),this.$el.find("li").not("."+this.transitionClass).length===this.compressionTitleElementCount&&this.changeTitle(this.compressionTitleElementCount)},render:function(){if(this.collection&&this.collection.length){var e=p.default({related:this.collection.models,relatedName:this.relatedTitle,visible:this.maxElementsCount-this.favouritesCollection.length});this.$el.html(e),this.$el.removeClass(this.transitionClass),this.$titleEl=n("#related-title"),this.attachPosterPopup(this.$el.find("li"))}},contentClick:function(e){var t=void 0!==e.originalEvent?e.originalEvent.target:null;if(t){var i=n(t).parents("[data-content-type]"),a=i.data("content-id"),s=i.data("content-type");"content"===s?d.default.setRecContentId(a):"compilation"===s&&d.default.setRecCompilationId(a),d.default.setBlockId(this.getLocalBlockId()),this.trackCollectionContentAction("hydra.content.open",i)}}})},function(e,t,i){var n=i(0);t.default=new n.Model({})},function(e,t,i){var n=i(14),a=i(28),s=i(7),o=i(64),r=i(3),l=i(8),d=i(723);t.default=n.default.extend({checkInvalidSessionMessage:!0,initialize:function(e){this.videoId=e.videoId},add:function(e){var t=this;return e.id=this.videoId,e.title=a.default.escapeText(e.title),this.mapiPost({data:e}).done(function(e){if(e.error)e.error.code===t.invalidSessionCodeError&&e.error.message===t.unconfirmedEmailMessageError?s.default.trigger("confirm:email:show:user",l.default.get("email"),!1):o.default.trigger("error",{type:"text",text:d.default()});else if(e.result)return o.default.trigger("form:review:collapse"),o.default.trigger("review:added",e.result,t.videoId),r.default.track("review_add_success"),!1})}})},function(e,t,i){var n=i(6),a=i(743);t.default=n.default.extend({scrollElem:"#share-button",run:function(){new a.default}})},function(e,t,i){var n=i(101),a=i(127),s=i(6),o=i(102),r=i(747),l=i(748),d=i(88),u=i(3),c=i(128);t.default=s.default.extend({run:function(e){var t=e.season||null;new r.default,new o.default({itemId:e.reviewId,contentType:"review",season:t,trackGroot:!0}),new l.default,new a.default({collection:new n.default({contentType:"review"}),itemId:e.reviewId,contentType:"review",season:t,initWaypoint:!0,canReply:!1,hasAnswers:!1}),this.listenTo(d.default,"comment:added",this.trackCommentAdded),this.listenTo(c.default,"like:add",this.trackLikeAdded)},trackCommentAdded:function(){u.default.track("review_comment_add")},trackLikeAdded:function(e){var t="review_";"comment"===e.objectType&&(t+="comment_"),t+=e.value,u.default.track(t)}})},function(e,t,i){var n=i(37),a=i(6),s=i(196),o=i(132),r=i(197),l=i(23),d=i(3),u=i(128);t.default=a.default.extend({run:function(e){var t=e.hru?new n.default:new l.default;new s.default({videoId:t.getId(),kind:t.getKind()}),new r.default({collection:new o.default([],{contentType:t.getContentType()}),page:e.page,video:t,initWaypoint:!0}),this.listenTo(u.default,"like:add",this.trackLikeAdded)},trackLikeAdded:function(e){d.default.track("review_"+e.value)}})},function(e,t,i){var n=i(74),a=i(751),s=i(37),o=i(6),r=i(19),l=i(752),d=i(753),u=i(193),c=i(155),p=i(23),f=i(5),h=i(7),g=i(11),m=i(10),v=i(8),_=i(758),b=i(20),y=i(18),w=i(81),C=i(321);t.default=o.default.extend({run:function(){var e,t=this,i=new p.default;e=i.isCompilation()?(new s.default).getContentEntity():i.getContentEntity(),new c.default,new a.default;var n=e.isFree()?m.default.player.free:m.default.player.paid,o={config:n,id:e.getId(),appVersion:(new r.default).getAppVersion(),queryParams:this.queryParams,contentType:"content",isPaid:e.isPaid(),width:m.default.player.params.width,height:m.default.player.params.height,autoStart:!0,continuewatching:!0};if(e.isPaid()){var l=!1;this.listenTo(g.default,"buy-button:show",function(n){if("true"===b.default.localStorage.getItem("autostart_"+e.getId()))o.autoStart=!0,b.default.localStorage.removeItem("autostart_"+e.getId());else if(e.isTvod()){var a=v.default.get("purchasedContent");if(!f.isUndefined(a)){var s=a.findWhere({object_id:e.getId()});if(!f.isUndefined(s)&&"temporal"===s.get("ownership_type")){l=!0;var r=new _.default;r.mapiGet({data:{id:o.id}}).done(function(e){o.autoStart=!!r.parse(e)}).fail(function(){o.autoStart=!1}).always(function(){t.renderPaidContentView(n,t.checkAgeLimit(i.isForAdult,o))})}}}l||t.renderPaidContentView(n,t.checkAgeLimit(i.isForAdult(),o))})}else h.default.once("autologin",function(){t.checkAgeLimit(i.isForAdult(),o),y.default.showNewAdBlock()&&!v.default.hasSubscription()?w.default.detectedDeferred.done(function(){t.isAdBlockDisabled(w.default.detected)&&(o.autoStart=!1),(new u.default).render(o)}):(new u.default).render(o)})},renderPaidContentView:function(e,t){e.isPurchased()?(new u.default).render(t):new l.default,(new d.default).render()},isAdBlockDisabled:function(e){var t=new C.default;return t.load(e),t.isAdBlockDisabled()},checkAgeLimit:function(e,t){if(e){(new n.default).canWatchAdultContent()||(t.autoStart=!1)}return t}})},function(e,t,i){var n=i(74),a=i(6),s=i(19),o=i(193),r=i(760),l=i(23),d=i(7),u=i(10),c=i(89),p=i(4);t.default=a.default.extend({trailerBlockWidth:"702px",trailerBlockHeight:"394px",playerContentType:"trailer",run:function(){this.trailerView=new r.default,this.listenTo(d.default,"autologin",this.setUpPlayer)},setUpPlayer:function(){var e=!0;if((new l.default).isForAdult()){(new n.default).canWatchAdultContent()||(e=!1)}var t={config:u.default.player.trailer,queryParams:this.queryParams,contentType:this.playerContentType,isPaid:!1,width:this.trailerBlockWidth,height:this.trailerBlockHeight,appVersion:(new s.default).getAppVersion(),autoStart:e};this.player=new o.default,this.listenTo(c.default,"trailer:play",function(e){t.id=e,this.player.render(t)}),this.playTrailer()},playTrailer:function(){"#play"===p.default.getLocation().hash&&this.trailerView.playTrailer()}})},function(e,t,i){var n=i(1),a=i(0),s=i(6),o=i(19),r=i(198),l=i(5),d=i(109),u=i(8),c=i(10),p=i(342),f=i(4),h=i(18);t.default=a.View.extend({playerParams:{},playerInfo:null,initialize:function(){var e=this;this.playerInfo=new r.default,n(window).resize(function(){e.setPlayerSize()});var t=new o.default,i=s.default.prototype.queryParams,a=h.default.getUserBucket(),c=i.adr_order_id?i.adr_order_id:0;this.playerParams={id:this.playerInfo.getContentId(),iviuid:u.default.getId(),subsite:t.getSubsiteId(),appVersion:this.playerInfo.getAppVersion(),session:d.default.getCookieForPlayer(),contentType:this.playerInfo.getContentType(),adrOrderId:c,userABBucket:a||null,isTrialAvailableForUser:u.default.isTrialAvailable()},l.extend(this.playerParams,this.getAdditionalParams()),this.render()},getAdditionalParams:function(){var e=f.default.getViewPort(),t=s.default.prototype.queryParams,i=t.postback_url?decodeURIComponent(t.postback_url):null,n=t.is_bn_post_message?decodeURIComponent(t.is_bn_post_message):0,a={width:e.width,height:e.height,postBackUrl:i,isBnPostMessage:n,start:this.playerInfo.getStart(),finish:this.playerInfo.getFinish(),mapiUrl:c.default.player.params.mapiUrl,lightUrl:c.default.player.params.lightUrl};return window.ivi.adaptive.isMobile||(a.autoStart=this.playerInfo.isAutoStart()),a},render:function(){p.default.createOldPlayer("js-player","js-rec-block",this.playerParams),this.setPlayerSize()},setPlayerSize:function(){n("#js-player, video").css({width:"100%",height:"100%"})}})},function(e,t){var i=function(){function e(){}return e.prototype.createOldPlayer=function(e,t,i){window.Puck&&new window.Puck(document.getElementById(e),document.getElementById(t),i)},e.prototype.createPlayer=function(e){window.Html5Player&&new window.Html5Player(e)},e}();t.default=new i},function(e,t,i){var n=i(1),a=i(6),s=i(109),o=i(50),r=i(4),l=i(83);t.default=a.default.extend({PLAYER_INNER_BODY_CLASS:"js-player-inner-body",KEY_ESCAPE:27,KEY_SPACE:32,KEY_ARROW_UP:38,KEY_ARROW_DOWN:40,KEY_ARROW_LEFT:37,KEY_ARROW_RIGHT:39,run:function(){n(window).on("message",this.postMessageHandler),n(document).keypress(this.playerKeyHandler.bind(this)),n(document).keyup(this.playerKeyHandler.bind(this)),n(document).keydown(this.playerKeyHandler.bind(this)),o.default.addMousewheelListener(this.playerMouseWheelHandler)},playerKeyHandler:function(e){var t=n(o.default.getActiveElement());if((t.hasClass(this.PLAYER_INNER_BODY_CLASS)||t.closest(this.PLAYER_INNER_BODY_CLASS))&&l.default.getKeyCode(e))return!1},playerMouseWheelHandler:function(e){if(s.default.isPlayerVolumeBlockHovered())return e.preventDefault(),!1},postMessageHandler:function(e){var t=e.originalEvent.data;if(t&&"player"===t.type)switch(t.message){case"playerAddToFavourite":s.default.favouriteAdd(t.params.id,t.params.type).done(function(){r.default.postMessage({type:"player",message:"playerFavouriteAdded",params:t.params},"*")});break;case"playerDeleteFromFavourite":s.default.favouriteDelete(t.params.id,t.params.type).done(function(){r.default.postMessage({type:"player",message:"playerFavouriteDeleted",params:t.params},"*")});break;case"playerGrootTrack":s.default.grootTrack(t.params.eventName,t.params.eventParams,"player");break;case"playerGrootBlockId":t.params.force&&s.default.grootRewriteSuperProperties({block_id:t.params.blockId}),s.default.grootSetBlockId(t.params.blockId);break;case"playerRecContentId":s.default.grootSetRecContentId(t.params.recContentId);break;case"playerRecCompilationId":s.default.grootSetRecCompilationId(t.params.recCompilationId)}}})},function(e,t){t.default={setRequestAnimationFrame:function(){window.requestAnimationFrame=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.msRequestAnimationFrame},transitionEndEventName:function(){var e=document.createElement("div"),t={transition:"transitionend",OTransition:"otransitionend",MozTransition:"transitionend",WebkitTransition:"webkitTransitionEnd"};for(var i in t)if(t.hasOwnProperty(i)&&void 0!==e.style[i])return t[i];return t.transition}}},function(e,t,i){var n=i(67),a=i(29),s=i(18);t.default=n.default.extend({uri:"/hydra/get/recommendation/v5/",fields:"title,id,poster_originals,kind,hru,content_paid_types,restrict,seasons_count,used_to_be_paid,seasons_content_total,seasons,episodes,seasons_description,ivi_rating_10_count,seasons_extra_info,kind",relatedScenario:"ITEM_PAGE",onboardingScenario:"MAIN_PAGE",relatedCount:5,onboardingRecommendationsCount:25,onboardingRecommendationsKind:1,requestParams:{},buildRequestParams:function(e){var t=a.default.prototype.buildRequestParams.call(this,e);t.data||(t.data={}),t.data.fields=this.fields;var i=s.default.getUserBucket();return i&&(t.data.user_ab_bucket=i),t},load:function(e){var t={data:{id:e.models[0].getId(),kind:e.models[0].getKind(),top:this.relatedCount,scenario_id:this.relatedScenario}};return this.mapiGet(t)},loadForOnboarding:function(){var e={data:{kind:this.onboardingRecommendationsKind,top:this.onboardingRecommendationsCount,scenario_id:this.onboardingScenario}};return this.mapiGet(e)}})},function(e,t,i){var n=i(21),a=i(31),s=i(285),o=i(16),r=i(19),l=i(32),d=i(835),u=i(836),c=i(837),p=i(348),f=i(838),h=i(91),g=i(30),m=i(839),v=i(140),_=i(3),b=o.default.extend({BIND_TOKEN_EXISTS_ERROR_CODE:110,template:f.default,modalHash:"#bind-contacts",fullAnimation:!0,renderAnimationDuration:300,destroyAnimationDuration:300,events:{"click .js-back-button":"moveToPrevStep"},statuses:{STATUS_TOKEN:1,STATUS_ERROR:3,STATUS_VERIFY_PHONE_BY_SMS:2},grootPageStatusRel:{},bindContactsModel:null,supportContacts:null,initialize:function(e){o.default.prototype.initialize.call(this,e),this.browserInfo=new l.default,this.mapiInfo=new r.default,this.phoneNumberHelper=new v.default,this.listenToOnce(h.default,"support:contactsLoaded",this.setSupportContacts),this.onBindNextToken=this.onBindNextToken.bind(this),this.onSmsCodeInput=this.handleInput.bind(this,"smsCode"),this.onSmsCodeFillingComplete=this.onSmsCodeFillingComplete.bind(this),this.onSmsCodeResend=this.onSmsCodeResend.bind(this)},beforeSubmit:function(){return!1},setSupportContacts:function(e){this.supportContacts=e},listenModalEvents:function(){},stopListeningModalEvents:function(){},onBindNextToken:function(){},onTokenInput:function(){},onErrorGroot:function(){},onOpen:function(){this.setViewInitialStatus(),this.listenModalEvents(),o.default.prototype.onOpen.apply(this,arguments)},onRender:function(){this.renderReact(),this.changeGrootPageParam(),this.trackPageView(),this.focusCurrentInput()},handleInput:function(e,t){this.model.set(e,t),this.model.deleteErrorCode(),this.renderReact()},onSmsCodeResend:function(){this.model.bindBegin(),this.renderReact(),_.default.track("request_sms_add")},bindBegin:function(e){this.model.bindBegin(),this.renderReact(),_.default.track("next_step_add"),e&&e.preventDefault()},onSmsCodeFillingComplete:function(e){_.default.track("next_step_add"),this.model.setSmsCode(e),this.model.bindConfirm(),this.model.deleteErrorCode(),this.renderReact()},moveToNextStep:function(){this.model.resetLoadings(),this.renderReact(),this.afterStepChanged()},moveToPrevStep:function(){return this.resetData(),this.model.setStatus(this.statuses.STATUS_TOKEN),this.renderReact(),this.afterStepChanged(),!1},resetData:function(){this.model.attributes={visibleToken:this.model.getVisibleToken(),emailToken:this.model.getEmailToken(),phoneToken:this.model.getPhoneToken(),smsCodeSent:this.model.isSmsCodeSent()}},afterStepChanged:function(){this.focusCurrentInput(),this.setModalControls(),this.changeGrootPageParam(),this.trackPageView()},setModalControls:function(){var e=this.$el.find(".fullscreen-popup");switch(e.removeClass("fullscreen-popup_has-close-view-button fullscreen-popup_has-previous-view-button"),this.model.get("status")){case this.statuses.STATUS_TOKEN:e.addClass("fullscreen-popup_has-close-view-button");break;case this.statuses.STATUS_VERIFY_PHONE_BY_SMS:case this.statuses.STATUS_ERROR:e.addClass("fullscreen-popup_has-previous-view-button")}},onBindStartSuccess:function(){var e=this.model.getStatus()!==this.statuses.STATUS_VERIFY_PHONE_BY_SMS;this.model.setStatus(this.statuses.STATUS_VERIFY_PHONE_BY_SMS),this.model.setSmsCodeSent(!0),e?this.moveToNextStep():(this.model.resetLoadings(),this.renderReact())},onError:function(){m.default.vibrateShortPeriod();var e=this.model.getErrorCode();e===this.BIND_TOKEN_EXISTS_ERROR_CODE?(this.model.deleteErrorCode(),this.model.setStatus(this.statuses.STATUS_ERROR),this.model.setSpecialErrorCode(e),this.moveToNextStep()):e===p.default.SMS_RATE_LIMIT_EXCEEDED_CODE?(this.model.deleteErrorCode(),this.model.setStatus(this.statuses.STATUS_VERIFY_PHONE_BY_SMS),this.model.setSpecialErrorCode(e),this.onErrorGroot(),this.moveToNextStep()):(this.onErrorGroot(),this.renderReact()),this.focusCurrentInput()},getBlocksPositions:function(){},renderReact:function(){var e=this.serializeData(),t=this.getBlocksPositions();this.renderReactComponent(d.default,".js-bind-contacts-token-react-wrapper",e,t.tokenBlockPosition),this.renderReactComponent(u.default,".js-bind-contacts-error-react-wrapper",e,t.errorBlockPosition),this.renderReactComponent(c.default,".js-bind-contacts-verify-phone-by-sms-react-wrapper",this.specifySerializedDataForComponent(e,c.default),t.verifyPhoneBySMSBlockPosition)},serializeData:function(){var e=o.default.prototype.serializeData.apply(this,arguments),t={supportContacts:this.supportContacts,onBindNextToken:this.onBindNextToken,onTokenInput:this.onTokenInput,onSmsCodeFillingComplete:this.onSmsCodeFillingComplete,onSmsCodeInput:this.onSmsCodeInput,onSmsCodeResend:this.onSmsCodeResend};return n.__assign({},e,t,this.model.attributes)},specifySerializedDataForComponent:function(e,t){switch(t){case c.default:return n.__assign({code:e.specialCode},e)}return e},setViewInitialStatus:function(){this.model.setStatus(this.statuses.STATUS_TOKEN)},changeGrootPageParam:function(){this.grootPageStatusRel[this.model.getStatus()]&&_.default.rewriteSuperProperties({page:this.grootPageStatusRel[this.model.getStatus()]})},renderReactComponent:function(e,t,i,n){i.position=n,s.render(a.createElement(e,i,null),this.$(t).get(0))},focusCurrentInput:function(){var e=this;window.ivi.adaptive.isMobile||setTimeout(function(){var t=e.$(".modal-view_finish").not(".modal-view_end"),i=t.find(".js-ivi-textfield__input").first();i.length>0?i.focus():t.find(".js-ivi-button").first().focus()},600)},onBindConfirmSuccess:function(){this.moveToNextStep(),g.default.trigger("profile:bindContacts:success")},onDestroy:function(){o.default.prototype.onDestroy.apply(this,arguments),this.model.clear(),this.stopListeningModalEvents()},trackPageView:function(){_.default.track("page_view")}});t.default=b},function(e,t,i){var n=i(21),a=i(31),s=i(201),o=i(4),r=function(e){function t(t,i){var n=e.call(this,t,i)||this;return n.state={focused:!1,filled:!1,tooltipBottom:!1,tooltipLeftBottom:!1},n}return n.__extends(t,e),t.prototype.onInput=function(e){var t=e.currentTarget.value;this.props.onInput&&this.props.onInput(t),this.setState({filled:!!t})},t.prototype.onFocus=function(){this.setState({focused:!0})},t.prototype.onBlur=function(){this.setState({focused:!1})},t.prototype.getInputWidthAndOffset=function(){return this.refs.input.offsetWidth+this.refs.input.offsetLeft},t.prototype.getTooltipWidthAndOffset=function(){return this.refs.tooltip.offsetWidth+this.refs.tooltip.offsetLeft},t.prototype.setTooltipPosition=function(){var e=this,t=o.default.getViewPort().width,i=this.getTooltipWidthAndOffset(),n=this.getInputWidthAndOffset();i+n>t?this.setState({tooltipBottom:!0},function(){i=e.getTooltipWidthAndOffset(),e.setState({tooltipLeftBottom:i>t})}):this.setState({tooltipBottom:!1,tooltipLeftBottom:!1})},t.prototype.componentDidMount=function(){this.setTooltipPosition(),window.addEventListener("resize",this.setTooltipPosition)},t.prototype.componentWillUnmount=function(){window.removeEventListener("resize",this.setTooltipPosition)},t.prototype.componentWillReceiveProps=function(e){e.error&&this.setTooltipPosition()},t.prototype.render=function(){var e=["ivi-textfield",this.props.addClasses],i=this.props.type||t.DEFAULT_INPUT_TYPE,n=["ivi-textfield__input js-ivi-textfield__input"],s=this.props.value||"";return(this.state.focused||this.state.filled)&&e.push("state_focused"),this.state.filled&&e.push("state_filled"),this.props.error&&(e.push("state_error tooltip"),this.state.tooltipBottom&&(e.push("tooltip_bottom"),this.state.tooltipLeftBottom&&e.push("tooltip_left-bottom"))),this.props.disabled&&n.push("disabled"),a.createElement("div",{className:e.join(" ")},a.createElement("input",{id:this.props.id,type:i,className:n.join(" "),placeholder:this.props.children,onFocus:this.onFocus,onBlur:this.onBlur,onChange:this.onInput,name:this.props.name,value:s,autoComplete:this.props.autocomplete?"autocomplete":"",disabled:this.props.disabled,ref:"input"}),a.createElement("label",{htmlFor:this.props.id,className:"ivi-textfield__label"},a.createElement("span",{className:"ivi-textfield__label-value"}," ",this.props.children," ")),a.createElement("div",{className:"ivi-textfield__tooltip-wrapper",ref:"tooltipWrapper"},a.createElement("div",{className:"ivi-textfield__tooltip",ref:"tooltip"},this.props.tooltipMessage)))},t.DEFAULT_INPUT_TYPE="text",n.__decorate([s.default.bindThis],t.prototype,"onInput",null),n.__decorate([s.default.bindThis],t.prototype,"onFocus",null),n.__decorate([s.default.bindThis],t.prototype,"onBlur",null),n.__decorate([s.default.bindThis],t.prototype,"setTooltipPosition",null),t}(a.PureComponent);t.default=r},function(e,t,i){var n=i(21),a=i(5),s=i(31),o=i(66),r=i(201),l=function(e){function t(t,i){var n=e.call(this,t,i)||this;return n.resendTimer=null,n.state={smsCodeSent:!1,value:"",resendTime:0,disableInput:!1},n}return n.__extends(t,e),t.prototype.getSmsCodeFormClasses=function(){var e=["circle-textfield"];return this.props.visible?this.props.codeCheking?(e.push("circle-textfield_loading"),e):(this.props.errorCode&&this.props.errorCode!==t.SMS_RATE_LIMIT_EXCEEDED_CODE&&e.push("circle-textfield_error"),this.state.resendTime?e.push("circle-textfield__get-code-sms-info_show"):!this.props.smsLeft||this.props.errorCode&&this.props.errorCode===t.SMS_RATE_LIMIT_EXCEEDED_CODE?this.props.errorCode&&this.props.errorCode!==t.SMS_RATE_LIMIT_EXCEEDED_CODE&&!this.props.smsCodeSent||e.push("circle-textfield__get-code_error_show"):e.push("circle-textfield__get-code_button_show"),e):e},t.prototype.getCodeItems=function(){var e=this,i=[],n=!this.props.smsLeft&&!!this.props.errorCode&&!this.props.codeCheking;return a.times(t.MAX_CODE_LENGTH,function(t){var a="",o=["circle-textfield__item"];e.state.value&&e.state.value[t]&&!e.props.codeCheking?(a=e.state.value[t],o.push("circle-textfield__item_has-number")):n||(o.push("circle-textfield__item_cursor-position"),n=!0),i.push(s.createElement("li",{className:o.join(" "),key:"bullet"+t},a))}),i},t.prototype.startResendTimer=function(){var e=this;this.resetResendTimer(),this.setState({resendTime:t.RESEND_TIME}),this.resendTimer=setInterval(function(){0===e.state.resendTime?e.resetResendTimer():e.setState({resendTime:e.state.resendTime-1})},1e3)},t.prototype.resetResendTimer=function(){clearInterval(this.resendTimer),this.resendTimer=null},t.prototype.componentWillReceiveProps=function(e){if(e.errorCode&&!e.smsLeft&&!e.smsCodeSent)return void this.setState({disableInput:!0});this.setState({disableInput:!1}),this.props.smsSending&&e.smsCodeSent&&this.startResendTimer()},t.prototype.onInput=function(e){var i=e.currentTarget.value;t.SMS_CODE_INPUT_RULE.test(i)&&(i.length>=t.MAX_CODE_LENGTH?(this.props.onSmsCodeFillingComplete&&this.props.onSmsCodeFillingComplete(i),this.setState({value:""}),this.props.onSmsCodeInput&&this.props.onSmsCodeInput("")):(this.setState({value:i}),this.props.onSmsCodeInput&&this.props.onSmsCodeInput(i)))},t.prototype.onClick=function(e){0===this.state.resendTime&&this.props.onSmsCodeResend&&this.props.onSmsCodeResend(),e.preventDefault()},t.prototype.render=function(){var e=this.getSmsCodeFormClasses(),i=["ivi-button two-line outline centered-content"],n=null;return this.state.resendTime>0&&i.push("disabled"),this.props.smsLeft&&(n=s.createElement("div",{className:"circle-textfield__info-message circle-textfield__info-message_margin\n                                circle-textfield__info-message_font-style js-sms-left"},"осталось",s.createElement("span",{className:"circle-textfield__iteration-count"}," ",this.props.smsLeft," "),"сообщен",o.default.getEnding(this.props.smsLeft,["ие","ия","ий"]))),s.createElement("div",{className:e.join(" ")},s.createElement("div",{className:"circle-textfield__field"},s.createElement("input",{id:"sms-code",type:"text",className:"js-ivi-textfield__input",maxLength:t.MAX_CODE_LENGTH,autoComplete:"off",onChange:this.onInput,value:this.state.value,disabled:this.state.disableInput}),s.createElement("label",{htmlFor:"sms-code"},s.createElement("div",{className:"circle-textfield__wrapper"},s.createElement("ul",{className:"circle-textfield__list"},this.getCodeItems())))),s.createElement("div",{className:"circle-textfield__get-code-wrapper"},s.createElement("div",{className:"circle-textfield_start-position circle-textfield__get-code-sms-info"},s.createElement("div",{className:i.join(" "),onClick:this.onClick},s.createElement("span",{className:"ivi-button__primary-text circle-textfield__get-code-message"},"Получить код повторно"),s.createElement("small",{className:"circle-textfield__get-code ivi-button__secondary-text\n                                    circle-textfield__info-message"},"через",s.createElement("span",{className:"circle-textfield__timer"}," ",this.state.resendTime," "),"секунд",o.default.getEnding(this.state.resendTime,["у","ы",""])),s.createElement("small",{className:"circle-textfield__get-code ivi-button__secondary-text\n                                    circle-textfield__get-code_button"},"сейчас")),n),s.createElement("div",{className:"circle-textfield_start-position circle-textfield__get-code_error"},s.createElement("div",{className:"circle-textfield__get-code-message"},"Израсходован дневной лимит сообщений"))))},t.MAX_CODE_LENGTH=6,t.SMS_RATE_LIMIT_EXCEEDED_CODE=122,t.RESEND_TIME=60,t.SMS_CODE_INPUT_RULE=/^\d*$/,n.__decorate([r.default.bindThis],t.prototype,"onInput",null),n.__decorate([r.default.bindThis],t.prototype,"onClick",null),t}(s.PureComponent);t.default=l},function(e,t,i){var n=i(14),a=i(30),s=n.default.extend({bindBeginUri:"",bindConfirmUri:"",bindType:"",parse:function(e){var t;return e.error?(t=e.error,t.user_message&&(t.message=t.user_message,delete t.user_message)):e.result&&(t=e.result,t.sms_left&&(t.smsLeft=parseInt(t.sms_left,10),delete t.sms_left)),t},sendBeginRequest:function(e){var t=this;this.set("isTokenChecking",!0),this.mapiPost({uri:this.bindBeginUri,data:e}).done(function(e){t.set("isTokenChecking",!1),e.error?a.default.trigger("profile:bindContacts:"+t.bindType+":beginError"):a.default.trigger("profile:bindContacts:"+t.bindType+":beginSuccess")}).fail(function(){t.set("isTokenChecking",!1),a.default.trigger("profile:bindContacts:"+t.bindType+":beginError")})},bindConfirm:function(){this.sendConfirmRequest({code:this.get("smsCode")})},sendConfirmRequest:function(e){var t=this;this.set("isVerifyPhoneBySMSChecking",!0),this.mapiPost({uri:this.bindConfirmUri,data:e}).done(function(e){t.set("isVerifyPhoneBySMSChecking",!1),e.error?a.default.trigger("profile:bindContacts:"+t.bindType+":confirmError"):a.default.trigger("profile:bindContacts:"+t.bindType+":confirmSuccess")}).fail(function(){t.set("isVerifyPhoneBySMSChecking",!1),a.default.trigger("profile:bindContacts:"+t.bindType+":confirmError")})},getErrorCode:function(){return this.get("code")},setErrorCode:function(e){this.set("code",e)},deleteErrorCode:function(){this.unset("code")},setSpecialErrorCode:function(e){this.set("specialCode",e)},getStatus:function(){return this.get("status")},setStatus:function(e){this.set("status",e)},resetLoadings:function(){this.set({isTokenChecking:!1,isVerifyPhoneBySMSChecking:!1})},setSmsCode:function(e){this.set("smsCode",e)},setVisibleToken:function(e){this.set("visibleToken",e)},setFormattedPhone:function(e){this.set("formattedToken",e)},getFormattedPhone:function(){return this.get("formattedToken")},getVisibleToken:function(){return this.get("visibleToken")},getEmailToken:function(){return this.get("emailToken")},getPhoneToken:function(){return this.get("phoneToken")},deleteEmailToken:function(){this.unset("emailToken")},deletePhoneToken:function(){this.unset("phoneToken")},setSmsCodeSent:function(e){this.set("smsCodeSent",e)},isSmsCodeSent:function(){return this.get("smsCodeSent")}});t.default=s},function(e,t,i){var n=i(1),a=i(0),s=i(3),o=i(917),r=i(4);t.default=a.View.extend({el:".js-unsubscribe",events:{"click .js-button[action=unsubscribe]":"clickUnsubscribe","click .js-button[action=subscribe]":"clickSubscribe","click .js-button[action=to-main]":"toMain","transitionend .js-screen":"afterTransition","webkitTransitionEnd .js-screen":"afterTransition","oTransitionEnd .js-screen":"afterTransition","MSTransitionEnd .js-screen":"afterTransition"},params:{},screens:{subscribe:"subscribe_success",unsubscribe:"unsubscribe_success"},notificationState:new o.default,initialize:function(e){this.params=e},afterTransition:function(e){var t=n(e.target);t.hasClass("unsubscribe__content")&&(t.hasClass("hide")&&t.removeClass("hide show"),t.hasClass("show")&&t.addClass("show_sharp"))},clickSubscribe:function(){var e=this;this.sendSubscribe().done(function(t){t.error?e.renderError():e.showScreen(e.screens.subscribe)}).fail(this.renderError)},clickUnsubscribe:function(){var e=this;this.sendUnsubscribe().done(function(t){t.error?e.renderError():e.showScreen(e.screens.unsubscribe)}).fail(this.renderError)},renderError:function(){n(".js-screen.show .js-error").removeClass("hide")},sendSubscribe:function(){return s.default.track("notifications_sub",{delivery_category_id:this.params.delivery_category_id,delivery_id:this.params.delivery_id,message_category_id:this.params.message_category_id}),this.changeNotificationState(!0)},sendUnsubscribe:function(){return s.default.track("notifications_unsub",{delivery_category_id:this.params.delivery_category_id,delivery_id:this.params.delivery_id,message_category_id:this.params.message_category_id}),this.changeNotificationState(!1)},showScreen:function(e){n(".unsubscribe__content.show").removeClass("show_sharp").addClass("hide"),n(".unsubscribe__content[screen="+e+"]").addClass("show")},changeNotificationState:function(e){return this.notificationState.change(e,this.params)},toMain:function(){r.default.redirect("/")}})},function(e,t,i){var n=i(350),a=i(352),s=n.default.extend({newSeriesNotifications:null,requestParamsWithSign:null,showClasses:"screen-slide__item_current js-current-slide-item animate-up screen-slide__slide_top-on",hideClasses:"screen-slide__item_previous animate-down screen-slide__slide_top-off",initialize:function(e){e&&(this.requestParamsWithSign=e.requestParamsWithSign,this.objectType=e.objectType)},onFavouritesDelete:function(e){this.onFavouritesChange(e,"Delete")},onFavouritesAdd:function(e){this.onFavouritesChange(e,"Add")},onFavouritesChange:function(e,t){e.result?(this.changeSlide(),a.default.trigger("unsubscribe:favourites"+t)):this.showError()},changeSlide:function(){var e=this.$(".js-current-slide-item");this.$(".page-subscription__content_error").removeClass("page-subscription__content_error"),e.hasClass("js-unsubscribe-slide")?(e.removeClass(this.showClasses),e.addClass(this.hideClasses),this.$(".js-subscribe-slide").addClass(this.showClasses)):e.hasClass("js-subscribe-slide")&&(e.removeClass(this.showClasses),e.addClass(this.hideClasses),this.$(".js-end-slide").addClass(this.showClasses))},showError:function(){this.$(".page-subscription__content").addClass("page-subscription__content_error")}});t.default=s},function(e,t,i){var n=i(0);t.default=new n.Model({})},function(e,t,i){i(354);var n=i(1),a=i(355),s=i(465),o=i(467),r=i(471),l=i(12),d=i(473),u=i(502),c=i(503),p=i(506),f=i(507),h=i(516),g=i(520),m=i(524),v=i(526),_=i(530),b=i(541),y=i(632),w=i(636),C=i(640),k=i(650),P=i(686),S=i(687),T=i(696),E=i(744),I=i(745),x=i(746),M=i(749),A=i(750),L=i(759),O=i(762),j=i(765),D=i(775),R=i(780),N=i(784),B=i(785),U=i(786),F=i(791),V=i(792),$=i(846),z=i(848),G=i(851),H=i(854),W=i(891),q=i(898),Y=i(904),K=i(905),Q=i(906),J=i(907),X=i(908),Z=i(910),ee=i(911),te=i(912),ie=i(913),ne=i(914),ae=i(915),se=i(918),oe=i(922),re=i(926),le=i(929),de=i(932),ue=[J.default,X.default,G.default,ie.default,te.default,Y.default,ne.default,Q.default,Z.default,T.default,M.default,x.default,S.default,k.default,E.default,L.default,A.default,I.default,ee.default,d.default,g.default,u.default,c.default,p.default,f.default,m.default,v.default,h.default,a.default,s.default,o.default,r.default,V.default,j.default,F.default,P.default,K.default,y.default,w.default,C.default,B.default,N.default,D.default,$.default,z.default,U.default,b.default,H.default,_.default,q.default,W.default,O.default,R.default,ae.default,se.default,oe.default,re.default,le.default,de.default,l.default];(window.ivi&&!window.ivi.adaptive||!window.ivi)&&(window.ivi=window.ivi||{},window.ivi.adaptive={isMobile:!1,isMobileStyle:!1,isPhone:function(){return!1},isTablet:function(){return!1},isDesktop:function(){return!0}}),n(function(){for(var e=0;e<ue.length;e++){var t=new ue[e];if(t.isMatch()){t.launch();break}}})},function(e,t){e.exports=Backbone.Stickit},function(e,t,i){var n=i(356),a=i(12),s=i(9);t.default=s.default.extend({routes:["/auth/facebook"],run:function(e){a.default.prototype.run(e),(new n.default).execute(e)}})},function(e,t,i){var n=i(136),a=i(22);t.default=n.default.extend({authErrorEvent:"auth:facebook:error",grootAuthSuccess:"fb_success",grootAuthError:"fb_error",run:function(){n.default.prototype.run.call(this)},authLogin:function(e){a.default.loginByFacebook(e)}})},function(e,t,i){var n=i(1),a=i(0),s=i(5),o=i(137),r=function(e,t){var i=n(e),a=!1,s=function(){var e=!1;return i.each(function(){var t=n(this),i=n(window),a=i.scrollTop(),s=a+i.height(),o=t.offset().top;o+t.height()<s&&o>a&&(e=!0)}),e},r=function(){a||s()&&(t(e),a=!0)};this.listenTo(o.default,"scroll",r),r()};s.extend(r.prototype,a.Events),t.default=r},function(e,t){e.exports=Groot},function(e,t,i){var n=i(21),a=i(1),s=i(138),o=i(4),r=i(39),l=i(8),d=i(10),u=i(361),c=i(7);t.default=s.default.extend({additionalEvents:{"click .js-participate":"participate"},LOGIN_EVENT_PARAM:"sber",BIND_CARD_URL:"/buy/sberbank?from=sberbank_landing&redirect_url=/collections/movies-family-watching",participateButtonClicked:!1,initialize:function(){this.events=n.__assign({},this.events,this.additionalEvents),this.listenTo(c.default,"user:logout",this.renderButton),this.listenTo(c.default,"auth:modal:closed",this.renderButton),s.default.prototype.initialize.call(this,{from:"sberbank_landing"}),this.initReloadSubscriber()},participate:function(){return l.default.isAuthenticated()?this.redirectToBuyPage():(this.participateButtonClicked=!0,c.default.trigger("auth:showLoginModal",this.LOGIN_EVENT_PARAM)),!1},renderButton:function(){l.default.isAuthenticated()&&!d.default.hasSubscription&&this.participateButtonClicked?this.redirectToBuyPage():this.$el.find(".js-participate-block").each(function(e,t){var i=a(t);i.html(u.default({user:l.default,host:r.default.getRightHostOrigin(),buttonClass:i.data("button-class"),sberbankHoldersDuration:i.data("duration")}))}),this.participateButtonClicked=!1},render:function(){s.default.prototype.render.call(this),this.renderButton()},initReloadSubscriber:function(){a(window).off("message"),a(window).on("message",this.onReloadMessage.bind(this))},redirectToBuyPage:function(){o.default.redirect(this.BIND_CARD_URL)},onReloadMessage:function(e){"window:reload"===e.originalEvent.data&&(!d.default.hasSubscription&&this.participateButtonClicked?this.redirectToBuyPage():o.default.reload())}})},function(e,t,i){var n=i(0);t.default=n.Model.extend({getTestCode:function(){return this.get("test_code")},getValue:function(){return this.get("value")},getGroupCode:function(){return this.get("group_code")}})},function(e,t,i){function n(e){return a.default.render('{% if hasSubscription %} <div class="section__warning"> <div class="section__warning-inner"> <div class="section__warning-text">У вас уже есть подписка, наслаждайтесь просмотром</div> <a href="{{ host }}/plus" class="ivi-button {{ buttonClass|default("") }} large">Смотреть фильмы по подписке</a> </div> </div>{% else %} <div class="section__actions"> <div class="section__actions-inner"> <a href="#" class="ivi-button huge {{ buttonClass|default("") }} js-participate">Получить {{ sberbankHoldersDuration }} {{ declension.days(sberbankHoldersDuration) }} подписки</a> {% if user.isAuthenticated() %} <div class="section__actions-conditions">Необходимо привязать карту Сбербанка</div> {% else %} <div class="section__actions-conditions">Необходимо зарегистрироваться на ivi и&nbsp;привязать карту Сбербанка</div> {% endif %} </div> </div>{% endif %}',e)}var a=i(2);t.default=n},function(e,t){e.exports=Twig},function(e,t){e.exports=bbcode},function(e,t,i){var n=i(14);t.default=n.default.extend({uri:"/user/session/refresh/v5/"})},function(e,t,i){var n=i(366),a=[30,33,38,251,127,172,229,201],s=[76,22,159,7,86,216,130,24],o=function(e,t){for(var i=t.toFixed(),n=e,a=0;a<7-i.length;a++)n+="0";n+=i;var s=n.charCodeAt(3)|n.charCodeAt(2)<<8|n.charCodeAt(1)<<16|n.charCodeAt(0)<<24,o=n.charCodeAt(7)|n.charCodeAt(6)<<8|n.charCodeAt(5)<<16|n.charCodeAt(4)<<24;return s<0&&(s=4294967296+s),o<0&&(o=4294967296+o),[s,o]},r=function(e){var t=e[0]>>8;return t<0&&(t=16777216+t),t},l=function(e,t,i,a){for(var s,l,d=new n,u=[],c=0;c<32;c+=2)u.push(parseInt(e.slice(c,c+2),16));d.init(u);for(var p={},f=[0,0],c=0;c<t;c++)s=o("1",c),1===a&&(s=[s[0]^f[0],s[1]^f[1]]),d._encryptBlock(s),f=s,l=r(s),p[l]=c;for(var h={},g=0,c=0;c<t;c++)g!==i&&(s=o("2",c),1===a&&(s=[s[0]^f[0],s[1]^f[1]]),d._encryptBlock(s),f=s,(l=r(s))in p&&!(p[l]in h)&&(h[p[l]]=c,g++));var m=[],v=Object.keys(h).sort(function(e,t){return e-t});for(var _ in v)v.hasOwnProperty(_)&&(m.push(v[_]-0),m.push(h[v[_]]));return m},d=function(e,t){for(var i,a,s,o,r,l=e,d=0;d<t.length;d+=8){for(i=t.slice(d,d+8),a=[],o=0;o<i.length;o++)a.push(i.charCodeAt(o));for(r=new n,r.init(a),s=r.encryptBlock(l),s=[s[3],s[2],s[1],s[0],s[7],s[6],s[5],s[4]],o=0;o<8;o++)l[o]=s[o]^l[o]}return l},u=function(e){e+="";var t,i;for(t=e.length<=8?8-e.length:8-e.length%8,i=0;i<t;i++)e+="\0";var n=this.compress(a,e).concat(this.compress(s,e)),o="";for(i=0;i<n.length;i++){var r=n[i].toString(16);1===r.length&&(r="0"+r),o+=r}return o};t.default={solve:l,compress:d,hasher:u}},function(e,t){e.exports=Blowfish},function(e,t,i){var n=i(1),a=i(16),s=i(22),o=i(7),r=i(369),l=i(3);t.default=a.default.extend({mobileModal:!0,openEvent:"confirm:email:show",events:{"click .js-confirm-button":"sendConfirm","click .js-confirm-ok-button":"closeConfirm"},template:r.default,initialize:function(e){a.default.prototype.initialize.call(this,e),this.listenTo(o.default,"confirm:email:show:user",this.showModalForUser)},sendConfirm:function(){l.default.track("email_conf_click"),s.default.sendConfirmEmail(),n("#js-confirm-text").empty().html("Мы отправили вам письмо на почту "+this.email+". Перейдите по ссылке внутри письма, чтобы подтвердить ваш email."),n(".js-confirm-button").empty().html("Ок").removeClass("js-confirm-button").addClass("js-confirm-ok-button")},closeConfirm:function(){this.$(this.cancelEl).click()},showModalForUser:function(e,t){this.email=e,this.isComment=t,o.default.trigger("confirm:email:show")},serializeData:function(){return{isComment:this.isComment}},onDestroyAnimation:function(){this.$el.empty()}})},function(e,t,i){var n=i(1),a=i(0),s=a.View.extend({render:function(e){n("#modal-container").append(e)}});t.default=new s},function(e,t,i){function n(e){return a.default.render('<div class="ivi-modal-wrapper-content simple-basic"> <h1 class="ivi-modal-title">Подтверждение email</h1> <div class="ivi-modal-content"> <p id="js-confirm-text">Подтвердите свой email. {% if isComment %}Отзывы{% else %}Рецензии{% endif %} могут оставлять только подтвержденные пользователи.</p> <div class="button-wrapper"> <span class="ivi-button large js-confirm-button">Подтвердить</span> </div> </div> <span class="ivi-modal-close js-modal-close">Закрыть</span></div>',e)}var a=i(2);t.default=n},function(e,t){e.exports=morphdom},function(e,t,i){var n=i(0);t.default=n.View.extend({el:"canvas#graph",initialize:function(e){this.countries=e,this.applyDefaultValues(),this.paintDiagram()},applyDefaultValues:function(){this.r1=0,this.r2=0,this.x1=0,this.x2=0,this.y1=0,this.y2=0,this.canvasSize=this.$el.width(),this.diameter=214,this.centerX=this.canvasSize/2,this.centerY=this.canvasSize/2,this.radius=this.diameter/2,this.segmentsLineWidth=45,this.context=this.el.getContext("2d")},paintDiagram:function(){this.paintLineBg(),this.paintSegmentsLines(),this.paintSegmentDividers()},paintLineBg:function(){this.paintLine(0,100,60,"#fff",3)},paintSegmentsLines:function(){for(var e=0,t=this.countries[0].percent,i=this.countries[0].color,n=0;n<this.countries.length;n++)this.paintLine(e,t,this.segmentsLineWidth,i,0),n!==this.countries.length-1&&(e+=this.countries[n].percent,t+=this.countries[n+1].percent,i=this.countries[n+1].color)},getRadian:function(e){return 2*Math.PI/100*e-Math.PI/2},getSinCosDividers:function(e){var t=this.getRadian(e);this.x1=this.r1*Math.cos(t)+this.centerX,this.y1=this.r1*Math.sin(t)+this.centerY,this.x2=this.r2*Math.cos(t)+this.centerX,this.y2=this.r2*Math.sin(t)+this.centerY},paintSegmentDividers:function(){this.r1=this.radius-this.segmentsLineWidth/2-3,this.r2=this.radius+this.segmentsLineWidth/2+3;var e=this.countries[0].percent;this.getSinCosDividers(e);for(var t=0;t<this.countries.length;t++)this.context.beginPath(),this.context.moveTo(this.x1,this.y1),this.context.lineTo(this.x2,this.y2),this.context.lineWidth=6,this.context.strokeStyle="#fff",this.context.stroke(),t!==this.countries.length-1&&(e+=this.countries[t+1].percent),this.getSinCosDividers(e)},paintLine:function(e,t,i,n,a){var s=this.getRadian(e),o=this.getRadian(t);this.context.beginPath(),this.context.arc(this.centerX,this.centerY,this.radius,s,o,!1),this.context.lineWidth=i,this.context.strokeStyle=n,this.context.shadowOffsetX=0,this.context.shadowOffsetY=0,this.context.shadowBlur=a,this.context.shadowColor="rgba(0, 0, 0, 0.2)",this.context.stroke()}})},function(e,t,i){function n(e){return a.default.render('<object type="application/x-shockwave-flash" data="{{ params.src }}" width="{{ params.width }}" height="{{ params.height }}" id="{{ params.id }}" style="visibility: visible; vertical-align: top;"> {% for key, value in params %} <param name="{{ key }}" value="{{ value }}"> {% endfor %}</object>',e)}var a=i(2);t.default=n},function(e,t,i){var n=i(1),a=i(20),s=i(4),o=i(374),r=function(){function e(){this.REMAINING_TIME_CHECK_PERIOD=300,this.WOW_VPAID_CONTAINER=".js-player-wow-vpaid",this.WOW_VPAID_IFRAME_ID="player-wow-vpaid-iframe",this.WOW_VPAID_VIDEO_ID="player-wow-vpaid-video",this.WOW_VPAID_WRAPPER_ID="player-wow-vpaid-wrapper",this.pauseNext=!1,this.remainTimeChangeInterval=null,this.currentAdDuration=null,this.currentBitrate=400,this.uid=null,this.currentAdvObject=null,this.playerIframe=null,this.$vpaidContainer=null,this.vpaidJsListenerAttached=!1,this.VPAID_ERROR_EVENT="AdError",this.CUSTOM_TIMEUPDATE_EVENT="currentTimeUpdate",this.vpaidIframe=null,this.vpaidCreative=null,this.resizeListenerBound=!1,this.vpaidEvents=["AdStarted","AdStopped","AdSkipped","AdLoaded","AdLinearChange","AdSizeChange","AdExpandedChange","AdSkippableStateChange","AdDurationChange","AdRemainingTimeChange","AdVolumeChange","AdImpression","AdClickThru","AdInteraction","AdVideoStart","AdVideoFirstQuartile","AdVideoMidpoint","AdVideoThirdQuartile","AdVideoComplete","AdUserAcceptInvitation","AdUserMinimize","AdUserClose","AdPaused","AdPlaying","AdLog"],this.VOLUME_LOCAL_STORAGE_KEY="video_volume",this.MUTE_LOCAL_STORAGE_KEY="video_mute"}return e.prototype.init=function(e,t){var i=this;this.playerIframe=document.getElementById("player-iframe"),this.playerIframe&&(this.currentBitrate=t.bitrate,this.uid=t.uid,this.currentAdvObject=e,this.vpaidJsListenerAttached||(window.addEventListener("message",this.vpaidJsLoaded.bind(this,e.getAdvVideoId()),!1),this.vpaidJsListenerAttached=!0),n(".js-player-wrapper").append(o.default()),setTimeout(function(){i.vpaidIframe=document.getElementById(i.WOW_VPAID_IFRAME_ID),i.vpaidIframe.contentWindow.document.write("<script onload=\"window.parent.postMessage('vpaidJsLoaded', '*');\" src=\""+e.getJsFile()+'"><\/script>'),i.vpaidIframe.contentWindow.document.write('<div id="'+i.WOW_VPAID_WRAPPER_ID+'"></div>')},0),this.resizeListenerBound||(this.resizeListenerBound=!0,n(window).resize(this.resize.bind(this))))},e.prototype.vpaidJsLoaded=function(e,t){if("vpaidJsLoaded"===t.data){if("function"!=typeof this.vpaidIframe.contentWindow.getVPAIDAd)return void this.vpaidEventHandler(this.VPAID_ERROR_EVENT,{pauseNext:this.pauseNext,errorMessage:"getVPAIDAd is not a function",advVideoId:e});this.vpaidCreative=this.vpaidIframe.contentWindow.getVPAIDAd();for(var i in this.vpaidEvents)this.vpaidCreative.subscribe(this.handleEvent.bind(this,e),this.vpaidEvents[i],this);this.vpaidCreative.subscribe(this.handleError.bind(this,e),this.VPAID_ERROR_EVENT,this);var n={};n.slot=this.vpaidIframe.contentWindow.document.getElementById(this.WOW_VPAID_WRAPPER_ID),n.videoSlot=document.getElementById(this.WOW_VPAID_VIDEO_ID),n.videoSlotCanAutoPlay=!0,this.currentAdvObject.isSurvey()&&(n.campaignId=this.currentAdvObject.getCampaignId(),n.orderId=this.currentAdvObject.getOrderId(),n.uid=this.uid),null!==this.vpaidIframe.contentWindow.document.body&&(this.vpaidIframe.contentWindow.document.body.style.margin=0);try{this.vpaidCreative.initAd(n.videoSlot.clientWidth,n.videoSlot.clientHeight,"normal",this.currentBitrate,{AdParameters:this.currentAdvObject.getAdParameters()},n)}catch(t){this.vpaidEventHandler(this.VPAID_ERROR_EVENT,{pauseNext:this.pauseNext,errorMessage:t.message||"",advVideoId:e})}}},e.prototype.handleError=function(e,t){if(t){var i={pauseNext:this.pauseNext};"string"==typeof t?i.errorMessage=t:t.getError&&(i.errorCode=t.getError().getErrorCode(),i.errorMessage=t.getError().getMessage()),i.advVideoId=e,this.vpaidEventHandler(this.VPAID_ERROR_EVENT,i)}},e.prototype.handleEvent=function(e,t){switch("object"==typeof t&&void 0!==t.type&&(t=t.type),t){case"AdLoaded":this.vpaidCreative.startAd();break;case"AdResumed":this.resumeAd(),this.setRemainingTimeChangeInterval(e,t,this.vpaidCreative.getAdLinear());break;case"AdPaused":clearInterval(this.remainTimeChangeInterval);break;case"AdStarted":this.setRemainingTimeChangeInterval(e,t,this.vpaidCreative.getAdLinear()),this.setStartVolume();break;case"AdUserClose":clearInterval(this.remainTimeChangeInterval),this.currentAdDuration=null,this.vpaidCreative.stopAd();break;case"AdStopped":clearInterval(this.remainTimeChangeInterval),this.currentAdDuration=null}this.vpaidEventHandler(t,{isLinear:this.vpaidCreative.getAdLinear(),pauseNext:this.pauseNext,advVideoId:e})},e.prototype.resumeAd=function(){this.previousVolume&&(this.vpaidCreative.setAdVolume(this.previousVolume),this.pauseNext=!1)},e.prototype.setStartVolume=function(){if(a.default.localStorage.getItem(this.MUTE_LOCAL_STORAGE_KEY))this.vpaidCreative.setAdVolume(0);else{var e=a.default.localStorage.getItem(this.VOLUME_LOCAL_STORAGE_KEY);e&&this.vpaidCreative.setAdVolume(parseFloat(e))}},e.prototype.pauseAd=function(){this.previousVolume=this.vpaidCreative.getAdVolume(),this.vpaidCreative.setAdVolume(0),this.pauseNext=!0},e.prototype.setRemainingTimeChangeInterval=function(e,t,i){var n=this;clearInterval(this.remainTimeChangeInterval);var a=function(){if(n.vpaidCreative)if(n.currentAdDuration){var a=n.currentAdDuration-n.vpaidCreative.getAdRemainingTime();a>0&&n.vpaidEventHandler(n.CUSTOM_TIMEUPDATE_EVENT,{isLinear:i,pauseNext:n.pauseNext,errorMessage:t.errorMessage||"",currentTime:a,advVideoId:e})}else n.currentAdDuration=n.vpaidCreative.getAdRemainingTime()};this.remainTimeChangeInterval=setInterval(a,this.REMAINING_TIME_CHECK_PERIOD),a()},e.prototype.vpaidEventHandler=function(e,t){e===this.VPAID_ERROR_EVENT&&this.hide(),s.default.postMessageToIframe(this.playerIframe,{type:"player",message:"vpaidEvent",params:t,event:e},"*")},e.prototype.hide=function(){null!==this.vpaidIframe&&(n(this.WOW_VPAID_CONTAINER).remove(),this.vpaidCreative=null,this.currentBitrate=400,this.currentAdvObject=null,this.vpaidIframe=null)},e.prototype.resize=function(){if(null!==this.vpaidCreative){var e=document.getElementById(this.WOW_VPAID_VIDEO_ID);null!==e&&e.clientWidth&&e.clientHeight&&this.vpaidCreative.resizeAd(e.clientWidth,e.clientHeight,"normal")}},e}();t.default=new r},function(e,t,i){function n(e){return a.default.render('<div class="player-wow-vpaid js-player-wow-vpaid"> <iframe id="player-wow-vpaid-iframe" allow="autoplay; fullscreen" style="width: 100%; height: 100%;" src="javascript:false" scrolling="no"></iframe> <video id="player-wow-vpaid-video" style="width: 100%; height: 100%;"></video></div>',e)}var a=i(2);t.default=n},function(e,t,i){function n(e){return a.default.render('<div class="fullscreen-popup fullscreen-popup_active {% if isFirstStep|default(true) and not isLoginByCodePage|default(false) %}fullscreen-popup_has-close-view-button {% endif %}js-auth-main-wrapper" id="auth-continuity"> <div class="fullscreen-popup__overlay"> <span></span> <span></span> <span></span> </div> <div class="fullscreen-popup__scroll-wrapper"> <div class="fullscreen-popup__wrapper js-auth-wrapper"> <a class="fullscreen-popup__previous-view-button js-back-button" href="#" title="Нажмите, чтобы перейти на шаг назад"> Назад </a> <a class="fullscreen-popup__close-view-button js-modal-close" href="#" title="Нажмите, чтобы закрыть форму"> Закрыть окно </a> {% if isLoginByCodePage|default(false) and isFakeAuthForm|default(false) %} {% if user.isAuthenticated() %} {% set userToken = "" %}{% if oauthUserToken|default(false) %} {% set userToken = oauthUserToken %}{% elseif formattedPhone|default(false) %} {% set userToken = formattedPhone %}{% elseif email|default(false) %} {% set userToken = email %}{% endif %}<div class="user-authorization-code-start modal-view modal-view_start {% if isLoginByCodeStep|default(false) %}modal-view_finish {% endif %}js-login-by-code-block"> <div class="user-authorization-code-start__grid-container"> <div class="user-authorization-code-start__container user-authorization-code-start_grid-container-inner"> <div class="user-authorization-code-start__top-lane"> <span class="user-badge user-badge_depicts-authorized-user medium"> <span class="user-badge__icon"></span> </span> <h3 class="fullscreen-popup__title user-authorization-code-start__title"> Вход на Smart TV <span class="fullscreen-popup__title-mark user-authorization-code-start__title-mark">{{ userToken }}</span> </h3> </div> <div class="circle-textfield {% if isLoginCodeChecking|default(false) %}circle-textfield_loading {% endif %}circle-textfield__get-code-sms-info_show user-authorization-code-start__circle-textfield"> <div class="circle-textfield__field user-authorization-code-start__field user-authorization-code-start__field"> <input id="login-code" class="js-ivi-textfield__input js-login-code{% if disableLoginByCode|default(false) %} disabled{% endif %}" {% if disableLoginByCode|default(false) %} disabled="disabled"{% endif %} maxlength="6" autocomplete="off" type="text" value="{{ loginCode|default("") }}"> <label for="login-code"> <div class="circle-textfield__wrapper"> <ul class="circle-textfield__list"> {% set hasCursor = disableLoginByCode|default(false) %} {% for index in 0..LOGIN_CODE_MAX_LENGTH - 1 %} {% if visibleLoginCode|default(false) and visibleLoginCode[index] %} <li class="circle-textfield__item circle-textfield__item_has-number">{{ visibleLoginCode[index] }}</li> {% else %} <li class="circle-textfield__item {% if not hasCursor %} circle-textfield__item_cursor-position{% endif %}"></li> {% set hasCursor = true %} {% endif %} {% endfor %} </ul> </div> </label> </div> <div class="circle-textfield__information-content"> {% if code|default(false) %} <div class="circle-textfield__content circle-textfield__content_visible circle-textfield__content_warning"> {{ userMessage|default("") }} </div> {% else %} <div class="circle-textfield__content circle-textfield__content_visible"> Введите код, указанный на экране приложения ivi для Smart TV, вход в профиль произойдёт автоматически </div> {% endif %} </div> </div> </div> <div class="user-authorization-code-start__help-information"> <div class="user-authorization-code-start__help-information-image"></div> <p class="user-authorization-code-start__help-information-content"> Откройте приложение ivi на Smart TV и выберите &laquo;Вход по коду&raquo; на экране авторизации </p> </div> </div></div> {% else %} {% include "auth/authenticationBlocks/authentication-token-block.front.twig" with {"isFirstStep": true} %} {% endif %} {% endif %} </div> </div></div>',e)}var a=i(2);t.default=n},function(e,t,i){function n(e){return a.default.render('{% set socialAuth = not isOauth2Page|default(false) and (yandexOauthCapability|default(false) or socialButtonsCapability|default(false)) %}{% set disableAuthTokenButton = not authToken|default(false) or code|default(false) or isAuthTokenChecking|default(false) %}<div class="auth-block modal-view modal-view_start {% if isFirstStep|default(false) %}modal-view_finish {% elseif isSecondStep|default(false) %}modal-view_end {% endif %} js-auth-token-block"> <div class="auth-block__grid-container"> <div class="auth-block__container auth-block__grid-container-inner"> <h3 class="fullscreen-popup__title fullscreen-popup__title_short{% if tokenFormNotice|default("") %} fullscreen-popup__title_error-active{% endif %}"> Войдите или&nbsp;зарегистрируйтесь{% if isLoginModalBeforePurchase|default(false) %} для&nbsp;продолжения покупки{% endif %} <span class="fullscreen-popup__title-mark_error">{{ tokenFormNotice|default("") }}</span> <span class="fullscreen-popup__title-mark">Если у вас еще нет профиля на ivi, он будет создан</span> </h3> <div class="social-button"> {% if socialAuth %} <ul class="social-button__list"> {% if socialButtonsCapability|default(false) %} <li id="vk-auth" class="social-button__item vkontakte knob">Вконтакте</li> <li id="fb-auth" class="social-button__item facebook knob">Facebook</li> {% endif %} {% if yandexOauthCapability %}<li id="ya-auth" class="social-button__item yandex knob">Яндекс</li>{% endif %} </ul> {% endif %} </div> {% if socialAuth %} <div class="auth-block__spacer">или</div> {% endif %} <form id="jsAuthToken" class="auth-block__form" action="#"> <div class="auth-block__group-fields"> <div class="ivi-textfield style_default size_large icon_user js-ivi-textfield{% if authTokenInputFocused|default(false) or authToken|default(false) %} state_focused{% endif %}{% if code|default(false) %} state_error tooltip{% endif %}{% if authToken|default(false) %} state_filled{% endif %}"> <input type="text" class="ivi-textfield__input js-auth-token js-ivi-textfield__input" value="{% if authToken|default(false) %}{{ authToken|default(false) }}{% endif %}" placeholder="Через email{% if smsRegistrationCapability|default(false) %} или телефон{% endif %}" name="emailOrPhone"> <label class="ivi-textfield__label"> <span class="ivi-textfield__label-value">Через email{% if smsRegistrationCapability|default(false) %} или телефон{% endif %}</span> </label> <div class="ivi-textfield__tooltip-wrapper"> <div class="ivi-textfield__tooltip">{{ userMessage|default("") }}</div> </div> </div> <div class="auth-block__state-container state-container"> <button type="submit" class="auth-block__form-button ivi-button large js-check-auth-token{% if isAuthTokenChecking|default(false) %} loading{% endif %}{% if disableAuthTokenButton %} disabled{% endif %}" {% if disableAuthTokenButton %}disabled="disabled"{% endif %}>Продолжить</button> <div class="auth-block__state-wrapper"> <svg class="auth-block__state-icon" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="32" height="32" viewBox="0 0 32 32"> <defs> <path id="a" d="M0 0h32v32H0z"></path> </defs> <g fill="none" fill-rule="evenodd"> <path fill="#645ba3" fill-rule="nonzero" d="M8.777 9.692a1.094 1.094 0 0 1-1.437.075c-.42-.338-.456-.92-.082-1.3 1.71-1.736 3.994-2.945 6.506-3.445.55-.11 1.09.204 1.212.7.12.497-.226.988-.775 1.097-2.09.412-3.993 1.42-5.42 2.87z" mask="url(#b)"></path> <path fill="#ec174f" fill-rule="nonzero" d="M16 0c8.837 0 16 7.163 16 16s-7.163 16-16 16S0 24.837 0 16 7.163 0 16 0zm0 2C8.268 2 2 8.268 2 16s6.268 14 14 14 14-6.268 14-14S23.732 2 16 2z" mask="url(#b)"></path> <path fill="#ec174f" d="M14.43 18.53l6.903-7.23c.38-.4 1-.4 1.38 0 .382.4.382 1.046 0 1.446L15.12 20.7c-.19.2-.44.3-.69.3-.25 0-.5-.1-.69-.3l-3.454-3.615a1.057 1.057 0 0 1 0-1.447c.38-.4 1-.4 1.38 0l2.763 2.893z" mask="url(#b)"></path> </g> </svg> </div> </div> </div> </form> {% if loadedYandexUserInfo|default(false) %} <span class="fullscreen-popup__title-mark">Войти через</span> <ul class="social-button__list oauth-social-buttons"> <li id="ya-click" class="social-button__item yandex knob">Яндекс</li> </ul> {% endif %} {% if isOauth2Page|default(false) %} <div class="oauth-modal-informer"> <div class="oauth-modal-informer__button"> <div class="oauth-modal-informer__tooltip"> <ul class="oauth-modal-informer__list"> <li class="oauth-modal-informer__item">Имя, email, номер телефона, дата рождения, дата регистрации, аватар</li> <li class="oauth-modal-informer__item">Список фильмов и сериалов, добавленных в раздел &laquo;Смотреть позже&raquo;</li> <li class="oauth-modal-informer__item">Список купленных фильмов и сериалов</li> </ul> </div> ? </div> <div class="oauth-modal-informer__message"> {% if oauth2ClientName %}Приложение &laquo;{{ oauth2ClientName }}&raquo;{% else %}Это приложение{% endif %} получит доступ к учётной записи ivi </div> </div> {% endif %} </div> {% if not isOauth2Page|default(false) %} <div class="auth-block__user-agreement"> <p> Нажимая на кнопку &laquo;Продолжить&raquo; вы принимаете условия <a class="auth-block__user-agreement-link" href="https://www.ivi.ru/info/agreement" target="_blank" title="Нажмите, чтобы посмотреть пользовательское соглашение">Пользовательского соглашения</a> и даёте согласие на получение информационных сообщений от ivi на предоставленный email или номер телефона </p> </div> {% endif %} </div></div>',e)}var a=i(2);t.default=n},function(e,t,i){function n(e){return a.default.render('{# Текст ошибки показываем только в случае получения ошибки и код ошибки не соответствует "Исчерпанию лимита" #}{% set errorActiveTitleClass = "" %}{% if code and code != SMS_RATE_LIMIT_EXCEEDED_CODE %} {% set errorActiveTitleClass = "fullscreen-popup__title_error-active" %}{% endif %}{# т.к. в форме сохраняется состояние после смены экрана, то при возврате и изменении, возможно, будет другая кнопка, #}{# соответственно пока не получим данные о том, какую кнопку показать - ничего не выводим, #}{# чтобы кнопки не мелькали анимацией #}{% set errorFormClass = "" %}{% if not isPhoneRegistrationChecking and isSecondStep %} {# Если проверяем валидность введенного кода, то выводим только лоадинг #} {% if isSMSVerifyCodeChecking %} {% set errorFormClass = "circle-textfield_loading" %} {% else %} {# Закрашиваем инпут красным только если получена ошибка и она не соответствует ошибке "Исчерпан лимит" #} {% if code and code != SMS_RATE_LIMIT_EXCEEDED_CODE %} {% set errorFormClass = "circle-textfield_error" %} {% endif %} {# Если запущен таймер, то показываем только его, иначе другие кнопки #} {% if currentResendTime %} {% set errorFormClass = "circle-textfield__get-code-sms-info_show" %} {% else %} {% if not smsLeft or code and code == SMS_RATE_LIMIT_EXCEEDED_CODE %} {# В случае, если получили ошибку и при этом у пользователя количество возможных к отправки смс равно 0 и до этого смс не была отправленна, #} {# то ничего не выводим #} {% if not code or code == SMS_RATE_LIMIT_EXCEEDED_CODE or isSmsVerifyCodeSent %} {% set errorFormClass = "circle-textfield__get-code_error_show" %} {% endif %} {% else %} {% set errorFormClass = "circle-textfield__get-code_button_show" %} {% endif %} {% endif %} {% endif %}{% endif %}<div class="auth-sms-registration-block modal-view modal-view_start {% if isSecondStep %}modal-view_finish {% elseif isLastStep %}modal-view_end {% endif %}js-sms-verify-code-block"> <div class="auth-sms-registration-block__grid-container"> <div class="auth-sms-registration-block__container auth-sms-registration-block__grid-container-inner"> <div class="user-badge user-badge_depicts-phone"> <div class="user-badge__icon"></div> <div class="user-badge__information-type"> {{ formattedPhone }} </div> </div> <h3 class="fullscreen-popup__title {{ errorActiveTitleClass }}"> {% if isPhoneRegistrationStep|default(false) %}Вы регистрируетесь на&nbsp;ivi{% else %}Здравствуйте{% endif %} <span class="fullscreen-popup__title-mark_error">{{ userMessage|default("") }}</span> <span class="fullscreen-popup__title-mark">Введите код, отправленный по смс</span> </h3> <form id="jsPhoneRegistration" class="auth-sms-registration-block__form" action=""> <div class="circle-textfield {{ errorFormClass }} js-sms-verify-code-wrapper"> <div class="circle-textfield__field"> <input id="sms-code" type="text" class="js-ivi-textfield__input js-sms-verify-code" value="{{ smsVerifyCode }}" {% if not smsLeft and code and not isSmsVerifyCodeSent %}disabled="disabled"{% endif %} autocomplete="off"/> <label for="sms-code"> <div class="circle-textfield__wrapper"> <ul class="circle-textfield__list"> {% set hasCursor = not smsLeft and code and not isSMSVerifyCodeChecking %} {% for index in 0..VERIFY_CODE_LENGTH - 1 %} {% if visibleSMSVerifyCode|default(false) and visibleSMSVerifyCode[index] and not isSMSVerifyCodeChecking %} <li class="circle-textfield__item circle-textfield__item_has-number">{{ visibleSMSVerifyCode[index] }}</li> {% else %} <li class="circle-textfield__item{% if not hasCursor %} circle-textfield__item_cursor-position{% endif %}"></li> {% set hasCursor = true %} {% endif %} {% endfor %} </ul> </div> </label> </div> <div class="circle-textfield__get-code-wrapper"> <div class="circle-textfield_start-position circle-textfield__get-code-sms-info"> <div class="ivi-button two-line outline centered-content{% if currentResendTime %} disabled{% endif %} js-send-sms-verify-code"> <span class="ivi-button__primary-text circle-textfield__get-code-message"> Получить код повторно </span> <small class="circle-textfield__get-code ivi-button__secondary-text circle-textfield__info-message"> через <span class="circle-textfield__timer">{{ currentResendTime }}</span> секунд </small> <small class="circle-textfield__get-code ivi-button__secondary-text circle-textfield__get-code_button"> сейчас </small> </div> {% if smsLeft|default(false) and not currentResendTime %} <div class="circle-textfield__info-message circle-textfield__info-message_margin circle-textfield__info-message_font-style"> осталось <span class="circle-textfield__iteration-count">{{ smsLeft }}</span> сообщен{{ declension.getEnding(smsLeft, ["ие", "ия", "ий"]) }} с кодом </div> {% endif %} </div> <div class="circle-textfield_start-position circle-textfield__get-code_error"> <div class="circle-textfield__get-code-message"> Израсходован дневной лимит SMS-сообщений </div> </div> </div> </div> </form> </div> </div></div>',e)}var a=i(2);t.default=n},function(e,t,i){function n(e){return a.default.render('<div class="auth-registration-block-success modal-view_start {% if isLastStep %}modal-view_finish {% elseif isSecondStep %}modal-view_end {% endif %}js-success-block"> <div class="auth-registration-block-success__grid-container"> <div class="auth-registration-block-success__container auth-registration-block-success__grid-container-inner"> <div class="user-badge user-badge_depicts-not-authorized"> <div class="user-badge__icon"></div> <div class="user-badge__information-type"> {{ formattedPhone }} </div> </div> <h3 class="fullscreen-popup__title"> Вы зарегистрировались на&nbsp;ivi <span class="fullscreen-popup__title-mark"> Теперь вы сможете использовать этот номер телефона для входа на любых устройствах, где есть приложение ivi </span> </h3> <div class="platform-icons"> <ul class="platform-icons__list"> <li class="platform-icons__item"> <div class="platform-icons__icon platform-icons__icon-ios"></div> </li> <li class="platform-icons__item"> <div class="platform-icons__icon platform-icons__icon-android"></div> </li> <li class="platform-icons__item"> <div class="platform-icons__icon platform-icons__icon-windows"></div> </li> <li class="platform-icons__item"> <div class="platform-icons__icon platform-icons__icon-smart"></div> </li> </ul> </div> <div class="auth-registration-block-success__button-wrapper js-modal-close"> <button class="auth-registration-block-success__button ivi-button huge">Найти своё кино</button> </div> </div> </div></div>',e)}var a=i(2);t.default=n},function(e,t,i){function n(e){return a.default.render('<div class="auth-password-recovery-block modal-view_start{% if isLastStep %} modal-view_finish{% elseif isSecondStep %} modal-view_end{% endif %} js-recovery-password-block"> <div class="auth-password-recovery-block__grid-container"> <div class="auth-password-recovery-block__container auth-password-recovery-block__grid-container-inner"> <div class="user-badge user-badge_full-width user-badge_depicts-not-authorized"> <div class="user-badge__icon"></div> <div class="user-badge__information-type"> {{ email }} </div> </div> <h3 class="fullscreen-popup__title"> Восстановление пароля <span class="fullscreen-popup__title-mark">{% if code %}{{ userMessage }}{% else %}На указанный email отправлено письмо с инструкцией о восстановлении{% endif %}</span> </h3> <div class="auth-password-recovery-block__button-wrapper"> <button class="link-not-valid__button ivi-button huge js-recovery-password-success-button">Ок</button> </div> </div> </div></div>',e)}var a=i(2);t.default=n},function(e,t,i){function n(e){return a.default.render('<div class="auth-link-not-valid modal-view_start modal-view_finish"> <div class="auth-link-not-valid__grid-container"> <div class="auth-link-not-valid__container auth-link-not-valid__grid-container-inner"> <div class="user-badge user-badge_full-width user-badge_depicts-not-authorized"> <div class="user-badge__icon"></div> <div class="user-badge__information-type"> </div> </div> <h3 class="fullscreen-popup__title"> Ссылка недействительна <span class="fullscreen-popup__title-mark">Не удалось сбросить пароль, попробуйте запросить восстановление ещё раз</span> </h3> <div class="auth-link-not-valid__button-wrapper"> <button class="auth-link-not-valid__button ivi-button large js-recovery-password-repeat">Восстановить пароль</button> </div> </div> </div></div>',e)}var a=i(2);t.default=n},function(e,t,i){function n(e){return a.default.render('<div class="oauth-confirm-block modal-view modal-view_start {% if isFirstStep|default(false) %}modal-view_end {% else %}modal-view_finish {% endif %}"> <div class="oauth-confirm-block__grid-container"> <div class="oauth-confirm-block__container oauth-confirm-block__grid-container-inner"> <div class="user-badge user-badge_full-width user-badge_depicts-not-authorized"> <div class="user-badge__icon"></div> <div class="user-badge__information-type"> {% if oauthUserToken|default(false) %}{{ oauthUserToken }}{% endif %} </div> </div> <h3 class="fullscreen-popup__title"> Разрешите использовать <br> учётную запись&nbsp;ivi <span class="fullscreen-popup__title-mark">{% if oauth2ClientName %}Приложение &laquo;{{ oauth2ClientName }}&raquo;{% else %}Это приложение{% endif %} получит доступ к учётной записи ivi</span> </h3> <div class="oauth-confirm-block__info"> <div class="icon-list"> <ul class="icon-list__list"> <li class="icon-list__item">Имя, email, номер телефона, дата рождения, дата регистрации, аватар</li> <li class="icon-list__item">Список фильмов и сериалов, добавленных в раздел &laquo;Смотреть позже&raquo;</li> <li class="icon-list__item">Список купленных фильмов и сериалов</li> </ul> </div> <div class="oauth-confirm-block__info-button-wrapper"> <button class="oauth-confirm-block__button ivi-button large js-oauth2-access">Разрешить</button> <button class="oauth-confirm-block__button ivi-button large outline js-oauth2-select">Выбрать другой аккаунт</button> </div> </div> </div> </div></div>',e)}var a=i(2);t.default=n},function(e,t,i){function n(e){return a.default.render('{% set userToken = "" %}{% if oauthUserToken|default(false) %} {% set userToken = oauthUserToken %}{% elseif formattedPhone|default(false) %} {% set userToken = formattedPhone %}{% elseif email|default(false) %} {% set userToken = email %}{% endif %}<div class="user-authorization-code-start modal-view modal-view_start {% if isLoginByCodeStep|default(false) %}modal-view_finish {% endif %}js-login-by-code-block"> <div class="user-authorization-code-start__grid-container"> <div class="user-authorization-code-start__container user-authorization-code-start_grid-container-inner"> <div class="user-authorization-code-start__top-lane"> <span class="user-badge user-badge_depicts-authorized-user medium"> <span class="user-badge__icon"></span> </span> <h3 class="fullscreen-popup__title user-authorization-code-start__title"> Вход на Smart TV <span class="fullscreen-popup__title-mark user-authorization-code-start__title-mark">{{ userToken }}</span> </h3> </div> <div class="circle-textfield {% if isLoginCodeChecking|default(false) %}circle-textfield_loading {% endif %}circle-textfield__get-code-sms-info_show user-authorization-code-start__circle-textfield"> <div class="circle-textfield__field user-authorization-code-start__field user-authorization-code-start__field"> <input id="login-code" class="js-ivi-textfield__input js-login-code{% if disableLoginByCode|default(false) %} disabled{% endif %}" {% if disableLoginByCode|default(false) %} disabled="disabled"{% endif %} maxlength="6" autocomplete="off" type="text" value="{{ loginCode|default("") }}"> <label for="login-code"> <div class="circle-textfield__wrapper"> <ul class="circle-textfield__list"> {% set hasCursor = disableLoginByCode|default(false) %} {% for index in 0..LOGIN_CODE_MAX_LENGTH - 1 %} {% if visibleLoginCode|default(false) and visibleLoginCode[index] %} <li class="circle-textfield__item circle-textfield__item_has-number">{{ visibleLoginCode[index] }}</li> {% else %} <li class="circle-textfield__item {% if not hasCursor %} circle-textfield__item_cursor-position{% endif %}"></li> {% set hasCursor = true %} {% endif %} {% endfor %} </ul> </div> </label> </div> <div class="circle-textfield__information-content"> {% if code|default(false) %} <div class="circle-textfield__content circle-textfield__content_visible circle-textfield__content_warning"> {{ userMessage|default("") }} </div> {% else %} <div class="circle-textfield__content circle-textfield__content_visible"> Введите код, указанный на экране приложения ivi для Smart TV, вход в профиль произойдёт автоматически </div> {% endif %} </div> </div> </div> <div class="user-authorization-code-start__help-information"> <div class="user-authorization-code-start__help-information-image"></div> <p class="user-authorization-code-start__help-information-content"> Откройте приложение ivi на Smart TV и выберите &laquo;Вход по коду&raquo; на экране авторизации </p> </div> </div></div>',e)}var a=i(2);t.default=n},function(e,t,i){function n(e){return a.default.render('<div class="user-authorization-code-success modal-view modal-view_start {% if isLoginByCodeSuccessStep|default(false) %}modal-view_finish {% endif %}js-login-by-code-success-block"> <div class="user-authorization-code-success__grid-container"> <div class="user-authorization-code-success__container user-authorization-code-success_grid-container-inner"> <div class="user-authorization-code-success__top-lane"> <span class="user-badge user-badge_depicts-phone medium"> <span class="user-badge__icon"></span> </span> <h3 class="fullscreen-popup__title user-authorization-code-success__title"> Вы успешно вошли в ivi на Smart TV {{ device|escape }} <span class="fullscreen-popup__title-mark user-authorization-code-success__title-mark">Смотрите любимые фильмы и сериалы теперь в приложении ivi для Smart TV</span> </h3> <div class="ivi-button large user-authorization-code-success__button js-login-by-code-another-device">Войти на другом устройстве</div> </div> </div> </div></div>',e)}var a=i(2);t.default=n},function(e,t,i){var n=i(8),a=i(16),s=i(3),o=i(4),r=i(385),l=i(386),d=i(387);t.default=a.default.extend({EMAIL_NOTIFICATIONS_MESSAGE_CATEGORY_ID:1,EMAIL_NOTIFICATIONS_DELIVERY_CATEGORY_IDS:[1],fullAnimation:!0,renderAnimationDuration:300,closeAnimationDuration:300,openEvent:"auth:registrationCompleted",template:r.default,wrapper:a.default.prototype.wrapper+"-auth",events:{"click .js-bonus-subscription-link":"trackRedirectToMyIvi"},beforeRender:function(){this.eventParams&&!this.eventParams.error&&(this.eventParams.user_popup?(this.template=l.default,s.default.rewriteSuperProperties({page:"gift_activated_mot"}),s.default.track("page_view")):this.eventParams.bind_email&&(this.template=d.default,s.default.rewriteSuperProperties({page:"success_add_mail"})))},serializeData:function(){var e;return n.default.hasSubscription()&&(e=n.default.getSubscription()),{email:this.model.getEmail(),error:!(!this.eventParams||!this.eventParams.error),confirmed:this.model.isEmailConfirmed(),subscription:e}},trackRedirectToMyIvi:function(e){return s.default.rewriteSuperProperties({page:"gift_activated_mot"}),s.default.track("my_ivi_click"),o.default.redirect(e.currentTarget.href),!1}})},function(e,t,i){function n(e){return a.default.render('<div class="fullscreen-popup fullscreen-popup_has-close-view-button" id="end-screens"> <a class="fullscreen-popup__close-view-button js-modal-close" href="#" title="Нажмите, чтобы закрыть форму"> Закрыть окно </a> <div class="fullscreen-popup__overlay"> <span></span> <span></span> <span></span> </div> {% if error|default(false) %} <div class="auth-link-not-valid modal-view modal-view_start modal-view_finish"> <div class="auth-link-not-valid__grid-container"> <div class="auth-link-not-valid__container auth-link-not-valid__grid-container-inner"> <span class="user-badge user-badge_full-width user-badge_depicts-not-authorized "> <span class="user-badge__icon"> </span> <span class="user-badge__information-type">{{ email }}</span> </span> <h3 class="fullscreen-popup__title"> Ссылка недействительна <span class="fullscreen-popup__title-mark">Вы перешли по недействительной ссылке</span> </h3> <div class="auth-link-not-valid__button-wrapper"> <button class="auth-link-not-valid__button ivi-button large js-modal-close">OK</button> </div> </div> </div> </div> {% else %} <div class="auth-registration-block-success modal-view_start modal-view_finish"> <div class="auth-registration-block-success__grid-container"> <div class="auth-registration-block-success__container auth-registration-block-success__grid-container-inner"> <div class="user-badge user-badge_full-width user-badge_depicts-not-authorized"> <div class="user-badge__icon"></div> <div class="user-badge__information-type"> {{ email }} </div> </div> <h3 class="fullscreen-popup__title"> Вы зарегистрировались&nbsp;на&nbsp;ivi <span class="fullscreen-popup__title-mark">Теперь вы сможете использовать этот email для входа на любых устройствах, где есть приложение ivi</span> </h3> <div class="platform-icons"> <ul class="platform-icons__list"> <li class="platform-icons__item"> <div class="platform-icons__icon platform-icons__icon-ios"></div> </li> <li class="platform-icons__item"> <div class="platform-icons__icon platform-icons__icon-android"></div> </li> <li class="platform-icons__item"> <div class="platform-icons__icon platform-icons__icon-windows"></div> </li> <li class="platform-icons__item"> <div class="platform-icons__icon platform-icons__icon-smart"></div> </li> </ul> </div> <div class="auth-registration-block-success__button-wrapper"> <button class="auth-registration-block-success__button ivi-button huge js-modal-close">Найти своё кино</button> </div> </div> </div> </div> {% endif %}</div>',e)}var a=i(2);t.default=n},function(e,t,i){function n(e){return a.default.render('<div class="fullscreen-popup fullscreen-popup_active fullscreen-popup_has-close-view-button"> <div class="fullscreen-popup__overlay"> <span></span> <span></span> <span></span> </div> <div class="fullscreen-popup__scroll-wrapper"> <div class="fullscreen-popup__wrapper"> <a class="fullscreen-popup__close-view-button js-modal-close" href="#" title="Нажмите, чтобы закрыть форму"> Закрыть окно </a> <div class="motivation motivation-success"> <div class="motivation__container motivation__container_centered"> <div class="motivation__container-inner motivation__container-inner_centered"> <div class="motivation__content"> <div class="motivation__badge"> <span class="user-badge user-badge_full-width user-badge_depicts-authorized-user"> <span class="user-badge__icon"></span> <span class="user-badge__information-type">{{ email }}</span> </span> </div> <h2 class="motivation__title motivation__title_centered motivation__title_small">Подписка успешно подключена</h2> <div class="motivation__main motivation__main_centered"> <p class="motivation__info"> Подписка активна до&nbsp;{{ internationalExpansion.getLocalDateTime(subscription.getSubscriptionExpireDate())|date("d MMMM") }}, смотрите фильмы и&nbsp;сериалы без&nbsp;рекламы на&nbsp;<a href="{{ internationalExpansion.getRightHostOrigin() }}/devices" class="ivi-link ivi-link_chaf">любых устройствах,</a> где&nbsp;есть ivi.&nbsp;Для входа используйте ваш email. </p> <div class="motivation__button-wrapper"> <a class="motivation__ivi-button ivi-button large js-bonus-subscription-link" href="{{ internationalExpansion.getRightHostOrigin() }}/profile#subscription">Управление подпиской</a> </div> </div> </div> </div> </div> </div> </div> </div></div>',e)}var a=i(2);t.default=n},function(e,t,i){function n(e){return a.default.render('<div class="fullscreen-popup fullscreen-popup_active fullscreen-popup_has-close-view-button"> <div class="fullscreen-popup__overlay"> <span></span> <span></span> <span></span> </div> <div class="fullscreen-popup__scroll-wrapper"> <div class="fullscreen-popup__wrapper"> <a class="fullscreen-popup__close-view-button js-modal-close" href="#" title="Нажмите, чтобы закрыть форму"> Закрыть окно </a> <div class="add-contacts modal-view modal-view_start"> <div class="add-contacts__container"> <div class="add-contacts__container-inner"> <div class="add-contacts__content"> <div class="add-contacts__badge add-contacts__badge_status add-contacts__badge_status_success"></div> <div class="add-contacts__title">Email успешно привязан</div> <div class="add-contacts__value">{{ email }}</div> <div class="add-contacts__status"> <p class="add-contacts__additional-info">Теперь вы можете использовать email для взаимодействия с сервисом и для входа на любой платформе</p> <a class="add-contacts__ivi-button ivi-button large" href="{{ internationalExpansion.getRightHostOrigin() }}/profile">Вернуться в профиль</a> </div> </div> </div> </div> </div> </div> </div></div>',e)}var a=i(2);t.default=n},function(e,t,i){function n(e){return a.default.render('<div class="ivi-modal-wrapper-content simple-basic"> <h1 class="ivi-modal-title">Ошибка</h1> <div class="ivi-modal-content"> {% if userCanAuthenticate %} <p>Время действия сессии истекло. Вы будете перемещены на главную страницу</p> {% else %} <p>Время действия сессии истекло. Страница будет обновлена.</p> {% endif %} <div class="button-wrapper"> <span class="ivi-button large js-modal-close">Закрыть</span> </div> </div> <span class="ivi-modal-close js-modal-close">Закрыть</span></div>',e)}var a=i(2);t.default=n},function(e,t,i){var n=i(14);t.default=n.default.extend({uri:"/user/favourites/v5/count",buildRequestParams:function(e){var t=n.default.prototype.buildRequestParams.call(this,e);return t.data||(t.data={}),t.data.withunavailable=0,t}})},function(e,t,i){function n(e){return a.default.render('{% set host = "" %}{% if external|default(false) %} {% set host = internationalExpansion.getRightHostOrigin() %}{% endif %}<li class="top-menu__profile-list-item"><a class="top-menu__profile-list-link" href="{{ host }}/profile">Мой ivi</a></li><li class="top-menu__profile-list-item"><a class="top-menu__profile-list-link" href="{{ host }}/profile#favorites">Смотреть позже</a></li><li class="top-menu__profile-list-item"><a class="top-menu__profile-list-link" href="{{ host }}/profile#watched">История просмотров</a></li><li class="top-menu__profile-list-item"><a class="top-menu__profile-list-link" href="{{ host }}/profile#purchases">Мои покупки</a></li><li class="top-menu__profile-list-item"><a class="top-menu__profile-list-link" href="{{ host }}/profile#subscription">Управление подпиской</a></li>{% if showLoginByCode %}<li class="top-menu__profile-list-item"><a class="top-menu__profile-list-link" href="{{ host }}/code">Вход по коду</a></li>{% endif %}{% if showSubscriptionSpasiboEnterPoint|default(false) %} <li class="top-menu__profile-list-item"> <a class="top-menu__profile-list-link" href="{{ host }}/spasibosberbank">Подписка за бонусы СПАСИБО <img class="top-profile__list-logo top-profile__list-logo_spasibo" src="{{ app.config.static.host }}/images/landing-iviplus/_base/partner-logo_sber-thnx.png" alt=""></a> </li>{% endif %}{% if user.isAuthenticated()|default(false) %} <li class="top-menu__profile-list-item"><a class="top-menu__profile-list-link js-logout-button" href="#">Выйти</a></li>{% else %} <li class="top-menu__profile-list-item"><a href="{{ currentUrl|default("") }}#auth" class="top-menu__profile-list-link js-login-btn">Войти</a></li>{% endif %}',e)}var a=i(2);t.default=n},function(e,t,i){function n(e){return a.default.render('{% set host = "" %}{% if external|default(false) %} {% set host = internationalExpansion.getRightHostOrigin() %}{% endif %}{% set hasName = user.getName()|length > 0 %}{% set hasEmail = user.getEmail()|length > 0 %}{% set hasPhone = user.getMsisdn()|length > 0 %}{# Флаг наличия второй строки в выпадашке в блоке имени пользователя #}{% set hasSecondTextLine = false %}{% if user.isAuthenticated() %} {% if hasName %} {% set cssClass = "name" %} {% elseif hasEmail %} {% set cssClass = "email" %} {% else %} {% set cssClass = "phone" %} {% endif %}{% else %} {% set cssClass = "not-authorized" %}{% endif %}<div class="top-profile ivi-top__profile js-auth-info"> <span class="user-badge user-badge_depicts-{{ cssClass }} small top-profile__badge"> <a href="{{ host }}/profile" class="user-badge__icon js-profile-link user-badge__icon_link {% if isMobile %} js-feedback-click-animation{% endif %}"> {% if user.isAuthenticated() %} {% if hasName %} {{ user.getName()|slice(0, 1)|upper }} {% elseif hasEmail %} {{ user.getEmail()|slice(0, 1)|upper }} {% endif %} {% endif %} </a> </span> <div class="top-profile__dropdown top-profile__dropdown_has-button"> <div class="top-profile__dropdown-inner"> <div class="top-profile__header"> {% if user.isAuthenticated() %} <a class="top-profile__header-link" href="{{ host }}/profile"> <span class="user-badge user-badge_depicts-{{ cssClass }} small top-profile__header-badge"> <span class="user-badge__icon user-badge__icon_link"> {% if hasName %} {{ user.getName()|slice(0, 1)|upper }} {% elseif hasEmail %} {{ user.getEmail()|slice(0, 1)|upper }} {% endif %} </span> </span> <span class="top-profile__info"> {% if hasName %} <span class="top-profile__info-primary-text">{{ user.getName() }}</span> {% if not user.isEmailConfirmed() %} {% set hasSecondTextLine = true %} <span class="top-profile__info-secondary-text top-profile__info-secondary-text_warning">email не подтверждён</span> {% elseif hasEmail %} {% set hasSecondTextLine = true %} <span class="top-profile__info-secondary-text">{{ user.getEmail() }}</span> {% endif %} {% elseif hasEmail %} <span class="top-profile__info-primary-text">{{ user.getEmail() }}</span> {% if not user.isEmailConfirmed() %} {% set hasSecondTextLine = true %} <span class="top-profile__info-secondary-text top-profile__info-secondary-text_warning">email не подтверждён</span> {% endif %} {% elseif hasPhone %} <span class="top-profile__info-primary-text">{{ user.getFormattedPhoneNumber() }}</span> {% endif %} </span> </a> <button class="top-profile__logout{% if not hasSecondTextLine %} top-profile__logout_centered{% endif %} js-logout-button">Выйти</button> {% else %} <a class="top-profile__header-button ivi-button medium pale js-login-btn" href="#auth">Войти или зарегистрироваться</a> {% endif %} </div> <div class="top-profile__menu"> <ul class="top-profile__list"> <li class="top-profile__list-item"> <a href="{{ host }}/profile" class="top-profile__list-link">Профиль</a> {% if not user.isAuthenticated() %} <span class="top-profile__list-item-note">для зарегистрированных</span> {% endif %} </li> <li class="top-profile__list-item top-profile__list-item_separated top-profile__list-item_highlight top-profile__list-item_ivi"> {% set subscriptionPurchase = user.getSubscription() %} {% if subscriptionPurchase.hasSubscription() %} <a href="{{ host }}/profile#subscription" class="top-profile__list-link">Управление подпиской</a> <span class="top-profile__list-item-note{% if not subscriptionPurchase.isRenewEnabled() %} top-profile__list-item-note_warning{% endif %}"> {% if subscriptionPurchase.isRenewEnabled() %} подписка активна до {{ internationalExpansion.getLocalDateTime(subscriptionPurchase.getSubscriptionExpireDate())|date("d.m.Y") }} {% else %} подписка истекает {{ internationalExpansion.getLocalDateTime(subscriptionPurchase.getSubscriptionExpireDate())|date("d.m.Y") }} {% endif %} </span> {% else %} <a href="#" id="add-subscription" class="top-profile__list-link top-profile__list-link_highlight">Подключить подписку</a> {% endif %} </li> <li class="top-profile__list-item"> {% if user.isIdentified() %} <a href="{{ host }}/profile#cards" class="top-profile__list-link">Мои карты</a> {% else %} <span class="top-profile__list-link top-profile__list-link_disabled">Мои карты</span> {% endif %} </li> <li class="top-profile__list-item top-profile__list-item_separated"> <a href="{{ host }}/profile#purchases" class="top-profile__list-link">Покупки</a> </li> <li class="top-profile__list-item"> <a href="{{ host }}/profile#favorites" class="top-profile__list-link"> Смотреть позже <small id="user-menu-favourites-count" {% if not user.getFavCount() %} style="display: none" {% endif %} > (<span>{{ user.getFavCount() }}</span>) </small> </a> </li> <li class="top-profile__list-item"> <a href="{{ host }}/profile#watched" class="top-profile__list-link">История просмотров</a> </li> {% if showLoginByCode %} <li class="top-profile__list-item top-profile__list-item_separated"> <a href="{{ host }}/code" class="top-profile__list-link js-login-by-code-link">Вход по коду</a> </li> {% endif %} </ul> <ul class="top-profile__list {% if showSubscriptionSpasiboEnterPoint|default(false) %}top-profile__list_sberbank{% else %}top-profile__list_highlighted{% endif %}"> <li class="top-profile__list-item"> <a href="{{ host }}/cert" class="top-profile__list-link">Активировать сертификат</a> {% if not user.isAuthenticated() %} <span class="top-profile__list-item-note">для зарегистрированных</span> {% endif %} </li> {% if showSubscriptionSpasiboEnterPoint|default(false) %} <li class="top-profile__list-item"> <a class="top-profile__list-link" href="{{ host }}/spasibosberbank">Подписка за бонусы СПАСИБО <img class="top-profile__list-logo top-profile__list-logo_spasibo" src="{{ app.config.static.host }}/images/landing-iviplus/_base/partner-logo_sber-thnx.png" alt=""></a> </li> {% endif %} </ul> </div> </div> </div></div>',e)}var a=i(2);t.default=n},function(e,t,i){var n=i(1),a=i(16),s=i(393),o=i(3),r=i(39),l=i(4);t.default=a.default.extend({events:{"click .js-add-funds":"addRedirectParam","input input#totalAmount":"checkAmount"},template:s.default,openEvent:"billing:addFunds",regionEnabled:!0,mobileModal:!0,menuFromParamValue:"drop_down",profileFromParamValue:"profile",startFromParamValue:"main",open:function(){a.default.prototype.open.apply(this,arguments),this.$fundButton=n(arguments[0])},addRedirectParam:function(){var e=parseInt(n("#totalAmount").val());return o.default.track("fund_modal_submit",{from:this.getFromParam(),amount:e}),l.default.redirect(r.default.getSchemaWithHost("https","www."+r.default.getRightHost())+"/buy/fund?&amount="+e+"&redirect_url="+encodeURIComponent(l.default.getLocation().pathname+l.default.getLocation().hash)+"&from="+this.getFromParam()),!1},checkAmount:function(e){var t=e.currentTarget.value;/^\d+$/.test(t)&&parseInt(t,10)?n(".js-add-funds").removeAttr("disabled"):n(".js-add-funds").attr("disabled","disabled")},getFromParam:function(){return this.$fundButton.length?this.$fundButton.data("from"):""},onShow:function(){o.default.track("add_funds",{from:this.getFromParam()})},beforeCancel:function(){this.undelegateModalEvents(),o.default.track("fund_modal_close",{from:this.getFromParam()})}})},function(e,t,i){function n(e){return a.default.render('<div class="ivi-modal-wrapper-content add-funds"> <h1 class="ivi-modal-title">Пополнение счета</h1> <form class="ivi-modal-content"> <p>Укажите сумму, на которую хотите пополнить личный счёт:</p> <div class="ivi-input"> <input id="totalAmount" type="text" value="500" maxlength="6"> <span>{{ internationalExpansion.getFormattedCurrency() }}</span> </div> <div class="button-wrapper"> <button class="ivi-button large js-add-funds">Пополнить</button> </div> </form> <span class="ivi-modal-close js-modal-close">Закрыть</span></div>',e)}var a=i(2);t.default=n},function(e,t,i){var n=i(0),a=i(7),s=i(11),o=i(30);t.default=n.View.extend({el:"body",events:{"click .js-add-funds-modal":"showFundModal"},initialize:function(){this.listenTo(a.default,"auth:userProfileBlockIsReady",this.delegateEvents),this.listenTo(o.default,"profile:personalSectionIsReady",this.delegateEvents),this.listenTo(a.default,"user:login",this.showFundButton),this.listenTo(a.default,"user:logout",this.hideFundButton)},showFundModal:function(e){return s.default.trigger("billing:addFunds",e.currentTarget),!1},showFundButton:function(){this.$(".js-add-funds-modal").show()},hideFundButton:function(){this.$(".js-add-funds-modal").hide()}})},function(e,t,i){var n=i(16),a=i(396),s=i(39),o=i(8);t.default=n.default.extend({template:a.default,openEvent:"billing:fundSuccess",regionEnabled:!0,serializeData:function(){var e=o.default.getBalance();return{balance:s.default.getPriceWithCurrency(e," ",e)}}})},function(e,t,i){function n(e){return a.default.render('<div class="ivi-modal-wrapper-content add-funds success"> <h1 class="ivi-modal-title">Пополнение счета</h1> <div class="ivi-modal-content"> <p><span>Платеж прошёл успешно!</span>Теперь на вашем счету {{ balance }}. </p> <div class="button-wrapper"> <a href="#" class="ivi-button large js-modal-close">ОК</a> </div> </div> <span class="ivi-modal-close js-modal-close">Закрыть</span></div>',e)}var a=i(2);t.default=n},function(e,t,i){var n=i(1),a=i(0);t.default=a.View.extend({el:".old-browser-wrapper",events:{"click a.close-link":"closeOverlay"},closeOverlay:function(){n(".old-browser-wrapper").remove()}})},function(e,t,i){i(149);var n=i(1),a=i(0),s=i(42);t.default=a.View.extend({el:"#waypoint",minimumLoadedPostersBlock:1,wayPoint:null,initialize:function(){var e=this;this.listenTo(s.default,"loader.point:disable",this.disable),this.listenTo(s.default,"loader.point:enable",this.enable);var t=this.$el.waypoint({enabled:this.$el.is(":visible"),handler:function(t){"down"===t&&(n(this.element).removeAttr("id"),n(this.element).removeClass(e.className),this.destroy(),s.default.trigger("loader.point:reached",this.element.id))},offset:function(){if("waypoint"===e.$el.attr("id")){var t=0;return n(".posters-block").not(".hidden").each(function(){n.trim(n(this).html()).length>0&&t++}),t<=e.minimumLoadedPostersBlock?this.adapter.offset().top:0}return 0}});t.length&&(this.wayPoint=t[0])},disable:function(){this.wayPoint&&this.wayPoint.disable()},enable:function(){this.wayPoint&&this.wayPoint.enable()}})},function(e,t,i){var n=i(0);t.default=n.Model.extend({getTitle:function(){return this.get("title")}})},function(e,t,i){var n=i(0),a=i(401);t.default=n.Collection.extend({model:a.default})},function(e,t,i){var n=i(0);t.default=n.Model.extend({getName:function(){return this.get("name")}})},function(e,t,i){function n(e){return a.default.render('{% set video = compilation %}<div class="link-wrapper"> <a href="{{ video.getBaseWatchLink() }}" class="js-description-link {% if video.isForAdult() %}js-adult{% endif %}">Описание</a> {% if video.getTrailerList()|length %} <a href="{{ video.getBaseWatchLink() }}/trailers#play" class="{% if video.isForAdult() %}js-adult{% endif %}">Трейлер</a> {% endif %} {% if not video.isFake() %} <span class="action-link-wrapper"> <a class="action-link js-favourite-link" data-type="compilation" data-id="{{ video.getId() }}">Смотреть позже</a> </span> {% endif %}</div>{% if isWorld and not video.isFake() %} {% if video.isSvod() and not hasSubscription %} <div class="subscription-wrapper js-popup-subscription-link"> <a href="#"><span>Оформить подписку</span></a> </div> {% endif %}{% endif %}<div class="properties"> {% if video.getHdAvailable() %}<span class="feature" title="Видео доступно в HD-качестве">HD</span>{% endif %} {% if video.getRestrict() is not null %} <span class="feature" content="{{ video.getRestrict() }}+" itemprop="contentRating">{{ video.getRestrict() }}+</span> {% endif %} {% if video.getYearList() and video.getYearList()|length > 0 %} <span itemprop="datePublished" content="{{ min(video.getYearList()) }}">{{ min(video.getYearList()) }}{% if min(video.getYearList()) != max(video.getYearList()) %} - {{ max(video.getYearList()) }}{% endif %}</span> {% endif %} {% if video.getCountryId() %} <span itemprop="productionCountry" content="{{ countryList[video.getCountryId()].code }}"> {{ countryList[video.getCountryId()].title }} </span> {% endif %} <span> {{ singleGenre.getTitle() }} </span></div><dl class="coupled persons compact"> {% if video.getIviRating() or video.getKpRating() or video.getImdbRating() %} <dt>Рейтинги</dt> <dd> <dl class="numeric-rating"> {% if video.getIviRating() %} <dt>ivi</dt> <dd itemprop="aggregateRating" itemscope itemtype="https://schema.org/AggregateRating"> <span itemprop="ratingValue" content="{{ video.getIviRating()|number_format(1, ".") }}"> {{ video.getIviRating()|number_format(1, ",") }} </span> </dd> {% endif %} {% if video.getKpRating() %} <dt>КиноПоиск</dt> <dd>{{ video.getKpRating()|number_format(1, ",") }}</dd> {% endif %} {% if video.getImdbRating() %}<dt>IMDb</dt> <dd>{{ video.getImdbRating()|number_format(1, ",") }}</dd>{% endif %} </dl> </dd> {% endif %} {% if directors|length %} <dt>Режиссеры</dt> <dd itemprop="director" itemscope itemtype="https://schema.org/Person"> <div class="wrapper-names"> {% for person in directors|slice(0, 3) %} <span itemprop="name">{{ person.getName() }}</span>{% if loop.index != directors|length and loop.index != 3 %}, {% endif %} {% endfor %} </div> </dd> {% endif %} {% if actors|length %} <dt>В ролях</dt> <dd itemprop="actor" itemscope itemtype="https://schema.org/Person"> <div class="wrapper-names"> {% for person in actors|slice(0, 3) %} <span itemprop="name">{{ person.getName() }}</span>{% if loop.index != actors|length and loop.index != 3 %}, {% endif %} {% endfor %} </div> </dd> {% endif %}</dl><div class="story-text"> {% if video.getSynopsis() %} <p>{{ video.getSynopsis() }}</p> {% else %} <p>{{ video.getDescription() }}</p> {% endif %}</div>',e)}var a=i(2);t.default=n},function(e,t,i){function n(e){return a.default.render('<div class="link-wrapper"> <a href="{{ video.getBaseWatchLink() }}/description" class="js-description-link{% if video.isForAdult() %} js-adult{% endif %}">Описание</a> {% if video.getTrailerList()|length %} <a href="{{ video.getBaseWatchLink() }}/trailers#play" class="{% if video.isForAdult() %}js-adult{% endif %}">Трейлер</a> {% endif %} {% if not video.isCompilation() and not video.isFake() %} <span class="action-link-wrapper"> <a class="action-link js-favourite-link" data-type="video" data-id="{{ video.getId() }}">Смотреть позже</a> </span> {% endif %}</div>{% if isWorld %} {% if video.isSvod() and not video.isFake() %} {% if not hasSubscription %} <div class="subscription-wrapper js-popup-subscription-link"> <a href="#"><span>Оформить подписку</span></a> </div> {% endif %} {% else %} {% if not video.isBought() %} {% if video.isFake() %} {% if video.isPreorderable() %} <div class="subscription-wrapper"> <a href="{{ video.getWatchLink() }}"><span>Предзаказ</span></a> </div> {% endif %} {% else %} <div class="subscription-wrapper"> <a href="{{ video.getWatchLink() }}"><span>Купить</span></a> </div> {% endif %} {% endif %} {% endif %}{% endif %}<div class="properties"> {% if video.getHdAvailable() %}<span class="feature" title="Видео доступно в HD-качестве">HD</span>{% endif %} {% if video.getRestrict() is not null %} <span class="feature" content="{{ video.getRestrict() }}+" itemprop="contentRating">{{ video.getRestrict() }}+</span> {% endif %} {% if video.getYear() %} <span itemprop="datePublished" content="{{ video.getYear() }}">{{ video.getYear() }}</span> {% endif %} {% if video.getCountryId() %} <span itemprop="productionCountry" content="{{ countryList[video.getCountryId()].code }}"> {{ countryList[video.getCountryId()].title }} </span> {% endif %} <span> {{ singleGenre.getTitle() }} </span> {% if video.getDurationMinutes() %} <time datetime="{{ video.getDurationPT() }}" itemprop="duration">{{ video.getDurationMinutes() }}&nbsp;мин.</time> {% endif %}</div><dl class="coupled persons compact"> {% if video.getIviRating() or video.getKpRating() or video.getImdbRating() %} <dt>Рейтинги</dt> <dd> <dl class="numeric-rating"> {% if video.getIviRating() %} <dt>ivi</dt> <dd itemprop="aggregateRating" itemscope itemtype="https://schema.org/AggregateRating"> <span itemprop="ratingValue" content="{{ video.getIviRating()|number_format(1, ".") }}"> {{ video.getIviRating()|number_format(1, ",") }} </span> </dd> {% endif %} {% if video.getKpRating() %} <dt>КиноПоиск</dt> <dd>{{ video.getKpRating()|number_format(1, ",") }}</dd> {% endif %} {% if video.getImdbRating() %}<dt>IMDb</dt> <dd>{{ video.getImdbRating()|number_format(1, ",") }}</dd>{% endif %} </dl> </dd> {% endif %} {% if directors|length %} <dt>Режиссеры</dt> <dd itemprop="director" itemscope itemtype="https://schema.org/Person"> <div class="wrapper-names"> {% for person in directors|slice(0, 3) %} <span itemprop="name">{{ person.getName() }}</span>{% if loop.index != directors|length and loop.index != 3 %}, {% endif %} {% endfor %} </div> </dd> {% endif %} {% if actors|length %} <dt>В ролях</dt> <dd itemprop="actor" itemscope itemtype="https://schema.org/Person"> <div class="wrapper-names"> {% for person in actors|slice(0, 3) %} <span itemprop="name">{{ person.getName() }}</span>{% if loop.index != actors|length and loop.index != 3 %}, {% endif %} {% endfor %} </div> </dd> {% endif %}</dl><div class="story-text"> {% if video.getSynopsis() %} <p>{{ video.getSynopsis() }}</p> {% else %} <p>{{ video.getDescription() }}</p> {% endif %}</div>',e)}var a=i(2);t.default=n},function(e,t,i){var n=i(1),a=i(0),s=i(110),o=i(4);t.default=a.View.extend({el:"body",events:{"click .js-erotic":"showAlert","click .js-adult":"showAlert"},showAlert:function(e){var t=n(e.target).closest("a"),i="_blank"===t.attr("target");if(!this.model.canWatchAdultContent())return n(e.target).closest(".js-favourite-button").length||(this.model.set("href",t.attr("href")),this.model.set("targetBlank",i),s.default.trigger("showEroticModal")),!1;window.ivi.adaptive.isMobileStyle&&setTimeout(function(){o.default.redirect(t.attr("href"))},100)}})},function(e,t,i){var n=i(1),a=i(0),s=i(26),o=i(3);t.default=a.View.extend({el:".js-favourite-link:visible",blockId:"",events:{click:"addFavourite"},initialize:function(){var e=this;this.listenTo(s.default,"favourite:have",function(t,i){i&&t.objectId===e.$el.data("id")&&t.type===e.$el.data("type")&&(e.$el.addClass("clicked"),e.stopListening(s.default,"favourite:have"))}),this.listenTo(s.default,"favourites:added",this.toggleFavouriteClass.bind(this,"added")),this.listenTo(s.default,"favourites:deleted",this.toggleFavouriteClass.bind(this,"deleted")),this.detectBlockId()},render:function(){s.default.trigger("favourite:check",{objectId:this.$el.data("id"),type:this.$el.data("type")})},addFavourite:function(){var e=this;this.$el.hasClass("clicked")?(s.default.trigger("favourite:delete",{objectId:this.$el.data("id"),type:this.$el.data("type"),blockId:this.blockId}),this.$el.removeClass("clicked"),this.$el.addClass("unclicked").delay(1e3).queue(function(){e.$el.removeClass("unclicked"),e.$el.dequeue()})):(s.default.trigger("favourite:add",{objectId:this.$el.data("id"),type:this.$el.data("type"),blockId:this.blockId}),this.$el.addClass("active"),this.$el.addClass("clicked"),this.$el.removeClass("unclicked"))},toggleFavouriteClass:function(e,t){n(".js-favourite-link").each(function(i,a){var s=n(a);parseInt(t.objectId,10)===parseInt(s.data("id"),10)&&t.type===s.data("type")&&("added"===e?(s.addClass("active"),s.addClass("clicked")):(s.removeClass("active"),s.removeClass("clicked")))})},detectBlockId:function(){this.$el.closest(".js-posters-favourites").length?this.blockId=o.default.getBlockIds().favouritesBlockId:this.$el.closest(".js-posters-similar").length?this.blockId=o.default.getBlockIds().favouritesSimilarBlockId:this.$el.closest(".js-related-block").length?this.blockId=o.default.getBlockIds().contentSimilarBlockId:this.$el.closest(".js-purchases-block").length?this.blockId=o.default.getBlockIds().profileShopBlockId:this.$el.closest(".js-favorites-block").length?this.blockId=o.default.getBlockIds().profileWantedBlockId:this.blockId=o.default.getBlockIds().collectionsBlockId}})},function(e,t,i){i(76);var n=i(1),a=i(0),s=i(5),o=i(7),r=i(44),l=i(10),d=i(150);t.default=a.View.extend({el:".js-carousel",animatingClassName:"animating",additionalPostersCount:3,defaultVisibleElementsCount:5,initialize:function(){window.ivi.adaptive.isMobile?(this.initMobileCarousel(),n(".js-carousel .viewport").on("scroll",this.handleMobileCarousel.bind(this)),this.listenTo(d.default,"gallery:init",this.additionalMobileCarousel)):(this.initCarousel(this.$el),this.listenTo(d.default,"gallery:init",this.initCarousel)),this.listenTo(o.default,"user:hasSubscription",this.clearAllPopupCache),this.listenTo(o.default,"user:hasNotSubscription",this.clearAllPopupCache),this.listenTo(o.default,"user:logout",this.clearAllPopupCache),this.listenTo(o.default,"autologin",this.sendMetrics)},initCarousel:function(e){var t=this;e.each(function(){var e=n(this),i=e.data("visible-elements-count")||t.defaultVisibleElementsCount;e.jcarousel({list:".gallery",wrap:"circular",animation:500,transitions:{transforms:!0,transforms3d:!0,easing:"ease"}}),e.keyup(function(t){switch(t.which){case 37:e.jcarousel("scroll","-="+i);break;case 39:e.jcarousel("scroll","+="+i)}}),e.children(".control.prev").jcarouselControl({carousel:e,target:"-="+String(i)}),e.children(".control.next").jcarouselControl({carousel:e,target:"+="+String(i)}),e.on("jcarousel:scroll",function(a,o,l){var d=o.visible(),u=d.slice(-1),c=n(u).nextAll("li"),p=l&&"+"===l[0]?c.slice(0,i):c.slice(-i);s.forEach(p,function(e){t.loadImage(n(e))}),r.default.viewList(e)}),e.on("jcarousel:animate",function(){e.addClass(t.animatingClassName)}),e.on("jcarousel:animateend",function(){e.removeClass(t.animatingClassName)})})},initMobileCarousel:function(){var e=this;n(".js-carousel").each(function(){var t=0;n(this).find("li").each(function(){if(t<e.additionalPostersCount){var i=n(this);void 0===i.find("img").attr("src")&&(e.loadImage(i),++t)}})})},additionalMobileCarousel:function(e){e.find(".viewport").on("scroll",this.handleMobileCarousel.bind(this))},handleMobileCarousel:function(e){var t=this,i=n(e.currentTarget).parent(),a=i.width(),s=!1,o=0;i.find("li").each(function(){var e=this.getBoundingClientRect().left,i=e>=0&&e<a;i&&(t.loadImage(n(this)),s=!0),s&&!i&&o<t.additionalPostersCount&&(t.loadImage(n(this)),++o)}),r.default.viewList(i)},loadImage:function(e){var t=e.find("img");void 0===t.attr("src")&&t.attr("src",t.data("src"))},clearAllPopupCache:function(){l.default.isWorld&&n(".popup-wrapper").html("")},sendMetrics:function(){var e=window.ivi.adaptive.isMobile?this.additionalPostersCount:this.defaultVisibleElementsCount;n(".js-criteo-gallery").each(function(t,i){var a=n(i),s=a.find("li").length,o=a.hasClass("js-carousel")||a.closest(".js-carousel").length>0;(s<=e||!o)&&r.default.viewList(a)})}})},function(e,t,i){var n=i(1),a=i(68),s=i(3),o=i(42);t.default=a.default.extend({el:".js-collection-header",events:{click:"collectionClick"},initialize:function(){n("body").hasClass("catalog")?this.setLocalBlockId("personal_catalog"):this.setLocalBlockId("collections"),this.listenToOnce(o.default,"start:firstCollection:rendered",this.firstCollectionRendered)},firstCollectionRendered:function(){n(".js-personal-recommendation .js-collection-header").on("click",this.collectionClick.bind(this))},collectionClick:function(e){var t=void 0!==e.originalEvent?e.originalEvent.target:null;if(t){var i=n(t),a=i.data("collection-id");a&&(a=a.toString(),s.default.setBlockId(s.default.getBlockIds().collectionsBlockId),this.trackCollectionAction("hydra.collection.open",i),s.default.setCollectionId(a))}}})},function(e,t,i){var n=i(1),a=i(68),s=i(3),o=i(42),r=i(20),l=i(4);t.default=a.default.extend({el:".js-collection-block",storageKey:"main_collections_clicked",events:{"click li > a":"contentClick","contextmenu li > a":"contentContextMenu","mouseup li > a":"contentMouseUp"},initialize:function(){n("body").hasClass("catalog")?this.setLocalBlockId("personal_catalog"):this.setLocalBlockId("collections"),this.listenToOnce(o.default,"start:firstCollection:rendered",this.firstCollectionRendered)},firstCollectionRendered:function(){n(".js-personal-recommendation .js-collection-block li > a").on("click",this.contentClick.bind(this))},contentMouseUp:function(e){3===e.which&&this.contentEventHandler(e)},contentContextMenu:function(e){this.contentEventHandler(e)},contentEventHandler:function(e,t){void 0===t&&(t=!1);var i=void 0!==e.originalEvent?e.originalEvent.target:null;if(i){var a=n(i).parents("ul[data-collection-id]"),o=n(i).parents("li[data-content-id]");if(a.length&&o.length){var d=o.find("a").attr("href").match(/\/watch\/[\w|\d|-]*/);if(l.default.isMainPage()&&d.length&&r.default.localStorage.setItem(this.storageKey,d[0]),!t)return;var u={},c=a.data("collection-id"),p=o.data("content-id");if(s.default.setBlockId(this.getLocalBlockId()),c&&(c=c.toString(),u.collection_id=c),p){p=p.toString(),u.poster_content_id=p;var f=!1,h=r.default.sessionStorage.getItem("collections-view");if(null!==h){h=h.split(";");for(var g=h.length,m=0;m<g;m++)if(h[m]===c){f=!0;break}}f||(this.storeHydraCollectionView(c),this.trackCollectionAction("hydra.collections.view",a)),this.trackCollectionContentAction("hydra.content.open",o)}Object.keys(u).length&&s.default.track("poster_click",u)}}},contentClick:function(e){this.contentEventHandler(e,!0)}})},function(e,t,i){var n=i(0),a=i(73),s=i(3);t.default=n.View.extend({initialize:function(){this.listenTo(a.default,"user:grade",this.grootRateContent)},grootRateContent:function(e,t,i){s.default.rewriteSuperProperties({block_id:"content_description"}),s.default.track("content_evaluate",{rate:i})}})},function(e,t,i){var n=i(0),a=i(6),s=i(26),o=i(3),r=i(4);t.default=n.View.extend({initialize:function(){this.listenTo(s.default,"favourites:deleted",this.onModelRemoved),this.listenTo(s.default,"favourites:added",this.onModelAdded)},onModelAdded:function(e){this.track("wantsee_add",e)},onModelRemoved:function(e){this.track("wantsee_delete",e)},track:function(e,t){if(!a.default.prototype.isEmbed()&&-1===r.default.getLocation().href.indexOf("/player/")){var i={};if(o.default.rewriteSuperProperties({block_id:t.blockId}),"compilation"===t.type)i.compilation_id=t.objectId,o.default.track(e,i);else{var n=o.default.getSuperProperty("content_id");i.content_id=t.objectId,o.default.rewriteSuperProperties(i),o.default.track(e),i.content_id=n,o.default.rewriteSuperProperties(i)}}}})},function(e,t,i){var n=i(0),a=i(3);t.default=n.View.extend({el:".js-watch-inner-nav",events:{"click a":"watchClick"},watchClick:function(e){void 0!==e.originalEvent&&a.default.track("click_film_menu",{source:"m"})}})},function(e,t,i){var n=i(0),a=i(3);t.default=n.View.extend({el:".more-wrapper",events:{"click a":"watchClick"},watchClick:function(){a.default.track("link_clck",{source:"l"})}})},function(e,t,i){var n=i(0),a=i(3);t.default=n.View.extend({el:".js-return-main-compilation",events:{click:"clickMainCompilation"},clickMainCompilation:function(){a.default.track("click_main_compilation")}})},function(e,t,i){var n=i(1),a=i(0),s=i(23),o=i(3);t.default=a.View.extend({el:".js-poster",events:{click:"watchClick"},watchClick:function(){var e={source:"p"},t=new s.default;n.extend(e,t.getRightTypeForGroot()),o.default.track("watchcontent_click",e)}})},function(e,t,i){var n=i(0),a=i(75),s=i(3),o=i(30);t.default=n.View.extend({el:"section.cols-wrapper",watchHistoryBlock:"watch_history",initialize:function(){this.listenTo(o.default,"profile:groot:paveView",this.sendPageView),this.listenTo(o.default,"profile:groot:setRefPage",this.setRefPage),this.listenTo(a.default,"collection:deleteWatchedSuccess",this.removeFromWatchHistory)},sendPageView:function(e,t){s.default.setAutoProperties({$url:window.location.href}),s.default.rewriteSuperProperties({page:e,ref_page:s.default.getRefPage()}),t&&s.default.rewriteSuperProperties({block_id:t}),s.default.track("page_view")},setRefPage:function(e){s.default.setRefPage(e)},removeFromWatchHistory:function(e){var t={};if(s.default.rewriteSuperProperties({block_id:this.watchHistoryBlock}),e.isSerie())t.compilation_id=e.getId(),s.default.track("continuewatching_delete",t);else{var i=s.default.getSuperProperty("content_id");t.content_id=e.getId(),s.default.rewriteSuperProperties(t),s.default.track("continuewatching_delete"),t.content_id=i,s.default.rewriteSuperProperties(t)}}})},function(e,t){t.default="18.05.22"},function(e,t,i){var n=i(1),a=i(237),s=i(3);t.default=a.default.extend({el:".js-menu-block",events:{"mouseenter li":"showSubMenu","click a":"hideSubMenu","click .js-tvchannels-link":"tvChannelsLinkClick"},showSubMenu:function(e){if(!this.isMobile()){var t=n(e.target).parent().find(".top-menu__dropdown");t.length&&t.css("visibility","")}},hideSubMenu:function(e){if(!this.isMobile()){var t=n(e.target).closest(".top-menu__dropdown");t.length&&t.css("visibility","hidden")}},tvChannelsLinkClick:function(){s.default.track("main_menubuttons_click")}})},function(e,t,i){var n=i(1),a=i(41),s=i(45),o=i(4),r=i(419),l=i(237);t.default=l.default.extend({el:".js-top-menu",exludedLinks:["js-erotic","js-auth-link-inner"],events:{"click a.top-menu__sublist-link":"clickLink","click a.top-menu__profile-list-link":"clickProfileLink","click li.top-menu__list-item_expanding":"clickMenuItem"},initialize:function(){n(".js-menu-block").on("click",this.clickMenu.bind(this)),this.listenTo(a.default,"menu:mobile:close",this.clickLink),n(r.default()).insertAfter(".js-collections-item")},clickMenu:function(e){this.isMobile()&&e.target&&(e.target.classList.contains("js-menu-block")||e.target.classList.contains("ivi-top__menu-toggle")||e.target.classList.contains("ivi-top__menu-toggle-item"))&&(n(".ivi-top__menu-toggle").toggleClass("ivi-top__menu-toggle_active"),this.$el.toggleClass("top-menu_expanded"),n("body").toggleClass("has-expanded-nav"),s.default.trigger("search:quick:reset"))},clickMenuItem:function(e){if(this.isMobile()){var t=n(e.target).closest("li");t.hasClass("top-menu__list-item_expanded")||this.$el.find(".top-menu__list").children("li").toggleClass("top-menu__list-item_expanded",!1),t.toggleClass("top-menu__list-item_expanded")}},clickLink:function(e){if(this.isMobile()&&(this.closeMenu(),e.target)){var t=n(e.target);for(var i in this.exludedLinks)if(t.hasClass(this.exludedLinks[i]))return;e.preventDefault(),setTimeout(function(){o.default.redirect(t.attr("href"))},100)}},clickProfileLink:function(){this.isMobile()&&this.closeMenu()},closeMenu:function(){n(".ivi-top__menu-toggle").toggleClass("ivi-top__menu-toggle_active",!1),this.$el.find(".top-menu__list").children("li").toggleClass("top-menu__list-item_expanded",!1),this.$el.toggleClass("top-menu_expanded",!1),n("body").toggleClass("has-expanded-nav",!1)}})},function(e,t,i){function n(e){return a.default.render('<li class="top-menu__list-item only-mobile"> <a href="/cert" class="top-menu__list-link" title="Активировать сертификат">Активировать сертификат</a></li>',e)}var a=i(2);t.default=n},function(e,t,i){var n=i(0),a=i(1),s=i(421),o=i(4),r=i(156);t.default=n.View.extend({el:".top-menu__list",events:{"mouseenter > li":"sendPixelAudit"},initialize:function(){var e=this,t=o.default.getSpecialLinks(),i={};Object.keys(t).forEach(function(e){i[e]||(i[e]=""),Object.keys(t[e]).forEach(function(n){var a={link:t[e][n].link||"",title:t[e][n].title||"",target:t[e][n].target||"",color:t[e][n].color||"",text:t[e][n].text||"",pixelAudit:t[e][n].pixelAudit||"",pixelClick:t[e][n].pixelClick||""};i[e]+=s.default(a)})}),Object.keys(i).forEach(function(t){a("#js-"+t+"-links .top-menu__sublist-item").remove(),a("#js-"+t+"-links").append(i[t]),a("#js-"+t+"-links .top-menu__sublist-item a").on("click",e.sendPixelClick)})},sendPixelAudit:function(e){a(e.currentTarget).find(".top-menu__sublist-item a").each(function(){var e=a(this).attr("data-pixel-audit");e&&(new r.default).setSrc(e)})},sendPixelClick:function(){var e=a(this).attr("data-pixel-click");e&&(new r.default).setSrc(e)}})},function(e,t,i){function n(e){return a.default.render('<li class="top-menu__sublist-item"> <a class="top-menu__sublist-link top-menu__sublist-link top-menu__sublist-link_special" href="{{ link|striptags|escape }}" title="{{ title|striptags|escape }}" target="{{ target|striptags|escape|default("_self") }}" {{ color ? "style=color:" ~ color|striptags|escape : "" }} data-pixel-audit="{{ pixelAudit|striptags|escape }}" data-pixel-click="{{ pixelClick|striptags|escape }}" > {{ text|striptags|escape }} </a></li>',e)}var a=i(2);t.default=n},function(e,t,i){var n=i(1),a=i(0),s=i(35),o=i(82),r=i(4);t.default=a.View.extend({el:"body",events:{"touchend .js-close-smart-button":"closeSmartButton"},hideInAppButtonCookieName:"hide_in_app_button",hideInAppButtonCookieExpire:86400,initialize:function(){this.removeSpoilersHref(),this.setExtraClassToWatchInnerNav(),this.scrollToActiveItem(),n("body .js-watch-inner-nav").on("click",this.toggleWatchInnerNav.bind(this)),n(window).on("resize",this.scrollToActiveItem),this.listenTo(o.default,"modal:open:extraData",this.setBodyHasModalClass),this.listenTo(o.default,"modal:close:extraData",this.removeBodyHasModalClass)},scrollToActiveItem:function(){var e=n(".js-inner-nav"),t=n(".js-active");if(e.length&&t.length){var i=t.offset().left+e.scrollLeft();r.default.getViewPort().width<i&&e.scrollLeft(i)}},removeSpoilersHref:function(){n(".expand-link").removeAttr("href")},toggleWatchInnerNav:function(e){var t=n(".js-watch-inner-nav");e.target===t.get(0)&&t.toggleClass("expanded")},setExtraClassToWatchInnerNav:function(){var e=n(".js-watch-inner-nav li");e.filter(function(t){return t>=e.length-1}).addClass("extra")},setBodyHasModalClass:function(e){this.$el.addClass("has-modal"),e.hasMobileModal()&&(this.$el.addClass(e.getMobileBodyClass()),e.canMobileScroll()||n(document).on("touchmove",function(){return!1}))},removeBodyHasModalClass:function(e){this.$el.removeClass("has-modal"),e.hasMobileModal()&&(this.$el.removeClass(e.getMobileBodyClass()),e.canMobileScroll()||n(document).off("touchmove"))},closeSmartButton:function(){return n(".js-popup-teaser").hide(),s.get(this.hideInAppButtonCookieName)||s.set(this.hideInAppButtonCookieName,"1",{expires:this.hideInAppButtonCookieExpire}),!1}})},function(e,t,i){var n=i(1),a=i(0),s=i(19),o=i(23),r=i(5),l=i(158),d=i(3),u=i(82),c=i(4);t.default=a.View.extend({el:".js-app-button",branchLink:"",initialize:function(e){if((new s.default).showOpenInAppBlock()&&!e.isSpecialRoute){r.isUndefined(e)&&(e={}),r.isUndefined(e.gutm)&&(e.gutm={});var t=d.default.loadGutmCookie(),i=r.extend(t||{},e.gutm);if(n(o.default.prototype.el).length)this.branchLink=l.default.createContentLink(i);else{var a=d.default.getRefPageFromGrootView(),p={};if("collection"===a){var f=n(".js-collection-block");f.eq(0)&&(p.collectionId=f.eq(0).data("collection-id")),c.default.getLocation().pathname&&(p.collectionHru=c.default.getLocation().pathname.replace("/collections/",""))}this.branchLink=l.default.createRedirectLink(a,p,i)}this.listenTo(u.default,"mobile:ensureBranchButtonClickEvent",this.ensureBranchLink),this.listenTo(u.default,"mobile:removeBranchLinkBlock",this.removeBranchLinkBlock),this.ensureBranchLink()}},ensureBranchLink:function(){this.$el.off("click"),this.setElement(".js-app-button",!0),this.$el.attr("href",this.branchLink),this.$el.on("click",this.processAppButtonClick)},processAppButtonClick:function(e){var t=this;e.preventDefault(),d.default.track("click_btn_new_banner"),setTimeout(function(){c.default.redirect(n(t).attr("href"))},300)},removeBranchLinkBlock:function(){n(".page-wrapper").nextAll(".js-popup-teaser").remove(),this.ensureBranchLink()}})},function(e,t){e.exports=branch},function(e,t,i){var n=i(0),a=i(3),s=i(43);t.default=n.View.extend({el:"#adriver_banner_581587721",initialize:function(){this.$el.length&&(s.default.isMobileFullScreenBannerShown()?this.trackBannerShow():document.body.addEventListener("DOMSubtreeModified",this.handleGrootTagChanging.bind(this,s.default)))},handleGrootTagChanging:function(e,t){"GROOT"===t.target.nodeName&&e.isMobileFullScreenBannerShown()&&this.trackBannerShow()},trackBannerShow:function(){a.default.track("fullscreen_imp")}})},function(e,t,i){var n=i(14),a=i(90);t.default=n.default.extend(a.default).extend({uri:"/notifications/read/"})},function(e,t,i){(function(e){i(76);var n=i(1),a=i(0),s=i(114),o=i(112),r=i(159),l=i(28),d=i(5),u=i(7),c=i(90),p=i(3),f=i(428),h=i(429),g=i(65),m=i(4),v=i(83);t.default=a.View.extend({el:".js-pulls-block",wrapperElClass:".js-pulls-wrapper",wrapperVisibilityClass:"top-notifications__dropdown_active",countElClass:".js-pulls-count",emptyElClass:".js-pulls-empty",listElClass:".js-pulls-list",wrapperListEl:".js-pulls-wrapper-list",events:{"click .js-pulls-icon":"handlePullsCountClick","click .js-pulls-list li":"clickWrapper","mouseup .js-pulls-list li":"clickWrapper","contextmenu .js-pulls-list li":"clickWrapper"},initialize:function(e){d.extend(this,d.pick(e,["countModel","readModel"])),this.$wrapperEl=this.$el.find(this.wrapperElClass),this.$countEl=this.$el.find(this.countElClass),this.$emptyEl=this.$el.find(this.emptyElClass),this.$listEl=this.$el.find(this.listElClass),this.$emptyEl.html(f.default()),this.countModel.on("change:unread",this.showPullsCount.bind(this)),this.countModel.on("change",this.getPulls.bind(this)),n("body").bind("click",this.closePullsBlock.bind(this)),n("body").bind("keyup",this.closePullsBlockEsc.bind(this)),this.listenTo(u.default,"auth:userProfileBlockIsReady",function(){n(".js-auth-info").mouseenter(this.closePullsBlock.bind(this))})},closePullsBlock:function(e){0===n(e.target).closest(this.el).length&&this.$wrapperEl.hasClass(this.wrapperVisibilityClass)&&this.handlePullsCountClick()},closePullsBlockEsc:function(e){v.default.getKeyCode(e)===v.default.KEY_ESCAPE&&this.$wrapperEl.hasClass(this.wrapperVisibilityClass)&&this.handlePullsCountClick()},handlePullsCountClick:function(){this.$wrapperEl.hasClass(this.wrapperVisibilityClass)?this.$wrapperEl.removeClass(this.wrapperVisibilityClass):(this.countModel.getTotal()&&this.collection.length?(this.read(),this.$listEl.html(h.default({pulls:this.collection.models})).show().find(this.wrapperListEl).perfectScrollbar({suppressScrollX:!0}),this.$emptyEl.hide()):this.showEmptyMessage(),this.showPullsWrapper())},read:function(){var e=this,t=0;this.readModel.resetAdditionUriParam(),this.collection.each(function(i){i.isRead()||(e.readModel.addParamsToUri("id="+i.getId()),t++)}),t&&(this.readModel.addParamsToUri("session="+g.default.get()),this.readModel.mapiPost().always(function(t){200===t.status&&e.countModel.set("unread",0)}))},clickWrapper:function(e){if(1===e.which&&"click"===e.type)e.preventDefault(),this.handlePullsClick(e);else if(2===e.which)e.preventDefault(),this.handlePullsClick(e,"open");else if(3===e.which){var t=n(e.currentTarget).data("id")||"",i=this.collection.get(t);this.openPull.call(n(e.currentTarget).find("a"),i,"href")}},handlePullsClick:function(e,t){var i=n(e.currentTarget).data("id")||"",a=this.collection.get(i);if(a){var s={delivery_id:a.getId(),message_type_id:a.getMessageType(),transport:c.default.transportType};a.getUrl()&&(p.default.setBlockId("notifications"),0!==a.getUrl().indexOf("/user/certificate")&&0!==a.getUrl().indexOf("/user/subscription")||(s.from="notifications")),p.default.track("notification_click",s),this.openPull(a,t)}return!1},openPull:function(t,i){var n=this;if(t.getUrl()){var a=m.default.redirect;"open"===i?a=m.default.open:"href"===i&&this instanceof e&&(a=function(e){n.attr("href",e)});var d=null,u=l.default.queryParams(t.getUrl());"/index"===t.getUrl()?a("/"):null!==(d=t.getUrl().match(/^\/movie\/open\/(\d+)/))?a("/watch/"+d[1]):null!==(d=t.getUrl().match(/^\/compilation\/open\/(\d+)/))?(new r.default).mapiGet({data:{id:d[1],fields:"hru"}}).done(function(e){if(e.result){var t="/watch/"+e.result.hru;u.season&&(t+="/season"+u.season),a(t)}}):null!==(d=t.getUrl().match(/^\/collection\/open\/(\d+)/))?(new o.default).mapiGet({data:{id:d[1],fields:"hru"}}).done(function(e){e.result&&a("/collections/"+e.result.hru)}):"/user/profile"===t.getUrl()||"/user"===t.getUrl()?a("/profile"):0===t.getUrl().indexOf("/user/certificate")?(s.default.prototype.setCertificateKeyInStorage(u.certificate_key),a("/cert")):"/user/subscription"===t.getUrl()?a("/buy/subscription?redirect_url="+window.location.pathname):0===t.getUrl().indexOf("/url/open")&&m.default.open(decodeURIComponent(u.url))}},showEmptyMessage:function(){this.collection.reset(),this.$emptyEl.show(),this.$listEl.hide()},showPullsWrapper:function(){this.$wrapperEl.addClass(this.wrapperVisibilityClass),p.default.track("notifications_open")},showPullsCount:function(){this.countModel.getUnread()?(this.$countEl.html(this.countModel.getUnread()),this.$el.toggleClass("top-notifications_has-unread",!0),p.default.track("notification_alert")):(this.$countEl.html(""),this.$el.toggleClass("top-notifications_has-unread",!1))},getPulls:function(){this.collection.mapiGet({data:{type:c.default.pullType}}),this.$el.toggleClass("top-notifications_empty",0===this.countModel.getTotal())}})}).call(t,i(1))},function(e,t,i){function n(e){return a.default.render('<div class="top-notifications__empty-title">Нет новых сообщений</div><div class="top-notifications__empty-text">Здесь появляются только важные сообщения</div>',e)}var a=i(2);t.default=n},function(e,t,i){function n(e){return a.default.render('<div class="top-notifications__list-wrapper js-pulls-wrapper-list"> <ul class="top-notifications__list"> {% for pull in pulls %} <li data-id="{{ pull.getId() }}" class="top-notifications__item{% if not pull.isRead() %} top-notifications__item_unread{% endif %}"> <a href="#" class="top-notifications__item-link"> <img class="top-notifications__item-image" src="{{ pull.getImg() }}"> <span class="top-notifications__item-text">{{ pull.getText() }}</span> </a> </li> {% endfor %} </ul></div>',e)}var a=i(2);t.default=n},function(e,t,i){var n=i(14),a=i(90),s=i(65);t.default=n.default.extend(a.default).extend({uri:"/notifications/count/",pollingId:null,pollingTime:6e4,defaults:{unread:0,total:0},getUnread:function(){return this.get("unread")},getTotal:function(){return this.get("total")},startPolling:function(){null!==this.pollingId&&clearInterval(this.pollingId),this.pollingId=setInterval(this.poll.bind(this),this.pollingTime),this.poll()},poll:function(){s.default.get()&&this.mapiGet({data:{type:a.default.pullType}})}})},function(e,t,i){var n=i(29),a=i(432),s=i(90);t.default=n.default.extend(s.default).extend({uri:"/notifications/",model:a.default,comparator:function(e){return-e.getStartDatetime()}})},function(e,t,i){var n=i(0),a=i(90);t.default=n.Model.extend(a.default).extend({getId:function(){return this.get("id")},isRead:function(){return!!this.get("read")},getUrl:function(){return this.get("url")||""},getDeliveryTypes:function(){return this.get("delivery_types")||[]},getMessageType:function(){return this.get("message_type")},getText:function(){return this.get("text")},getStartDatetime:function(){return this.get("start_datetime")},getValidUntil:function(){return this.get("valid_until")},getImg:function(){return this.get("img")+"/84x128/"}})},function(e,t,i){var n=i(0);t.default=new n.Model({})},function(e,t){var i=function(e){var t=[];this.route=e,this._namedRegexp=new RegExp(e.replace(/(?:str|int):([-\w]+)/g,function(e,i){return t.push(i),"(.*)"}).replace(this._escapeRegExp,"\\$&")),this._namedStringParam=/str:\w+/g,this._namedIntParam=/int:\w+/g,this._escapeRegExp=/[-[\]{}+?,\\^$|#\s]/g,this._nameMatches=function(e){if(!e)return{};for(var i=t.length,n={},a=0;a<i;a++)n[t[a]]=e[a+1];return n},this.extractParams=function(e){return this._nameMatches(this._namedRegexp.exec(e))},this.test=function(t){return e=this.route.replace(this._escapeRegExp,"\\$&").replace(this._namedIntParam,"(\\d+)").replace(this._namedStringParam,"([\\w-]*[A-Za-z]+[\\w-]*)"),new RegExp("^"+e+"$").test(t)}};t.default=i},function(e,t){t.default=function(){}},function(e,t,i){var n=i(0),a=i(45);t.default=n.View.extend({el:"#js-quick-search-form",events:{reset:"resetForm"},resetForm:function(){a.default.trigger("search:quick:reset")}})},function(e,t,i){var n=i(1),a=i(0),s=i(45);t.default=a.View.extend({el:"body",events:{click:"hideResults"},hideResults:function(e){n(e.target).closest("#js-quick-search-form").length||s.default.trigger("search:quick:reset")}})},function(e,t,i){var n=i(1),a=i(160),s=i(240),o=i(242),r=i(5),l=i(10),d=i(446),u=i(4);t.default=s.default.extend({el:"body",formShown:!1,actualPageBodyClasses:"",resultBoxMobileView:null,additionalEvents:{"click #js-quick-search-link":"showSearchForm","submit #js-search-page-form":"focusoutInput","click #js-search-page-button":"focusoutInput"},initialize:function(){r.extend(this.events,this.additionalEvents),this.formSearchFieldView=new a.default({isMobile:!0}),this.sendResultStat()},showSearchForm:function(){if(l.default.external)u.default.redirect("/search/");else if(!this.formShown){n(".js-footer").hide(),n(".js-top-menu").removeClass("top-menu_expanded"),n(".ivi-top__menu-toggle").removeClass("ivi-top__menu-toggle_active");var e=n(".page-wrapper");e.addClass("js-actual-page-wrapper"),e.hide(),e.after(d.default()),this.actualPageBodyClasses=this.$el.attr("class"),this.$el.attr("class","search-dropdown"),window.ivi.adaptive.isMobileStyle||this.$el.addClass("tablet touch"),n(".js-mobile-search-form").show(),n(".modal-container").hide();var t=n("#js-search-page-query");this.formSearchFieldView.setElement(t),t.focus(),this.resultBoxMobileView?this.resultBoxMobileView.setElement(this.$("#js-result-box-search")):this.resultBoxMobileView=new o.default,this.formShown=!0}},focusoutInput:function(){return n("#js-search-page-query").blur(),!1},hideSearchForm:function(){if(this.formShown){n(".js-footer").show();var e=n(".js-actual-page-wrapper");e.removeClass("js-actual-page-wrapper"),e.show(),n(".top-search__mobile-search").removeClass("animating"),n(".js-mobile-search-form").remove(),n(".modal-container").show(),this.$el.attr("class",this.actualPageBodyClasses),this.formShown=!1}}})},function(e,t,i){var n=i(0),a=i(243),s=i(45),o=i(440),r=i(77),l=i(441);t.default=n.View.extend({el:"#result-video",initialize:function(){var e=new a.default;e.to=9,this.listenTo(e,"reset",this.render)},render:function(e){if(this.$el.html(""),this.$el.addClass("empty"),r.default.setResultList(e),e.length){var t="";e.each(function(e,i){t+=o.default({index:i,video:e})}),this.$el.html(l.default({videoList:t})),this.$el.removeClass("empty")}r.default.sendSearchStat(r.default.refsQuick),s.default.trigger("search:result:movieReady")}})},function(e,t,i){function n(e){return a.default.render('<li data-index="{{ index }}"> <a tabindex="-1" href="{{ video.getPosterSpecificLinkQuickSearch(false) }}" data-index="{{ index }}" class="item-content-wrapper js-collection-content{% if video.isForAdult() %} js-adult{% endif %}"> <span class="image" data-index="{{ index }}"> <img src="{{ video.getPosterPath("/172x264/") }}" data-index="{{ index }}" alt="{{ video.getTitle() }}"> <span class="age-limit" data-value="{{ video.getRestrict()|default(0) }}+"></span> </span> <span class="title"><span>{{ video.getTitle() }}</span></span> </a></li>',e)}var a=i(2);t.default=n},function(e,t,i){function n(e){return a.default.render('<ul class="gallery posters-large mobile-has-titles js-content-result"> {{ videoList }}</ul>',e)}var a=i(2);t.default=n},function(e,t,i){var n=i(0),a=i(245),s=i(45),o=i(444);t.default=n.View.extend({el:"#result-person",initialize:function(){this.listenTo(new a.default,"reset",this.render)},render:function(e){this.$el.html(""),this.$el.addClass("empty");var t=[];e.each(function(e){t.push(e.toJSON())}),t.length>0&&(this.$el.html(o.default({persons:t})),this.$el.removeClass("empty")),s.default.trigger("search:result:personReady")}})},function(e,t,i){var n=i(0);t.default=n.Model.extend({parse:function(e){var t=e.is_temporary?"/temporary":"";return t+="/person/"+(e.hru?e.hru:e.id),{name:e.name,isPerson:!0,link:t.toLowerCase()}}})},function(e,t,i){function n(e){return a.default.render('<a class="anchor" id="persons"></a><h2>Найденные имена</h2><ul class="roomy-list"> {% for person in persons %} <li> <a href="{{ person.link }}">{{ person.name }}</a> </li> {% endfor %}</ul>',e)}var a=i(2);t.default=n},function(e,t,i){function n(e){return a.default.render('<li class="more-link only-mobile js-more-results"><a href="/search/?q={{ searchQuery }}">Все результаты</a></li>',e)}var a=i(2);t.default=n},function(e,t,i){function n(e){return a.default.render('{% block content %}<div class="page-wrapper js-mobile-search-form" style="display: none"> <div class="content-main"> <section class="top-wrapper light"> <h1 class="no-mobile">Поиск</h1> <form id="js-search-page-form" class="search-form" autocomplete="off"> <div class="ivi-input"> <input id="js-search-page-query" maxlength="150" type="search" name="q" value=""> </div> <button id="js-search-page-button" type="submit" class="ivi-button large search" disabled="disabled">Найти</button> </form> </section> <div id="js-result-box-search"> <section class="gallery-wrapper" id="result-video"> </section> <section class="persons-block" id="result-person"> </section> </div> </div></div>{% endblock %}',e)}var a=i(2);t.default=n},function(e,t,i){var n=i(1),a=i(0),s=i(448),o=i(450),r=i(10),l=i(246),d=i(45),u=i(452),c=i(77);t.default=a.View.extend({el:"#js-result-box",elVisibilityClass:"top-search__dropdown_active",events:{"click .js-more-results a":"clickAllResults","click .content-result li":"clickResultChoice","mouseenter li":"eventClearSelected"},initialize:function(){this.movieList=new s.default,this.personList=new o.default,this.listenTo(d.default,"search:result:movieReady",this.showResult),this.listenTo(d.default,"search:result:personReady",this.showResult),this.listenTo(d.default,"hide-results",this.hide)},eventClearSelected:function(e){this.$el.find("a").removeClass("top-search__results-link_selected"),n(e.currentTarget).find("a").addClass("top-search__results-link_selected")},showResult:function(){var e="";if(this.movieList.$el.children().length&&(e+=this.movieList.$el.get(0).outerHTML),this.personList.$el.children().length&&(e+=this.personList.$el.get(0).outerHTML),""!==e){var t={external:r.default.external,searchQuery:encodeURI(n("#search-text").val())};e+=u.default(t),this.$el.children(".top-search__dropdown-inner").html(e)}else this.$el.children(".top-search__dropdown-inner").html(l.default());this.$el.addClass(this.elVisibilityClass)},hide:function(){this.$el.removeClass(this.elVisibilityClass)},clickAllResults:function(){c.default.sendAllResultsStat(c.default.refsQuick)},clickResultChoice:function(e){c.default.sendResultChoiceStat(c.default.refsQuick,n(e.target).data("index"))}})},function(e,t,i){var n=i(0),a=i(243),s=i(10),o=i(45),r=i(449),l=i(77);t.default=n.View.extend({tagName:"ul",className:"top-search__results top-search__results_content",initialize:function(){this.listenTo(o.default,"hide-results",this.$el.remove),this.listenTo(new a.default,"reset",this.render)},render:function(e){var t=this;this.$el.html(""),l.default.setResultList(e),e.each(function(e,i){var n=e.toJSON();n.index=i,n.external=s.default.external,t.$el.append(r.default({index:i,external:s.default.external,video:e}))}),l.default.sendSearchStat(l.default.refsQuick),o.default.trigger("search:result:movieReady")}})},function(e,t,i){function n(e){return a.default.render('{% set host = "" %}{% if external|default(false) %} {% set host = internationalExpansion.getRightHostOrigin() %}{% endif %}<li class="top-search__results-item" data-index="{{ index }}"> <a href="{{ host }}{{ video.getPosterSpecificLinkQuickSearch(hasSubscription) }}" data-index="{{ index }}" data-right-types="{{ video.getContentPaidTypeList|join(",") }}" data-right-types-quality="" class="top-search__results-link"> <img class="top-search__results-link-image" alt="" src="{{ video.getPosterPath("/41x62/") }}" data-index="{{ index }}"> <span class="top-search__results-link-title"> {{ video.getTitle() }} <small class="top-search__results-link-tags"> {% if video.getYearList() and video.getYearList().length %} {{ min(video.getYearList()) }}{% if min(video.getYearList()) != max(video.getYearList()) %} - {{ max(video.getYearList()) }}{% endif %} {% else %} {{ video.getYear() }} {% endif %} </small> </span> </a></li>',e)}var a=i(2);t.default=n},function(e,t,i){var n=i(0),a=i(245),s=i(10),o=i(45),r=i(451);t.default=n.View.extend({tagName:"ul",className:"top-search__results top-search__results_content",initialize:function(){this.listenTo(o.default,"hide-results",this.$el.remove),this.listenTo(new a.default,"reset",this.render)},render:function(e){var t=this;this.$el.html(""),e.each(function(e){var i=e.toJSON();i.external=s.default.external,t.$el.append(r.default(i))}),o.default.trigger("search:result:personReady")}})},function(e,t,i){function n(e){return a.default.render('{% set host = "" %}{% if external|default(false) %} {% set host = internationalExpansion.getRightHostOrigin() %}{% endif %}<li class="top-search__results-item top-search__results-item_person"> <a href="{{ host }}{{ link }}" class="top-search__results-link"> <span class="top-search__results-link-title">{{ name }}</span> </a></li>',e)}var a=i(2);t.default=n},function(e,t,i){function n(e){return a.default.render('{% set host = "" %}{% if external|default(false) %} {% set host = internationalExpansion.getRightHostOrigin() %}{% endif %}<ul class="top-search__results top-search__results_more"> <li class="top-search__results-item"> <a href="{{ host }}/search/?q={{ searchQuery }}" class="top-search__results-link"> <span class="top-search__results-link-title">Все результаты</span> </a> </li></ul>',e)}var a=i(2);t.default=n},function(e,t,i){var n=i(1),a=i(0),s=i(454);t.default=a.View.extend({el:".js-story-text",maxLinesNumToHide:3,initialize:function(){this.prepareStoryText(),n(".js-expand-block").each(function(e,t){n(t).find("p:empty").remove(),new s(t)})},prepareStoryText:function(){var e=this,t=n("<p>LINE height</p>").css("display","none");n("body").append(t);var i=t.height();t.remove(),this.$el.each(function(t,a){var s=n(a),o=e.getTextElement(s);o&&o.height()<=i*e.maxLinesNumToHide&&s.hide()})},getTextElement:function(e){var t=e.parent().prev();return!(!t.get(0)||!t.children(".expandable-content").get(0)||t.hasClass("height-5-lines"))&&t.children(".expandable-content").eq(0)}})},function(e,t){e.exports=Expandable},function(e,t,i){var n=i(0),a=i(7),s=i(30),o=i(91),r=i(249);t.default=n.View.extend({el:".support-phone.js-user-support-phone",teaserSupportCLass:"support-phone",initialize:function(){this.listenToOnce(o.default,"support:phoneLoaded",this.saveAndShowSupportPhone),this.listenToOnce(a.default,"user:logout",this.hide),this.listenTo(s.default,"profile:sectionShowed",this.showProfilePhone),this.listenTo(o.default,"support:phonePromoHide",this.promoHide),this.listenTo(o.default,"support:phonePromoShow",this.promoShow)},showProfilePhone:function(){this.setElement(".support-phone.js-user-support-phone"),this.placeSupportPhone(this.phone)},saveAndShowSupportPhone:function(e){this.phone=e,this.placeSupportPhone(this.phone)},placeSupportPhone:function(e){this.$el.html(r.default({phone:e}))},hide:function(){this.$el.closest(".teaser-plate").length&&this.$el.closest(".teaser-plate").removeClass(this.teaserSupportCLass),this.$el.remove()},promoHide:function(){this.$el.hide()},promoShow:function(){this.$el.show()}})},function(e,t,i){var n=i(14),a=i(91),s=i(4);t.default=n.default.extend({uri:"/support/phone/",parse:function(e){return e},requestSupportPhone:function(){var e=this,t={};return-1!==s.default.getLocation().href.indexOf("/buy")&&(t.ignore_schedule=1),this.mapiGet({data:t}).done(function(t){!t.error&&t.phone&&a.default.trigger("support:phoneLoaded",t.phone),a.default.trigger("support:contactsLoaded",e)})},getPhone:function(){return this.get("phone")||null},getEmail:function(){return this.get("email")||null}})},function(e,t,i){var n=i(33),a=i(458),s=i(7),o=i(20),r=i(92),l=i(8);t.default=n.default.extend({EMAIL_NOTIFY_KEY:"email_notify",ONE_DAY:864e5,TOPLINE_SHOW_INTERVAL:3e5,afterLogin:function(){this.tryShowTopLine(),this.listenTo(s.default,"auth:modal:closed",this.tryShowTopLine),this.listenTo(r.default,"topline:setToplineShowNextDay",this.setToplineShowNextDay),this.listenTo(r.default,"topline:clear",this.clearToplineTime)},tryShowTopLine:function(){if(!window.ivi.adaptive.isMobile&&l.default.isAuthenticated()&&!l.default.isSocialAuth()&&!l.default.isPhoneAuth()&&(!l.default.getEmail()||!l.default.isEmailConfirmed())){var e=parseInt(o.default.localStorage.getItem(this.EMAIL_NOTIFY_KEY),10),t=Date.now();e?t>=e+this.ONE_DAY&&this.showToplineForNow():(e=t+this.TOPLINE_SHOW_INTERVAL,this.showToplineForNow()),e-this.TOPLINE_SHOW_INTERVAL<t&&t<e&&new a.default}},showToplineForNow:function(){var e=Date.now()+this.TOPLINE_SHOW_INTERVAL;o.default.localStorage.setItem(this.EMAIL_NOTIFY_KEY,e),new a.default},setToplineShowNextDay:function(){var e=Date.now()+this.ONE_DAY+this.TOPLINE_SHOW_INTERVAL;o.default.localStorage.setItem(this.EMAIL_NOTIFY_KEY,e)},clearToplineTime:function(){this.stopListening(),o.default.localStorage.removeItem(this.EMAIL_NOTIFY_KEY)}})},function(e,t,i){var n=i(1),a=i(0),s=i(22),o=i(7),r=i(459),l=i(92),d=i(460),u=i(8),c=i(20);t.default=a.View.extend({el:"body",events:{"click .js-topline-close":"closeTopline","click .js-send-confirm-email":"sendConfirmEmail"},initialize:function(){if(n(".js-topline").length)return l.default.trigger("topline:clear"),void this.undelegateEvents();this.$el.addClass("has-topline"),u.default.getEmail()?u.default.isEmailConfirmed()||this.$el.append(r.default({motivationRegistrationShown:c.default.getMotivationRegistrationCompletion()})):this.$el.append(d.default()),l.default.trigger("topline:show"),this.listenTo(o.default,"user:logout",this.hide),this.listenTo(o.default,"auth:email:confirm:sent",this.closeTopline)},closeTopline:function(){this.hide(),l.default.trigger("topline:setToplineShowNextDay")},sendConfirmEmail:function(){n(".js-topline").animate({opacity:0},"slow",this.animationCompleted())},animationCompleted:function(){this.closeTopline(),s.default.sendConfirmEmail(c.default.getMotivationRegistrationCompletion())},hide:function(){this.$el.removeClass("has-topline"),n(".js-topline").remove(),l.default.trigger("topline:hide")}})},function(e,t,i){function n(e){return a.default.render('<div class="js-topline topline no-mobile"> <div class="topline__container"> <div class="topline__text"> <span>Подтвердите свой e-mail, чтобы завершить регистрацию{% if abExperiment.showRegistrationMotivationWithBonus() and motivationRegistrationShown %} и получить подписку в подарок{% endif %}</span> <div class="ivi-button small pale js-send-confirm-email">Выслать письмо для подтверждения</div> </div> {% if not abExperiment.showRegistrationMotivationWithBonus() %} <div class="topline__info"> <div class="topline__info-icon"></div> <span>Зачем это нужно</span> <div class="topline__dropdown"> <span>На почту мы присылаем подарочные сертификаты и информацию о транзакциях, чтобы своевременно оказывать поддержку в вопросах оплаты.</span> </div> </div> {% endif %} <div class="topline__close js-topline-close"></div> </div></div>',e)}var a=i(2);t.default=n},function(e,t,i){function n(e){return a.default.render('{% set host = "" %}{% if external|default(false) %} {% set host = internationalExpansion.getRightHostOrigin() %}{% endif %}<div class="js-topline topline no-mobile"> <div class="topline__container"> <div class="topline__text"> <a href="{{ host }}/profile">Укажите свой e-mail</a> <span>и подтвердите его, чтобы пользоваться всеми преимуществами личного кабинета</span> </div> <div class="topline__info"> <div class="topline__info-icon"></div> <span>Зачем это нужно</span> <div class="topline__dropdown"> <span>Без почты мы не сможем присылать подарочные сертификаты и оказывать в полной мере поддержку в вопросах о выполненных транзакциях.</span> <a href="{{ host }}/profile" class="ivi-button small pale">Указать свой e-mail</a> </div> </div> <div class="topline__close js-topline-close"></div> </div></div>',e)}var a=i(2);t.default=n},function(e,t,i){var n=i(33),a=i(462),s=i(20),o=i(92),r=i(32);t.default=n.default.extend({WINDOWS_APP_HIDDEN_KEY:"windows_app_hidden",ONE_DAY:864e5,afterLogin:function(){this.listenTo(o.default,"toplineWinApp:setToplineShowDate",this.setToplineShowNextDate),this.listenTo(o.default,"toplineWinApp:clear",this.clearToplineTime);var e=new r.default;if(e.isWindows10()&&(e.isEdge()||e.isIE())){var t=parseInt(s.default.localStorage.getItem(this.WINDOWS_APP_HIDDEN_KEY),10),i=Date.now();(!t||i>=t)&&new a.default}},setToplineShowNextDate:function(e){var t=Date.now()+this.ONE_DAY*e;s.default.localStorage.setItem(this.WINDOWS_APP_HIDDEN_KEY,t)},clearToplineTime:function(){this.stopListening(),s.default.localStorage.removeItem(this.WINDOWS_APP_HIDDEN_KEY)}})},function(e,t,i){var n=i(1),a=i(0),s=i(463),o=i(92),r=i(3);t.default=a.View.extend({el:"body",events:{"click .js-topline-close":"closeTopline","click .js-topline-button":"buttonClicked"},initialize:function(){if(n(".js-topline").length)return o.default.trigger("toplineWinApp:clear"),void this.undelegateEvents();this.$el.addClass("has-topline"),this.$el.append(s.default()),o.default.trigger("topline:show"),r.default.track("topline_win10_view")},buttonClicked:function(){this.hide(),r.default.track("topline_win10_click"),o.default.trigger("toplineWinApp:setToplineShowDate",14)},closeTopline:function(){this.hide(),r.default.track("topline_win10_close"),o.default.trigger("toplineWinApp:setToplineShowDate",1)},hide:function(){this.$el.removeClass("has-topline"),n(".js-topline").remove(),o.default.trigger("topline:hide")}})},function(e,t,i){function n(e){return a.default.render('<div class="js-topline topline no-mobile"> <div class="topline__container"> <div class="topline__text"> <span>Попробуйте приложение ivi для Windows 10</span> <a href="ms-windows-store://pdp/?ProductId=9nblggh43kx3&cid=browser_edge_ie_top_line" class="ivi-button small pale js-topline-button">Установить приложение</a> </div> <div class="topline__close js-topline-close"></div> </div></div>',e)}var a=i(2);t.default=n},function(e,t,i){var n=i(6),a=i(28),s=i(4),o=i(11),r=i(7);t.default=n.default.extend({TRIAL_PRODUCT_IDENTIFIER:"trial.free.7days",initialize:function(){this.listenTo(o.default,"buy:processSubscriptionPurchaseAfterLogin",this.processSubscriptionPurchaseAfterLogin),this.listenTo(o.default,"buy:processContentPurchaseAfterLogin",this.processContentPurchaseAfterLogin)},processSubscriptionPurchaseAfterLogin:function(e){var t=this;e.subscriptionPurchaseOptions.fetchOptions().done(function(){if(e.subscriptionPurchaseOptions.isPurchased()&&!e.alwaysRedirectToPayment)return void e.callbackForPurchasedState();if(!a.default.urlHasParam(e.redirectUrl,"option_hash"))return e.productIdentifier!==t.TRIAL_PRODUCT_IDENTIFIER||e.subscriptionPurchaseOptions.isTrialAvailable()?void s.default.redirect(e.redirectUrl):void s.default.reload();var i=e.subscriptionPurchaseOptions.getPurchaseOptionList();if(i){var n=i.getByProductIdentifier(e.productIdentifier);n&&(r.default.trigger("auth:setReloadPageAfterLoginLogout",!1),s.default.redirect(t.replaceOptionHashInUrl(e.redirectUrl,n.getOptionHash())))}})},processContentPurchaseAfterLogin:function(e){var t=this;e.contentPurchaseOptions.mapiGet({data:{id:e.contentId}}).done(function(){if(e.contentPurchaseOptions.isPurchased())return void e.callbackForPurchasedState();var i=e.contentPurchaseOptions.getPurchaseOptionList();if(i){var n=i.getByProductIdentifier(e.productIdentifier);n&&(r.default.trigger("auth:setReloadPageAfterLoginLogout",!1),s.default.redirect(t.replaceOptionHashInUrl(e.redirectUrl,n.getOptionHash())))}})},replaceOptionHashInUrl:function(e,t){return a.default.replaceParamsInUrl(e,"option_hash",t)}})},function(e,t,i){var n=i(466),a=i(12),s=i(9);t.default=s.default.extend({routes:["/auth/vk"],run:function(e){a.default.prototype.run(e),(new n.default).execute(e)}})},function(e,t,i){var n=i(136),a=i(22);t.default=n.default.extend({authErrorEvent:"auth:vk:error",grootAuthSuccess:"vk_success",grootAuthError:"vk_error",run:function(){n.default.prototype.run.call(this)},authLogin:function(e){a.default.loginByVk(e)}})},function(e,t,i){var n=i(9),a=i(147),s=i(224),o=i(225),r=i(151),l=i(152),d=i(231),u=i(232),c=i(153),p=i(233),f=i(235),h=i(154),g=i(236),m=i(157),v=i(239),_=i(247),b=i(248),y=i(238),w=i(468);t.default=n.default.extend({routes:[w.default.prototype.OAUTH2_PAGE_ROUTE,"/code"],run:function(){(new u.default).execute(),(new v.default).execute(),(new f.default).execute(),(new p.default).execute(),(new r.default).execute(),(new h.default).execute(),(new g.default).execute(),(new d.default).execute(),(new s.default).execute(),(new m.default).execute(!0),(new o.default).execute(),(new _.default).execute(),(new l.default).execute(),(new a.default).execute(),(new b.default).execute(),(new c.default).execute(),(new y.default).execute(),(new w.default).execute()}})},function(e,t,i){var n=i(1),a=i(6),s=i(7),o=i(8),r=i(22),l=i(469),d=i(65),u=i(470),c=i(108),p=i(220),f=i(221),h=i(4),g=a.default.extend({OAUTH2_PAGE_ROUTE:"/oauth2",hasLoginOrRegisterRequest:!1,usedSessionFromParams:!1,oldSession:"",oauth2Model:null,initialize:function(){r.default.autoLogin(),this.authenticationView=new c.default({model:r.default}),this.authenticationView.listen(s.default),this.authenticationView.disableModalEvents(),this.authenticationView.setAnimation(!1),this.authenticationView.addBeforeRenderCallbacks(function(){n("#"+c.default.prototype.modalId).remove()}),this.isOauth2Page()?(this.oauth2Model=new l.default({queryParams:this.decodedQueryParams,oauth2ClientName:u.default.getName()}),this.listenTo(s.default,"autologin",this.afterUserLoginOnOauth2Page),this.listenTo(s.default,"user:login",this.onUserLoginOrRegister),this.listenTo(s.default,"auth:modal:oauth2Access",this.oauthAccess),this.listenTo(s.default,"auth:modal:user:close",this.onAuthModalUserClose),this.listenTo(s.default,"oauth2:loadYandexUserInfo:success",this.onLoadYandexUserInfoSuccess),this.listenTo(s.default,"oauth2:loadYandexUserInfo:error",this.triggerShowAuthModalOnOauth2Page),this.listenTo(s.default,"user:logout",this.onUserLogout)):((new p.default).listen(s.default),new f.default,this.listenTo(s.default,"autologin",this.afterUserLoginOnLoginByCodePage))},isOauth2Page:function(){return h.default.getLocation().pathname===this.OAUTH2_PAGE_ROUTE},onLoadYandexUserInfoSuccess:function(e){var t=e.emails&&e.emails.length?e.emails[0]:null;this.authenticationView.setYandexUserInfo(this.decodedQueryParams.ya_access_token,e.display_name||t||e.id),this.authenticationView.setStatus(this.authenticationView.statuses.STATUS_OAUTH2_ACCESS),this.triggerShowAuthModalOnOauth2Page()},afterUserLoginOnOauth2Page:function(){o.default.isAuthenticated()?this.usedSessionFromParams?this.oauthAccess():(this.authenticationView.setStatus(this.authenticationView.statuses.STATUS_OAUTH2_ACCESS),this.triggerShowAuthModalOnOauth2Page()):!this.usedSessionFromParams&&this.decodedQueryParams&&this.decodedQueryParams.session?(this.usedSessionFromParams=!0,this.oldSession=d.default.get(),d.default.set(this.decodedQueryParams.session),r.default.loadUser(),this.listenToOnce(s.default,"loadUser",this.onLoadUser),this.listenToOnce(s.default,"auth:loadUserFailed",this.onLoadUserFailed)):((this.usedSessionFromParams||this.decodedQueryParams&&!this.decodedQueryParams.session)&&this.decodedQueryParams&&this.decodedQueryParams.ya_access_token&&this.oauth2Model.loadYandexUserInfo(this.decodedQueryParams.ya_access_token),this.authenticationView.setStatus(this.authenticationView.statuses.STATUS_AUTH_TOKEN),this.triggerShowAuthModalOnOauth2Page())},afterUserLoginOnLoginByCodePage:function(){s.default.trigger("auth:showAuthModal",{isLoginByCodePage:!0,user:o.default})},onLoadUser:function(e){e.get("code")===r.default.invalidSessionCodeError?this.onLoadUserFailed():(d.default.set(this.oldSession),this.stopListening(s.default,"auth:loadUserFailed",this.onLoadUserFailed),this.authenticationView.setStatus(this.authenticationView.statuses.STATUS_OAUTH2_ACCESS),this.triggerShowAuthModalOnOauth2Page(e),e.logout())},onLoadUserFailed:function(){this.stopListening(s.default,"loadUser",this.onLoadUser),d.default.set(this.oldSession),this.afterUserLoginOnOauth2Page()},triggerShowAuthModalOnOauth2Page:function(e){s.default.trigger("auth:showAuthModal",{isOauth2Page:!0,oauth2ClientName:u.default.getName(),priorityModal:!0,user:e||o.default})},onUserLoginOrRegister:function(){this.hasLoginOrRegisterRequest=!0,this.afterUserLoginOnOauth2Page()},onUserLogout:function(){this.hasLoginOrRegisterRequest=!1},oauthAccess:function(){!o.default.isAuthenticated()&&this.decodedQueryParams&&this.decodedQueryParams.session?(d.default.set(this.decodedQueryParams.session),r.default.autoLogin()):(this.hasLoginOrRegisterRequest=!0,this.onAuthModalUserClose())},onAuthModalUserClose:function(e){void 0===e&&(e=!1),this.hasLoginOrRegisterRequest?h.default.postRedirect(this.oauth2Model.getRedirectUrl(),this.oauth2Model.getRedirectParams(d.default.get())):(e&&this.oauth2Model.removeSessionParam(),h.default.postRedirect(this.oauth2Model.getRedirectUrl(),this.oauth2Model.getRedirectParams()))}});t.default=g},function(e,t,i){var n=i(0),a=i(5),s=i(10),o=i(1),r=i(7),l=n.Model.extend({AUTHORIZE_URL:"authorize",YANDEX_USER_INFO_URL:"https://login.yandex.ru/info",getName:function(){return this.get("oauth2ClientName")},getRedirectUrl:function(){return s.default.oauth2.js_url+this.AUTHORIZE_URL},getRedirectParams:function(e){void 0===e&&(e=null);var t=a.clone(this.get("queryParams"));return null!==e&&(t.session=e),t},removeSessionParam:function(){this.get("queryParams")&&delete this.get("queryParams").session},loadYandexUserInfo:function(e){o.ajax({url:this.YANDEX_USER_INFO_URL+"?oauth_token="+e,type:"GET",dataType:"json",crossDomain:!0,timeout:3e3}).done(function(e){r.default.trigger("oauth2:loadYandexUserInfo:success",e)}).fail(function(){r.default.trigger("oauth2:loadYandexUserInfo:error")})}});t.default=l},function(e,t,i){var n=i(0),a=i(1),s=n.View.extend({getParam:function(e){return a("oauth2").data(e)},getName:function(){return this.getParam("name")}});t.default=new s},function(e,t,i){var n=i(472),a=i(12),s=i(9);t.default=s.default.extend({routes:["/auth/yandex"],run:function(e){a.default.prototype.run(e),(new n.default).execute(e)}})},function(e,t,i){var n=i(136),a=i(22),s=i(28);t.default=n.default.extend({authErrorEvent:"auth:yandex:error",grootAuthSuccess:"ya_success",grootAuthError:"ya_error",run:function(){n.default.prototype.run.call(this),this.queryParams=s.default.queryParams(window.location.hash.replace("#","?")),this.queryParams.state&&(this.queryParams=s.default.queryParams("?"+decodeURIComponent(this.queryParams.state)))},authLogin:function(e){a.default.loginByYandex(e)}})},function(e,t,i){var n=i(12),a=i(84),s=i(9);t.default=s.default.extend({routes:["/buy"],run:function(e){n.default.prototype.run(e),(new a.default).execute(e)}})},function(e,t,i){i(76);var n=i(1),a=i(16),s=i(475),o=i(11),r=i(19);t.default=a.default.extend({template:s.default,openEvent:"billing:payment:cardSelectModalOpen",regionEnabled:!0,mobileModal:!0,savedCards:[],withApplePay:!1,subscriptionSpasiboPaymentCapability:!1,triggerAddNewCardOnCancel:!0,events:{"click .js-add-new-card":"addNewCard","click .js-change-card":"changeCard","click .js-spasibo-button":"showTabSpabibo"},initialize:function(){this.listenTo(o.default,"billing:payment:cardSelectModalClose",this.closeModal),this.mapiInfo=new r.default,this.subscriptionSpasiboPaymentCapability=this.mapiInfo.isSubscriptionSpasiboPaymentCapability()},beforeRender:function(e){e&&(e.paymentOption&&(this.savedCards=e.paymentOption.getSavedCards()),this.withApplePay=e.withApplePay)},render:function(){n("#js-pay-content").length&&a.default.prototype.render.call(this)},onShow:function(){this.$el.find(".js-perfect-scrollbar").perfectScrollbar()},beforeCancel:function(){a.default.prototype.beforeCancel.call(this),this.triggerAddNewCardOnCancel&&(o.default.trigger("billing:payment:addNewCard"),this.undelegateModalEvents())},addNewCard:function(){o.default.trigger("billing:payment:addNewCard"),this.triggerAddNewCardOnCancel=!1,this.triggerCancel()},changeCard:function(e){o.default.trigger("billing:payment:changeCard",n(e.target).val()),this.triggerAddNewCardOnCancel=!1,this.triggerCancel()},showTabSpabibo:function(){o.default.trigger("payment:show:spasibo"),this.closeModal()},serializeData:function(){return{savedCards:this.savedCards,withApplePay:this.withApplePay,subscriptionSpasiboPaymentCapability:this.subscriptionSpasiboPaymentCapability}},closeModal:function(){this.triggerAddNewCardOnCancel=!1,this.triggerCancel()}})},function(e,t,i){function n(e){return a.default.render('<div class="ivi-modal-wrapper-content pay-modal"> <span class="title">Выберите карту</span> <div class="viewport js-perfect-scrollbar"> {% for card in savedCards %} <label class="presaved-card {{ card.type }}"> <input type="radio" class="js-change-card" name="card_selected" {% if loop.first %} checked="checked" {% endif %} value="{{ card.id }}"> <span class="number">{{ card.number }}</span> <span class="icon"></span> </label> {% endfor %} </div> <div class="ivi-button large add-card js-add-new-card">Добавить новую карту</div> {% if withApplePay|default(false) %} <div class="js-apple-pay-button apple-pay-button apple-pay-button-black"></div> {% endif %} {% if subscriptionSpasiboPaymentCapability|default(false) %} <div class="js-spasibo-button ivi-button large sberbank offset-pay-button spasibo-button">Списать бонусы СПАСИБО</div> {% endif %} <span class="ivi-modal-close js-modal-close">Закрыть</span></div>',e)}var a=i(2);t.default=n},function(e,t,i){var n=i(1),a=i(16),s=i(477);t.default=a.default.extend({template:s.default,openEvent:"billing:payment:errorModalOpen",regionEnabled:!0,mobileModal:!0,message:"",beforeRender:function(e){this.message=e},onRender:function(){n(".js-modal-close").focus()},serializeData:function(){return{message:this.message}}})},function(e,t,i){function n(e){return a.default.render('<div class="ivi-modal-wrapper-content pay-warning-modal"> <span class="title">Внимание</span> <span class="text"> <span>{{ message }}</span> </span> <div class="ivi-button large js-modal-close">ОК</div></div>',e)}var a=i(2);t.default=n},function(e,t,i){function n(e){return a.default.render('<div class="js-loader loader-block"> <div class="loader-icon"></div></div>',e)}var a=i(2);t.default=n},function(e,t,i){function n(e){return a.default.render('<span class="error-message">Оплата недоступна</span><div class="support"> <span>К сожалению, попытка оплаты не удалась. Попробуйте произвести оплату <a href="">еще раз</a>.</span></div>',e)}var a=i(2);t.default=n},function(e,t,i){var n=i(1),a=i(481),s=function(){function e(){this.promoAction=null}return e.prototype.setFirstPromoAction=function(e){this.promoAction=e},e.prototype.preparePromoActions=function(){var e=[],t={};t.certificate=new a.default;for(var i=this.promoAction;null!==i;)i.prepare(t,e),i=i.getNext();return n.when.apply(n,e)},e.prototype.applyPromoAction=function(e){return null!==this.promoAction&&this.promoAction.execute(e)},e}();t.default=s},function(e,t,i){var n=i(21),a=i(114),s=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t.prototype.buildUrl=function(e){return e},t.prototype.check=function(e){return this.mapiGet({uri:t.CHECK_URI,data:{key:e}})},t.prototype.activate=function(e){return this.mapiPost({uri:t.ACTIVATE_URI,data:{key:e}})},t.ACTIVATE_URI="/ajax/cert/activate",t.CHECK_URI="/ajax/cert/check",t}(a.default);t.default=s},function(e,t,i){function n(e){return a.default.render('<div class="fullscreen-popup fullscreen-popup_active fullscreen-popup_has-close-view-button"> <div class="fullscreen-popup__overlay"> <span></span> <span></span> <span></span> </div> <div class="fullscreen-popup__scroll-wrapper"> <div class="fullscreen-popup__wrapper"> <a class="fullscreen-popup__close-view-button js-cancel" href="#" title="Нажмите, чтобы закрыть форму"> Закрыть Окно </a> <div class="long-trial long-trial_gift"> <div class="long-trial-inner"> <div class="long-trial__icon__wrapper"> <div class="long-trial__icon long-trial_gift__icon"> <span></span><span></span><span></span> </div> </div> {% if type == "trialformaster" %} <div class="long-trial__image long-trial__image_narrow long-trial__image_mastercard"> <img src="{{ app.config.static.host }}/images/main/components/long-trial/logo_mastercard.svg" alt=""> </div> {% endif %} <div class="long-trial__title long-trial_gift__title"> <div class="long-trial_gift__title__inner">Вам подарок!</div> </div> <div class="long-trial__content long-trial_gift__content"> <div class="long-trial__card"> <div class="long-trial__card__title">Подписка ivi</div> {% if duration %} <div class="long-trial__card__duration"> <span class="long-trial__card__value">{{ duration }}</span> <span class="long-trial__card__unit">{{ declension.days(duration) }}</span> </div> {% endif %} </div> {% if type == "trialformaster" %} <div class="long-trial__card__caption">Суперпредложение от ivi и Mastercard: ваши любимые фильмы и сериалы без рекламы в отличном качестве</div> {% else %} <div class="long-trial__card__caption">Просмотр без рекламы, дополнительный каталог, качество Full&nbsp;HD&nbsp;1080 и скачивание на мобильные устройства</div> {% endif %} <div class="long-trial__actions"> <a class="ivi-button huge js-activate" href="#">Получить подарок</a> </div> </div> {% if type == "trialformaster" %} <div class="long-trial__image long-trial__image_wide long-trial__image_mastercard"> <img src="{{ app.config.static.host }}/images/_main/long-trial/mastercard.svg" alt=""> </div> {% else %} <div class="long-trial__image long-trial__image_content"> <img src="{{ app.config.static.host }}/images/_main/long-trial/poster.png" alt=""> </div> {% endif %} </div> </div> </div> </div></div>',e)}var a=i(2);t.default=n},function(e,t,i){function n(e){return a.default.render('{% set subscriptionRenewalPriceWithCurrency = internationalExpansion.getPriceWithCurrency(subscriptionPurchase.getRenewalPrice()|money_format, " ", subscriptionPurchase.getRenewalPrice()) %}<div class="fullscreen-popup"> <div class="fullscreen-popup__overlay"> <span></span> <span></span> <span></span> </div> <div class="fullscreen-popup__wrapper"> <a class="fullscreen-popup__close-view-button js-close" href="#" title="Нажмите, чтобы закрыть форму"> Закрыть Окно </a> <div class="long-trial long-trial_success"> <div class="long-trial-inner"> <div class="long-trial__icon__wrapper"> <div class="long-trial__icon long-trial_success__icon"> <span></span><span></span><span></span> </div> </div> <div class="long-trial__title long-trial_success__title"> <div class="long-trial_success__title__inner">Подписка ivi успешно активирована на&nbsp;{{ duration }}&nbsp;{{ declension.days(duration) }}!</div> </div> <div class="long-trial__content long-trial_success__content"> <div class="long-trial__advantages"> <div class="long-trial__advantages__caption">Теперь вам стали доступны:</div> <ul class="long-trial__advantages__list"> <li class="long-trial__advantages__item long-trial__advantages__item_no-ads">Просмотр без&nbsp;рекламы</li> <li class="long-trial__advantages__item long-trial__advantages__item_catalog">Еще больше фильмов и&nbsp;сериалов</li> <li class="long-trial__advantages__item long-trial__advantages__item_hd">Качество Full&nbsp;HD&nbsp;1080</li> <li class="long-trial__advantages__item long-trial__advantages__item_gift">Фильм в&nbsp;подарок каждую неделю</li> <li class="long-trial__advantages__item long-trial__advantages__item_download">Скачивание на&nbsp;мобильные устройства</li> </ul> </div> <div class="long-trial__actions"> <a class="ivi-button huge js-close" href="#">Продолжить</a> </div> </div> <div class="long-trial__conditions"> <div class="long-trial__conditions__inner">Если вам всё понравится, с {{ internationalExpansion.getLocalDateTime(subscriptionPurchase.getSubscriptionExpireDate())|date("d.m.Y") }} стоимость подписки составит {{ subscriptionRenewalPriceWithCurrency }} в месяц. Отключить продление можно в любой момент в разделе «Мой ivi».</div> </div> </div> </div> </div></div>',e)}var a=i(2);t.default=n},function(e,t,i){var n=i(21),a=i(253),s=i(485),o=i(20),r=i(19),l=i(3),d=i(11),u=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t.prototype.getTrialType=function(){return"trialformaster"},t.prototype.loadMapiParams=function(){var e=new r.default;this.showModalInterval=e.getTrialForBuyersPopupShowInterval(),this.certificateDuration=e.getTrialForMastercardDuration(),e.isTrialForMastercardActive()&&(this.certificateKey="trial_for_mastercard")},t.prototype.prepareView=function(){new s.default({model:this}).listen(d.default)},t.prototype.execute=function(e){if(e.purchase){var t=this.purchaseList.findWhere({id:e.purchase.get("purchase_id")});if(this.check(t)&&t.isPaidByMastercard())return d.default.trigger("billing:mastercardTrial:modal",{redirectUrl:e.redirectUrl,grootParams:e.grootParams,grootPageOnClose:l.default.getSuperProperty("page")}),o.default.setMastercardTrialModalShowTime(Date.now()),l.default.rewriteSuperProperties({page:this.getTrialType()}),l.default.track("page_view",e.grootParams),!0}return null!==this.next&&this.next.execute(e)},t.prototype.getLastModalShowTime=function(){return o.default.getMastercardTrialModalShowTime()},t}(a.default);t.default=u},function(e,t,i){var n=i(255);t.default=n.default.extend({modalId:"js-mastercard-trial",openEvent:"billing:mastercardTrial:modal"})},function(e,t,i){var n=i(1),a=i(0),s=i(7),o=i(487);t.default=a.View.extend({el:"#js-pay-content",events:{"click #js-reg":"regClick","click #js-auth":"authClick"},render:function(e){this.$el.html(o.default(e)),n(".pay-block").addClass("success"),n(".js-pay-success-block").removeClass("hidden"),n(".js-pay-success-message").css("display","block"),n(".js-agreement").hide()},regClick:function(){return s.default.trigger("auth:showRegModal"),!1},authClick:function(){return s.default.trigger("auth:showLoginModal"),!1}})},function(e,t,i){function n(e){return a.default.render('<div class="pay-success"> <span class="title"> {% if objectType == "subscription" %} Зарегистрируйтесь, чтобы управлять подпиской! {% elseif (objectType == "content" or objectType == "collection") %} Зарегистрируйтесь, чтобы не потерять покупку! {% endif %} </span> {% if isWorld %} <span class="info"> Регистрация дает возможность использовать профиль ivi на нескольких компьютерах с общими покупками, историей просмотров, списком «Смотреть позже» и персональными рекомендациями. </span> {% else %} <span class="info"> Используйте покупки, историю просмотров, «Смотреть позже» и персональные рекомендации на разных устройствах: </span> <ul class="info"> <li>Популярных телевизоров Smart TV</li> <li>iPhone и iPad</li> <li>Android телефонов и планшетов</li> </ul> {% endif %} <a id="js-reg" href="#" class="ivi-button huge">Зарегистрироваться</a> <div class="action-link-wrapper"> <a id="js-auth" href="#" class="action-link">У меня есть аккаунт</a> </div></div>',e)}var a=i(2);t.default=n},function(e,t,i){function n(e){return a.default.render("Не удалось произвести платеж. Воспользуйтесь другой картой.",e)}var a=i(2);t.default=n},function(e,t,i){function n(e){return a.default.render("<span>Платеж принят и обрабатывается.</span><span>Это может занять несколько минут.</span>",e)}var a=i(2);t.default=n},function(e,t,i){function n(e){return a.default.render('<div class="apple-pay-header"> <div class="js-apple-pay-button apple-pay-button apple-pay-button-black"></div></div>',e)}var a=i(2);t.default=n},function(e,t,i){function n(e){return a.default.render('<div class="apple-pay-footer"> <div class="js-apple-pay-button apple-pay-button apple-pay-button-black apple-pay-button-with-text apple-pay-button-setup"> <span class="text">Set up</span> <span class="logo"></span> </div></div>',e)}var a=i(2);t.default=n},function(e,t,i){function n(e){return a.default.render("Не удалось произвести оплату. Пожалуйста, повторите попытку или используйте другой способ оплаты",e)}var a=i(2);t.default=n},function(e,t,i){function n(e){return a.default.render('<p class="apple-pay-info"> Платеж через Apple Pay обрабатывается</p>',e)}var a=i(2);t.default=n},function(e,t,i){var n=i(1),a=i(163),s=i(495),o=i(93),r=i(116),l=i(5),d=i(496),u=i(11),c=i(3),p=i(497),f=i(498),h=i(4),g=i(257);t.default=o.default.extend({name:"sms",bindings:{"#sn":{observe:"sn",setOptions:{validate:!0}}},currentTpl:null,model:new s.default,events:{"input #sn":"formatNumberInput","copy #sn":"copyNumberInput","cut #sn":"copyNumberInput","click #change-phone":"changePhoneClick","click #purchase-submit":"purchaseClick","click #change-cards":"changeCardsClick"},timer:null,waitTimer:null,waitTimerLimit:99,timerTplAdditionalDescriptions:{video:"Ответьте на него и фильм станет доступным для просмотра.",animation:"Ответьте на него и мультфильм станет доступным для просмотра.",compilation:"Ответьте на него и сериал станет доступным для просмотра.",collection:"Ответьте на него и коллекция станет доступна для просмотра.",subscription:"Ответьте на него для подключения подписки."},initialize:function(e){o.default.prototype.initialize.call(this,e),r.bind(this,{forceUpdate:!0}),this.model.bind("validated:valid",this.enableButton.bind(this)),this.model.bind("validated:invalid",this.disableButton.bind(this)),this.showPhoneInput(),this.listenTo(u.default,"purchase:sms:status",this.checkStatus)},enableButton:function(){this.$("#purchase-submit").removeClass("disabled").removeAttr("disabled")},disableButton:function(){this.$("#purchase-submit").addClass("disabled").attr("disabled","disabled")},getTpl:function(){return this.currentTpl},render:function(){o.default.prototype.render.call(this,this.options),this.stickit(),this.timer&&(clearTimeout(this.timer),this.timer=null)},reset:function(){this.model.set("sn","+7"),clearInterval(this.waitTimer),this.showPhoneInput()},formatNumberInput:function(){var e=n("#sn"),t=e.val().trim();t=t.replace(/[^+\d]/g,"").replace(/^\+7 ?(\d{10})(.+)$/,"+7 $1").replace(/^\+7 ?(\d{3})(\d)/,"+7 $1  $2").replace(/^\+7 ?(\d{3}  \d{3})(\d)/,"+7 $1 $2").replace(/^\+7 ?(\d{3}  \d{3} \d{2})(\d)/,"+7 $1 $2"),t.length>this.model.getMaxPhoneNumber()&&(t=t.slice(0,this.model.getMaxPhoneNumber()-1)),e.val(t)},copyNumberInput:function(e){var t,i,a,s,o,r=e.originalEvent.clipboardData||h.default.getClipboardData(),l=n("#sn");if(r&&(t=l.get(0),s=t.selectionStart,o=t.selectionEnd,i=l.val(),a=i.substr(s,o-s).replace(/[^\d\+]/g,""),r.setData("Text",a),(r.getData("Text")||r.getData("text/plain"))===a&&(e.preventDefault(),"cut"===e.type))){var d=i.substr(0,s)+i.substr(o);l.val(d),this.model.set("sn",d),this.model.validate(),this.formatNumberInput()}},showPhoneInput:function(){n(".pay-card-block").removeClass("error");var e=l.first(this.getPaymentOption().where({ps_method:"sms",payment_system_account:null}));e&&(this.options={paymentOption:e.toJSON()}),this.options=this.extendTemplateParams(this.options),this.currentTpl=p.default,this.render(),this.model.get("sn")&&this.enableButton(),setTimeout(function(){n("#sn").val("+7").focus()},0)},showTimer:function(){var e=this,t=this.waitTimerLimit;this.options.phone=this.model.getPhoneForDisplay(),this.options=this.extendTemplateParams(this.options),this.options.timerAdditionalDescription=this.getTimerTplAdditionalDescription(),this.options.waitTimerLimit=t,this.currentTpl=f.default,this.render(),this.waitTimer=setInterval(function(){n(".loader-icon").attr("data-time",--t),t||(clearInterval(e.waitTimer),e.showError())},1e3)},showError:function(){var e={reason:this.name};l.extend(e,this.options.groot,this.options.paymentOption.groot),c.default.track("payment_error",e),u.default.trigger("purchase:finished_error"),n(".pay-block").addClass("error"),this.options.phone=this.model.getPhoneForDisplay(),this.options=this.extendTemplateParams(this.options),this.currentTpl=d.default,this.render(),this.changeCardTabState(this.paymentOption.isCardAvailable())},changePhoneClick:function(){return u.default.trigger("payment:option:select","sms"),this.reset(),this.render(),!1},purchaseClick:function(){return this.changeCardTabState(!1),u.default.trigger("purchase:sms",this.model.get("sn").replace(/\D/g,""),this.options.paymentOption),!1},checkStatus:function(e,t){var i=this;e.get("error")||"error"===e.get("status")?this.showError():"new"===e.get("status")?(this.showTimer(),i.timer=setInterval(function(){(new a.default).mapiGet({data:{id:e.get("credit_id")}}).done(function(n){n.result&&"fail"!==n.result.status?"ok"===n.result.status&&(i.triggerEventSuccessEvent(e,t),clearTimeout(i.timer),clearTimeout(i.waitTimer),i.timer=null,i.waitTimer=null):(i.showError(),clearTimeout(i.timer),clearTimeout(i.waitTimer),i.timer=null,i.waitTimer=null)})},1e4)):"ok"===e.get("status")&&(i.triggerEventSuccessEvent(e,t),clearTimeout(i.waitTimer),i.waitTimer=null)},triggerEventSuccessEvent:function(e,t){u.default.trigger("purchase:success",e,t),n(".pay-menu").removeAttr("disabled"),this.changeCardTabState(this.paymentOption.isCardAvailable())},changeCardTabState:function(e){e?n(".pay-menu").removeAttr("disabled"):(n("#card").prop("disabled","disabled"),n("#spasibo").prop("disabled","disabled")),n(".js-pay-header").replaceWith(g.default({isCardAvailable:e,isSmsAvailable:!0,isSpasiboAvailable:e&&this.isSpasiboAvailable,isLongSubscription:this.isLongSubscription,subscriptionSpasiboPaymentCapability:this.mapiInfo.isSubscriptionSpasiboPaymentCapability()}))},changeCardsClick:function(){return u.default.trigger("payment:option:select","card"),!1},getTimerTplAdditionalDescription:function(){return this.timerTplAdditionalDescriptions[this.payType]?this.timerTplAdditionalDescriptions[this.payType]:""}})},function(e,t,i){var n=i(0);t.default=n.Model.extend({validation:{sn:{required:!0,length:17,pattern:/^\+\d (\d{3})  (\d{3}) (\d{2}) (\d{2})$/}},getPhoneForDisplay:function(){return"+7 "+this.get("sn").replace(this.validation.sn.pattern,"$1 $2-$3-$4")},getMaxPhoneNumber:function(){return this.validation.sn.length}})},function(e,t,i){function n(e){return a.default.render('<span class="error-message">Ошибка оплаты с номера <span class="phone">{{ phone }}.</span></span><div class="support"> <span>Оплатите покупку, используя <a id="change-cards" href="#">банковскую карту</a> или <a id="change-phone" href="#">другой номер телефона</a>.</span></div>',e)}var a=i(2);t.default=n},function(e,t,i){function n(e){return a.default.render('<form class="pay-form"> <fieldset> <div class="phone-number"> <span>Введите номер мобильного телефона</span> <input id="sn" type="text" value=""> </div> </fieldset> <div class="payment-security"> <span> <span class="security-guarantee"></span> Гарантия безопасности </span> </div> <div class="button-wrapper"> <input id="purchase-submit" type="submit" class="ivi-button huge disabled" value="{{ payButtonTitle }}" disabled="disabled"> </div></form>',e)}var a=i(2);t.default=n},function(e,t,i){function n(e){return a.default.render('<div class="loader-block"> <div class="loader-icon" data-time="{{ waitTimerLimit }}"></div> <span>В течение {{ waitTimerLimit }} секунд на номер <em>{{ phone }}</em> будет доставлено SMS с просьбой подтвердить</span> <span>платеж на сумму {{ internationalExpansion.getPriceWithCurrency(paymentOption.user_price) }} {{ timerAdditionalDescription }}</span></div>',e)}var a=i(2);t.default=n},function(e,t,i){var n=i(115),a=i(93),s=i(11),o=i(164);t.default=n.default.extend({name:"spasibo",currentTpl:o.default,options:null,events:{},purchaseData:{},timer:null,initialize:function(e){a.default.prototype.initialize.call(this,e),this.paymentOption=e.paymentOptionListSpasibo,this.listenTo(s.default,"purchase:spasibo:status",this.checkStatus),this.postMessageHandlerBinded=this.postMessageHandler.bind(this)},reset:function(){this.options=this.getFreeCard(),this.showFreeCard(),this.timer&&(clearTimeout(this.timer),this.timer=null)},showFreeCard:function(){this.currentTpl=o.default,s.default.trigger("purchase:spasibo",this.options)}})},function(e,t,i){var n=i(1),a=i(5),s=i(0),o=i(116),r=i(501),l=i(8),d=i(7),u=i(11),c=i(43),p=i(3),f=i(28);t.default=s.View.extend({el:"#payment-credentials-input-block",$submitButton:null,$input:null,inputType:null,inputValue:null,paymentClicked:!1,grootPaymentParams:{},savedPaymentCredentials:null,events:{"input .js-payment-credentials-input":"validateInput","click .js-submit":"processSubmit","submit form":"processSubmit","click .js-has-credentials .receipt__value":"showInput","click .js-no-credentials .receipt__text":"toggleInputExpanded"},initialize:function(){this.emailModel=new(s.Model.extend({validation:{email:{required:!0,pattern:"email"}}})),o.bind(this,{model:this.emailModel}),this.currentCountryCode=c.default.getCountryCode(),n(window).on("message",this.postMessageHandler.bind(this)),this.listenTo(u.default,"payment:payment_groot_params_ready",this.setGrootPaymentParams),this.listenTo(u.default,"purchase:sms",this.processSmsPayment),this.listenTo(u.default,"payment:option:select",this.processPaymentOptionSelect),this.listenTo(u.default,"purchase:success",this.hideForm)},setGrootPaymentParams:function(e){this.grootPaymentParams=e},getGrootParams:function(e){void 0===e&&(e=!1);var t=a.clone(this.grootPaymentParams);return e&&(t.is_empty=!Boolean(this.$input.val())),t},showInput:function(){this.$(".js-no-credentials").show().addClass("expanded"),this.$(".js-has-credentials").hide(),p.default.track("payment_credentials_open",this.getGrootParams(!0))},hideInput:function(){this.$(".js-no-credentials").hide().removeClass("expanded"),this.$(".js-has-credentials").show(),p.default.track("payment_credentials_close",this.getGrootParams(!0))},toggleInputExpanded:function(){var e=this.$(".js-no-credentials");this.savedPaymentCredentials?e.hasClass("expanded")?this.hideInput():this.showInput():(e.hasClass("expanded")?p.default.track("payment_credentials_close",this.getGrootParams(!0)):p.default.track("payment_credentials_open",this.getGrootParams(!0)),e.toggleClass("expanded"))},disableForm:function(){this.$submitButton&&this.$input&&(this.$submitButton.addClass("disabled"),this.$input.attr("disabled","disabled"))},enableForm:function(){this.$submitButton&&this.$input&&(this.$submitButton.removeClass("disabled"),this.$input.removeAttr("disabled"))},render:function(){l.default.getEmail()||l.default.getPhoneNumber()||(this.savedPaymentCredentials=f.default.escapeText(this.getPaymentCredentials()),this.$el.html(r.default({savedPaymentCredentials:this.savedPaymentCredentials,hasCredentials:!!this.savedPaymentCredentials})),this.$submitButton=this.$(".js-submit"),this.$input=n(".js-payment-credentials-input"),this.savedPaymentCredentials&&this.$input.val(this.savedPaymentCredentials).trigger("input"))},getPaymentCredentials:function(){var e=l.default.getPaymentCredentials();return e?e.email?e.email:e.msisdn?e.msisdn:"":""},validateInput:function(e){var t=!1,i=!1;this.inputType=null,this.inputValue||p.default.track("payment_credentials_typein",this.getGrootParams()),this.inputValue=n(e.currentTarget).val().trim(),this.emailModel.set("email",this.inputValue),t=this.emailModel.isValid(!0),t?(this.inputType="email",this.$submitButton.removeClass("disabled")):(i=this.validatePhone(this.inputValue),i?(this.inputType="phone",this.$submitButton.removeClass("disabled")):this.$submitButton.addClass("disabled"))},validatePhone:function(e){return!(e.indexOf("+")>0||e.indexOf("+")!==e.lastIndexOf("+")||/[^\d-\+\s\(\)]/.test(e))&&(e=e.replace(/[^0-9]/g,""),this.inputValue=e,e.length>=11&&e.length<=15)},processSubmit:function(){var e=this;if(this.$submitButton.hasClass("disabled"))return!1;this.disableForm();var t=this.getGrootParams();return a.extend(t,(i={},i[this.inputType]=this.inputValue,i)),p.default.track("payment_credentials_send",t),"RU"===this.currentCountryCode&&"phone"===this.inputType&&"8"===this.inputValue.charAt(0)&&11===this.inputValue.length&&(this.inputValue="7"+this.inputValue.substring(1)),this.listenToOnce(d.default,"user:paymentCredentialsChanged",function(t){t||e.savedPaymentCredentials?(t&&(e.$(".js-has-credentials .receipt__value").text(e.inputValue),e.$input.val(e.inputValue),e.savedPaymentCredentials=e.inputValue),e.hideInput()):e.$(".js-no-credentials").removeClass("expanded"),e.enableForm()}),l.default.setPaymentCredentials((n={},n[this.inputType]=f.default.escapeText(this.inputValue),n)),!1;var i,n},postMessageHandler:function(e){"groot:payment_initiate_click"===e.originalEvent.data?(this.disableForm(),this.paymentClicked=!0):"iframe:ready"===e.originalEvent.data&&this.paymentClicked&&(this.enableForm(),this.paymentClicked=!1)},processSmsPayment:function(){this.disableForm(),this.paymentClicked=!0},processPaymentOptionSelect:function(){this.paymentClicked&&(this.enableForm(),this.paymentClicked=!1)},hideForm:function(){this.$el.hide()}})},function(e,t,i){function n(e){return a.default.render('<div class="receipt"> {% set inputDisplay = "block" %} {% set savedCredentialsDisplayStyle = "block" %} {% if hasCredentials %} {% set inputDisplayStyle = "none" %} {% else %} {% set savedCredentialsDisplayStyle = "none" %} {% endif %} {# Вариант когда имейл или телефон не сохранены #} <div class="receipt__inner js-no-credentials" style="display: {{ inputDisplayStyle }}"> <div class="receipt__text"> <span class="receipt__value"> Укажите email или номер телефона </span> </div> <span class="receipt__label">чтобы получить чек</span> <div class="receipt__form"> <form> <span class="ivi-input"> <input type="text" class="js-payment-credentials-input" maxlength="255" placeholder="Введите email или телефон"> </span> <span class="ivi-button large disabled js-submit">Сохранить</span> </form> </div> </div> {# Вариант когда имейл или телефон были сохранены ранее #} <div class="receipt__inner js-has-credentials" style="display: {{ savedCredentialsDisplayStyle }}"> <div class="receipt__text filled"> <span class="receipt__value"> {{ savedPaymentCredentials }} </span> </div> <span class="receipt__label">для отправки чека</span> </div></div>',e)}var a=i(2);t.default=n},function(e,t,i){var n=i(12),a=i(259),s=i(9);t.default=s.default.extend({routes:["/buy/cardbind"],run:function(e){n.default.prototype.run(e),(new a.default).execute(e)}})},function(e,t,i){var n=i(12),a=i(504),s=i(9);t.default=s.default.extend({routes:["/buy/changecard"],run:function(e){n.default.prototype.run(e),(new a.default).execute(e)}})},function(e,t,i){var n=i(84),a=i(60),s=i(505),o=i(78),r=i(79),l=i(4);t.default=n.default.extend({doIt:function(){var e=this,t=new a.default;t.fetchChangeCardOptions().done(function(){var i=t.getChangeCardOption();i?e.showPayment(i.getOptionHash(),t):l.default.redirect(e.queryParams.redirect_url)})},showPayment:function(e,t){var i=t.getPurchaseOptionList().findProduct(e);if(i){var n=new s.default({paymentOptionList:new r.default(i),queryParams:this.queryParams,price:i.getMinUserPrice(),payType:"1"===this.queryParams.new?"bindCard":"changeCard"});n.reset(),n.render()}else(new o.default).render()},success:function(){l.default.redirect(this.queryParams.redirect_url)}})},function(e,t,i){var n=i(115),a=i(20);t.default=n.default.extend({reset:function(){var e=a.default.getChangeCardAccountId();e?(this.options=this.getPaymentOption().getByPsAccountId(e),"get"in this.options&&(this.options.get("purchase_params").landing_name="change-card")):this.options=this.getFreeCard(),this.showFreeCard(),this.timer&&(clearTimeout(this.timer),this.timer=null)},showLanding:function(){}})},function(e,t,i){var n=i(12),a=i(262),s=i(9);t.default=s.default.extend({routes:["/buy/addcard"],run:function(e){n.default.prototype.run(e),(new a.default).execute(e)}})},function(e,t,i){var n=i(12),a=i(508),s=i(9);t.default=s.default.extend({routes:["/buy/sberbank"],run:function(e){n.default.prototype.run(e),(new a.default).execute(e)}})},function(e,t,i){var n=i(262),a=i(509),s=i(513);t.default=n.default.extend({promoActions:[a.default],getCardBindView:function(){return new s.default},cardBindSuccess:function(){var e=this;this.promoActionService.preparePromoActions().done(function(){e.promoActionService.applyPromoAction({redirectUrl:e.queryParams.redirect_url,supportPhone:e.supportPhone})||n.default.prototype.cardBindSuccess()})}})},function(e,t,i){var n=i(21),a=i(5),s=i(254),o=i(19),r=i(8),l=i(263),d=i(80),u=i(264),c=i(511),p=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.noSberbankCertificateKey=null,t.noSberbankHoldersDuration="",t.psAccounts=null,t.cardsInfo=null,t}return n.__extends(t,e),t.prototype.loadMapiParams=function(){var e=new o.default;this.certificateDuration=e.getSberbankHoldersDuration(),this.noSberbankHoldersDuration=e.getNoSberbankHoldersDuration(),e.isSberbankCertificateActive()&&(this.certificateKey="sber_holder"),e.isNoSberbankCertificateActive()&&(this.noSberbankCertificateKey="nosber_holder")},t.prototype.prepare=function(t,i){e.prototype.prepare.call(this,t,i),t.psAccounts||(t.psAccounts=new l.default,i.push(t.psAccounts.load())),t.cardsInfo||(t.cardsInfo=new u.default,i.push(t.cardsInfo.load())),this.psAccounts=t.psAccounts,this.cardsInfo=t.cardsInfo},t.prototype.execute=function(t){var i,n,s,o=this,l=this.psAccounts.getCards(),u=a.find(l,function(e){return e.isSberbankCard()});return u?(i=u,n=this.getCertificateKey(),s=this.getCertificateDuration()):l.length&&l[0]&&(i=l[0],n=this.noSberbankCertificateKey,s=this.noSberbankHoldersDuration),i&&n&&s?(this.getCertificateModel().activate(n).done(function(){switch(o.getCertificateModel().get("status")){case"success":var e=new d.default;e.mapiGet().done(function(){var n=e.createSubscriptionPurchaseObject();(new c.default).render({redirectUrl:t.redirectUrl,durationInDays:s,card:i,cardsInfo:o.cardsInfo,subscriptionPurchase:n,isAuthenticated:r.default.isAuthenticated()})});break;default:(new c.default).render({redirectUrl:t.redirectUrl,supportPhone:t.supportPhone,durationInDays:s,card:i,cardsInfo:o.cardsInfo,subscriptionPurchase:null,isAuthenticated:r.default.isAuthenticated()})}}).fail(function(){(new c.default).render({redirectUrl:t.redirectUrl,supportPhone:t.supportPhone,durationInDays:s,card:i,cardsInfo:o.cardsInfo,subscriptionPurchase:null,isAuthenticated:r.default.isAuthenticated()})}),!0):e.prototype.execute.call(this,t)},t}(s.default);t.default=p},function(e,t,i){var n=i(0);t.default=n.Model.extend({getLogoUrl:function(){return this.get("logo_url")},getTypeLogo:function(){return this.get("type_logo")},getTitle:function(){return this.get("title")},getInkColor:function(){return this.get("ink_color")},getGradStart:function(){return this.get("grad_start")},getGradEnd:function(){return this.get("grad_end")}})},function(e,t,i){var n=i(1),a=i(0),s=i(512),o=i(4),r=i(8),l=i(7);t.default=a.View.extend({el:".page-wrapper",events:{"click .js-auth":"authClick","click .js-watch":"watchClick"},redirectUrl:null,render:function(e){this.redirectUrl=e.redirectUrl,this.listenTo(l.default,"auth:modal:closed",this.authenticatedRedirect),n("body").addClass("subscription-period"),this.$el.html(s.default(e))},authClick:function(){return l.default.trigger("auth:showLoginModal"),!1},authenticatedRedirect:function(){r.default.isAuthenticated()&&this.watchClick()},watchClick:function(){return o.default.redirect(this.redirectUrl),!1}})},function(e,t,i){function n(e){return a.default.render('<div class="bg-triangles"> <span></span> <span></span> <span></span></div><div class="subscription-period__content subscription-period_success__content"> <div class="subscription-period__content-inner"> <div class="subscription-period__image"><img src="{{ app.config.static.host }}/images/landing/multipage/bg_4.png" alt=""></div> {% if subscriptionPurchase is null %} <div class="subscription-period__column subscription-period__column_content subscription-period__column_with-icon"> <div class="subscription-period_success__title subscription-period_success__title_error">Подписку ivi<br /> подключить&nbsp;не&nbsp;удалось</div> <div class="subscription-period__text"> <p>Мы не&nbsp;смогли подключить подписку в&nbsp;рамках акции со&nbsp;Сбербанком. Пожалуйста, напишите в&nbsp;<a href="mailto:support@ivi.ru" class="ivi-link ivi-link_chaf">службу поддержки</a> или позвоните по&nbsp;номеру <span class="subscription-period__text-phone">{{ supportPhone }}</span></p> <p>Не&nbsp;расстраивайтесь, мы обязательно решим вашу проблему.</p> </div> <div class="subscription-period__actions"> <a href="mailto:support@ivi.ru" class="ivi-button large subscription-period__actions-button">Написать в службу поддержки</a> </div> </div> {% else %} {% set subscriptionRenewalPriceWithCurrency = internationalExpansion.getPriceWithCurrency(subscriptionPurchase.getRenewalPrice()|money_format, " ", subscriptionPurchase.getRenewalPrice()) %} <div class="subscription-period__column subscription-period__column_content"> <div class="subscription-period_success__title">Подписка ivi<br /> на&nbsp;{{ durationInDays }}&nbsp;{{ declension.days(durationInDays) }} в&nbsp;подарок</div> {% if card.isSberbankCard() %} <div class="subscription-period__text"> <p> <span class="subscription-period__text-line">{{ internationalExpansion.getLocalDateTime(subscriptionPurchase.getSubscriptionExpireDate())|locale_date("d MMMM Y") }} произойдет автоматическое продление.</span> <span class="subscription-period__text-line">Cумма списания составит {{ subscriptionRenewalPriceWithCurrency }}.</span> </p> <p>Отмена продления в&nbsp;любой момент.</p> </div> {% else %} <div class="subscription-period__notice">Вы привязали карту, на&nbsp;которую не&nbsp;распространяется <a href="https://sberbank.ivi.ru" class="ivi-link ivi-link_chaf">акция&nbsp;со&nbsp;Сбербанком</a></div> <div class="subscription-period__text"> <p>Не&nbsp;расстраивайтесь, мы всё&nbsp;равно решили подарить вам {{ durationInDays }}&nbsp;{{ declension.days(durationInDays) }} подписки&nbsp;ivi, наслаждайтесь просмотром. {{ internationalExpansion.getLocalDateTime(subscriptionPurchase.getSubscriptionExpireDate())|locale_date("d MMMM Y") }}&nbsp;произойдет автоматическое продление подписки&nbsp;ivi за&nbsp;{{ subscriptionRenewalPriceWithCurrency }}.</p> <p>Отмена продления в&nbsp;любой момент.</p> </div> {% endif %} <div class="subscription-period__actions"> {% if isAuthenticated %} <a href="#" class="ivi-button large subscription-period__actions-button js-watch">Смотреть фильмы по подписке</a> {% else %} <div class="notice-block"> <div class="notice-block__title">Зарегистрируйтесь, чтобы&nbsp;не&nbsp;потерять подписку&nbsp;ivi</div> <div class="notice-block__note">После регистрации вы сможете пользоваться подпиской на&nbsp;всех доступных устройствах</div> <div class="notice-block__actions"> <div class="notice-block__actions-item"><a href="#" class="ivi-button medium js-auth">Зарегистрироваться или войти</a></div> <div class="notice-block__actions-item"><a href="#" class="ivi-button medium outline js-watch">Смотреть фильмы по подписке</a></div> </div> </div> {% endif %} </div> </div> {% endif %} <div class="subscription-period__column subscription-period__column_partner subscription-period__partner"> <div class="subscription-period__partner-title">Ваша карта</div> <div class="subscription-period__partner-block"> {% set bankInfo = cardsInfo.getBankInfo(card.getCardBankKey()) %}{% set psTypeInfo = cardsInfo.getPsTypeInfo(card.getPsType()) %}<div data-id="{{ card.getId() }}" class="payment-card js-card-account {% if card.isCardExpired() %} payment-card_expired{% endif %} {% if card.isCardExpiring() %} payment-card_expiring{% endif %} {% if showCardDeactivate|default(false) %} payment-card_with-delete{% endif %} {% if showCardAsLink|default(false) %} payment-card_link{% endif %}"> <div class="payment-card__inner" style="color: {{ bankInfo.getInkColor() }}" > <div class="payment-card__background" style=" background: {{ bankInfo.getGradStart() }}; background: -moz-linear-gradient(33deg, {{ bankInfo.getGradStart() }}, {{ bankInfo.getGradEnd() }}); background: -webkit-linear-gradient(33deg, {{ bankInfo.getGradStart() }}, {{ bankInfo.getGradEnd() }}); background: linear-gradient(33deg, {{ bankInfo.getGradStart() }}, {{ bankInfo.getGradEnd() }}); "></div> {% if bankInfo.getLogoUrl() %} <div class="payment-card__bank-logo"> <img class="payment-card__bank-logo-image" src="{{ bankInfo.getLogoUrl() }}"> </div> {% endif %} <div class="payment-card__number">{{ card.getTitle() }}</div> <div class="payment-card__expired">{{ card.getCardExpiresDate()|card_validity|default("&nbsp;") }}</div> {% if psTypeInfo %} <div class="payment-card__system-type"> <img class="payment-card__system-type-image" src="{{ psTypeInfo[bankInfo.getTypeLogo()] }}"> </div> {% endif %} </div> {% if showCardDeactivate|default(false) %} <button class="payment-card__delete js-deactivate-card">Удалить карту</button> {% endif %} <div class="payment-card__caption">{{ bankInfo.getTitle() }}</div></div> </div> </div> </div></div>',e)}var a=i(2);t.default=n},function(e,t,i){var n=i(260),a=i(514);t.default=n.default.extend({payButtonTitle:"Привязать карту",renderPaymentError:function(){(new a.default).render()}})},function(e,t,i){var n=i(78),a=i(515);t.default=n.default.extend({getErrorText:function(){return a.default()}})},function(e,t,i){function n(e){return a.default.render('<span class="error-message">Привязка карты недоступна</span><div class="support"> <span>К сожалению, попытка привязки карты не удалась. Попробуйте <a href="">еще раз</a>.</span></div>',e)}var a=i(2);t.default=n},function(e,t,i){var n=i(12),a=i(517),s=i(9);t.default=s.default.extend({routes:["/buy/fund"],run:function(e){n.default.prototype.run(e),(new a.default).execute(e)}})},function(e,t,i){var n=i(205),a=i(518),s=i(84),o=i(78),r=i(162),l=i(11),d=i(3);t.default=s.default.extend({amount:null,paymentFormShown:!1,afterLogin:function(){s.default.prototype.afterLogin.call(this),this.amount=parseInt(this.queryParams.amount),this.amount&&l.default.trigger("payment:showPriceInHeader",this.amount)},doIt:function(){var e=this;this.balanceOptions=new a.default,this.balanceOptions.mapiGet().done(function(){e.showPayment()})},showPayment:function(){this.balanceOptions.models&&this.balanceOptions.models.length?(this.listenTo(l.default,"payment:option:select",this.paymentTabChange),this.balanceOptions.setUserPrice(this.amount),new r.default({paymentOptionList:this.balanceOptions,queryParams:this.queryParams,payType:this.getPayType()}),l.default.trigger("payment:show",this.balanceOptions)):(new o.default).render()},purchaseCard:function(e){var t=new n.default,i=e.get("purchase_params")||e.purchase_params;i.amount=this.queryParams.amount,t.mapiPost({data:i}).done(function(){l.default.trigger("purchase:card:status",t,e)}).fail(function(){l.default.trigger("purchase:card:status","error")})},purchaseSMS:function(e,t){var i=t.purchase_params||t.get("purchase_params");i.amount=this.queryParams.amount,i.ps_account=e;var a=t.groot||t.get("groot");this.from&&(a.from=this.from),d.default.track("payment_initiated",a),l.default.trigger("purchase:initiated");var s=new n.default;s.mapiPost({data:i}).done(function(){l.default.trigger("purchase:sms:status",s,t)}).fail(function(){l.default.trigger("purchase:sms:status","error",t)})},success:function(e,t){-1!==this.queryParams.redirect_url.indexOf("?")?this.queryParams.redirect_url+="&fund_success=1":this.queryParams.redirect_url+="?fund_success=1",s.default.prototype.success.call(this,e,t)},getPayType:function(){return"balance"},paymentTabChange:function(e){if(this.paymentFormShown){var t=this.balanceOptions.findWhere({ps_method:e}).get("groot");this.from&&(t.from=this.from),d.default.track("payment_form_select_click",t),l.default.trigger("payment:payment_groot_params_ready",t)}this.paymentFormShown=!0}})},function(e,t,i){var n=i(29),a=i(519),s=i(79),o=i(5);t.default=n.default.extend(s.default.prototype).extend({model:a.default,uri:"/billing/v1/balance/options/",sendUserABBucket:!0,constructor:function(){n.default.prototype.constructor.apply(this,arguments)},set:function(e,t){var i=n.default.prototype.set.call(this,e,t);return this.models.length&&(this.models=this.filterUnsupportedMethods(this.models),this.models=this.sortByIndex(this.models)),i},parse:function(e){return e.result?e.result.payment_options:[]},filterUnsupportedMethods:function(){var e=this;return o.filter(this.models,function(t){var i=o.findWhere(e.psList,{ps_method:t.get("ps_method")});return!!i&&(t.set(i),t.set("groot",{type:"add_funds",payment_method:i.ps_method}),!0)})},sortByIndex:function(e){return o.sortBy(e,function(e){return e.get("index")})},getParamsForGroot:function(){return{}},setUserPrice:function(e){o.each(this.models,function(t){t.set("user_price",e),t.get("groot")&&(t.get("groot").amount=e)})}})},function(e,t,i){var n=i(0);t.default=n.Model},function(e,t,i){var n=i(12),a=i(521),s=i(9);t.default=s.default.extend({routes:["/buy/subscription"],run:function(e){n.default.prototype.run(e),(new a.default).execute(e)}})},function(e,t,i){var n=i(84),a=i(60),s=i(4),o=i(80),r=i(522),l=i(8),d=i(10),u=i(1),c=i(79),p=i(11),f=i(162),h=i(78);t.default=n.default.extend({doIt:function(){var e=this,t=new a.default,i=this.mapiInfo.isEnableSubscriptionSpasiboScoringCapability()?t.fetchOptionsSpasiboScoring():t.fetchOptions(),n=new a.default,o=n.fetchOptionsSpasiboPayment();u.when(i,o).done(function(){if(e.queryParams.option_hash)e.showPayment(e.queryParams.option_hash,t,n);else{var i=t.getPurchaseOptionList();if(i){var a=i.getStandardSubscription();a?e.showPayment(a.getOptionHash(),t,n):s.default.redirect(e.queryParams.redirect_url)}else s.default.redirect(e.queryParams.redirect_url)}})},showPayment:function(e,t,i){var n=t.getPurchaseOptionList().findProduct(e),a=i.getPurchaseOptionList().findProduct(e);if(n){var s=!0;this.paymentOptionList=new c.default(n),a?(this.paymentOptionListSpasibo=new c.default(a),this.paymentOptionListSpasibo.setIsSpasibo(!0)):(this.paymentOptionListSpasibo=null,s=!1,u('.js-pay-header [data-method="spasibo"]').addClass("disabled")),this.listenTo(p.default,"payment:option:select",this.paymentTabChange),this.listenTo(p.default,"payment:show:spasibo",this.showTabSpabibo);var o=n.getMinUserPrice();new f.default({paymentOptionList:this.paymentOptionList,paymentOptionListSpasibo:this.paymentOptionListSpasibo,queryParams:this.queryParams,price:o,currency:n.getCurrency(),payType:this.getPayType(),isLongSubscription:n.isLongSubscription(),isSpasiboAvailable:s},s),"spasibo"===this.queryParams.tab&&this.paymentOptionListSpasibo?this.showTabSpabibo():p.default.trigger("payment:show",this.paymentOptionList)}else(new h.default).render()},afterSuccess:function(e,t,i){var n=this;this.initSuccessGTM();var a=new o.default;a.mapiGet().done(function(){var e=a.createSubscriptionPurchaseObject();if(e.hasSubscription()){var o=t.toJSON&&t.get?t.get("bonus_info"):t.bonus_info,u=void 0;u=-1!==n.queryParams.redirect_url.indexOf("watch")?n.queryParams.redirect_url:d.default.isWorld?"/":"/plus",(new r.default).render({subscriptionPurchase:e,isAuthenticated:l.default.isAuthenticated(),bonusInfo:i?o:null,redirectUrl:u})}else s.default.redirect(n.queryParams.redirect_url)}).fail(function(){s.default.redirect(n.queryParams.redirect_url)})},getPayType:function(){return"subscription"},showTabSpabibo:function(){p.default.trigger("payment:show",this.paymentOptionListSpasibo,!0),u("#js-pay-block").addClass("pay-block_spasibo-active")}})},function(e,t,i){var n=i(1),a=i(0),s=i(523),o=i(4),r=i(7);t.default=a.View.extend({el:".page-wrapper",events:{"click .js-auth":"authClick","click .js-watch":"watchClick"},redirectUrl:null,render:function(e){this.redirectUrl=e.redirectUrl,this.listenTo(r.default,"user:login",this.watchClick),n("body").addClass("subscription-period subscription-period_success"),this.$el.html(s.default(e))},authClick:function(){return r.default.trigger("auth:showLoginModal"),!1},watchClick:function(){return o.default.redirect(this.redirectUrl),!1}})},function(e,t,i){function n(e){return a.default.render('<div class="bg-triangles"> <span></span> <span></span> <span></span></div>{% set subscriptionPackageColors = { 1: "minimal", 3: "middling", 6: "popular", 12: "maximal" } %}{% set durationInMonth = subscriptionPurchase.getSubscriptionDurationInMonths() %}{% set subscriptionRenewalPriceWithCurrency = internationalExpansion.getPriceWithCurrency(subscriptionPurchase.getRenewalPrice()|money_format, " ", subscriptionPurchase.getRenewalPrice()) %}<div class="subscription-period__content subscription-period_success__content"> <div class="subscription-period__content-inner"> <div class="subscription-period__image"><img src="{{ app.config.static.host }}/images/landing/multipage/bg_4.png" alt=""></div> <div class="subscription-period_success__title">Подписка ivi успешно&nbsp;{% if hasSubscription %}продлена{% else %}подключена{% endif %}</div> <div class="subscription-period__details{% if subscriptionPackageColors[durationInMonth] is defined %} subscription-period__details_{{ subscriptionPackageColors[durationInMonth] }}{% endif %}"> <div class="subscription-period__duration"> <span class="subscription-period__duration-text">на {{ durationInMonth }} {{ declension.month(durationInMonth) }}</span> </div> <div class="subscription-period__reward"> {% if bonusInfo %} <span class="subscription-period__reward-cash">+{{ bonusInfo }}</span> {% endif %} </div> </div> <div class="subscription-period__text"> <p> <span class="subscription-period__text-line">{{ internationalExpansion.getLocalDateTime(subscriptionPurchase.getSubscriptionExpireDate())|locale_date("d MMMM Y") }} произойдет автоматическое продление.</span> <span class="subscription-period__text-line">Cумма списания составит {{ subscriptionRenewalPriceWithCurrency }}.</span> </p> <p>Отмена продления в любой момент</p> </div> <div class="subscription-period__actions"> {% if isAuthenticated %} <a href="#" class="ivi-button large subscription-period__actions-button js-watch">Смотреть фильмы по подписке</a> {% else %} <div class="notice-block"> <div class="notice-block__title">Зарегистрируйтесь, чтобы&nbsp;не&nbsp;потерять подписку&nbsp;ivi</div> <div class="notice-block__note">После регистрации вы сможете пользоваться подпиской на&nbsp;всех доступных устройствах</div> <div class="notice-block__actions"> <div class="notice-block__actions-item"><a href="#" class="ivi-button medium js-auth">Зарегистрироваться или войти</a></div> <div class="notice-block__actions-item"><a href="#" class="ivi-button medium outline js-watch">Смотреть фильмы по подписке</a></div> </div> </div> {% endif %} </div> </div></div>',e)}var a=i(2);t.default=n},function(e,t,i){var n=i(12),a=i(525),s=i(9);t.default=s.default.extend({routes:["/buy/success"],run:function(e){n.default.prototype.run(e),(new a.default).execute(e)}})},function(e,t,i){var n=i(6),a=i(4);t.default=n.default.extend({run:function(){"fail"===this.queryParams.result&&"repeat_purchase"===this.queryParams.action&&"fraud"===this.queryParams.error?a.default.postMessageToParent("purchase:card:repeat_purchase","*"):a.default.postMessageToParent("purchase:card:"+this.queryParams.result,"*")}})},function(e,t,i){var n=i(12),a=i(527),s=i(9);t.default=s.default.extend({routes:["/buy/subscription/try"],run:function(e){n.default.prototype.run(e),(new a.default).execute(e)}})},function(e,t,i){var n=i(84),a=i(79),s=i(60),o=i(528),r=i(11),l=i(3),d=i(4);t.default=n.default.extend({trialRenewalInitialPeriodInDays:null,trialRenewalPrice:null,doIt:function(){this.listenTo(r.default,"billing:purchase:get:options",this.getPurchaseOptions),this.getPurchaseOptions()},getPurchaseOptions:function(){var e=this,t=new s.default;(this.mapiInfo.isEnableSubscriptionSpasiboScoringCapability()?t.fetchOptionsSpasiboScoring():t.fetchOptions()).done(function(){var i=t.get("purchase_options");if(i){var n=!1,s=null,o=null;i.forEach(function(i){"subscription"===i.object_type&&!0===i.trial&&i.renewal_initial_period&&i.renewal_price&&(e.trialRenewalInitialPeriodInDays=Math.round(parseInt(i.renewal_initial_period)/86400),e.trialRenewalPrice=i.renewal_price,s=t.getPurchaseOptionList().findProduct(i.option_hash),o=new a.default(s),o.checkIfPsMethodIsAvailable("card")&&(n=!0))}),n?(e.isTrial=!0,e.showPayment(o)):d.default.redirect(e.queryParams.redirect_url)}else d.default.redirect(e.queryParams.redirect_url)})},showPayment:function(e){if(this.trialTabView)this.trialTabView.parseOptions({paymentOptionList:e,queryParams:this.queryParams,payType:this.getPayType()});else{var t=e.first().get("groot");this.queryParams.from&&(t.from=this.queryParams.from),this.queryParams.landing_from&&(t.landing_from=this.queryParams.landing_from),t.is_trybuy=1,l.default.track("payment_form_open",t),r.default.trigger("payment:payment_groot_params_ready",t),this.trialTabView=new o.default({paymentOptionList:e,queryParams:this.queryParams,payType:this.getPayType()})}this.trialTabView.reset(),this.trialTabView.trialData={renewalInitialPeriodInDays:this.trialRenewalInitialPeriodInDays,renewalPrice:this.trialRenewalPrice},this.trialTabView.render()},getPayType:function(){return"trial"}})},function(e,t,i){var n=i(115),a=i(529);t.default=n.default.extend({render:function(){var e=null;e=this.options.toJSON(),e=this.extendTemplateParams(e),this.currentTpl!==a.default?this.$el.html(this.getTpl()(e)):this.$el.empty()}})},function(e,t,i){function n(e){return a.default.render('{#для триала выводим другой текст#}{% if (trialData is not empty) %} <div class="headline">Данные вашей карты приняты и&nbsp;будут обработаны в&nbsp;течение нескольких минут. В&nbsp;очень редких случаях это может занять несколько часов. Пожалуйста, не&nbsp;закрывайте это окно.</div>{% else %} <div class="headline">Ваш платеж принят и&nbsp;будет обработан в&nbsp;течение нескольких минут. В&nbsp;очень редких случаях это может занять несколько часов. Пожалуйста, не&nbsp;закрывайте это окно.</div>{% endif %}',e)}var a=i(2);t.default=n},function(e,t,i){var n=i(12),a=i(531),s=i(275),o=i(166),r=i(9),l=i(4);t.default=r.default.extend({routes:["/series.*","/movies.*","/animation.*","/programs.*","/plus.*"],run:function(e){var t=l.default.getLocation().pathname||"",i=["/movies/blockbusters.*","/animation/blockbusters.*","/movies/plus.*","/series/plus.*","/animation/plus.*","/plus.*"],r={"/movies/plus.*":"subscription_movies","/series/plus.*":"subscription_series","/animation/plus.*":"subscription_animation","/movies/blockbusters.*":"blockbuster_movies","/animation/blockbusters.*":"blockbuster_animation","/plus/erotica.*":"subscription_erotika","/plus.*":"subscription","/movies":"films","/animation":"animation","/series":"series"},d=["/plus/erotica.*","/movies/erotika.*"],u=new RegExp(i.join("|")),c=new RegExp(d.join("|")),p=new RegExp(/page(\d+)/),f=p.exec(t);f&&2===f.length&&(e.page=f[1]),n.default.prototype.run(e);var h={};for(var g in r){if(new RegExp(g).test(t)){h.grootId=r[g];break}}var m=new o.default;m.setPage(t.split("/").pop()),m.execute(e,h),u.test(t)||(new a.default).execute(e),c.test(t)&&(new s.default).execute(e)}})},function(e,t,i){var n=i(1),a=i(265),s=i(6),o=i(273),r=i(274);t.default=s.default.extend({enablePseudoRoute:!0,catalogView:null,initedOnce:!1,run:function(e){n(a.default.prototype.el).length&&(this.catalogView=new a.default({collection:new r.default,page:e.page,filterModel:new o.default}),this.catalogView.show())},pseudoRouter:function(e){if(!this.initedOnce){switch(this.initedOnce=!0,e){case"#svod":this.catalogView.paidTypesInit("svod");break;case"#est":this.catalogView.paidTypesInit("est");break;case"#avod":this.catalogView.paidTypesInit("avod")}this.enablePseudoRoute=!1}}})},function(e,t,i){var n=i(1),a=i(533);t.default={showLoader:function(e){if(e&&e.length){var t=e.find(".overlay");t.length||(t=n(a.default()).appendTo(e));var i=e.find(".loader");e.addClass("loading");var s=n(window).height(),o=n(window,"body").scrollTop(),r=e.offset().top,l=e.height(),d=o+s-r;d>l?i.css({top:l/2}):d<=i.height()+32?i.css({top:""}):i.css({top:d/2})}},hideLoader:function(e){e&&e.length&&e.removeClass("loading")}}},function(e,t,i){function n(e){return a.default.render('<div class="overlay"><span class="loader"></span></div>',e)}var a=i(2);t.default=n},function(e,t,i){function n(e){return a.default.render('<li class="{% if video.isInfoVideo() or video.isPreorderable() %}info {% endif %}{% if abExperiment.useNewPriceBadges() %}{{ video.getNewPriceBadgeClasses(abExperiment.showFreeBadge(), hasSubscription) }}{% else %}{{ video.getPaidIcon() }}{% endif %}" data-content-id="{{ video.getId() }}" data-content-type="{% if video.isCompilation() %}compilation{% else %}content{% endif %}" data-content-position="{{ loop.index }}"> <a tabindex="-1" href="{{ video.getPosterSpecificLink(hasSubscription, false) }}" class="item-content-wrapper js-collection-content{% if video.isForAdult() %} js-adult{% endif %}"> <span class="image" data-caption="{% if video.isSvod() %}{{ video.getPosterSpecificCaption(hasSubscription) }}{% else %}{{ video.getPosterSpecificCaption() }}{% endif %}"> <img src="{{ video.getPosterPath("/140x215/") }}" alt="{{ video.getTitle() }}"> <span class="age-limit" data-value="{{ video.getRestrict()|default(0) }}+"></span> {% if abExperiment.useNewPriceBadges() %} <div class="badge"> <div class="badge__content" data-badge-content="{{ video.getNewPriceBadgeTitle(abExperiment.showFreeBadge(), hasSubscription) }}"></div> </div> {% endif %} </span> <span class="title"><span>{{ video.getTitle() }}</span></span> </a> <div class="popup-wrapper-container"> <div class="popup-wrapper" data-hru="{% if video.isCompilation() %}{{ video.getHru() }}{% else %}{{ video.getId() }}{% endif %}"></div> </div></li>',e)}var a=i(2);t.default=n},function(e,t,i){var n=i(16),a=i(230),s=i(4),o=i(23);t.default=n.default.extend({template:a.default,cancelEl:".js-modal-close",openEvent:"erotic:showContentForAdultModal",regionEnabled:!0,events:{"click #js-erotic-confirm":"confirm","click #js-erotic-deny":"deny"},mobileModal:!0,confirm:function(){var e=new o.default;this.model.allowToWatchAdultContent(),this.hide(),e.getId()&&!e.isTvod()&&this.autoStartPlayer()},deny:function(){s.default.redirect("/")},closeModal:function(){this.deny()},beforeCancel:function(){n.default.prototype.beforeCancel.call(this),this.model.canWatchAdultContent()||this.deny()},hide:function(){this.$el.hide()}})},function(e,t,i){var n=i(0),a=i(41);t.default=n.View.extend({el:".teaser-wrapper",events:{"click .js-teaser-subscription-button":"subscriptionButtonClick"},subscriptionButtonClick:function(){return a.default.trigger("showSubscriptionLanding","plus"),!1}})},function(e,t,i){var n=i(1),a=i(68),s=i(156),o=i(28),r=i(5),l=i(3),d=i(43),u=i(105),c=i(4),p=i(20);t.default=a.default.extend({GROOT_PROMO_SECTION_POSITION:1,el:".promo",grootBlockId:"main_promo",promoShownAttr:"data-promo-shown",promoVisibleHeightValue:.5,storageKey:"main_promo_clicked",events:{keyup:"showContent","click li > a":"contentClick","mouseup li > a":"contentMouseUp","contextmenu li > a":"contentContextMenu","click .button-wrapper > a":"buttonClick","mouseup .button-wrapper > a":"buttonMouseUp","contextmenu .button-wrapper > a":"buttonContextMenu","click .control.prev":"showContent","click .control.next":"showContent","click .js-subscription-promo":"promoSubscriptionClick","click .js-trial-promo":"promoTrialClick","click .js-tvchannels-promo":"promoTVChannelsClick"},initialize:function(e){this.listenTo(u.default,"promo:scrolling",this.showContent);var t=[],i=this;void 0!==e&&(this.grootBlockId=e.grootBlockId||this.grootBlockId),this.$el.find("li").each(function(e,a){var s=Object.keys(i.getElementData(n(a)));s.length&&t.push(parseInt(s[0]))}),this.showContent()},getElementData:function(e){var t=e.data("promo-type"),i=e.data("promo-object-id"),n=e.data("promo-id"),a={position:e.data("promo-position"),section_position:this.GROOT_PROMO_SECTION_POSITION};return n&&(a.promo_id=n.toString()),i&&(a[t]=i.toString()),a},contentMouseUp:function(e){3===e.which&&this.contentEventHandler(e)},contentContextMenu:function(e){this.contentEventHandler(e)},contentClick:function(e){return this.contentEventHandler(e,!0)},contentEventHandler:function(e,t){void 0===t&&(t=!1);var i=void 0!==e.originalEvent?e.originalEvent.target:null,a=n(i).parents("[data-promo-id]");if(a.length){if(this.setItemInLocalStorage(a.find("a").attr("href")),t)return this.trackPromoActions("promo_click",this.getElementData(a)),this.handleClickAudit(a)}else;},setItemInLocalStorage:function(e){var t=e.match(/\/watch\/[\w|\d|-]*/);c.default.isMainPage()&&t&&t.length&&p.default.localStorage.setItem(this.storageKey,t[0])},handleClickAudit:function(e){var t=e.data("click-audit"),i=t?t.split("|"):[],n=e.data("link")||"";if(r.each(i,function(e){if(e!==n){(new s.default).setSrc(o.default.setRandomNumber(o.default.schemaLessUrl(e)))}}),n)return c.default.open(o.default.setRandomNumber(o.default.schemaLessUrl(n))),!1},buttonMouseUp:function(e){3===e.which&&this.buttonEventHandler(e)},buttonContextMenu:function(e){this.buttonEventHandler(e)},buttonEventHandler:function(e,t){void 0===t&&(t=!1);var i=void 0!==e.originalEvent?e.originalEvent.target:null;if(i){var a=n(i),s=a.parents("[data-promo-id]");if(s.length){var o=null,r=s.data("promo-id");if(r){if(a.hasClass("js-promo-watch-link")?(o="promo_click",this.setItemInLocalStorage(a.attr("href"))):a.hasClass("js-promo-trailer-link")&&(o="promo_click_trailer"),!t)return;r=r.toString(),l.default.setPromoId(r),l.default.setBlockId(this.grootBlockId),o&&this.trackPromoActions(o,this.getElementData(s))}}}},buttonClick:function(e){this.buttonEventHandler(e,!0)},showContent:function(e){var t=this.$el.find("li.active");e&&37!==e.which&&39!==e.which&&1!==e.which||t.length&&(l.default.setPromoId(t.data("promo-id")),!t.attr(this.promoShownAttr)&&this.isPromoVisible(t)&&(this.trackPromoActions("promo_view",this.getElementData(t)),(t.hasClass("js-subscription-promo")||t.hasClass("js-trial-promo"))&&l.default.track("price_selection",this.getSubscriptionGrootParams(d.default.getSubscriptionPrice())),t.attr(this.promoShownAttr,1),this.handlePxAudit(t)))},trackPromoActions:function(e,t){l.default.setBlockId(this.grootBlockId),l.default.updatePromoAndCollectionParams(t),t.block_id=this.grootBlockId,l.default.clearSuperProperties(this.GROOT_SUPER_PROPERTIES_TO_CLEAN),l.default.rewriteSuperProperties(t),l.default.track(e,t)},handlePxAudit:function(e){var t=e.data("px-audit");if(t){var i=t.split("|");r.each(i,function(e){(new s.default).setSrc(o.default.setRandomNumber(o.default.schemaLessUrl(e)))})}},getSubscriptionGrootParams:function(e){var t={is_trybuy:l.default.isTrialAvailable(),from:"main_promo",m_svod:1};return e&&(t.price=String(e)),t},promoSubscriptionClick:function(){l.default.track("price_click",this.getSubscriptionGrootParams(d.default.getSubscriptionPrice()))},promoTrialClick:function(){l.default.track("price_click",this.getSubscriptionGrootParams("0"))},promoTVChannelsClick:function(){l.default.track("main_channels_click")},isPromoVisible:function(e){return n(document).scrollTop()<e.offset().top+e.height()*this.promoVisibleHeightValue}})},function(e,t,i){var n=i(276),a=i(539),s=i(278);t.default=n.default.extend({events:{},initialize:function(){if(this.loadSavedPromo(),this.listenToOnce(s.default,"promo:stopAutoScroll",this.stopScrolling),this.el){var e=new a(this.el);e.on("swipeleft",this.swipeLeft.bind(this)),e.on("swiperight",this.swipeRight.bind(this))}this.setScrolling()},swipeLeft:function(){this.stopScrolling(),this.changeContent(!0)},swipeRight:function(){this.stopScrolling(),this.changeContent(!1)}})},function(e,t){e.exports=Hammer},function(e,t,i){var n=i(1),a=i(0),s=i(277),o=i(26),r=i(7),l=i(8),d=i(3),u=i(83),c=i(50);t.default=a.View.extend({el:".js-promo-slider",promoShownAttr:"data-promo-shown",promoVisibleHeightValue:.5,events:{keydown:"onKeyDownEvent",beforeChange:"beforeSlideChange",afterChange:"afterSlideChange",breakpoint:"onSliderBreakpoint",swipe:"onSliderSwipe","click .promo-slider__control":"arrowsClick","click .js-favourite-button":"triggerFavourite"},isDocumentVisible:!0,$sliderEl:null,promoType:null,savedPromo:null,savedPromoIndex:null,currentSlideIndex:null,lastSlideIndex:null,isSlideChanging:!1,isGrootSent:!1,$dotsWrapper:null,$dotsItems:null,$dotsNav:null,itemWidth:null,visibleDots:9,dotMargin:4,dotWidth:6,initialize:function(){c.default.addVisibilityChangeListener(this.onDocumentVisibilityChanged.bind(this)),this.listenTo(r.default,"loadUser",this.checkFavourites),this.listenTo(o.default,"favourite:have",this.setDefaultActive),this.listenTo(o.default,"favourites:added",this.updateFavouriteStatus),this.listenTo(o.default,"favourites:deleted",this.updateFavouriteStatus),this.beforeSliderInit(),this.sliderInit(),this.afterSliderInit()},onDocumentVisibilityChanged:function(){this.isDocumentVisible="visible"===document.visibilityState},sliderInit:function(){this.$sliderEl=this.$el.find(".js-promo-slider__list"),this.$sliderEl.slick({draggable:!1,variableWidth:!0,adaptiveHeight:!1,centerMode:!0,centerPadding:"0",slidesToShow:1,touchMove:!1,infinite:!0,prevArrow:'<span class="promo-slider__control promo-slider__control_prev" data-direction="left">Назад</span>',nextArrow:'<span class="promo-slider__control promo-slider__control_next" data-direction="right">Далее</span>',dots:!0,dotsClass:"promo-slider__nav-inner",dotClassActive:"active",appendDots:n(".js-promo-slider__nav"),autoplay:!0,autoplaySpeed:8e3,cssEase:"ease-in-out",speed:500,responsive:[{breakpoint:1599,settings:{centerPadding:"156px",variableWidth:!1}},{breakpoint:1299,settings:{centerPadding:"0",variableWidth:!0}},{breakpoint:599,settings:{variableWidth:!1,adaptiveHeight:!0,arrows:!1}}]})},beforeSliderInit:function(){this.loadSavedPromo()},afterSliderInit:function(){this.dotsInit(),this.savedPromoIndex&&(this.$sliderEl.slick("slickGoTo",this.savedPromoIndex,!1),this.dotsStateUpdate(this.savedPromoIndex))},afterSlideChange:function(e,t,i){var n=t.$slides.eq(i),a=n.data(this.promoShownAttr);this.isSlideChanging=!1,this.isGrootSent=!1,!a&&this.isPromoVisible()&&this.isDocumentVisible&&(d.default.track("promo_view",{collection_id:n.data("promo-object-id"),position:i+1,promo_id:n.data("promo-id"),section_position:1}),t.$slides.eq(i).data(this.promoShownAttr,1))},beforeSlideChange:function(e,t,i,n){this.isSlideChanging=!0,this.lastSlideIndex=i,this.currentSlideIndex=n,this.savePromoPosition(t,n),this.dotsStateUpdate(n)},onSliderBreakpoint:function(){this.dotsInit(),this.dotsStateUpdate(this.currentSlideIndex)},dotsInit:function(){this.$dotsWrapper=this.$el.find(".promo-slider__nav"),this.$dotsNav=this.$el.find(".promo-slider__nav-inner"),this.$dotsItems=this.$dotsWrapper.find("li"),this.itemWidth=this.dotWidth+2*this.dotMargin,this.$dotsWrapper.width(this.itemWidth*this.visibleDots),this.$dotsItems.eq(this.visibleDots-1).addClass("small"),this.$dotsItems.eq(this.visibleDots).addClass("hidden")},resetDotClass:function(){this.$dotsItems.removeClass("small hidden")},dotsStateUpdate:function(e){var t=Math.floor(this.visibleDots/2),i=this.itemWidth*(e-t),n=e-t,a=e+t,s=n-1,o=a+1,r=this.$dotsNav.width();i<0?this.$dotsNav.css({transform:"translateX(0px)"}):i+this.itemWidth*this.visibleDots>r?this.$dotsNav.css({transform:"translateX(-"+(r-this.itemWidth*this.visibleDots)+"px)"}):this.$dotsNav.css({transform:"translateX(-"+i+"px)"}),this.$dotsItems.length>this.visibleDots&&(this.resetDotClass(),e>t&&e<this.$dotsItems.length-t?(this.$dotsItems.eq(n).addClass("small"),this.$dotsItems.eq(s).addClass("hidden"),this.$dotsItems.eq(a).addClass("small"),this.$dotsItems.eq(o).addClass("hidden")):e>t?this.$dotsItems.eq(this.$dotsItems.length-this.visibleDots).addClass("small"):e<this.$dotsItems.length-t&&(this.$dotsItems.eq(this.visibleDots-1).addClass("small"),this.$dotsItems.eq(this.visibleDots).addClass("hidden")))},savePromoPosition:function(e,t){var i=e.$slides.eq(t).find(".js-promo-slider__item").data("promo-id");this.savedPromo.savePromoId(this.promoType,i)},loadSavedPromo:function(){this.savedPromo=new s.default,this.promoType=this.$el.data("promo-type");var e=this.savedPromo.getPromoId(this.promoType);e&&(this.savedPromoIndex=this.getSlideIndexByPromoId(e))},getSlideIndexByPromoId:function(e){return(this.$sliderEl?this.$sliderEl.slick("getSlick").$slides.find('.promo-slider__item[data-promo-id="'+e+'"]').parents(".slick-slide").data("slick-index"):this.$el.find('.promo-slider__item[data-promo-id="'+e+'"]').index())||null},arrowsClick:function(e){var t=n(e.target).data("direction");this.$sliderEl&&this.$sliderEl.slick("getSlick").$list.attr("tabindex",0).focus(),this.isSlideChanging&&!this.isGrootSent&&(d.default.track(t+"_arrow_promo_click"),this.isGrootSent=!0)},onKeyDownEvent:function(e){this.isSlideChanging&&!this.isGrootSent&&(u.default.getKeyCode(e)===u.default.KEY_ARROW_LEFT?(d.default.track("left_arrow_promo_click"),this.isGrootSent=!0):u.default.getKeyCode(e)===u.default.KEY_ARROW_RIGHT&&(d.default.track("right_arrow_promo_click"),this.isGrootSent=!0))},isPromoVisible:function(){return n(document).scrollTop()<this.$el.offset().top+this.$el.height()*this.promoVisibleHeightValue},triggerFavourite:function(e){var t=n(e.target);return t.hasClass("link-action_active")?o.default.trigger("favourite:delete",{objectId:t.data("object-id"),type:t.data("object-type"),blockId:d.default.getBlockIds().promoBlockId}):o.default.trigger("favourite:add",{objectId:t.data("object-id"),type:t.data("object-type"),blockId:d.default.getBlockIds().promoBlockId}),!1},setDefaultActive:function(e,t){var i=this.$sliderEl.slick("getSlick").$slides.find("a[data-object-id="+e.objectId+"]");t&&i.data("object-type")===e.type&&i.addClass("link-action_active")},checkFavourites:function(){l.default.isFreshStoragelessSession()||this.$sliderEl.slick("getSlick").$slides.find(".js-favourite-button").each(function(){o.default.trigger("favourite:check",{objectId:n(this).data("object-id"),type:n(this).data("object-type")})})},updateFavouriteStatus:function(e){var t=this.$el.find("a[data-object-id="+e.objectId+"]");t.data("object-type")===e.type&&t.toggleClass("link-action_active")}})},function(e,t,i){var n=i(12),a=i(542),s=i(9);t.default=s.default.extend({routes:["/cert","/pcert"],run:function(e){n.default.prototype.run(e),(new a.default).execute(e)}})},function(e,t,i){var n=i(543),a=i(33),s=i(165),o=i(311),r=i(629),l=i(631);t.default=a.default.extend({certificatePageView:null,initialize:function(){this.listenTo(o.default,"certificateView:cardbind",this.showBindingForm),new l.default},afterLogin:function(){this.certificatePageView=new n.default,this.certificatePageView.render()},showBindingForm:function(){var e=this,t=new s.default;(new r.default).listen(o.default);var i={data:{landing_name:"cert",ps_key:"cards"}};t.mapiPost(i).done(function(t){e.certificatePageView.bindCard(t)})}})},function(e,t,i){var n=i(1),a=i(31),s=i(285),o=i(114),r=i(621),l=i(623),d=i(6),u=i(22),c=i(7),p=i(146),f=i(8),h=i(311),g=i(11),m=i(4),v=i(83),_=i(624),b=i(627);t.default=l.default.extend({el:"#certificate-page",elementSelector:"#certificate-page",codeFrom:"page_certificate",source:"page",slides:null,slidesArray:null,currentSlideIndex:null,currentSlideData:null,currentSlideFlag:null,previousSlide:null,slidesInited:!1,lastCertificate:null,cardBindSuccessEvent:"certificateView:cardbind:success",events:{"click .js-certificate-activate":"activateCertificateClick","keyup .js-certificate-key":"keyUpCertificateKey","input .js-certificate-key":"changeCertificateKey","click .js-certificate-reset":"reset","click .js-certificate__advert":"toggleBlock","blur .js-ivi-textfield__input":"onInputBlur","focus .js-ivi-textfield__input":"onInputFocus","keyup .js-ivi-textfield__input":"onInputKeyup",click:"hideInputError"},initialize:function(){l.default.prototype.initialize.call(this),this.listenTo(c.default,"user:logout",m.default.forceReload),this.listenTo(c.default,"user:login",this.afterAuth)},initSlides:function(){this.slides=this.$el.find(".js-screen-slide__item:not(.js-screen-slide__item_hidden)"),this.slidesArray=this.slides.length?this.slides.toArray():[],this.currentSlideIndex=0,this.lastCertificate=null,this.slidesInited=!0},render:function(){switch(this.slidesInited||(new p.default,this.initElements(),this.initSlides()),this.model.get("status")){case"new":this.$el.find(".js-screen-slide__item_hidden").length||(this.$el.find(".screen-slide__item").eq(1).addClass("screen-slide__item_hidden js-screen-slide__item_hidden"),this.$el.find(".certificate__header").show(),this.initSlides(),this.updateSlide()),this.$el.find(".certificate__ticket").removeClass("certificate__ticket_active"),this.$keyField.parent().removeClass("state_error tooltip"),this.$keyField.val(""),this.$keyField.prop("disabled",""),this.$activateButton.removeClass("loading").prop("disabled","disabled"),this.$keyField.trigger("keyup"),this.updateSlide();break;case"error":var e=this.$keyField.parent();this.$keyField.prop("disabled",""),this.$activateButton.removeClass("loading").prop("disabled","disabled"),e.addClass("state_error tooltip"),e.find(".ivi-textfield__tooltip").html(this.model.getMessage());break;case"cardBind":var t=this.$el.find(".certificate__ticket__wrapper");this.$el.find(".js-screen-slide__item_hidden").removeClass("screen-slide__item_hidden js-screen-slide__item_hidden"),t.eq(t.length-1).parent().hide(),this.initSlides(),this.updateSlide(),this.updateCertTypeCards(!0),h.default.trigger("certificateView:cardbind"),this.listenTo(g.default,this.cardBindSuccessEvent,this.activateCertificate);break;case"success":this.lastCertificate=null,this.updateSlide(),this.updateCertTypeCards(!1),this.model.setCertificateKeyInStorage(""),this.renderSuccessView();break;case"":this.$keyField.focus();break;default:var i=null;d.default.prototype.queryParams.code?i=d.default.prototype.queryParams.code:o.default.prototype.getCertificateKeyFromStorage()&&(i=o.default.prototype.getCertificateKeyFromStorage(),o.default.prototype.removeCertificateKeyFromStorage()),i&&(this.$keyField.val(i),this.$keyField.trigger("keyup"),this.$activateButton.prop("disabled","")),this.$keyField.focus()}},clearClasses:function(){n(this.slides).removeClass("screen-slide__item_previous screen-slide__item_current screen-slide__slide_top-off screen-slide__slide_top-on screen-slide__slide_bottom-off screen-slide__slide_bottom-on certificate__content_animate-up certificate__content_animate-down")},updateCertTypeCards:function(e){var t,i=this.$el.find(".js-certificate__ticket").toArray();t=this.model.isSubscriptionBuy()||e?i.filter(function(e){return"subscription"===e.getAttribute("data-value")}):this.model.isContent()||this.model.isCollection()?i.filter(function(e){return"content"===e.getAttribute("data-value")}):this.model.isPersonalBalance()?i.filter(function(e){return"money"===e.getAttribute("data-value")}):i.filter(function(e){return"discount"===e.getAttribute("data-value")}),n(t).addClass("certificate__ticket_active").find(".certificate__ticket__title").text(this.model.getCertificateKeyFromStorage())},updateCurrentState:function(){this.currentSlideData++,this.currentSlideIndex=this.slidesArray.length?(this.currentSlideData+this.slidesArray.length)%this.slidesArray.length:null,this.currentSlideFlag=n(this.slidesArray).eq(this.currentSlideIndex).attr("sticky"),n(this.slidesArray).eq(this.currentSlideIndex).addClass("screen-slide__item_current certificate__content_animate-up")},updatePreviousState:function(){this.previousSlide=this.currentSlideIndex,n(this.slidesArray).eq(this.previousSlide).addClass("screen-slide__item_previous"),n(this.slidesArray).eq(this.currentSlideIndex).addClass("certificate__content_animate-down")},moveSlide:function(){this.updatePreviousState(),n(this.slidesArray).eq(this.previousSlide).addClass("screen-slide__slide_top-off"),this.updateCurrentState(),n(this.slidesArray).eq(this.currentSlideIndex).addClass("screen-slide__slide_top-on")},updateSlide:function(){this.currentSlideData=this.currentSlideIndex,this.clearClasses(),this.moveSlide()},changeCertificateKey:function(){this.isCertInputValid()?this.$activateButton.prop("disabled",""):this.$activateButton.prop("disabled","disabled")},onInputFocus:function(){this.$keyField.val().length&&this.$keyField.hasClass("state_error")&&(this.$keyField.val(""),this.$keyField.trigger("keyup"))},onInputKeyup:function(){this.lastCertificate&&this.lastCertificate.length&&(this.lastCertificate=null)},onInputBlur:function(){!this.$keyField.val().length&&this.lastCertificate&&this.lastCertificate.length&&(this.$keyField.val(this.lastCertificate),this.$keyField.trigger("keyup"),this.$keyField.parent().addClass("state_error"))},hideInputError:function(){this.$keyField.parent().hasClass("tooltip")&&this.$keyField.parent().removeClass("tooltip")},keyUpCertificateKey:function(e){v.default.getKeyCode(e)===v.default.KEY_ENTER&&this.isCertInputValid()&&this.activateCertificateClick()},activateCertificateClick:function(){if(!this.$keyField.val()||this.$activateButton.prop("disabled")||this.$activateButton.hasClass("loading"))return!1;this.activateCertificate()},activateCertificate:function(){var e=n.trim(this.$keyField.val());this.model.setCertificateKeyInStorage(e),this.lastCertificate=e,f.default.isAuthenticated()?(this.$keyField.prop("disabled","disabled"),this.activate(e,!1,"click"),this.$activateButton.addClass("loading")):c.default.trigger("auth:showLoginModal","certificate")},afterAuth:function(){n(".js-certificate__title").removeClass("certificate__title_offset-bottom_none"),n(".js-certificate__description").hide(),this.$activateButton.text("Активировать"),this.activateCertificateClick()},bindCard:function(e){var t=this.$el.find(".js-certificate__activate-wrapper").get(0),i={cardBindSuccessEvent:this.cardBindSuccessEvent,url:e.result?e.result.redirect_url:null,onCardError:this.onCardError,onAntiFraud:this.onAntiFraud};this.renderReactComponent(b.default,i,t)},onCardError:function(e){h.default.trigger("billing:payment:errorModalOpen",{message:e.data.text,title:"Внимание"})},onAntiFraud:function(){h.default.trigger("certificateView:cardbind"),h.default.trigger("billing:payment:errorModalOpen",{title:"Оплата недоступна",message:"К сожалению, попытка оплаты не удалась. Попробуйте произвести оплату еще раз."})},renderSuccessView:function(){var e=this;this.$el.find(".js-certificate__success__wrapper").empty();var t=this.$el.find(".js-certificate__success__wrapper").get(0),i={certificateModel:this.model,objectModel:r.default.createObject(this.model.getObjectType())};i.objectModel?i.objectModel.mapiGet({data:{id:this.model.getObjectId()}}).always(function(){e.renderReactComponent(_.default,i,t)}):this.model.isSubscriptionBuy()?(u.default.unset("purchases"),this.listenToOnce(c.default,"auth:userProfileBlockIsReady",this.renderReactComponent.bind(this,_.default,i,t)),c.default.trigger("isUser")):this.renderReactComponent(_.default,i,t)},renderReactComponent:function(e,t,i){s.render(a.createElement(e,t,null),i)},reset:function(){this.$el.find(".certificate__ticket__title").text("Сертификат"),this.model.set("status","new"),this.render()},toggleBlock:function(e){window.ivi.adaptive.isMobileStyle&&n(e.currentTarget).find(".certificate__premium").toggleClass("certificate__premium_mobile-opened")}})},function(e,t,i){"use strict";var n=i(24),a=i(279),s=i(169),o=i(545),r=i(282),l=i(546),d=i(52),u=i(283),c=i(284),p=i(548),f=(i(17),d.createElement),h=d.createFactory,g=d.cloneElement,m=n,v={Children:{map:a.map,forEach:a.forEach,count:a.count,toArray:a.toArray,only:p},Component:s,PureComponent:o,createElement:f,cloneElement:g,isValidElement:d.isValidElement,PropTypes:u,createClass:r.createClass,createFactory:h,createMixin:function(e){return e},DOM:l,version:c,__spread:m};e.exports=v},function(e,t,i){"use strict";function n(e,t,i){this.props=e,this.context=t,this.refs=l,this.updater=i||r}function a(){}var s=i(24),o=i(169),r=i(170),l=i(94);a.prototype=o.prototype,n.prototype=new a,n.prototype.constructor=n,s(n.prototype,o.prototype),n.prototype.isPureReactComponent=!0,e.exports=n},function(e,t,i){"use strict";function n(e){return a.createFactory(e)}var a=i(52),s=i(547),o=s({a:"a",abbr:"abbr",address:"address",area:"area",article:"article",aside:"aside",audio:"audio",b:"b",base:"base",bdi:"bdi",bdo:"bdo",big:"big",blockquote:"blockquote",body:"body",br:"br",button:"button",canvas:"canvas",caption:"caption",cite:"cite",code:"code",col:"col",colgroup:"colgroup",data:"data",datalist:"datalist",dd:"dd",del:"del",details:"details",dfn:"dfn",dialog:"dialog",div:"div",dl:"dl",dt:"dt",em:"em",embed:"embed",fieldset:"fieldset",figcaption:"figcaption",figure:"figure",footer:"footer",form:"form",h1:"h1",h2:"h2",h3:"h3",h4:"h4",h5:"h5",h6:"h6",head:"head",header:"header",hgroup:"hgroup",hr:"hr",html:"html",i:"i",iframe:"iframe",img:"img",input:"input",ins:"ins",kbd:"kbd",keygen:"keygen",label:"label",legend:"legend",li:"li",link:"link",main:"main",map:"map",mark:"mark",menu:"menu",menuitem:"menuitem",meta:"meta",meter:"meter",nav:"nav",noscript:"noscript",object:"object",ol:"ol",optgroup:"optgroup",option:"option",output:"output",p:"p",param:"param",picture:"picture",pre:"pre",progress:"progress",q:"q",rp:"rp",rt:"rt",ruby:"ruby",s:"s",samp:"samp",script:"script",section:"section",select:"select",small:"small",source:"source",span:"span",strong:"strong",style:"style",sub:"sub",summary:"summary",sup:"sup",table:"table",tbody:"tbody",td:"td",textarea:"textarea",tfoot:"tfoot",th:"th",thead:"thead",time:"time",title:"title",tr:"tr",track:"track",u:"u",ul:"ul",var:"var",video:"video",wbr:"wbr",circle:"circle",clipPath:"clipPath",defs:"defs",ellipse:"ellipse",g:"g",image:"image",line:"line",linearGradient:"linearGradient",mask:"mask",path:"path",pattern:"pattern",polygon:"polygon",polyline:"polyline",radialGradient:"radialGradient",rect:"rect",stop:"stop",svg:"svg",text:"text",tspan:"tspan"},n);e.exports=o},function(e,t,i){"use strict";function n(e,t,i){if(!e)return null;var n={};for(var s in e)a.call(e,s)&&(n[s]=t.call(i,e[s],s,e));return n}var a=Object.prototype.hasOwnProperty;e.exports=n},function(e,t,i){"use strict";function n(e){return s.isValidElement(e)||a("23"),e}var a=i(15),s=i(52);i(13);e.exports=n},function(e,t,i){"use strict";var n=i(27),a=i(550),s=i(308),o=i(86),r=i(53),l=i(284),d=i(619),u=i(309),c=i(620);i(17);a.inject();var p={findDOMNode:d,render:s.render,unmountComponentAtNode:s.unmountComponentAtNode,version:l,unstable_batchedUpdates:r.batchedUpdates,unstable_renderSubtreeIntoContainer:c};"undefined"!=typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.inject&&__REACT_DEVTOOLS_GLOBAL_HOOK__.inject({ComponentTree:{getClosestInstanceFromNode:n.getClosestInstanceFromNode,getNodeFromInstance:function(e){return e._renderedComponent&&(e=u(e)),e?n.getNodeFromInstance(e):null}},Mount:s,Reconciler:o});e.exports=p},function(e,t,i){"use strict";function n(){C||(C=!0,v.EventEmitter.injectReactEventListener(m),v.EventPluginHub.injectEventPluginOrder(o),v.EventPluginUtils.injectComponentTree(c),v.EventPluginUtils.injectTreeTraversal(f),v.EventPluginHub.injectEventPluginsByName({SimpleEventPlugin:w,EnterLeaveEventPlugin:r,ChangeEventPlugin:s,SelectEventPlugin:y,BeforeInputEventPlugin:a}),v.HostComponent.injectGenericComponentClass(u),v.HostComponent.injectTextComponentClass(h),v.DOMProperty.injectDOMPropertyConfig(l),v.DOMProperty.injectDOMPropertyConfig(b),v.EmptyComponent.injectEmptyComponentFactory(function(e){return new p(e)}),v.Updates.injectReconcileTransaction(_),v.Updates.injectBatchingStrategy(g),v.Component.injectEnvironment(d))}var a=i(551),s=i(555),o=i(558),r=i(559),l=i(560),d=i(294),u=i(566),c=i(27),p=i(590),f=i(591),h=i(592),g=i(593),m=i(594),v=i(596),_=i(597),b=i(603),y=i(604),w=i(605),C=!1;e.exports={inject:n}},function(e,t,i){"use strict";function n(e){return(e.ctrlKey||e.altKey||e.metaKey)&&!(e.ctrlKey&&e.altKey)}function a(e){switch(e){case E.topCompositionStart:return I.compositionStart;case E.topCompositionEnd:return I.compositionEnd;case E.topCompositionUpdate:return I.compositionUpdate}}function s(e,t){return e===E.topKeyDown&&t.keyCode===y}function o(e,t){switch(e){case E.topKeyUp:return-1!==b.indexOf(t.keyCode);case E.topKeyDown:return t.keyCode!==y;case E.topKeyPress:case E.topMouseDown:case E.topBlur:return!0;default:return!1}}function r(e){var t=e.detail;return"object"==typeof t&&"data"in t?t.data:null}function l(e,t,i,n){var l,d;if(w?l=a(e):M?o(e,i)&&(l=I.compositionEnd):s(e,i)&&(l=I.compositionStart),!l)return null;P&&(M||l!==I.compositionStart?l===I.compositionEnd&&M&&(d=M.getData()):M=g.getPooled(n));var u=m.getPooled(l,t,i,n);if(d)u.data=d;else{var c=r(i);null!==c&&(u.data=c)}return f.accumulateTwoPhaseDispatches(u),u}function d(e,t){switch(e){case E.topCompositionEnd:return r(t);case E.topKeyPress:return t.which!==S?null:(x=!0,T);case E.topTextInput:var i=t.data;return i===T&&x?null:i;default:return null}}function u(e,t){if(M){if(e===E.topCompositionEnd||o(e,t)){var i=M.getData();return g.release(M),M=null,i}return null}switch(e){case E.topPaste:return null;case E.topKeyPress:return t.which&&!n(t)?String.fromCharCode(t.which):null;case E.topCompositionEnd:return P?null:t.data;default:return null}}function c(e,t,i,n){var a;if(!(a=k?d(e,i):u(e,i)))return null;var s=v.getPooled(I.beforeInput,t,i,n);return s.data=a,f.accumulateTwoPhaseDispatches(s),s}var p=i(62),f=i(95),h=i(34),g=i(552),m=i(553),v=i(554),_=i(71),b=[9,13,27,32],y=229,w=h.canUseDOM&&"CompositionEvent"in window,C=null;h.canUseDOM&&"documentMode"in document&&(C=document.documentMode);var k=h.canUseDOM&&"TextEvent"in window&&!C&&!function(){var e=window.opera;return"object"==typeof e&&"function"==typeof e.version&&parseInt(e.version(),10)<=12}(),P=h.canUseDOM&&(!w||C&&C>8&&C<=11),S=32,T=String.fromCharCode(S),E=p.topLevelTypes,I={beforeInput:{phasedRegistrationNames:{bubbled:_({onBeforeInput:null}),captured:_({onBeforeInputCapture:null})},dependencies:[E.topCompositionEnd,E.topKeyPress,E.topTextInput,E.topPaste]},compositionEnd:{phasedRegistrationNames:{bubbled:_({onCompositionEnd:null}),captured:_({onCompositionEndCapture:null})},dependencies:[E.topBlur,E.topCompositionEnd,E.topKeyDown,E.topKeyPress,E.topKeyUp,E.topMouseDown]},compositionStart:{phasedRegistrationNames:{bubbled:_({onCompositionStart:null}),captured:_({onCompositionStartCapture:null})},dependencies:[E.topBlur,E.topCompositionStart,E.topKeyDown,E.topKeyPress,E.topKeyUp,E.topMouseDown]},compositionUpdate:{phasedRegistrationNames:{bubbled:_({onCompositionUpdate:null}),captured:_({onCompositionUpdateCapture:null})},dependencies:[E.topBlur,E.topCompositionUpdate,E.topKeyDown,E.topKeyPress,E.topKeyUp,E.topMouseDown]}},x=!1,M=null,A={eventTypes:I,extractEvents:function(e,t,i,n){return[l(e,t,i,n),c(e,t,i,n)]}};e.exports=A},function(e,t,i){"use strict";function n(e){this._root=e,this._startText=this.getText(),this._fallbackText=null}var a=i(24),s=i(69),o=i(289);a(n.prototype,{destructor:function(){this._root=null,this._startText=null,this._fallbackText=null},getText:function(){return"value"in this._root?this._root.value:this._root[o()]},getData:function(){if(this._fallbackText)return this._fallbackText;var e,t,i=this._startText,n=i.length,a=this.getText(),s=a.length;for(e=0;e<n&&i[e]===a[e];e++);var o=n-e;for(t=1;t<=o&&i[n-t]===a[s-t];t++);var r=t>1?1-t:void 0;return this._fallbackText=a.slice(e,r),this._fallbackText}}),s.addPoolingTo(n),e.exports=n},function(e,t,i){"use strict";function n(e,t,i,n){return a.call(this,e,t,i,n)}var a=i(63),s={data:null};a.augmentClass(n,s),e.exports=n},function(e,t,i){"use strict";function n(e,t,i,n){return a.call(this,e,t,i,n)}var a=i(63),s={data:null};a.augmentClass(n,s),e.exports=n},function(e,t,i){"use strict";function n(e){var t=e.nodeName&&e.nodeName.toLowerCase();return"select"===t||"input"===t&&"file"===e.type}function a(e){var t=P.getPooled(M.change,L,e,S(e));y.accumulateTwoPhaseDispatches(t),k.batchedUpdates(s,t)}function s(e){b.enqueueEvents(e),b.processEventQueue(!1)}function o(e,t){A=e,L=t,A.attachEvent("onchange",a)}function r(){A&&(A.detachEvent("onchange",a),A=null,L=null)}function l(e,t){if(e===x.topChange)return t}function d(e,t,i){e===x.topFocus?(r(),o(t,i)):e===x.topBlur&&r()}function u(e,t){A=e,L=t,O=e.value,j=Object.getOwnPropertyDescriptor(e.constructor.prototype,"value"),Object.defineProperty(A,"value",N),A.attachEvent?A.attachEvent("onpropertychange",p):A.addEventListener("propertychange",p,!1)}function c(){A&&(delete A.value,A.detachEvent?A.detachEvent("onpropertychange",p):A.removeEventListener("propertychange",p,!1),A=null,L=null,O=null,j=null)}function p(e){if("value"===e.propertyName){var t=e.srcElement.value;t!==O&&(O=t,a(e))}}function f(e,t){if(e===x.topInput)return t}function h(e,t,i){e===x.topFocus?(c(),u(t,i)):e===x.topBlur&&c()}function g(e,t){if((e===x.topSelectionChange||e===x.topKeyUp||e===x.topKeyDown)&&A&&A.value!==O)return O=A.value,L}function m(e){return e.nodeName&&"input"===e.nodeName.toLowerCase()&&("checkbox"===e.type||"radio"===e.type)}function v(e,t){if(e===x.topClick)return t}var _=i(62),b=i(96),y=i(95),w=i(34),C=i(27),k=i(53),P=i(63),S=i(177),T=i(178),E=i(292),I=i(71),x=_.topLevelTypes,M={change:{phasedRegistrationNames:{bubbled:I({onChange:null}),captured:I({onChangeCapture:null})},dependencies:[x.topBlur,x.topChange,x.topClick,x.topFocus,x.topInput,x.topKeyDown,x.topKeyUp,x.topSelectionChange]}},A=null,L=null,O=null,j=null,D=!1;w.canUseDOM&&(D=T("change")&&(!("documentMode"in document)||document.documentMode>8));var R=!1;w.canUseDOM&&(R=T("input")&&(!("documentMode"in document)||document.documentMode>11));var N={get:function(){return j.get.call(this)},set:function(e){O=""+e,j.set.call(this,e)}},B={eventTypes:M,extractEvents:function(e,t,i,a){var s,o,r=t?C.getNodeFromInstance(t):window;if(n(r)?D?s=l:o=d:E(r)?R?s=f:(s=g,o=h):m(r)&&(s=v),s){var u=s(e,t);if(u){var c=P.getPooled(M.change,u,i,a);return c.type="change",y.accumulateTwoPhaseDispatches(c),c}}o&&o(e,r,t)}};e.exports=B},function(e,t,i){"use strict";function n(e,t,i){"function"==typeof e?e(t.getPublicInstance()):s.addComponentAsRefTo(t,e,i)}function a(e,t,i){"function"==typeof e?e(null):s.removeComponentAsRefFrom(t,e,i)}var s=i(557),o={};o.attachRefs=function(e,t){if(null!==t&&!1!==t){var i=t.ref;null!=i&&n(i,e,t._owner)}},o.shouldUpdateRefs=function(e,t){var i=null===e||!1===e,n=null===t||!1===t;return i||n||t.ref!==e.ref||"string"==typeof t.ref&&t._owner!==e._owner},o.detachRefs=function(e,t){if(null!==t&&!1!==t){var i=t.ref;null!=i&&a(i,e,t._owner)}},e.exports=o},function(e,t,i){"use strict";var n=i(15),a=(i(13),{isValidOwner:function(e){return!(!e||"function"!=typeof e.attachRef||"function"!=typeof e.detachRef)},addComponentAsRefTo:function(e,t,i){a.isValidOwner(i)||n("119"),i.attachRef(t,e)},removeComponentAsRefFrom:function(e,t,i){a.isValidOwner(i)||n("120");var s=i.getPublicInstance();s&&s.refs[t]===e.getPublicInstance()&&i.detachRef(t)}});e.exports=a},function(e,t,i){"use strict";var n=i(71),a=[n({ResponderEventPlugin:null}),n({SimpleEventPlugin:null}),n({TapEventPlugin:null}),n({EnterLeaveEventPlugin:null}),n({ChangeEventPlugin:null}),n({SelectEventPlugin:null}),n({BeforeInputEventPlugin:null})];e.exports=a},function(e,t,i){"use strict";var n=i(62),a=i(95),s=i(27),o=i(119),r=i(71),l=n.topLevelTypes,d={mouseEnter:{registrationName:r({onMouseEnter:null}),dependencies:[l.topMouseOut,l.topMouseOver]},mouseLeave:{registrationName:r({onMouseLeave:null}),dependencies:[l.topMouseOut,l.topMouseOver]}},u={eventTypes:d,extractEvents:function(e,t,i,n){if(e===l.topMouseOver&&(i.relatedTarget||i.fromElement))return null;if(e!==l.topMouseOut&&e!==l.topMouseOver)return null;var r;if(n.window===n)r=n;else{var u=n.ownerDocument;r=u?u.defaultView||u.parentWindow:window}var c,p;if(e===l.topMouseOut){c=t;var f=i.relatedTarget||i.toElement;p=f?s.getClosestInstanceFromNode(f):null}else c=null,p=t;if(c===p)return null;var h=null==c?r:s.getNodeFromInstance(c),g=null==p?r:s.getNodeFromInstance(p),m=o.getPooled(d.mouseLeave,c,i,n);m.type="mouseleave",m.target=h,m.relatedTarget=g;var v=o.getPooled(d.mouseEnter,p,i,n);return v.type="mouseenter",v.target=g,v.relatedTarget=h,a.accumulateEnterLeaveDispatches(m,v,c,p),[m,v]}};e.exports=u},function(e,t,i){"use strict";var n=i(85),a=n.injection.MUST_USE_PROPERTY,s=n.injection.HAS_BOOLEAN_VALUE,o=n.injection.HAS_NUMERIC_VALUE,r=n.injection.HAS_POSITIVE_NUMERIC_VALUE,l=n.injection.HAS_OVERLOADED_BOOLEAN_VALUE,d={isCustomAttribute:RegExp.prototype.test.bind(new RegExp("^(data|aria)-["+n.ATTRIBUTE_NAME_CHAR+"]*$")),Properties:{accept:0,acceptCharset:0,accessKey:0,action:0,allowFullScreen:s,allowTransparency:0,alt:0,async:s,autoComplete:0,autoPlay:s,capture:s,cellPadding:0,cellSpacing:0,charSet:0,challenge:0,checked:a|s,cite:0,classID:0,className:0,cols:r,colSpan:0,content:0,contentEditable:0,contextMenu:0,controls:s,coords:0,crossOrigin:0,data:0,dateTime:0,default:s,defer:s,dir:0,disabled:s,download:l,draggable:0,encType:0,form:0,formAction:0,formEncType:0,formMethod:0,formNoValidate:s,formTarget:0,frameBorder:0,headers:0,height:0,hidden:s,high:0,href:0,hrefLang:0,htmlFor:0,httpEquiv:0,icon:0,id:0,inputMode:0,integrity:0,is:0,keyParams:0,keyType:0,kind:0,label:0,lang:0,list:0,loop:s,low:0,manifest:0,marginHeight:0,marginWidth:0,max:0,maxLength:0,media:0,mediaGroup:0,method:0,min:0,minLength:0,multiple:a|s,muted:a|s,name:0,nonce:0,noValidate:s,open:s,optimum:0,pattern:0,placeholder:0,poster:0,preload:0,profile:0,radioGroup:0,readOnly:s,referrerPolicy:0,rel:0,required:s,reversed:s,role:0,rows:r,rowSpan:o,sandbox:0,scope:0,scoped:s,scrolling:0,seamless:s,selected:a|s,shape:0,size:r,sizes:0,span:r,spellCheck:0,src:0,srcDoc:0,srcLang:0,srcSet:0,start:o,step:0,style:0,summary:0,tabIndex:0,target:0,title:0,type:0,useMap:0,value:0,width:0,wmode:0,wrap:0,about:0,datatype:0,inlist:0,prefix:0,property:0,resource:0,typeof:0,vocab:0,autoCapitalize:0,autoCorrect:0,autoSave:0,color:0,itemProp:0,itemScope:s,itemType:0,itemID:0,itemRef:0,results:0,security:0,unselectable:0},DOMAttributeNames:{acceptCharset:"accept-charset",className:"class",htmlFor:"for",httpEquiv:"http-equiv"},DOMPropertyNames:{}};e.exports=d},function(e,t,i){"use strict";var n=i(15),a=i(87),s=i(34),o=i(562),r=i(46),l=(i(13),{dangerouslyReplaceNodeWithMarkup:function(e,t){if(s.canUseDOM||n("56"),t||n("57"),"HTML"===e.nodeName&&n("58"),"string"==typeof t){var i=o(t,r)[0];e.parentNode.replaceChild(i,e)}else a.replaceChildWithTree(e,t)}});e.exports=l},function(e,t,i){"use strict";function n(e){var t=e.match(u);return t&&t[1].toLowerCase()}function a(e,t){var i=d;d||l(!1);var a=n(e),s=a&&r(a);if(s){i.innerHTML=s[1]+e+s[2];for(var u=s[0];u--;)i=i.lastChild}else i.innerHTML=e;var c=i.getElementsByTagName("script");c.length&&(t||l(!1),o(c).forEach(t));for(var p=Array.from(i.childNodes);i.lastChild;)i.removeChild(i.lastChild);return p}var s=i(34),o=i(563),r=i(564),l=i(13),d=s.canUseDOM?document.createElement("div"):null,u=/^\s*<(\w+)/;e.exports=a},function(e,t,i){"use strict";function n(e){var t=e.length;if((Array.isArray(e)||"object"!=typeof e&&"function"!=typeof e)&&o(!1),"number"!=typeof t&&o(!1),0===t||t-1 in e||o(!1),"function"==typeof e.callee&&o(!1),e.hasOwnProperty)try{return Array.prototype.slice.call(e)}catch(e){}for(var i=Array(t),n=0;n<t;n++)i[n]=e[n];return i}function a(e){return!!e&&("object"==typeof e||"function"==typeof e)&&"length"in e&&!("setInterval"in e)&&"number"!=typeof e.nodeType&&(Array.isArray(e)||"callee"in e||"item"in e)}function s(e){return a(e)?Array.isArray(e)?e.slice():n(e):[e]}var o=i(13);e.exports=s},function(e,t,i){"use strict";function n(e){return o||s(!1),p.hasOwnProperty(e)||(e="*"),r.hasOwnProperty(e)||(o.innerHTML="*"===e?"<link />":"<"+e+"></"+e+">",r[e]=!o.firstChild),r[e]?p[e]:null}var a=i(34),s=i(13),o=a.canUseDOM?document.createElement("div"):null,r={},l=[1,'<select multiple="true">',"</select>"],d=[1,"<table>","</table>"],u=[3,"<table><tbody><tr>","</tr></tbody></table>"],c=[1,'<svg xmlns="http://www.w3.org/2000/svg">',"</svg>"],p={"*":[1,"?<div>","</div>"],area:[1,"<map>","</map>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],legend:[1,"<fieldset>","</fieldset>"],param:[1,"<object>","</object>"],tr:[2,"<table><tbody>","</tbody></table>"],optgroup:l,option:l,caption:d,colgroup:d,tbody:d,tfoot:d,thead:d,td:u,th:u};["circle","clipPath","defs","ellipse","g","image","line","linearGradient","mask","path","pattern","polygon","polyline","radialGradient","rect","stop","text","tspan"].forEach(function(e){p[e]=c,r[e]=!0}),e.exports=n},function(e,t,i){"use strict";var n=i(180),a=i(27),s={dangerouslyProcessChildrenUpdates:function(e,t){var i=a.getNodeFromInstance(e);n.processUpdates(i,t)}};e.exports=s},function(e,t,i){"use strict";function n(e){if(e){var t=e._currentElement._owner||null;if(t){var i=t.getName();if(i)return" This DOM node was rendered by `"+i+"`."}}return""}function a(e,t){t&&(X[e._tag]&&(null!=t.children||null!=t.dangerouslySetInnerHTML)&&g("137",e._tag,e._currentElement._owner?" Check the render method of "+e._currentElement._owner.getName()+".":""),null!=t.dangerouslySetInnerHTML&&(null!=t.children&&g("60"),"object"==typeof t.dangerouslySetInnerHTML&&W in t.dangerouslySetInnerHTML||g("61")),null!=t.style&&"object"!=typeof t.style&&g("62",n(e)))}function s(e,t,i,n){if(!(n instanceof R)){var a=e._hostContainerInfo,s=a._node&&a._node.nodeType===Y,r=s?a._node:a._ownerDocument;$(t,r),n.getReactMountReady().enqueue(o,{inst:e,registrationName:t,listener:i})}}function o(){var e=this;P.putListener(e.inst,e.registrationName,e.listener)}function r(){var e=this;A.postMountWrapper(e)}function l(){var e=this;j.postMountWrapper(e)}function d(){var e=this;L.postMountWrapper(e)}function u(){var e=this;e._rootNodeID||g("63");var t=V(e);switch(t||g("64"),e._tag){case"iframe":case"object":e._wrapperState.listeners=[T.trapBubbledEvent(k.topLevelTypes.topLoad,"load",t)];break;case"video":case"audio":e._wrapperState.listeners=[];for(var i in K)K.hasOwnProperty(i)&&e._wrapperState.listeners.push(T.trapBubbledEvent(k.topLevelTypes[i],K[i],t));break;case"source":e._wrapperState.listeners=[T.trapBubbledEvent(k.topLevelTypes.topError,"error",t)];break;case"img":e._wrapperState.listeners=[T.trapBubbledEvent(k.topLevelTypes.topError,"error",t),T.trapBubbledEvent(k.topLevelTypes.topLoad,"load",t)];break;case"form":e._wrapperState.listeners=[T.trapBubbledEvent(k.topLevelTypes.topReset,"reset",t),T.trapBubbledEvent(k.topLevelTypes.topSubmit,"submit",t)];break;case"input":case"select":case"textarea":e._wrapperState.listeners=[T.trapBubbledEvent(k.topLevelTypes.topInvalid,"invalid",t)]}}function c(){O.postUpdateWrapper(this)}function p(e){te.call(ee,e)||(Z.test(e)||g("65",e),ee[e]=!0)}function f(e,t){return e.indexOf("-")>=0||null!=t.is}function h(e){var t=e.type;p(t),this._currentElement=e,this._tag=t.toLowerCase(),this._namespaceURI=null,this._renderedChildren=null,this._previousStyle=null,this._previousStyleCopy=null,this._hostNode=null,this._hostParent=null,this._rootNodeID=null,this._domID=null,this._hostContainerInfo=null,this._wrapperState=null,this._topLevelWrapper=null,this._flags=0}var g=i(15),m=i(24),v=i(567),_=i(568),b=i(87),y=i(181),w=i(85),C=i(299),k=i(62),P=i(96),S=i(174),T=i(122),E=i(294),I=i(579),x=i(286),M=i(27),A=i(580),L=i(581),O=i(300),j=i(582),D=(i(38),i(583)),R=i(588),N=(i(46),i(121)),B=(i(13),i(178),i(71)),U=(i(187),i(190),i(17),x),F=P.deleteListener,V=M.getNodeFromInstance,$=T.listenTo,z=S.registrationNameModules,G={string:!0,number:!0},H=B({style:null}),W=B({__html:null}),q={children:null,dangerouslySetInnerHTML:null,suppressContentEditableWarning:null},Y=11,K={topAbort:"abort",topCanPlay:"canplay",topCanPlayThrough:"canplaythrough",topDurationChange:"durationchange",topEmptied:"emptied",topEncrypted:"encrypted",topEnded:"ended",topError:"error",topLoadedData:"loadeddata",topLoadedMetadata:"loadedmetadata",topLoadStart:"loadstart",topPause:"pause",topPlay:"play",topPlaying:"playing",topProgress:"progress",topRateChange:"ratechange",topSeeked:"seeked",topSeeking:"seeking",topStalled:"stalled",topSuspend:"suspend",topTimeUpdate:"timeupdate",topVolumeChange:"volumechange",topWaiting:"waiting"},Q={area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0},J={listing:!0,pre:!0,textarea:!0},X=m({menuitem:!0},Q),Z=/^[a-zA-Z][a-zA-Z:_\.\-\d]*$/,ee={},te={}.hasOwnProperty,ie=1;h.displayName="ReactDOMComponent",h.Mixin={mountComponent:function(e,t,i,n){this._rootNodeID=ie++,this._domID=i._idCounter++,this._hostParent=t,this._hostContainerInfo=i;var s=this._currentElement.props;switch(this._tag){case"audio":case"form":case"iframe":case"img":case"link":case"object":case"source":case"video":this._wrapperState={listeners:null},e.getReactMountReady().enqueue(u,this);break;case"button":s=I.getHostProps(this,s,t);break;case"input":A.mountWrapper(this,s,t),s=A.getHostProps(this,s),e.getReactMountReady().enqueue(u,this);break;case"option":L.mountWrapper(this,s,t),s=L.getHostProps(this,s);break;case"select":O.mountWrapper(this,s,t),s=O.getHostProps(this,s),e.getReactMountReady().enqueue(u,this);break;case"textarea":j.mountWrapper(this,s,t),s=j.getHostProps(this,s),e.getReactMountReady().enqueue(u,this)}a(this,s);var o,c;null!=t?(o=t._namespaceURI,c=t._tag):i._tag&&(o=i._namespaceURI,c=i._tag),(null==o||o===y.svg&&"foreignobject"===c)&&(o=y.html),o===y.html&&("svg"===this._tag?o=y.svg:"math"===this._tag&&(o=y.mathml)),this._namespaceURI=o;var p;if(e.useCreateElement){var f,h=i._ownerDocument;if(o===y.html)if("script"===this._tag){var g=h.createElement("div"),m=this._currentElement.type;g.innerHTML="<"+m+"></"+m+">",f=g.removeChild(g.firstChild)}else f=s.is?h.createElement(this._currentElement.type,s.is):h.createElement(this._currentElement.type);else f=h.createElementNS(o,this._currentElement.type);M.precacheNode(this,f),this._flags|=U.hasCachedChildNodes,this._hostParent||C.setAttributeForRoot(f),this._updateDOMProperties(null,s,e);var _=b(f);this._createInitialChildren(e,s,n,_),p=_}else{var w=this._createOpenTagMarkupAndPutListeners(e,s),k=this._createContentMarkup(e,s,n);p=!k&&Q[this._tag]?w+"/>":w+">"+k+"</"+this._currentElement.type+">"}switch(this._tag){case"input":e.getReactMountReady().enqueue(r,this),s.autoFocus&&e.getReactMountReady().enqueue(v.focusDOMComponent,this);break;case"textarea":e.getReactMountReady().enqueue(l,this),s.autoFocus&&e.getReactMountReady().enqueue(v.focusDOMComponent,this);break;case"select":case"button":s.autoFocus&&e.getReactMountReady().enqueue(v.focusDOMComponent,this);break;case"option":e.getReactMountReady().enqueue(d,this)}return p},_createOpenTagMarkupAndPutListeners:function(e,t){var i="<"+this._currentElement.type;for(var n in t)if(t.hasOwnProperty(n)){var a=t[n];if(null!=a)if(z.hasOwnProperty(n))a&&s(this,n,a,e);else{n===H&&(a&&(a=this._previousStyleCopy=m({},t.style)),a=_.createMarkupForStyles(a,this));var o=null;null!=this._tag&&f(this._tag,t)?q.hasOwnProperty(n)||(o=C.createMarkupForCustomAttribute(n,a)):o=C.createMarkupForProperty(n,a),o&&(i+=" "+o)}}return e.renderToStaticMarkup?i:(this._hostParent||(i+=" "+C.createMarkupForRoot()),i+=" "+C.createMarkupForID(this._domID))},_createContentMarkup:function(e,t,i){var n="",a=t.dangerouslySetInnerHTML;if(null!=a)null!=a.__html&&(n=a.__html);else{var s=G[typeof t.children]?t.children:null,o=null!=s?null:t.children;if(null!=s)n=N(s);else if(null!=o){var r=this.mountChildren(o,e,i);n=r.join("")}}return J[this._tag]&&"\n"===n.charAt(0)?"\n"+n:n},_createInitialChildren:function(e,t,i,n){var a=t.dangerouslySetInnerHTML;if(null!=a)null!=a.__html&&b.queueHTML(n,a.__html);else{var s=G[typeof t.children]?t.children:null,o=null!=s?null:t.children;if(null!=s)b.queueText(n,s);else if(null!=o)for(var r=this.mountChildren(o,e,i),l=0;l<r.length;l++)b.queueChild(n,r[l])}},receiveComponent:function(e,t,i){var n=this._currentElement;this._currentElement=e,this.updateComponent(t,n,e,i)},updateComponent:function(e,t,i,n){var s=t.props,o=this._currentElement.props;switch(this._tag){case"button":s=I.getHostProps(this,s),o=I.getHostProps(this,o);break;case"input":A.updateWrapper(this),s=A.getHostProps(this,s),o=A.getHostProps(this,o);break;case"option":s=L.getHostProps(this,s),o=L.getHostProps(this,o);break;case"select":s=O.getHostProps(this,s),o=O.getHostProps(this,o);break;case"textarea":j.updateWrapper(this),s=j.getHostProps(this,s),o=j.getHostProps(this,o)}a(this,o),this._updateDOMProperties(s,o,e),this._updateDOMChildren(s,o,e,n),"select"===this._tag&&e.getReactMountReady().enqueue(c,this)},_updateDOMProperties:function(e,t,i){var n,a,o;for(n in e)if(!t.hasOwnProperty(n)&&e.hasOwnProperty(n)&&null!=e[n])if(n===H){var r=this._previousStyleCopy;for(a in r)r.hasOwnProperty(a)&&(o=o||{},o[a]="");this._previousStyleCopy=null}else z.hasOwnProperty(n)?e[n]&&F(this,n):f(this._tag,e)?q.hasOwnProperty(n)||C.deleteValueForAttribute(V(this),n):(w.properties[n]||w.isCustomAttribute(n))&&C.deleteValueForProperty(V(this),n);for(n in t){var l=t[n],d=n===H?this._previousStyleCopy:null!=e?e[n]:void 0;if(t.hasOwnProperty(n)&&l!==d&&(null!=l||null!=d))if(n===H)if(l?l=this._previousStyleCopy=m({},l):this._previousStyleCopy=null,d){for(a in d)!d.hasOwnProperty(a)||l&&l.hasOwnProperty(a)||(o=o||{},o[a]="");for(a in l)l.hasOwnProperty(a)&&d[a]!==l[a]&&(o=o||{},o[a]=l[a])}else o=l;else if(z.hasOwnProperty(n))l?s(this,n,l,i):d&&F(this,n);else if(f(this._tag,t))q.hasOwnProperty(n)||C.setValueForAttribute(V(this),n,l);else if(w.properties[n]||w.isCustomAttribute(n)){var u=V(this);null!=l?C.setValueForProperty(u,n,l):C.deleteValueForProperty(u,n)}}o&&_.setValueForStyles(V(this),o,this)},_updateDOMChildren:function(e,t,i,n){var a=G[typeof e.children]?e.children:null,s=G[typeof t.children]?t.children:null,o=e.dangerouslySetInnerHTML&&e.dangerouslySetInnerHTML.__html,r=t.dangerouslySetInnerHTML&&t.dangerouslySetInnerHTML.__html,l=null!=a?null:e.children,d=null!=s?null:t.children,u=null!=a||null!=o,c=null!=s||null!=r;null!=l&&null==d?this.updateChildren(null,i,n):u&&!c&&this.updateTextContent(""),null!=s?a!==s&&this.updateTextContent(""+s):null!=r?o!==r&&this.updateMarkup(""+r):null!=d&&this.updateChildren(d,i,n)},getHostNode:function(){return V(this)},unmountComponent:function(e){switch(this._tag){case"audio":case"form":case"iframe":case"img":case"link":case"object":case"source":case"video":var t=this._wrapperState.listeners;if(t)for(var i=0;i<t.length;i++)t[i].remove();break;case"html":case"head":case"body":g("66",this._tag)}this.unmountChildren(e),M.uncacheNode(this),P.deleteAllListeners(this),E.unmountIDFromEnvironment(this._rootNodeID),this._rootNodeID=null,this._domID=null,this._wrapperState=null},getPublicInstance:function(){return V(this)}},m(h.prototype,h.Mixin,D.Mixin),e.exports=h},function(e,t,i){"use strict";var n=i(27),a=i(297),s={focusDOMComponent:function(){a(n.getNodeFromInstance(this))}};e.exports=s},function(e,t,i){"use strict";var n=i(298),a=i(34),s=(i(38),i(569),i(571)),o=i(572),r=i(574),l=(i(17),r(function(e){return o(e)})),d=!1,u="cssFloat";if(a.canUseDOM){var c=document.createElement("div").style;try{c.font=""}catch(e){d=!0}void 0===document.documentElement.style.cssFloat&&(u="styleFloat")}var p={createMarkupForStyles:function(e,t){var i="";for(var n in e)if(e.hasOwnProperty(n)){var a=e[n];null!=a&&(i+=l(n)+":",i+=s(n,a,t)+";")}return i||null},setValueForStyles:function(e,t,i){var a=e.style;for(var o in t)if(t.hasOwnProperty(o)){var r=s(o,t[o],i);if("float"!==o&&"cssFloat"!==o||(o=u),r)a[o]=r;else{var l=d&&n.shorthandPropertyExpansions[o];if(l)for(var c in l)a[c]="";else a[o]=""}}}};e.exports=p},function(e,t,i){"use strict";function n(e){return a(e.replace(s,"ms-"))}var a=i(570),s=/^-ms-/;e.exports=n},function(e,t,i){"use strict";function n(e){return e.replace(a,function(e,t){return t.toUpperCase()})}var a=/-(.)/g;e.exports=n},function(e,t,i){"use strict";function n(e,t,i){if(null==t||"boolean"==typeof t||""===t)return"";if(isNaN(t)||0===t||s.hasOwnProperty(e)&&s[e])return""+t;if("string"==typeof t){t=t.trim()}return t+"px"}var a=i(298),s=(i(17),a.isUnitlessNumber);e.exports=n},function(e,t,i){"use strict";function n(e){return a(e).replace(s,"-ms-")}var a=i(573),s=/^ms-/;e.exports=n},function(e,t,i){"use strict";function n(e){return e.replace(a,"-$1").toLowerCase()}var a=/([A-Z])/g;e.exports=n},function(e,t,i){"use strict";function n(e){var t={};return function(i){return t.hasOwnProperty(i)||(t[i]=e.call(this,i)),t[i]}}e.exports=n},function(e,t,i){"use strict";var n=null;e.exports={debugTool:n}},function(e,t,i){"use strict";function n(e){return'"'+a(e)+'"'}var a=i(121);e.exports=n},function(e,t,i){"use strict";function n(e){a.enqueueEvents(e),a.processEventQueue(!1)}var a=i(96),s={handleTopLevel:function(e,t,i,s){n(a.extractEvents(e,t,i,s))}};e.exports=s},function(e,t,i){"use strict";function n(e,t){var i={};return i[e.toLowerCase()]=t.toLowerCase(),i["Webkit"+e]="webkit"+t,i["Moz"+e]="moz"+t,i["ms"+e]="MS"+t,i["O"+e]="o"+t.toLowerCase(),i}function a(e){if(r[e])return r[e];if(!o[e])return e;var t=o[e];for(var i in t)if(t.hasOwnProperty(i)&&i in l)return r[e]=t[i];return""}var s=i(34),o={animationend:n("Animation","AnimationEnd"),animationiteration:n("Animation","AnimationIteration"),animationstart:n("Animation","AnimationStart"),transitionend:n("Transition","TransitionEnd")},r={},l={};s.canUseDOM&&(l=document.createElement("div").style,"AnimationEvent"in window||(delete o.animationend.animation,delete o.animationiteration.animation,delete o.animationstart.animation),"TransitionEvent"in window||delete o.transitionend.transition),e.exports=a},function(e,t,i){"use strict";var n=i(123),a={getHostProps:n.getHostProps};e.exports=a},function(e,t,i){"use strict";function n(){this._rootNodeID&&p.updateWrapper(this)}function a(e){var t=this._currentElement.props,i=d.executeOnChange(t,e);c.asap(n,this);var a=t.name;if("radio"===t.type&&null!=a){for(var o=u.getNodeFromInstance(this),r=o;r.parentNode;)r=r.parentNode;for(var l=r.querySelectorAll("input[name="+JSON.stringify(""+a)+'][type="radio"]'),p=0;p<l.length;p++){var f=l[p];if(f!==o&&f.form===o.form){var h=u.getInstanceFromNode(f);h||s("90"),c.asap(n,h)}}}return i}var s=i(15),o=i(24),r=i(123),l=i(299),d=i(183),u=i(27),c=i(53),p=(i(13),i(17),{getHostProps:function(e,t){var i=d.getValue(t),n=d.getChecked(t);return o({type:void 0,step:void 0},r.getHostProps(e,t),{defaultChecked:void 0,defaultValue:void 0,value:null!=i?i:e._wrapperState.initialValue,checked:null!=n?n:e._wrapperState.initialChecked,onChange:e._wrapperState.onChange})},mountWrapper:function(e,t){var i=t.defaultValue;e._wrapperState={initialChecked:null!=t.checked?t.checked:t.defaultChecked,initialValue:null!=t.value?t.value:i,listeners:null,onChange:a.bind(e)}},updateWrapper:function(e){var t=e._currentElement.props,i=t.checked;null!=i&&l.setValueForProperty(u.getNodeFromInstance(e),"checked",i||!1);var n=u.getNodeFromInstance(e),a=d.getValue(t);if(null!=a){var s=""+a;s!==n.value&&(n.value=s)}else null==t.value&&null!=t.defaultValue&&(n.defaultValue=""+t.defaultValue),null==t.checked&&null!=t.defaultChecked&&(n.defaultChecked=!!t.defaultChecked)},postMountWrapper:function(e){var t=e._currentElement.props,i=u.getNodeFromInstance(e);"submit"!==t.type&&"reset"!==t.type&&(i.value=i.value);var n=i.name;""!==n&&(i.name=""),i.defaultChecked=!i.defaultChecked,i.defaultChecked=!i.defaultChecked,""!==n&&(i.name=n)}});e.exports=p},function(e,t,i){"use strict";function n(e){var t="";return s.forEach(e,function(e){null!=e&&("string"==typeof e||"number"==typeof e?t+=e:l||(l=!0))}),t}var a=i(24),s=i(279),o=i(27),r=i(300),l=(i(17),!1),d={mountWrapper:function(e,t,i){var a=null;if(null!=i){var s=i;"optgroup"===s._tag&&(s=s._hostParent),null!=s&&"select"===s._tag&&(a=r.getSelectValueContext(s))}var o=null;if(null!=a){var l;if(l=null!=t.value?t.value+"":n(t.children),o=!1,Array.isArray(a)){for(var d=0;d<a.length;d++)if(""+a[d]===l){o=!0;break}}else o=""+a===l}e._wrapperState={selected:o}},postMountWrapper:function(e){var t=e._currentElement.props;if(null!=t.value){o.getNodeFromInstance(e).setAttribute("value",t.value)}},getHostProps:function(e,t){var i=a({selected:void 0,children:void 0},t);null!=e._wrapperState.selected&&(i.selected=e._wrapperState.selected);var s=n(t.children);return s&&(i.children=s),i}};e.exports=d},function(e,t,i){"use strict";function n(){this._rootNodeID&&c.updateWrapper(this)}function a(e){var t=this._currentElement.props,i=l.executeOnChange(t,e);return u.asap(n,this),i}var s=i(15),o=i(24),r=i(123),l=i(183),d=i(27),u=i(53),c=(i(13),i(17),{getHostProps:function(e,t){return null!=t.dangerouslySetInnerHTML&&s("91"),o({},r.getHostProps(e,t),{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue,onChange:e._wrapperState.onChange})},mountWrapper:function(e,t){var i=l.getValue(t),n=i;if(null==i){var o=t.defaultValue,r=t.children;null!=r&&(null!=o&&s("92"),Array.isArray(r)&&(r.length<=1||s("93"),r=r[0]),o=""+r),null==o&&(o=""),n=o}e._wrapperState={initialValue:""+n,listeners:null,onChange:a.bind(e)}},updateWrapper:function(e){var t=e._currentElement.props,i=d.getNodeFromInstance(e),n=l.getValue(t);if(null!=n){var a=""+n;a!==i.value&&(i.value=a),null==t.defaultValue&&(i.defaultValue=a)}null!=t.defaultValue&&(i.defaultValue=t.defaultValue)},postMountWrapper:function(e){var t=d.getNodeFromInstance(e);t.value=t.textContent}});e.exports=c},function(e,t,i){"use strict";function n(e,t,i){return{type:p.INSERT_MARKUP,content:e,fromIndex:null,fromNode:null,toIndex:i,afterNode:t}}function a(e,t,i){return{type:p.MOVE_EXISTING,content:null,fromIndex:e._mountIndex,fromNode:f.getHostNode(e),toIndex:i,afterNode:t}}function s(e,t){return{type:p.REMOVE_NODE,content:null,fromIndex:e._mountIndex,fromNode:t,toIndex:null,afterNode:null}}function o(e){return{type:p.SET_MARKUP,content:e,fromIndex:null,fromNode:null,toIndex:null,afterNode:null}}function r(e){return{type:p.TEXT_CONTENT,content:e,fromIndex:null,fromNode:null,toIndex:null,afterNode:null}}function l(e,t){return t&&(e=e||[],e.push(t)),e}function d(e,t){c.processChildrenUpdates(e,t)}var u=i(15),c=i(184),p=(i(99),i(38),i(296)),f=(i(70),i(86)),h=i(584),g=(i(46),i(587)),m=(i(13),{Mixin:{_reconcilerInstantiateChildren:function(e,t,i){return h.instantiateChildren(e,t,i)},_reconcilerUpdateChildren:function(e,t,i,n,a,s){var o;return o=g(t),h.updateChildren(e,o,i,n,a,this,this._hostContainerInfo,s),o},mountChildren:function(e,t,i){var n=this._reconcilerInstantiateChildren(e,t,i);this._renderedChildren=n;var a=[],s=0;for(var o in n)if(n.hasOwnProperty(o)){var r=n[o],l=f.mountComponent(r,t,this,this._hostContainerInfo,i);r._mountIndex=s++,a.push(l)}return a},updateTextContent:function(e){var t=this._renderedChildren;h.unmountChildren(t,!1);for(var i in t)t.hasOwnProperty(i)&&u("118");d(this,[r(e)])},updateMarkup:function(e){var t=this._renderedChildren;h.unmountChildren(t,!1);for(var i in t)t.hasOwnProperty(i)&&u("118");d(this,[o(e)])},updateChildren:function(e,t,i){this._updateChildren(e,t,i)},_updateChildren:function(e,t,i){var n=this._renderedChildren,a={},s=[],o=this._reconcilerUpdateChildren(n,e,s,a,t,i);if(o||n){var r,u=null,c=0,p=0,h=0,g=null;for(r in o)if(o.hasOwnProperty(r)){var m=n&&n[r],v=o[r];m===v?(u=l(u,this.moveChild(m,g,c,p)),p=Math.max(m._mountIndex,p),m._mountIndex=c):(m&&(p=Math.max(m._mountIndex,p)),u=l(u,this._mountChildAtIndex(v,s[h],g,c,t,i)),h++),c++,g=f.getHostNode(v)}for(r in a)a.hasOwnProperty(r)&&(u=l(u,this._unmountChild(n[r],a[r])));u&&d(this,u),this._renderedChildren=o}},unmountChildren:function(e){var t=this._renderedChildren;h.unmountChildren(t,e),this._renderedChildren=null},moveChild:function(e,t,i,n){if(e._mountIndex<n)return a(e,t,i)},createChild:function(e,t,i){return n(i,t,e._mountIndex)},removeChild:function(e,t){return s(e,t)},_mountChildAtIndex:function(e,t,i,n,a,s){return e._mountIndex=n,this.createChild(e,i,t)},_unmountChild:function(e,t){var i=this.removeChild(e,t);return e._mountIndex=null,i}}});e.exports=m},function(e,t,i){"use strict";(function(t){function n(e,t,i,n){var a=void 0===e[i];null!=t&&a&&(e[i]=s(t,!0))}var a=i(86),s=i(301),o=(i(168),i(188)),r=i(167);i(17);void 0!==t&&Object({NODE_ENV:"production"});var l={instantiateChildren:function(e,t,i,a){if(null==e)return null;var s={};return r(e,n,s),s},updateChildren:function(e,t,i,n,r,l,d,u){if(t||e){var c,p;for(c in t)if(t.hasOwnProperty(c)){p=e&&e[c];var f=p&&p._currentElement,h=t[c];if(null!=p&&o(f,h))a.receiveComponent(p,h,r,u),t[c]=p;else{p&&(n[c]=a.getHostNode(p),a.unmountComponent(p,!1));var g=s(h,!0);t[c]=g;var m=a.mountComponent(g,r,l,d,u);i.push(m)}}for(c in e)!e.hasOwnProperty(c)||t&&t.hasOwnProperty(c)||(p=e[c],n[c]=a.getHostNode(p),a.unmountComponent(p,!1))}},unmountChildren:function(e,t){for(var i in e)if(e.hasOwnProperty(i)){var n=e[i];a.unmountComponent(n,t)}}};e.exports=l}).call(t,i(185))},function(e,t,i){"use strict";function n(e){}function a(e){return!(!e.prototype||!e.prototype.isReactComponent)}function s(e){return!(!e.prototype||!e.prototype.isPureReactComponent)}var o=i(15),r=i(24),l=i(184),d=i(70),u=i(52),c=i(176),p=i(99),f=(i(38),i(302)),h=(i(171),i(86)),g=i(586),m=i(94),v=(i(13),i(187)),_=i(188),b=(i(17),{ImpureClass:0,PureClass:1,StatelessFunctional:2});n.prototype.render=function(){var e=p.get(this)._currentElement.type,t=e(this.props,this.context,this.updater);return t};var y=1,w={construct:function(e){this._currentElement=e,this._rootNodeID=null,this._compositeType=null,this._instance=null,this._hostParent=null,this._hostContainerInfo=null,this._updateBatchNumber=null,this._pendingElement=null,this._pendingStateQueue=null,this._pendingReplaceState=!1,this._pendingForceUpdate=!1,this._renderedNodeType=null,this._renderedComponent=null,this._context=null,this._mountOrder=0,this._topLevelWrapper=null,this._pendingCallbacks=null,this._calledComponentWillUnmount=!1},mountComponent:function(e,t,i,r){this._context=r,this._mountOrder=y++,this._hostParent=t,this._hostContainerInfo=i;var l,d=this._currentElement.props,c=this._processContext(r),f=this._currentElement.type,h=e.getUpdateQueue(),g=a(f),v=this._constructComponent(g,d,c,h);g||null!=v&&null!=v.render?s(f)?this._compositeType=b.PureClass:this._compositeType=b.ImpureClass:(l=v,null===v||!1===v||u.isValidElement(v)||o("105",f.displayName||f.name||"Component"),v=new n(f),this._compositeType=b.StatelessFunctional);v.props=d,v.context=c,v.refs=m,v.updater=h,this._instance=v,p.set(v,this);var _=v.state;void 0===_&&(v.state=_=null),("object"!=typeof _||Array.isArray(_))&&o("106",this.getName()||"ReactCompositeComponent"),this._pendingStateQueue=null,this._pendingReplaceState=!1,this._pendingForceUpdate=!1;var w;w=v.unstable_handleError?this.performInitialMountWithErrorHandling(l,t,i,e,r):this.performInitialMount(l,t,i,e,r),v.componentDidMount&&e.getReactMountReady().enqueue(v.componentDidMount,v);return w},_constructComponent:function(e,t,i,n){return this._constructComponentWithoutOwner(e,t,i,n)},_constructComponentWithoutOwner:function(e,t,i,n){var a=this._currentElement.type;return e?new a(t,i,n):a(t,i,n)},performInitialMountWithErrorHandling:function(e,t,i,n,a){var s,o=n.checkpoint();try{s=this.performInitialMount(e,t,i,n,a)}catch(r){n.rollback(o),this._instance.unstable_handleError(r),this._pendingStateQueue&&(this._instance.state=this._processPendingState(this._instance.props,this._instance.context)),o=n.checkpoint(),this._renderedComponent.unmountComponent(!0),n.rollback(o),s=this.performInitialMount(e,t,i,n,a)}return s},performInitialMount:function(e,t,i,n,a){var s=this._instance;s.componentWillMount&&(s.componentWillMount(),this._pendingStateQueue&&(s.state=this._processPendingState(s.props,s.context))),void 0===e&&(e=this._renderValidatedComponent());var o=f.getType(e);this._renderedNodeType=o;var r=this._instantiateReactComponent(e,o!==f.EMPTY);return this._renderedComponent=r,h.mountComponent(r,n,t,i,this._processChildContext(a))},getHostNode:function(){return h.getHostNode(this._renderedComponent)},unmountComponent:function(e){if(this._renderedComponent){var t=this._instance;if(t.componentWillUnmount&&!t._calledComponentWillUnmount)if(t._calledComponentWillUnmount=!0,e){var i=this.getName()+".componentWillUnmount()";c.invokeGuardedCallback(i,t.componentWillUnmount.bind(t))}else t.componentWillUnmount();this._renderedComponent&&(h.unmountComponent(this._renderedComponent,e),this._renderedNodeType=null,this._renderedComponent=null,this._instance=null),this._pendingStateQueue=null,this._pendingReplaceState=!1,this._pendingForceUpdate=!1,this._pendingCallbacks=null,this._pendingElement=null,this._context=null,this._rootNodeID=null,this._topLevelWrapper=null,p.remove(t)}},_maskContext:function(e){var t=this._currentElement.type,i=t.contextTypes;if(!i)return m;var n={};for(var a in i)n[a]=e[a];return n},_processContext:function(e){var t=this._maskContext(e);return t},_processChildContext:function(e){var t=this._currentElement.type,i=this._instance,n=i.getChildContext&&i.getChildContext();if(n){"object"!=typeof t.childContextTypes&&o("107",this.getName()||"ReactCompositeComponent");for(var a in n)a in t.childContextTypes||o("108",this.getName()||"ReactCompositeComponent",a);return r({},e,n)}return e},_checkContextTypes:function(e,t,i){g(e,t,i,this.getName(),null,this._debugID)},receiveComponent:function(e,t,i){var n=this._currentElement,a=this._context;this._pendingElement=null,this.updateComponent(t,n,e,a,i)},performUpdateIfNecessary:function(e){null!=this._pendingElement?h.receiveComponent(this,this._pendingElement,e,this._context):null!==this._pendingStateQueue||this._pendingForceUpdate?this.updateComponent(e,this._currentElement,this._currentElement,this._context,this._context):this._updateBatchNumber=null},updateComponent:function(e,t,i,n,a){var s=this._instance;null==s&&o("136",this.getName()||"ReactCompositeComponent");var r,l=!1;this._context===a?r=s.context:(r=this._processContext(a),l=!0);var d=t.props,u=i.props;t!==i&&(l=!0),l&&s.componentWillReceiveProps&&s.componentWillReceiveProps(u,r);var c=this._processPendingState(u,r),p=!0;this._pendingForceUpdate||(s.shouldComponentUpdate?p=s.shouldComponentUpdate(u,c,r):this._compositeType===b.PureClass&&(p=!v(d,u)||!v(s.state,c))),this._updateBatchNumber=null,p?(this._pendingForceUpdate=!1,this._performComponentUpdate(i,u,c,r,e,a)):(this._currentElement=i,this._context=a,s.props=u,s.state=c,s.context=r)},_processPendingState:function(e,t){var i=this._instance,n=this._pendingStateQueue,a=this._pendingReplaceState;if(this._pendingReplaceState=!1,this._pendingStateQueue=null,!n)return i.state;if(a&&1===n.length)return n[0];for(var s=r({},a?n[0]:i.state),o=a?1:0;o<n.length;o++){var l=n[o];r(s,"function"==typeof l?l.call(i,s,e,t):l)}return s},_performComponentUpdate:function(e,t,i,n,a,s){var o,r,l,d=this._instance,u=Boolean(d.componentDidUpdate);u&&(o=d.props,r=d.state,l=d.context),d.componentWillUpdate&&d.componentWillUpdate(t,i,n),this._currentElement=e,this._context=s,d.props=t,d.state=i,d.context=n,this._updateRenderedComponent(a,s),u&&a.getReactMountReady().enqueue(d.componentDidUpdate.bind(d,o,r,l),d)},_updateRenderedComponent:function(e,t){var i=this._renderedComponent,n=i._currentElement,a=this._renderValidatedComponent();if(_(n,a))h.receiveComponent(i,a,e,this._processChildContext(t));else{var s=h.getHostNode(i);h.unmountComponent(i,!1);var o=f.getType(a);this._renderedNodeType=o;var r=this._instantiateReactComponent(a,o!==f.EMPTY);this._renderedComponent=r;var l=h.mountComponent(r,e,this._hostParent,this._hostContainerInfo,this._processChildContext(t));this._replaceNodeWithMarkup(s,l,i)}},_replaceNodeWithMarkup:function(e,t,i){l.replaceNodeWithMarkup(e,t,i)},_renderValidatedComponentWithoutOwnerOrContext:function(){var e=this._instance,t=e.render();return t},_renderValidatedComponent:function(){var e;if(this._compositeType!==b.StatelessFunctional){d.current=this;try{e=this._renderValidatedComponentWithoutOwnerOrContext()}finally{d.current=null}}else e=this._renderValidatedComponentWithoutOwnerOrContext();return null===e||!1===e||u.isValidElement(e)||o("109",this.getName()||"ReactCompositeComponent"),e},attachRef:function(e,t){var i=this.getPublicInstance();null==i&&o("110");var n=t.getPublicInstance();(i.refs===m?i.refs={}:i.refs)[e]=n},detachRef:function(e){delete this.getPublicInstance().refs[e]},getName:function(){var e=this._currentElement.type,t=this._instance&&this._instance.constructor;return e.displayName||t&&t.displayName||e.name||t&&t.name||null},getPublicInstance:function(){var e=this._instance;return this._compositeType===b.StatelessFunctional?null:e},_instantiateReactComponent:null},C={Mixin:w};e.exports=C},function(e,t,i){"use strict";(function(t){function n(e,t,i,n,l,d){for(var u in e)if(e.hasOwnProperty(u)){var c;try{"function"!=typeof e[u]&&a("84",n||"React class",s[i],u),c=e[u](t,u,n,i,null,o)}catch(e){c=e}if(c instanceof Error&&!(c.message in r)){r[c.message]=!0}}}var a=i(15),s=i(172),o=i(173);i(13),i(17);void 0!==t&&Object({NODE_ENV:"production"});var r={};e.exports=n}).call(t,i(185))},function(e,t,i){"use strict";(function(t){function n(e,t,i,n){if(e&&"object"==typeof e){var a=e,s=void 0===a[i];s&&null!=t&&(a[i]=t)}}function a(e,t){if(null==e)return e;var i={};return s(e,n,i),i}var s=(i(168),i(167));i(17);void 0!==t&&Object({NODE_ENV:"production"}),e.exports=a}).call(t,i(185))},function(e,t,i){"use strict";function n(e){this.reinitializeTransaction(),this.renderToStaticMarkup=e,this.useCreateElement=!1,this.updateQueue=new r(this)}var a=i(24),s=i(69),o=i(97),r=(i(38),i(589)),l=[],d={enqueue:function(){}},u={getTransactionWrappers:function(){return l},getReactMountReady:function(){return d},getUpdateQueue:function(){return this.updateQueue},destructor:function(){},checkpoint:function(){},rollback:function(){}};a(n.prototype,o.Mixin,u),s.addPoolingTo(n),e.exports=n},function(e,t,i){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var a=i(189),s=(i(97),i(17),function(){function e(t){n(this,e),this.transaction=t}return e.prototype.isMounted=function(e){return!1},e.prototype.enqueueCallback=function(e,t,i){this.transaction.isInTransaction()&&a.enqueueCallback(e,t,i)},e.prototype.enqueueForceUpdate=function(e){this.transaction.isInTransaction()&&a.enqueueForceUpdate(e)},e.prototype.enqueueReplaceState=function(e,t){this.transaction.isInTransaction()&&a.enqueueReplaceState(e,t)},e.prototype.enqueueSetState=function(e,t){this.transaction.isInTransaction()&&a.enqueueSetState(e,t)},e}());e.exports=s},function(e,t,i){"use strict";var n=i(24),a=i(87),s=i(27),o=function(e){this._currentElement=null,this._hostNode=null,this._hostParent=null,this._hostContainerInfo=null,this._domID=null};n(o.prototype,{mountComponent:function(e,t,i,n){var o=i._idCounter++;this._domID=o,this._hostParent=t,this._hostContainerInfo=i;var r=" react-empty: "+this._domID+" ";if(e.useCreateElement){var l=i._ownerDocument,d=l.createComment(r);return s.precacheNode(this,d),a(d)}return e.renderToStaticMarkup?"":"\x3c!--"+r+"--\x3e"},receiveComponent:function(){},getHostNode:function(){return s.getNodeFromInstance(this)},unmountComponent:function(){s.uncacheNode(this)}}),e.exports=o},function(e,t,i){"use strict";function n(e,t){"_hostNode"in e||l("33"),"_hostNode"in t||l("33");for(var i=0,n=e;n;n=n._hostParent)i++;for(var a=0,s=t;s;s=s._hostParent)a++;for(;i-a>0;)e=e._hostParent,i--;for(;a-i>0;)t=t._hostParent,a--;for(var o=i;o--;){if(e===t)return e;e=e._hostParent,t=t._hostParent}return null}function a(e,t){"_hostNode"in e||l("35"),"_hostNode"in t||l("35");for(;t;){if(t===e)return!0;t=t._hostParent}return!1}function s(e){return"_hostNode"in e||l("36"),e._hostParent}function o(e,t,i){for(var n=[];e;)n.push(e),e=e._hostParent;var a;for(a=n.length;a-- >0;)t(n[a],!1,i);for(a=0;a<n.length;a++)t(n[a],!0,i)}function r(e,t,i,a,s){for(var o=e&&t?n(e,t):null,r=[];e&&e!==o;)r.push(e),e=e._hostParent;for(var l=[];t&&t!==o;)l.push(t),t=t._hostParent;var d;for(d=0;d<r.length;d++)i(r[d],!0,a);for(d=l.length;d-- >0;)i(l[d],!1,s)}var l=i(15);i(13);e.exports={isAncestor:a,getLowestCommonAncestor:n,getParentInstance:s,traverseTwoPhase:o,traverseEnterLeave:r}},function(e,t,i){"use strict";var n=i(15),a=i(24),s=i(180),o=i(87),r=i(27),l=(i(38),i(121)),d=(i(13),i(190),function(e){this._currentElement=e,this._stringText=""+e,this._hostNode=null,this._hostParent=null,this._domID=null,this._mountIndex=0,this._closingComment=null,this._commentNodes=null});a(d.prototype,{mountComponent:function(e,t,i,n){var a=i._idCounter++,s=" react-text: "+a+" ";if(this._domID=a,this._hostParent=t,e.useCreateElement){var d=i._ownerDocument,u=d.createComment(s),c=d.createComment(" /react-text "),p=o(d.createDocumentFragment());return o.queueChild(p,o(u)),this._stringText&&o.queueChild(p,o(d.createTextNode(this._stringText))),o.queueChild(p,o(c)),r.precacheNode(this,u),this._closingComment=c,p}var f=l(this._stringText);return e.renderToStaticMarkup?f:"\x3c!--"+s+"--\x3e"+f+"\x3c!-- /react-text --\x3e"},receiveComponent:function(e,t){if(e!==this._currentElement){this._currentElement=e;var i=""+e;if(i!==this._stringText){this._stringText=i;var n=this.getHostNode();s.replaceDelimitedText(n[0],n[1],i)}}},getHostNode:function(){var e=this._commentNodes;if(e)return e;if(!this._closingComment)for(var t=r.getNodeFromInstance(this),i=t.nextSibling;;){if(null==i&&n("67",this._domID),8===i.nodeType&&" /react-text "===i.nodeValue){this._closingComment=i;break}i=i.nextSibling}return e=[this._hostNode,this._closingComment],this._commentNodes=e,e},unmountComponent:function(){this._closingComment=null,this._commentNodes=null,r.uncacheNode(this)}}),e.exports=d},function(e,t,i){"use strict";function n(){this.reinitializeTransaction()}var a=i(24),s=i(53),o=i(97),r=i(46),l={initialize:r,close:function(){p.isBatchingUpdates=!1}},d={initialize:r,close:s.flushBatchedUpdates.bind(s)},u=[d,l];a(n.prototype,o.Mixin,{getTransactionWrappers:function(){return u}});var c=new n,p={isBatchingUpdates:!1,batchedUpdates:function(e,t,i,n,a,s){var o=p.isBatchingUpdates;p.isBatchingUpdates=!0,o?e(t,i,n,a,s):c.perform(e,null,t,i,n,a,s)}};e.exports=p},function(e,t,i){"use strict";function n(e){for(;e._hostParent;)e=e._hostParent;var t=c.getNodeFromInstance(e),i=t.parentNode;return c.getClosestInstanceFromNode(i)}function a(e,t){this.topLevelType=e,this.nativeEvent=t,this.ancestors=[]}function s(e){var t=f(e.nativeEvent),i=c.getClosestInstanceFromNode(t),a=i;do{e.ancestors.push(a),a=a&&n(a)}while(a);for(var s=0;s<e.ancestors.length;s++)i=e.ancestors[s],g._handleTopLevel(e.topLevelType,i,e.nativeEvent,f(e.nativeEvent))}function o(e){e(h(window))}var r=i(24),l=i(305),d=i(34),u=i(69),c=i(27),p=i(53),f=i(177),h=i(595);r(a.prototype,{destructor:function(){this.topLevelType=null,this.nativeEvent=null,this.ancestors.length=0}}),u.addPoolingTo(a,u.twoArgumentPooler);var g={_enabled:!0,_handleTopLevel:null,WINDOW_HANDLE:d.canUseDOM?window:null,setHandleTopLevel:function(e){g._handleTopLevel=e},setEnabled:function(e){g._enabled=!!e},isEnabled:function(){return g._enabled},trapBubbledEvent:function(e,t,i){var n=i;return n?l.listen(n,t,g.dispatchEvent.bind(null,e)):null},trapCapturedEvent:function(e,t,i){var n=i;return n?l.capture(n,t,g.dispatchEvent.bind(null,e)):null},monitorScrollValue:function(e){var t=o.bind(null,e);l.listen(window,"scroll",t)},dispatchEvent:function(e,t){if(g._enabled){var i=a.getPooled(e,t);try{p.batchedUpdates(s,i)}finally{a.release(i)}}}};e.exports=g},function(e,t,i){"use strict";function n(e){return e.Window&&e instanceof e.Window?{x:e.pageXOffset||e.document.documentElement.scrollLeft,y:e.pageYOffset||e.document.documentElement.scrollTop}:{x:e.scrollLeft,y:e.scrollTop}}e.exports=n},function(e,t,i){"use strict";var n=i(85),a=i(96),s=i(175),o=i(184),r=i(282),l=i(303),d=i(122),u=i(304),c=i(53),p={Component:o.injection,Class:r.injection,DOMProperty:n.injection,EmptyComponent:l.injection,EventPluginHub:a.injection,EventPluginUtils:s.injection,EventEmitter:d.injection,HostComponent:u.injection,Updates:c.injection};e.exports=p},function(e,t,i){"use strict";function n(e){this.reinitializeTransaction(),this.renderToStaticMarkup=!1,this.reactMountReady=s.getPooled(null),this.useCreateElement=e}var a=i(24),s=i(290),o=i(69),r=i(122),l=i(306),d=(i(38),i(97)),u=i(189),c={initialize:l.getSelectionInformation,close:l.restoreSelection},p={initialize:function(){var e=r.isEnabled();return r.setEnabled(!1),e},close:function(e){r.setEnabled(e)}},f={initialize:function(){this.reactMountReady.reset()},close:function(){this.reactMountReady.notifyAll()}},h=[c,p,f],g={getTransactionWrappers:function(){return h},getReactMountReady:function(){return this.reactMountReady},getUpdateQueue:function(){return u},checkpoint:function(){return this.reactMountReady.checkpoint()},rollback:function(e){this.reactMountReady.rollback(e)},destructor:function(){s.release(this.reactMountReady),this.reactMountReady=null}};a(n.prototype,d.Mixin,g),o.addPoolingTo(n),e.exports=n},function(e,t,i){"use strict";function n(e,t,i,n){return e===i&&t===n}function a(e){var t=document.selection,i=t.createRange(),n=i.text.length,a=i.duplicate();a.moveToElementText(e),a.setEndPoint("EndToStart",i);var s=a.text.length;return{start:s,end:s+n}}function s(e){var t=window.getSelection&&window.getSelection();if(!t||0===t.rangeCount)return null;var i=t.anchorNode,a=t.anchorOffset,s=t.focusNode,o=t.focusOffset,r=t.getRangeAt(0);try{r.startContainer.nodeType,r.endContainer.nodeType}catch(e){return null}var l=n(t.anchorNode,t.anchorOffset,t.focusNode,t.focusOffset),d=l?0:r.toString().length,u=r.cloneRange();u.selectNodeContents(e),u.setEnd(r.startContainer,r.startOffset);var c=n(u.startContainer,u.startOffset,u.endContainer,u.endOffset),p=c?0:u.toString().length,f=p+d,h=document.createRange();h.setStart(i,a),h.setEnd(s,o);var g=h.collapsed;return{start:g?f:p,end:g?p:f}}function o(e,t){var i,n,a=document.selection.createRange().duplicate();void 0===t.end?(i=t.start,n=i):t.start>t.end?(i=t.end,n=t.start):(i=t.start,n=t.end),a.moveToElementText(e),a.moveStart("character",i),a.setEndPoint("EndToStart",a),a.moveEnd("character",n-i),a.select()}function r(e,t){if(window.getSelection){var i=window.getSelection(),n=e[u()].length,a=Math.min(t.start,n),s=void 0===t.end?a:Math.min(t.end,n);if(!i.extend&&a>s){var o=s;s=a,a=o}var r=d(e,a),l=d(e,s);if(r&&l){var c=document.createRange();c.setStart(r.node,r.offset),i.removeAllRanges(),a>s?(i.addRange(c),i.extend(l.node,l.offset)):(c.setEnd(l.node,l.offset),i.addRange(c))}}}var l=i(34),d=i(599),u=i(289),c=l.canUseDOM&&"selection"in document&&!("getSelection"in window),p={getOffsets:c?a:s,setOffsets:c?o:r};e.exports=p},function(e,t,i){"use strict";function n(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function a(e){for(;e;){if(e.nextSibling)return e.nextSibling;e=e.parentNode}}function s(e,t){for(var i=n(e),s=0,o=0;i;){if(3===i.nodeType){if(o=s+i.textContent.length,s<=t&&o>=t)return{node:i,offset:t-s};s=o}i=n(a(i))}}e.exports=s},function(e,t,i){"use strict";function n(e,t){return!(!e||!t)&&(e===t||!a(e)&&(a(t)?n(e,t.parentNode):"contains"in e?e.contains(t):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(t))))}var a=i(601);e.exports=n},function(e,t,i){"use strict";function n(e){return a(e)&&3==e.nodeType}var a=i(602);e.exports=n},function(e,t,i){"use strict";function n(e){var t=e?e.ownerDocument||e:document,i=t.defaultView||window;return!(!e||!("function"==typeof i.Node?e instanceof i.Node:"object"==typeof e&&"number"==typeof e.nodeType&&"string"==typeof e.nodeName))}e.exports=n},function(e,t,i){"use strict";var n={xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace"},a={accentHeight:"accent-height",accumulate:0,additive:0,alignmentBaseline:"alignment-baseline",allowReorder:"allowReorder",alphabetic:0,amplitude:0,arabicForm:"arabic-form",ascent:0,attributeName:"attributeName",attributeType:"attributeType",autoReverse:"autoReverse",azimuth:0,baseFrequency:"baseFrequency",baseProfile:"baseProfile",baselineShift:"baseline-shift",bbox:0,begin:0,bias:0,by:0,calcMode:"calcMode",capHeight:"cap-height",clip:0,clipPath:"clip-path",clipRule:"clip-rule",clipPathUnits:"clipPathUnits",colorInterpolation:"color-interpolation",colorInterpolationFilters:"color-interpolation-filters",colorProfile:"color-profile",colorRendering:"color-rendering",contentScriptType:"contentScriptType",contentStyleType:"contentStyleType",cursor:0,cx:0,cy:0,d:0,decelerate:0,descent:0,diffuseConstant:"diffuseConstant",direction:0,display:0,divisor:0,dominantBaseline:"dominant-baseline",dur:0,dx:0,dy:0,edgeMode:"edgeMode",elevation:0,enableBackground:"enable-background",end:0,exponent:0,externalResourcesRequired:"externalResourcesRequired",fill:0,fillOpacity:"fill-opacity",fillRule:"fill-rule",filter:0,filterRes:"filterRes",filterUnits:"filterUnits",floodColor:"flood-color",floodOpacity:"flood-opacity",focusable:0,fontFamily:"font-family",fontSize:"font-size",fontSizeAdjust:"font-size-adjust",fontStretch:"font-stretch",fontStyle:"font-style",fontVariant:"font-variant",fontWeight:"font-weight",format:0,from:0,fx:0,fy:0,g1:0,g2:0,glyphName:"glyph-name",glyphOrientationHorizontal:"glyph-orientation-horizontal",glyphOrientationVertical:"glyph-orientation-vertical",glyphRef:"glyphRef",gradientTransform:"gradientTransform",gradientUnits:"gradientUnits",hanging:0,horizAdvX:"horiz-adv-x",horizOriginX:"horiz-origin-x",ideographic:0,imageRendering:"image-rendering",in:0,in2:0,intercept:0,k:0,k1:0,k2:0,k3:0,k4:0,kernelMatrix:"kernelMatrix",kernelUnitLength:"kernelUnitLength",kerning:0,keyPoints:"keyPoints",keySplines:"keySplines",keyTimes:"keyTimes",lengthAdjust:"lengthAdjust",letterSpacing:"letter-spacing",lightingColor:"lighting-color",limitingConeAngle:"limitingConeAngle",local:0,markerEnd:"marker-end",markerMid:"marker-mid",markerStart:"marker-start",markerHeight:"markerHeight",markerUnits:"markerUnits",markerWidth:"markerWidth",mask:0,maskContentUnits:"maskContentUnits",maskUnits:"maskUnits",mathematical:0,mode:0,numOctaves:"numOctaves",offset:0,opacity:0,operator:0,order:0,orient:0,orientation:0,origin:0,overflow:0,overlinePosition:"overline-position",overlineThickness:"overline-thickness",paintOrder:"paint-order",panose1:"panose-1",pathLength:"pathLength",patternContentUnits:"patternContentUnits",patternTransform:"patternTransform",patternUnits:"patternUnits",pointerEvents:"pointer-events",points:0,pointsAtX:"pointsAtX",pointsAtY:"pointsAtY",pointsAtZ:"pointsAtZ",preserveAlpha:"preserveAlpha",preserveAspectRatio:"preserveAspectRatio",primitiveUnits:"primitiveUnits",r:0,radius:0,refX:"refX",refY:"refY",renderingIntent:"rendering-intent",repeatCount:"repeatCount",repeatDur:"repeatDur",requiredExtensions:"requiredExtensions",requiredFeatures:"requiredFeatures",restart:0,result:0,rotate:0,rx:0,ry:0,scale:0,seed:0,shapeRendering:"shape-rendering",slope:0,spacing:0,specularConstant:"specularConstant",specularExponent:"specularExponent",speed:0,spreadMethod:"spreadMethod",startOffset:"startOffset",stdDeviation:"stdDeviation",stemh:0,stemv:0,stitchTiles:"stitchTiles",stopColor:"stop-color",stopOpacity:"stop-opacity",strikethroughPosition:"strikethrough-position",strikethroughThickness:"strikethrough-thickness",string:0,stroke:0,strokeDasharray:"stroke-dasharray",strokeDashoffset:"stroke-dashoffset",strokeLinecap:"stroke-linecap",strokeLinejoin:"stroke-linejoin",strokeMiterlimit:"stroke-miterlimit",strokeOpacity:"stroke-opacity",strokeWidth:"stroke-width",surfaceScale:"surfaceScale",systemLanguage:"systemLanguage",tableValues:"tableValues",targetX:"targetX",targetY:"targetY",textAnchor:"text-anchor",textDecoration:"text-decoration",textRendering:"text-rendering",textLength:"textLength",to:0,transform:0,u1:0,u2:0,underlinePosition:"underline-position",underlineThickness:"underline-thickness",unicode:0,unicodeBidi:"unicode-bidi",unicodeRange:"unicode-range",unitsPerEm:"units-per-em",vAlphabetic:"v-alphabetic",vHanging:"v-hanging",vIdeographic:"v-ideographic",vMathematical:"v-mathematical",values:0,vectorEffect:"vector-effect",version:0,vertAdvY:"vert-adv-y",vertOriginX:"vert-origin-x",vertOriginY:"vert-origin-y",viewBox:"viewBox",viewTarget:"viewTarget",visibility:0,widths:0,wordSpacing:"word-spacing",writingMode:"writing-mode",x:0,xHeight:"x-height",x1:0,x2:0,xChannelSelector:"xChannelSelector",xlinkActuate:"xlink:actuate",xlinkArcrole:"xlink:arcrole",xlinkHref:"xlink:href",xlinkRole:"xlink:role",xlinkShow:"xlink:show",xlinkTitle:"xlink:title",xlinkType:"xlink:type",xmlBase:"xml:base",xmlns:0,xmlnsXlink:"xmlns:xlink",xmlLang:"xml:lang",xmlSpace:"xml:space",y:0,y1:0,y2:0,yChannelSelector:"yChannelSelector",z:0,zoomAndPan:"zoomAndPan"},s={Properties:{},DOMAttributeNamespaces:{xlinkActuate:n.xlink,xlinkArcrole:n.xlink,xlinkHref:n.xlink,xlinkRole:n.xlink,xlinkShow:n.xlink,xlinkTitle:n.xlink,xlinkType:n.xlink,xmlBase:n.xml,xmlLang:n.xml,xmlSpace:n.xml},DOMAttributeNames:{}};Object.keys(a).forEach(function(e){s.Properties[e]=0,a[e]&&(s.DOMAttributeNames[e]=a[e])}),e.exports=s},function(e,t,i){"use strict";function n(e){if("selectionStart"in e&&d.hasSelectionCapabilities(e))return{start:e.selectionStart,end:e.selectionEnd};if(window.getSelection){var t=window.getSelection();return{anchorNode:t.anchorNode,anchorOffset:t.anchorOffset,focusNode:t.focusNode,focusOffset:t.focusOffset}}if(document.selection){var i=document.selection.createRange();return{parentElement:i.parentElement(),text:i.text,top:i.boundingTop,left:i.boundingLeft}}}function a(e,t){if(w||null==_||_!==c())return null;var i=n(_);if(!y||!h(y,i)){y=i;var a=u.getPooled(v.select,b,e,t);return a.type="select",a.target=_,o.accumulateTwoPhaseDispatches(a),a}return null}var s=i(62),o=i(95),r=i(34),l=i(27),d=i(306),u=i(63),c=i(307),p=i(292),f=i(71),h=i(187),g=s.topLevelTypes,m=r.canUseDOM&&"documentMode"in document&&document.documentMode<=11,v={select:{phasedRegistrationNames:{bubbled:f({onSelect:null}),captured:f({onSelectCapture:null})},dependencies:[g.topBlur,g.topContextMenu,g.topFocus,g.topKeyDown,g.topMouseDown,g.topMouseUp,g.topSelectionChange]}},_=null,b=null,y=null,w=!1,C=!1,k=f({onSelect:null}),P={eventTypes:v,extractEvents:function(e,t,i,n){if(!C)return null;var s=t?l.getNodeFromInstance(t):window;switch(e){case g.topFocus:(p(s)||"true"===s.contentEditable)&&(_=s,b=t,y=null);break;case g.topBlur:_=null,b=null,y=null;break;case g.topMouseDown:w=!0;break;case g.topContextMenu:case g.topMouseUp:return w=!1,a(i,n);case g.topSelectionChange:if(m)break;case g.topKeyDown:case g.topKeyUp:return a(i,n)}return null},didPutListener:function(e,t,i){t===k&&(C=!0)}};e.exports=P},function(e,t,i){"use strict";function n(e){return"."+e._rootNodeID}var a=i(15),s=i(62),o=i(305),r=i(95),l=i(27),d=i(606),u=i(607),c=i(63),p=i(608),f=i(609),h=i(119),g=i(611),m=i(612),v=i(613),_=i(98),b=i(614),y=i(46),w=i(191),C=(i(13),i(71)),k=s.topLevelTypes,P={abort:{phasedRegistrationNames:{bubbled:C({onAbort:!0}),captured:C({onAbortCapture:!0})}},animationEnd:{phasedRegistrationNames:{bubbled:C({onAnimationEnd:!0}),captured:C({onAnimationEndCapture:!0})}},animationIteration:{phasedRegistrationNames:{bubbled:C({onAnimationIteration:!0}),captured:C({onAnimationIterationCapture:!0})}},animationStart:{phasedRegistrationNames:{bubbled:C({onAnimationStart:!0}),captured:C({onAnimationStartCapture:!0})}},blur:{phasedRegistrationNames:{bubbled:C({onBlur:!0}),captured:C({onBlurCapture:!0})}},canPlay:{phasedRegistrationNames:{bubbled:C({onCanPlay:!0}),captured:C({onCanPlayCapture:!0})}},canPlayThrough:{phasedRegistrationNames:{bubbled:C({onCanPlayThrough:!0}),captured:C({onCanPlayThroughCapture:!0})}},click:{phasedRegistrationNames:{bubbled:C({onClick:!0}),captured:C({onClickCapture:!0})}},contextMenu:{phasedRegistrationNames:{bubbled:C({onContextMenu:!0}),captured:C({onContextMenuCapture:!0})}},copy:{phasedRegistrationNames:{bubbled:C({onCopy:!0}),captured:C({onCopyCapture:!0})}},cut:{phasedRegistrationNames:{bubbled:C({onCut:!0}),captured:C({onCutCapture:!0})}},doubleClick:{phasedRegistrationNames:{bubbled:C({onDoubleClick:!0}),captured:C({onDoubleClickCapture:!0})}},drag:{phasedRegistrationNames:{bubbled:C({onDrag:!0}),captured:C({onDragCapture:!0})}},dragEnd:{phasedRegistrationNames:{bubbled:C({onDragEnd:!0}),captured:C({onDragEndCapture:!0})}},dragEnter:{phasedRegistrationNames:{bubbled:C({onDragEnter:!0}),captured:C({onDragEnterCapture:!0})}},dragExit:{phasedRegistrationNames:{bubbled:C({onDragExit:!0}),captured:C({onDragExitCapture:!0})}},dragLeave:{phasedRegistrationNames:{bubbled:C({onDragLeave:!0}),captured:C({onDragLeaveCapture:!0})}},dragOver:{phasedRegistrationNames:{bubbled:C({onDragOver:!0}),captured:C({onDragOverCapture:!0})}},dragStart:{phasedRegistrationNames:{bubbled:C({onDragStart:!0}),captured:C({onDragStartCapture:!0})}},drop:{phasedRegistrationNames:{bubbled:C({onDrop:!0}),captured:C({onDropCapture:!0})}},durationChange:{phasedRegistrationNames:{bubbled:C({onDurationChange:!0}),captured:C({onDurationChangeCapture:!0})}},emptied:{phasedRegistrationNames:{bubbled:C({onEmptied:!0}),captured:C({onEmptiedCapture:!0})}},encrypted:{phasedRegistrationNames:{bubbled:C({onEncrypted:!0}),captured:C({onEncryptedCapture:!0})}},ended:{phasedRegistrationNames:{bubbled:C({onEnded:!0}),captured:C({onEndedCapture:!0})}},error:{phasedRegistrationNames:{bubbled:C({onError:!0}),captured:C({onErrorCapture:!0})}},focus:{phasedRegistrationNames:{bubbled:C({onFocus:!0}),captured:C({onFocusCapture:!0})}},input:{phasedRegistrationNames:{bubbled:C({onInput:!0}),captured:C({onInputCapture:!0})}},invalid:{phasedRegistrationNames:{bubbled:C({onInvalid:!0}),captured:C({onInvalidCapture:!0})}},keyDown:{phasedRegistrationNames:{bubbled:C({onKeyDown:!0}),captured:C({onKeyDownCapture:!0})}},keyPress:{phasedRegistrationNames:{bubbled:C({onKeyPress:!0}),captured:C({onKeyPressCapture:!0})}},keyUp:{phasedRegistrationNames:{bubbled:C({onKeyUp:!0}),captured:C({onKeyUpCapture:!0})}},load:{phasedRegistrationNames:{bubbled:C({onLoad:!0}),captured:C({onLoadCapture:!0})}},loadedData:{phasedRegistrationNames:{bubbled:C({onLoadedData:!0}),captured:C({onLoadedDataCapture:!0})}},loadedMetadata:{phasedRegistrationNames:{bubbled:C({onLoadedMetadata:!0}),captured:C({onLoadedMetadataCapture:!0})}},loadStart:{phasedRegistrationNames:{bubbled:C({onLoadStart:!0}),captured:C({onLoadStartCapture:!0})}},mouseDown:{phasedRegistrationNames:{bubbled:C({onMouseDown:!0}),captured:C({onMouseDownCapture:!0})}},mouseMove:{phasedRegistrationNames:{bubbled:C({onMouseMove:!0}),captured:C({onMouseMoveCapture:!0})}},mouseOut:{phasedRegistrationNames:{bubbled:C({onMouseOut:!0}),captured:C({onMouseOutCapture:!0})}},mouseOver:{phasedRegistrationNames:{bubbled:C({onMouseOver:!0}),captured:C({onMouseOverCapture:!0})}},mouseUp:{phasedRegistrationNames:{bubbled:C({onMouseUp:!0}),captured:C({onMouseUpCapture:!0})}},paste:{phasedRegistrationNames:{bubbled:C({onPaste:!0}),captured:C({onPasteCapture:!0})}},pause:{phasedRegistrationNames:{bubbled:C({onPause:!0}),captured:C({onPauseCapture:!0})}},play:{phasedRegistrationNames:{bubbled:C({onPlay:!0}),captured:C({onPlayCapture:!0})}},playing:{phasedRegistrationNames:{bubbled:C({onPlaying:!0}),captured:C({onPlayingCapture:!0})}},progress:{phasedRegistrationNames:{bubbled:C({onProgress:!0}),captured:C({onProgressCapture:!0})}},rateChange:{phasedRegistrationNames:{bubbled:C({onRateChange:!0}),captured:C({onRateChangeCapture:!0})}},reset:{phasedRegistrationNames:{bubbled:C({onReset:!0}),captured:C({onResetCapture:!0})}},scroll:{phasedRegistrationNames:{bubbled:C({onScroll:!0}),captured:C({onScrollCapture:!0})}},seeked:{phasedRegistrationNames:{bubbled:C({onSeeked:!0}),captured:C({onSeekedCapture:!0})}},seeking:{phasedRegistrationNames:{bubbled:C({onSeeking:!0}),captured:C({onSeekingCapture:!0})}},stalled:{phasedRegistrationNames:{bubbled:C({onStalled:!0}),captured:C({onStalledCapture:!0})}},submit:{phasedRegistrationNames:{bubbled:C({onSubmit:!0}),captured:C({onSubmitCapture:!0})}},suspend:{phasedRegistrationNames:{bubbled:C({onSuspend:!0}),captured:C({onSuspendCapture:!0})}},timeUpdate:{phasedRegistrationNames:{bubbled:C({onTimeUpdate:!0}),captured:C({onTimeUpdateCapture:!0})}},touchCancel:{phasedRegistrationNames:{bubbled:C({onTouchCancel:!0}),captured:C({onTouchCancelCapture:!0})}},touchEnd:{phasedRegistrationNames:{bubbled:C({onTouchEnd:!0}),captured:C({onTouchEndCapture:!0})}},touchMove:{phasedRegistrationNames:{bubbled:C({onTouchMove:!0}),captured:C({onTouchMoveCapture:!0})}},touchStart:{phasedRegistrationNames:{bubbled:C({onTouchStart:!0}),captured:C({onTouchStartCapture:!0})}},transitionEnd:{phasedRegistrationNames:{bubbled:C({onTransitionEnd:!0}),captured:C({onTransitionEndCapture:!0})}},volumeChange:{phasedRegistrationNames:{bubbled:C({onVolumeChange:!0}),captured:C({onVolumeChangeCapture:!0})}},waiting:{phasedRegistrationNames:{bubbled:C({onWaiting:!0}),captured:C({onWaitingCapture:!0})}},wheel:{phasedRegistrationNames:{bubbled:C({onWheel:!0}),captured:C({onWheelCapture:!0})}}},S={topAbort:P.abort,topAnimationEnd:P.animationEnd,topAnimationIteration:P.animationIteration,topAnimationStart:P.animationStart,topBlur:P.blur,topCanPlay:P.canPlay,topCanPlayThrough:P.canPlayThrough,topClick:P.click,topContextMenu:P.contextMenu,topCopy:P.copy,topCut:P.cut,topDoubleClick:P.doubleClick,topDrag:P.drag,topDragEnd:P.dragEnd,topDragEnter:P.dragEnter,topDragExit:P.dragExit,topDragLeave:P.dragLeave,topDragOver:P.dragOver,topDragStart:P.dragStart,topDrop:P.drop,topDurationChange:P.durationChange,topEmptied:P.emptied,topEncrypted:P.encrypted,topEnded:P.ended,topError:P.error,topFocus:P.focus,topInput:P.input,topInvalid:P.invalid,topKeyDown:P.keyDown,topKeyPress:P.keyPress,topKeyUp:P.keyUp,topLoad:P.load,topLoadedData:P.loadedData,topLoadedMetadata:P.loadedMetadata,topLoadStart:P.loadStart,topMouseDown:P.mouseDown,topMouseMove:P.mouseMove,topMouseOut:P.mouseOut,topMouseOver:P.mouseOver,topMouseUp:P.mouseUp,topPaste:P.paste,topPause:P.pause,topPlay:P.play,topPlaying:P.playing,topProgress:P.progress,topRateChange:P.rateChange,topReset:P.reset,topScroll:P.scroll,topSeeked:P.seeked,topSeeking:P.seeking,topStalled:P.stalled,topSubmit:P.submit,topSuspend:P.suspend,topTimeUpdate:P.timeUpdate,topTouchCancel:P.touchCancel,topTouchEnd:P.touchEnd,topTouchMove:P.touchMove,topTouchStart:P.touchStart,topTransitionEnd:P.transitionEnd,topVolumeChange:P.volumeChange,topWaiting:P.waiting,topWheel:P.wheel};for(var T in S)S[T].dependencies=[T];var E=C({onClick:null}),I={},x={eventTypes:P,extractEvents:function(e,t,i,n){var s=S[e];if(!s)return null;var o;switch(e){case k.topAbort:case k.topCanPlay:case k.topCanPlayThrough:case k.topDurationChange:case k.topEmptied:case k.topEncrypted:case k.topEnded:case k.topError:case k.topInput:case k.topInvalid:case k.topLoad:case k.topLoadedData:case k.topLoadedMetadata:case k.topLoadStart:case k.topPause:case k.topPlay:case k.topPlaying:case k.topProgress:case k.topRateChange:case k.topReset:case k.topSeeked:case k.topSeeking:case k.topStalled:case k.topSubmit:case k.topSuspend:case k.topTimeUpdate:case k.topVolumeChange:case k.topWaiting:o=c;break;case k.topKeyPress:if(0===w(i))return null;case k.topKeyDown:case k.topKeyUp:o=f;break;case k.topBlur:case k.topFocus:o=p;break;case k.topClick:if(2===i.button)return null;case k.topContextMenu:case k.topDoubleClick:case k.topMouseDown:case k.topMouseMove:case k.topMouseOut:case k.topMouseOver:case k.topMouseUp:o=h;break;case k.topDrag:case k.topDragEnd:case k.topDragEnter:case k.topDragExit:case k.topDragLeave:case k.topDragOver:case k.topDragStart:case k.topDrop:o=g;break;case k.topTouchCancel:case k.topTouchEnd:case k.topTouchMove:case k.topTouchStart:o=m;break;case k.topAnimationEnd:case k.topAnimationIteration:case k.topAnimationStart:o=d;break;case k.topTransitionEnd:o=v;break;case k.topScroll:o=_;break;case k.topWheel:o=b;break;case k.topCopy:case k.topCut:case k.topPaste:o=u}o||a("86",e);var l=o.getPooled(s,t,i,n);return r.accumulateTwoPhaseDispatches(l),l},didPutListener:function(e,t,i){if(t===E){var a=n(e),s=l.getNodeFromInstance(e);I[a]||(I[a]=o.listen(s,"click",y))}},willDeleteListener:function(e,t){if(t===E){var i=n(e);I[i].remove(),delete I[i]}}};e.exports=x},function(e,t,i){"use strict";function n(e,t,i,n){return a.call(this,e,t,i,n)}var a=i(63),s={animationName:null,elapsedTime:null,pseudoElement:null};a.augmentClass(n,s),e.exports=n},function(e,t,i){"use strict";function n(e,t,i,n){return a.call(this,e,t,i,n)}var a=i(63),s={clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}};a.augmentClass(n,s),e.exports=n},function(e,t,i){"use strict";function n(e,t,i,n){return a.call(this,e,t,i,n)}var a=i(98),s={relatedTarget:null};a.augmentClass(n,s),e.exports=n},function(e,t,i){"use strict";function n(e,t,i,n){return a.call(this,e,t,i,n)}var a=i(98),s=i(191),o=i(610),r=i(179),l={key:o,location:null,ctrlKey:null,shiftKey:null,altKey:null,metaKey:null,repeat:null,locale:null,getModifierState:r,charCode:function(e){return"keypress"===e.type?s(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?s(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}};a.augmentClass(n,l),e.exports=n},function(e,t,i){"use strict";function n(e){if(e.key){var t=s[e.key]||e.key;if("Unidentified"!==t)return t}if("keypress"===e.type){var i=a(e);return 13===i?"Enter":String.fromCharCode(i)}return"keydown"===e.type||"keyup"===e.type?o[e.keyCode]||"Unidentified":""}var a=i(191),s={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},o={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"};e.exports=n},function(e,t,i){"use strict";function n(e,t,i,n){return a.call(this,e,t,i,n)}var a=i(119),s={dataTransfer:null};a.augmentClass(n,s),e.exports=n},function(e,t,i){"use strict";function n(e,t,i,n){return a.call(this,e,t,i,n)}var a=i(98),s=i(179),o={touches:null,targetTouches:null,changedTouches:null,altKey:null,metaKey:null,ctrlKey:null,shiftKey:null,getModifierState:s};a.augmentClass(n,o),e.exports=n},function(e,t,i){"use strict";function n(e,t,i,n){return a.call(this,e,t,i,n)}var a=i(63),s={propertyName:null,elapsedTime:null,pseudoElement:null};a.augmentClass(n,s),e.exports=n},function(e,t,i){"use strict";function n(e,t,i,n){return a.call(this,e,t,i,n)}var a=i(119),s={deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:null,deltaMode:null};a.augmentClass(n,s),e.exports=n},function(e,t,i){"use strict";function n(e,t){var i={_topLevelWrapper:e,_idCounter:1,_ownerDocument:t?t.nodeType===a?t:t.ownerDocument:null,_node:t,_tag:t?t.nodeName.toLowerCase():null,_namespaceURI:t?t.namespaceURI:null};return i}var a=(i(190),9);e.exports=n},function(e,t,i){"use strict";var n={useCreateElement:!0};e.exports=n},function(e,t,i){"use strict";var n=i(618),a=/\/?>/,s=/^<\!\-\-/,o={CHECKSUM_ATTR_NAME:"data-react-checksum",addChecksumToMarkup:function(e){var t=n(e);return s.test(e)?e:e.replace(a," "+o.CHECKSUM_ATTR_NAME+'="'+t+'"$&')},canReuseMarkup:function(e,t){var i=t.getAttribute(o.CHECKSUM_ATTR_NAME);return i=i&&parseInt(i,10),n(e)===i}};e.exports=o},function(e,t,i){"use strict";function n(e){for(var t=1,i=0,n=0,s=e.length,o=-4&s;n<o;){for(var r=Math.min(n+4096,o);n<r;n+=4)i+=(t+=e.charCodeAt(n))+(t+=e.charCodeAt(n+1))+(t+=e.charCodeAt(n+2))+(t+=e.charCodeAt(n+3));t%=a,i%=a}for(;n<s;n++)i+=t+=e.charCodeAt(n);return t%=a,i%=a,t|i<<16}var a=65521;e.exports=n},function(e,t,i){"use strict";function n(e){if(null==e)return null;if(1===e.nodeType)return e;var t=o.get(e);if(t)return t=r(t),t?s.getNodeFromInstance(t):null;"function"==typeof e.render?a("44"):a("45",Object.keys(e))}var a=i(15),s=(i(70),i(27)),o=i(99),r=i(309);i(13),i(17);e.exports=n},function(e,t,i){"use strict";var n=i(308);e.exports=n.renderSubtreeIntoContainer},function(e,t,i){var n=i(310),a=i(622),s=i(159),o=i(112),r=function(){function e(){}return e.createObject=function(e){switch(e){case"content":return new n.default;case"season":return new a.default;case"compilation":return new s.default;case"collection":return new o.default;default:return null}},e}();t.default=r},function(e,t,i){var n=i(14);t.default=n.default.extend({uri:"/seasoninfo/v5/",fields:"id,title,compilation.poster_originals",parse:function(e){e=e.result;var t=e;return e.compilation&&e.compilation.poster_originals&&e.compilation.poster_originals[0]&&(t.poster=e.compilation.poster_originals[0].path.replace("http:","")),t},getPosterPath:function(){return this.get("poster")}})},function(e,t,i){var n=i(1),a=i(0),s=i(114),o=i(23),r=i(22),l=i(3),d=i(8),u=i(4);t.default=a.View.extend({initElements:function(){this.$el=n(this.elementSelector),this.$activateButton=this.$el.find(".js-certificate-activate"),this.$keyField=this.$el.find(".js-certificate-key"),this.delegateEvents()},initialize:function(){this.initElements(),this.model=new s.default},activate:function(e,t,i){var n=this;d.default.isIdentified()?this.activateAction(e,t,i):r.default.registerProofOfWork().done(function(){n.activateAction(e,t,i)})},activateAction:function(e,t,i){var n=this;"click"===i&&this.sendGrootEvent("click"),"error"===this.model.validate(e)?this.render():this.model.activate(e).done(function(){switch(n.model.get("status")){case"error":n.sendGrootEvent("error"),n.render(t);break;case"cardBind":n.render(t);break;case"success":n.model.isCollection()?u.default.pushToDataLayer({event:"buy_cert_collection"}):n.model.isSubscription()||n.model.isDiscountSubscription()?u.default.pushToDataLayer({event:"buy_cert_subscription"}):n.model.isContent()?u.default.pushToDataLayer({event:"buy_cert_single"}):u.default.pushToDataLayer({event:"buy_cert"}),n.model.set("status","success"),n.sendGrootEvent("success"),n.render(t)}}).error(function(){n.model.set("status","error"),n.model.set(s.default.prototype.baseErrors.server),n.sendGrootEvent("error"),n.render(t)})},isCertInputValid:function(){return!(!n.trim(this.$keyField.val())||this.$keyField.val().length>100||!/^[A-Za-z0-9]*$/.test(this.$keyField.val()))},sendGrootEvent:function(e){var t={code_from:this.codeFrom};n.extend(t,(new o.default).getRightTypeForGroot()),this.model.get("code")&&(t.code=this.model.get("code")),l.default.track("activatecode_"+e,t)}})},function(e,t,i){var n=i(21),a=i(31),s=i(10),o=i(66),r=i(39),l=i(625),d=i(626),u=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t.prototype.getSubscriptionBlock=function(){if(!this.props.certificateModel.isSubscriptionBuy())return null;var e=["certificate__success__premium"],t=this.props.certificateModel.getDurationDays();return s.default.isWorld&&e.push("certificate__success__premium_world"),a.createElement("div",{className:e.join(" ")},"Подписка ivi ",a.createElement("span",null,"на ",t," ",o.default.days(t)))},t.prototype.getTextBlock=function(e){if(this.props.certificateModel.isDiscount())return a.createElement("div",{className:"certificate__success__text certificate__success__premium__text"},a.createElement("p",null,"Успейте воспользоваться выгодным предложением."));var t=this.props.certificateModel.isSubscription()?null:this.getPoster(e,"only-mobile");return a.createElement("div",{className:"certificate__success__text certificate__success__premium__text"},t,this.getMessage())},t.prototype.getDiscountBlock=function(){return this.props.certificateModel.isDiscount()?a.createElement("div",{className:"discount-box certificate__success__discount"},a.createElement("p",{className:"discount-box__percent"},"-",this.props.certificateModel.getDiscountProgram().percent,"%"),a.createElement("div",{className:"discount-box__text"},this.getMessage())):null},t.prototype.getPoster=function(e,t){if(!e)return null;var i=[t];if(this.props.objectModel){var n=this.props.certificateModel.isCollection(),o=n?this.props.objectModel.getPreviewPath():this.props.objectModel.getPosterPath();return o?(i.push(n?"certificate__success__compilation":"certificate__success__image"),this.props.certificateModel.isDiscount()||n?a.createElement("span",{className:i.join(" ")},a.createElement("img",{src:o})):(i.push("certificate__success__image_link"),a.createElement("a",{href:d.default.makeUrl(e.action,e.action_params),className:i.join(" ")},a.createElement("img",{src:o})))):null}return this.props.certificateModel.isSubscription()?(i.push("certificate__success__subscription-img"),a.createElement("span",{className:i.join(" ")},a.createElement("img",{src:(s.default.static.host||"")+"/images/_main/long-trial/poster.png"}))):null},t.prototype.getButton=function(e){if(!e)return null;var t=null;return t=this.props.certificateModel.isDiscount()?d.default.makeUrl(e.action,e.action_params,this.props.certificateModel.isSubscription()?null:{buy_modal:1}):d.default.makeUrl(e.action,e.action_params),a.createElement(l.default,{addClasses:"certificate__success__button",size:l.default.SIZES.huge,href:t},e.caption)},t.prototype.getMessage=function(){var e=[],i=this.props.certificateModel.getMessage().split(t.SPLIT_MESSAGE_RULE);return e.push(a.createElement("p",{key:"first-message"},i[0],i.length>1?".":"")),i.length>1&&e.push(a.createElement("p",{key:"second-message"},i.slice(1).join(". "))),e},t.prototype.render=function(){var e=this.props.certificateModel.getControl("main");return a.createElement("div",{className:"certificate__success__wrapper"},a.createElement("div",{className:"certificate__success"},a.createElement("div",{className:"certificate__title certificate__success__title"},"Сертификат успешно ",a.createElement("span",null,"активирован")),this.getSubscriptionBlock(),this.getDiscountBlock(),this.getTextBlock(e),this.getButton(e),a.createElement("div",{className:"certificate__rules-link"},a.createElement("a",{target:"_blank",href:t.RULES_LINK},"Правила использования сертификатов"))),this.getPoster(e,"no-mobile"))},t.RULES_LINK=r.default.getRightHostOrigin()+"/pages/certificate/rules.pdf",t.SPLIT_MESSAGE_RULE=/\.\s/,t}(a.PureComponent);t.default=u},function(e,t,i){var n=i(21),a=i(31),s=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t.prototype.render=function(){var e=[this.props.addClasses,"ivi-button",this.props.size];return a.createElement("a",{className:e.join(" "),href:this.props.href},this.props.children)},t.SIZES={huge:"huge"},t}(a.PureComponent);t.default=s},function(e,t,i){var n=i(28),a=i(8),s=i(10),o=function(){function e(){}return e.makeUrl=function(t,i,o){void 0===o&&(o={});var r=null;return t===e.MOVIE_OPEN?r="/watch/"+i.id:t===e.COLLECTION_OPEN?r="/collections/"+i.hru:t===e.COMPILATION_OPEN?r=i.season?"/watch/"+i.hru+"/season"+i.season:"/watch/"+i.hru:t===e.INDEX?r="/":t===e.USER?r="/profile":t===e.SUBSCRIPTION&&(r=a.default.hasSubscription()?s.default.isWorld?"/":"/plus":"/profile#subscription"),r&&(r=n.default.addParamsToUrl(r,o)),r},e.MOVIE_OPEN="/movie/open",e.COMPILATION_OPEN="/compilation/open",e.COLLECTION_OPEN="/collection/open",e.INDEX="/index",e.USER="/user",e.SUBSCRIPTION="/user/subscription",e}();t.default=o},function(e,t,i){(function(e){var n=i(21),a=i(31),s=i(261),o=i(628),r=function(t){function i(e){var i=t.call(this,e)||this;return i.postMessage=function(e){if("iframe:ready"===e.originalEvent.data)i.setState({loading:!1});else if("groot:payment_initiate_click"===e.originalEvent.data)i.setState({loading:!0});else if("purchase:card:success"===e.originalEvent.data)i.checker.run();else if("purchase:card:fail"===e.originalEvent.data||"purchase:card:repeat_purchase"===e.originalEvent.data)i.setState({loading:!0}),i.props.onAntiFraud();else try{var t=JSON.parse(e.originalEvent.data);"card:error"===t.message&&(i.setState({loading:!1}),i.props.onCardError(t))}catch(e){}},i.checker=new s.default(i.props.cardBindSuccessEvent),i.state={loading:!0},i}return n.__extends(i,t),i.prototype.componentDidMount=function(){e(window).on("message",this.postMessage)},i.prototype.componentWillUnmount=function(){e(window).off("message",this.postMessage)},i.prototype.render=function(){var e=["certificate__activate-wrapper"];return this.state.loading&&e.push("loading"),a.createElement("div",{className:e.join(" ")},a.createElement(o.default,{id:"js-certificate__form",src:this.props.url}))},i}(a.PureComponent);t.default=r}).call(t,i(1))},function(e,t,i){var n=i(21),a=i(31),s=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t.prototype.render=function(){return a.createElement("iframe",{id:this.props.id,scrolling:"no",width:"100%",src:this.props.src,frameBorder:"0"})},t}(a.PureComponent);t.default=s},function(e,t,i){var n=i(1),a=i(16),s=i(630);t.default=a.default.extend({template:s.default,openEvent:"billing:payment:errorModalOpen",regionEnabled:!0,mobileModal:!0,message:"",onRender:function(){n(".js-modal-close").focus()},serializeData:function(){return{message:this.eventParams.message||"",title:this.eventParams.title||""}}})},function(e,t,i){function n(e){return a.default.render('<div class="ivi-modal-wrapper-content simple-basic"> <h1 class="ivi-modal-title">{{ title }}</h1> <div class="ivi-modal-content"> <p>{{ message }}</p> <div class="button-wrapper"> <button class="ivi-button large js-modal-close">OK</button> </div> </div> <span class="ivi-modal-close js-modal-close">Закрыть</span></div>',e)}var a=i(2);t.default=n},function(e,t,i){var n=i(250);t.default=n.default.extend({el:".js-certificate-support"})},function(e,t,i){var n=i(12),a=i(633),s=i(9);t.default=s.default.extend({routes:["/collections","/collections/pageint:page"],run:function(e){n.default.prototype.run(e),(new a.default).execute(e)}})},function(e,t,i){var n=i(148),a=i(634),s=i(6),o=i(100);t.default=s.default.extend({run:function(e){new a.default({collection:new n.default,page:e.page}),window.ivi.adaptive.isDesktop()&&new o.default}})},function(e,t,i){var n=i(1),a=i(0),s=i(28),o=i(61),r=i(5),l=i(635);t.default=a.View.extend(o.default).extend({el:"#js-collection-list",initialize:function(e){this.elementsPerPage=32,this.elementsPerLine=4,this.startPage=void 0===e.page?0:e.page-1,this.loadDataParams.data={fields:"id,title,images,hru"};var t=this.prepareRepeatingUrlParameter("paid_type",this.$el.data("collection-paid-type"));r.isNull(t)||this.collection.addParamsToUri(t),this.initLoadMore(),this.randomStub=new s.default.randomStub},render:function(){var e=this,t=n("<div/>"),i=0,a=[];o.default.render.apply(this,arguments),r.each(e.collection.models,function(e){e.getPreviewPath().length||i++}),a=e.randomStub.getRandomImages(i);var s=0;r.each(e.collection.models,function(e){n(l.default({collection:e,stubImages:a,stubIndex:s})).appendTo(t),e.getPreviewPath().length||s++}),e.$el.append(t.html()),e.afterRender()}})},function(e,t,i){function n(e){return a.default.render('<li> <a href="/collections/{{ collection.getHru() }}" class="item-content-wrapper" title="Подборка {{ collection.getTitle() }}"> <span class="image"> {% if collection.getPreviewPath() %} <img src="{{ collection.getPreviewPath() }}/216x124/" alt="{{ collection.getTitle() }}"> {% else %} <img src="{{ app.config.static.host }}{{ stubImages[stubIndex]|default("/images/stubs/pixel_5.gif") }}" alt="{{ collection.getTitle() }}"> {% endif %} </span> <span class="title"><span>{{ collection.getTitle() }}</span></span> </a></li>',e)}var a=i(2);t.default=n},function(e,t,i){var n=i(12),a=i(637),s=i(9);t.default=s.default.extend({routes:["/bundles","/bundles/pageint:page"],run:function(e){n.default.prototype.run(e),(new a.default).execute(e)}})},function(e,t,i){var n=i(148),a=i(638),s=i(6),o=i(100);t.default=s.default.extend({run:function(e){new a.default({collection:new n.default,page:e.page}),window.ivi.adaptive.isDesktop()&&new o.default}})},function(e,t,i){var n=i(1),a=i(0),s=i(5),o=i(61),r=i(639);t.default=a.View.extend(o.default).extend({el:"#js-purchasable-collections-list",initialize:function(e){this.elementsPerPage=24,this.elementsPerLine=4,this.startPage=void 0===e.page?0:e.page-1,this.loadDataParams.data={fields:"id,title,poster,hru",purchasable:"true"},this.initLoadMore()},render:function(){var e=n("<div/>");o.default.render.apply(this,arguments),s.each(this.collection.models,function(t){n(r.default({collection:t})).appendTo(e)}),this.$el.append(e.html()),this.afterRender()}})},function(e,t,i){function n(e){return a.default.render('<li> <a tabindex="-1" href="/collections/{{ collection.getHru() }}" class="item-content-wrapper"> <span class="image" data-caption="Смотреть"> <img src="{{ collection.getPosterPath() }}/234x360/" alt="{{ collection.getTitle() }}"> </span> <span class="title"> <span>{{ collection.getTitle() }}</span> </span> </a></li>',e)}var a=i(2);t.default=n},function(e,t,i){var n=i(12),a=i(312),s=i(646),o=i(9);t.default=o.default.extend({routes:["/collections/str:hru","/collections/str:hru/pageint:page"],excludeRoutes:["/collections/page.*"],run:function(e){n.default.prototype.run(e),(new a.default).execute(e),(new s.default).execute(e)}})},function(e,t,i){var n=i(1),a=i(0),s=i(51),o=i(61),r=i(5),l=i(228);t.default=a.View.extend(s.default).extend(o.default).extend({el:"#js-collection-item",fields:"id,title,fake,preorderable,available_in_countries,hru,poster_originals,content_paid_types,compilation_hru,kind,additional_data,restrict,hd_available,seasons_count,seasons_content_total,seasons,episodes,seasons_description,ivi_rating_10_count,seasons_extra_info,count",sort:null,initialize:function(e){this.elementsPerPage=24,this.elementsPerLine=4,this.startPage=void 0===e.page?0:e.page-1,this.sort=this.$el.data("collection-sort"),this.loadDataParams.data={fields:this.fields,sort:this.sort,fake:this.$el.data("collection-showf"),withpreorderable:this.$el.data("collection-withpreorderable"),id:this.$el.data("collection-id")};var t=this.prepareRepeatingUrlParameter("paid_type",this.$el.data("collection-paid-type"));r.isNull(t)||this.collection.addParamsToUri(t),this.initLoadMore()},render:function(){var e=this,t=n("<div/>");o.default.render.apply(this,arguments),r.each(e.collection.getVideoList(),function(i,a){n(l.default({video:i,collection:e.collection,loop:{index:e.loadDataParams.data.from+a+1},hiddenStartIndex:e.loadDataParams.data.to+2,currentPage:"collectionItem"})).appendTo(t)}),e.$el.append(t.html()),e.attachPosterPopup(e.$el.children("li:nth-child(n + "+e.loadDataParams.data.from+")")),e.afterRender()}})},function(e,t,i){i(76);var n=i(1),a=i(0),s=i(643);t.default=a.View.extend({el:"#js-order",defaultWidth:250,defaultTypedLife:500,initialize:function(){this.$el.each(function(){n(this).val(n(this).find("option[selected]").val())}),this.$el.change(this.changeSort.bind(this)),this.celesta=new s(this.$el.get(0),{width:this.defaultWidth,typedLife:this.defaultTypedLife}),n(this.celesta.getOptlist()).perfectScrollbar({suppressScrollX:!0})},changeSort:function(){var e=window.location.href.replace(/\/page\d+/,"");e=this.updateQueryStringParameter(e,"sort",this.$el.find("option:selected").val()),window.location.href=e},updateQueryStringParameter:function(e,t,i){var n=new RegExp("([?&])"+t+"=.*?(&|$)","i"),a=-1!==e.indexOf("?")?"&":"?";return e.match(n)?e.replace(n,"$1"+t+"="+i+"$2"):e+a+t+"="+i}})},function(e,t){e.exports=Celesta},function(e,t,i){var n=i(1),a=i(0);t.default=a.View.extend({initialize:function(){var e=n(".gallery > li").outerHeight(!0);n(".text-spacer").height(Math.ceil(n(".text-block").outerHeight()/e)*e),n(".text-block").show()}})},function(e,t,i){function n(e){return a.default.render('<label for="js-order">Показать</label><select id="js-order"> {% for sort, title in sortVariants %} <option{% if sort == currentSort %} selected{% endif %} value="{{ sort }}">{{ title }}</option> {% endfor %}</select>',e)}var a=i(2);t.default=n},function(e,t,i){var n=i(5),a=i(33),s=i(111),o=i(256),r=i(313),l=i(647),d=i(106),u=i(8),c=i(11),p=i(3),f=i(22),h=i(18),g=i(20),m=i(35),v=i(7),_=i(4);t.default=a.default.extend({collectionInfo:null,collectionPurchaseOptions:null,contentPurchaseOptionsMulti:null,collectionPurchaseModal:null,collectionPurchaseButtonsView:null,grootParamFrom:"bundle",grootParamSource:"b",grootParams:{},contentIds:[],initialize:function(){this.collectionInfo=new s.default({el:"collection-info"}),this.collectionPurchaseOptions=new o.default,this.contentPurchaseOptionsMulti=new r.default,this.collectionPurchaseButtonsView=new l.default,this.grootParams={source:this.grootParamSource},this.listenTo(c.default,"price:click",this.processPriceClick),p.default.rewriteSuperProperties({collection_id:this.collectionInfo.getId()})},afterLogin:function(){this.collectionInfo.isPurchasable()&&h.default.canSellBundles()&&this.showPurchaseBlock(),this.grootParams.from=this.getGrootParamFrom(),g.default.localStorage.setItem("groot_from","bundle")},getGrootParamFrom:function(){return"content_description"===m.get("prev_ref_page")?"content":this.grootParamFrom},showPurchaseBlock:function(){var e=this;this.collectionPurchaseOptions.mapiGet({data:{id:this.collectionInfo.getId()}}).done(function(){if(!e.collectionPurchaseOptions.isPurchased()&&e.collectionInfo.getContentIds().length){var t={sd:e.collectionPurchaseOptions.getPriceForQuality(d.default.prototype.sdQuality),hd:e.collectionPurchaseOptions.getPriceForQuality(d.default.prototype.hdQuality)},i={};n.extend(i,e.grootParams,e.collectionPurchaseOptions.getPurchaseOptionList().getRightTypeForGroot()),p.default.track("price_selection",i),e.contentIds=e.collectionInfo.getContentIds(),(a=e.contentPurchaseOptionsMulti).requestOptions.apply(a,e.contentIds).done(function(){var i=e.contentPurchaseOptionsMulti.getBundleTotalPriceByQuality();e.collectionPurchaseButtonsView.showFullPricesAndDiscount(i,t)})}var a})},processPriceClick:function(e,t){var i=this;u.default.isIdentified()?this.goToPurchaseForm(e,t):f.default.registerProofOfWork().done(function(){i.goToPurchaseForm(e,t)})},goToPurchaseForm:function(e,t){var i=this.collectionPurchaseOptions.getPurchaseOptionList().findProduct(e);if(i){this.productIdentifier=i.getProductIdentifier(),this.redirectUrl=t;var a={};if(n.extend(a,this.grootParams,i.getGrootParams()),a.quality=i.getQuality(),a.m_est=1,a.price=i.getMinUserPrice(),p.default.track("price_click",a),!u.default.isAuthenticated()&&h.default.showAuthBeforePurchase())return this.processPurchaseClickByGuestUser(),void v.default.trigger("auth:showLoginModal:beforePurchase");c.default.trigger("purchase:personal",i.toJSON(),t+"&from="+this.getGrootParamFrom())}},processPurchaseClickByGuestUser:function(){var e=this;this.listenTo(v.default,"loadUser",this.processPurchaseAfterLogin),this.listenTo(v.default,"auth:modal:closed",function(){e.stopListening(v.default,"loadUser",e.processPurchaseAfterLogin)})},processPurchaseAfterLogin:function(){var e={redirectUrl:this.redirectUrl,productIdentifier:this.productIdentifier,callbackForPurchasedState:_.default.reload,contentPurchaseOptions:this.collectionPurchaseOptions,contentId:this.collectionInfo.getId()};c.default.trigger("buy:processContentPurchaseAfterLogin",e)}})},function(e,t,i){var n=i(1),a=i(0),s=i(648),o=i(649),r=i(11);t.default=a.View.extend({el:".js-collection-purchase-buttons-wrapper",events:{"click .js-purchase-button":"priceClick"},priceClick:function(e){e.preventDefault();var t=n(e.currentTarget).data("option_hash");r.default.trigger("price:click",t,e.currentTarget.href)},showFullPricesAndDiscount:function(e,t){var i=0,n=0,a=this.$('.js-purchase-button-wrapper[data-quality="sd"]').find(".js-purchase-button-notice"),r=this.$('.js-purchase-button-wrapper[data-quality="hd"]').find(".js-purchase-button-notice");e.sd>0&&t.sd>0&&(a.html(s.default({price:e.sd})).show(),i=Math.round((e.sd-t.sd)/e.sd*100)),e.hd>0&&t.hd>0&&(r.html(s.default({price:e.hd})).show(),n=Math.round((e.hd-t.hd)/e.hd*100));var l=Math.max(n,i);l>0&&this.$(".js-discount-info").html(o.default({discount:l}))}})},function(e,t,i){function n(e){return a.default.render('<p class="film-header__button-description">{{ internationalExpansion.getPriceWithCurrency(price) }} по отдельности</p>',e)}var a=i(2);t.default=n},function(e,t,i){function n(e){return a.default.render('<div class="discount-box film-header__discount"> <p class="discount-box__percent">-{{ discount }}%</p> <p class="discount-box__text">Покупка коллекции выгоднее покупки по&nbsp;отдельности</p></div>',e)}var a=i(2);t.default=n},function(e,t,i){var n=i(54),a=i(56),s=i(9),o=i(25);t.default=s.default.extend({routes:["/watch/str:hru/awards"],run:function(e){o.default.prototype.run(e),(new n.default).execute(e),(new a.default).execute(e)}})},function(e,t,i){function n(e){return a.default.render('<div class="ivi-modal-wrapper-content simple-basic"> <h1 class="ivi-modal-title">Невозможно приобрести контент</h1> <div class="ivi-modal-content js-purchase-impossible"> <p>Извините, но контент недоступен в вашем регионе</p> <div class="button-wrapper"> <span class="ivi-button large js-modal-close">ok</span> </div> </div> <span class="ivi-modal-close js-modal-close">Закрыть</span></div>',e)}var a=i(2);t.default=n},function(e,t,i){var n=i(192),a=i(657);t.default=n.default.extend({openEvent:"billing:purchase:seasonModal:show",template:a.default,beforeRender:function(e){this.model.set("purchaseOptionList",e.getSeasonOptionsGroupedByOwnershipType()),this.setModelAndGrootParams(e),this.trackCriteo(e.getSeasonOptions())}})},function(e,t,i){var n=i(16),a=i(5),s=i(3),o=i(4);t.default=n.default.extend({regionEnabled:!0,openEvent:"billing:purchase:contentModal:show",mobileModal:!0,mobileBodyClass:"has-scrollable-modal",reloadPage:function(){o.default.getLocation().reload()},getAdditionalGrootParams:function(){var e={};return this.source&&(e.source=this.source),this.from&&(e.from=this.from),e},beforeSubmit:function(){return!1},trackSuccessIviBuy:function(e){var t=this.getAdditionalGrootParams();a.extend(t,this.grootRightTypeParams),t.credit_id=e.get("credit_id"),t.purchase_id=e.get("purchase_id"),t.payment_method="ivi",s.default.track("payment_confirmed",t),this.closeModal()}})},function(e,t,i){function n(e){return a.default.render('<div class="fullscreen-popup fullscreen-popup_has-close-view-button"> <div class="fullscreen-popup__overlay"> <span></span> <span></span> <span></span> </div> <div class="fullscreen-popup__scroll-wrapper"> <div class="fullscreen-popup__wrapper fullscreen-popup_has-close-view-button ivi-page__popup-wrapper"> <a class="fullscreen-popup__close-view-button js-modal-close" href="#" title="Нажмите, чтобы закрыть форму">Закрыть Окно</a> <div class="purchase-options"> <div class="purchase-options-inner"> <div class="purchase-options__content"> <div class="purchase-options__variations-description"> <div class="purchase-options__variations"> {% for ownershipType,options in purchaseOptionList %} <div class="purchase-options__actions"> <div class="purchase-options__actions__title"> {% if ownershipType == "eternal" %} Покупка {% elseif ownershipType == "temporal" %} Аренда {% endif %} </div> <div class="purchase-options__actions__buttons"> {% for option in options %} {% set price = option.getMaxPrice() %} {% set user_price = option.getMaxUserPrice() %} {% set priceFormat = "<ins>" ~ user_price ~ "</ins>" %} {% if user_price < price %} {% set priceFormat = "<del>" ~ price ~ "</del>&nbsp;" ~ priceFormat %} {% endif %} <div class="purchase-options__actions__buttons__item"> <a class="js-buy ivi-button large {% if option.get("quality") == "HD" %}hd{% endif %}" href="{{ internationalExpansion.getSchemaWithHost("https", host) }}/buy?object_id={{ option.get("object_id") }}&option_hash={{ option.get("option_hash") }}&redirect_url={{ redirectUrl }}" data-option_hash="{{ option.get("option_hash") }}" data-product-identifier="{{ option.getProductIdentifier() }}" > {{ internationalExpansion.getPriceWithCurrency(priceFormat) }} </a> </div> {% endfor %} </div> {% if ownershipType == "eternal" %} <div class="purchase-options__actions__caption purchase-options__actions__caption_buy"> <p>Купленный фильм будет доступен вам для просмотра всегда.</p> <p>Количество просмотров не ограничено.</p> </div> {% elseif ownershipType == "temporal" %} <div class="purchase-options__actions__caption purchase-options__actions__caption_rent"> <p>Арендованный фильм надо посмотреть в течение 30 дней.</p> <p>После начала просмотра у вас будет 48 часов для того, чтобы его досмотреть.</p> </div> {% endif %} </div> {# блок для отображения коллекции в которую входит контент если цен на 1 строку #} {% if cheapestCollectionPurchaseOptions|default(false) and purchaseOptionList|length == 1 %} <div class="purchase-options__collection js-collection-purchase-option"></div> {% endif %} {% endfor %} </div> <div class="purchase-options__description"> <div class="purchase-options__product"> <div class="purchase-options__product__poster"><img src="{{ contentEntity.getPosterPath() }}/165x253/" alt="{{ contentEntity.getTitle() }}"></div> {% if not showDrmNotice|default(false) %} <div class="purchase-options__product__note">{{ contentEntity.getTitle() }}</div> {% endif %} </div> {% if showDrmNotice|default(false) %} <div class="purchase-options__drm"> <div class="purchase-options__drm__note"> <span>Ваш браузер не поддерживает просмотр покупаемого фильма.</span> <span class="no-mobile">Мы гарантируем возможность просмотра в браузерах Chrome, Firefox, в наших мобильных приложениях и на Smart TV.</span> <span class="only-mobile">Мы гарантируем возможность просмотра в десктопной версии сайта, в наших мобильных приложениях и на Smart TV.</span> </div> <div class="purchase-options__drm__button only-mobile"><a href="{{ branchLink }}" class="ivi-button large outline">Открыть в приложении</a></div> </div> {% endif %} {# блок для отображения коллекции в которую входит контент если цен на 2 строки #} {% if cheapestCollectionPurchaseOptions|default(false) and purchaseOptionList|length > 1 %} <div class="purchase-options__collection js-collection-purchase-option"></div> {% endif %} </div> </div> </div> {% if not isWorld %} <div class="purchase-options__certificate"> <a class="ivi-button medium outline" href="/cert">Активировать сертификат</a> </div> {% endif %} </div> </div> </div> </div></div>',e)}var a=i(2);t.default=n},function(e,t,i){var n=i(1),a=i(0),s=i(656),o=i(112),r=i(67),l=i(313);t.default=a.View.extend({COLLECTION_INFO_FIELDS:"title,hru",COLLECTION_CATALOG_FIELDS:"id,title,poster_originals",el:".js-collection-purchase-option",collectionId:null,cheapestCollectionPurchaseOptions:null,collectionInfoModel:null,contentPurchaseOptionsMulti:null,discountPercent:0,hasData:!1,initialize:function(e){this.cheapestCollectionPurchaseOptions=e.cheapestCollectionPurchaseOptions,this.collectionId=this.cheapestCollectionPurchaseOptions[0].getObjectId(),this.collectionInfoModel=new o.default,this.collectionCatalogModel=new r.default,this.contentPurchaseOptionsMulti=new l.default},render:function(){var e=this;if(this.hasData)return this.showCollectionBlock(),void this.showDiscount();var t=this.collectionInfoModel.mapiGet({data:{id:this.collectionId,fields:this.COLLECTION_INFO_FIELDS}}),i=this.collectionCatalogModel.mapiGet({data:{id:this.collectionId,from:0,to:99,fields:this.COLLECTION_CATALOG_FIELDS,sort:"pop"}});n.when(t,i).done(function(){if(e.collectionCatalogModel.length>0){e.showCollectionBlock();var t=e.collectionCatalogModel.models.map(function(e){return e.getId()});(i=e.contentPurchaseOptionsMulti).requestOptions.apply(i,t).done(function(){e.hasData=!0;var t=e.contentPurchaseOptionsMulti.getBundleTotalPriceByQuality();e.cheapestCollectionPurchaseOptions.forEach(function(i){var n=i.getPrice(),a=null;if(i.isSDQuality()&&t.sd>0?a=t.sd:i.isHDQuality()&&t.hd>0&&(a=t.hd),a>0&&n>0&&n<a){var s=Math.round((a-n)/a*100);s>e.discountPercent&&(e.discountPercent=s)}}),e.discountPercent>0&&e.showDiscount()})}var i})},showDiscount:function(){var e=this.$el.find(".js-collection-discount");e.text("-"+this.discountPercent+"%"),e.show()},showCollectionBlock:function(){this.$el.html(s.default({title:this.collectionInfoModel.get("title"),link:"/collections/"+this.collectionInfoModel.get("hru"),items:this.collectionCatalogModel.models}))}})},function(e,t,i){function n(e){return a.default.render('<a href="{{ link }}" target="_blank" class="js-collection-link"> <div class="purchase-options__collection"> <div class="purchase-options__collection__caption">Входит в коллекцию</div> <div class="purchase-options__collection__name"> <span class="purchase-options__collection__link">{{ title }}</span> </div> <div class="purchase-options__collection__note">Этот фильм обойдётся дешевле при покупке коллекции</div> <div class="purchase-options__collection__posters"> {% for item in items|slice(0, 7) %} <div class="purchase-options__collection__posters__item"> <img src="{{ item.getPosterPath() }}/33x51/" alt="{{ item.getTitle() }}"> </div> {% endfor %} </div> <div class="purchase-options__collection__sale js-collection-discount hidden"></div> </div></a>',e)}var a=i(2);t.default=n},function(e,t,i){function n(e){return a.default.render('<div class="fullscreen-popup fullscreen-popup_has-close-view-button"> <div class="fullscreen-popup__overlay"> <span></span> <span></span> <span></span> </div> <div class="fullscreen-popup__scroll-wrapper"> <div class="fullscreen-popup__wrapper fullscreen-popup_has-close-view-button ivi-page__popup-wrapper"> <a class="fullscreen-popup__close-view-button js-modal-close" href="#" title="Нажмите, чтобы закрыть форму">Закрыть Окно</a> <div class="purchase-options"> <div class="purchase-options-inner"> <div class="purchase-options__content"> <div class="purchase-options__variations-description"> <div class="purchase-options__variations"> {% for ownershipType,options in purchaseOptionList %} <div class="purchase-options__actions"> <div class="purchase-options__actions__title"> Покупка{% if season %} — Сезон {{ season }}{% endif %} </div> <div class="purchase-options__actions__buttons"> {% for seasonPurchaseOptionParams in options %} {% if seasonPurchaseOptionParams.getMinUserPrice() %} {% set priceFormat = "<ins>" ~ seasonPurchaseOptionParams.getMinUserPrice() ~ "</ins>" %} {% if seasonPurchaseOptionParams.getMinUserPrice() < seasonPurchaseOptionParams.getMinPrice() %} {% set priceFormat = "<del>" ~ seasonPurchaseOptionParams.getMinPrice() ~ "</del>&nbsp;" ~ priceFormat %} {% endif %} <div class="purchase-options__actions__buttons__item"> <a class="ivi-button large js-buy {% if seasonPurchaseOptionParams.isHDQuality() %}hd{% endif %}" href="{{ internationalExpansion.getSchemaWithHost("https", host) }}/buy?object_id={{ seasonPurchaseOptionParams.getObjectId() }}&option_hash={{ seasonPurchaseOptionParams.getOptionHash() }}&redirect_url={{ redirectUrl }}&object_type=season&serie_id={{ serieId }}" data-option_hash="{{ seasonPurchaseOptionParams.getOptionHash() }}" data-product-identifier="{{ seasonPurchaseOptionParams.getProductIdentifier() }}" > {{ internationalExpansion.getPriceWithCurrency(priceFormat) }} </a> </div> {% endif %} {% endfor %} </div> <div class="purchase-options__actions__caption purchase-options__actions__caption_buy"> <p>Купленный сезон будет доступен вам для просмотра всегда.</p> <p>Количество просмотров не ограничено.</p> </div> </div> {% endfor %} </div> <div class="purchase-options__description"> <div class="purchase-options__product"> <div class="purchase-options__product__poster"><img src="{{ contentEntity.getPosterPath() }}/165x253/" alt="{{ contentEntity.getTitle() }}"></div> {% if not showDrmNotice|default(false) %} <div class="purchase-options__product__note">{{ contentEntity.getTitle() }}</div> {% endif %} </div> {% if showDrmNotice|default(false) %} <div class="purchase-options__drm"> <div class="purchase-options__drm__note"> <span>Ваш браузер не поддерживает просмотр покупаемого фильма.</span> <span class="no-mobile">Мы гарантируем возможность просмотра в браузерах Chrome, Firefox, в наших мобильных приложениях и на Smart TV.</span> <span class="only-mobile">Мы гарантируем возможность просмотра в десктопной версии сайта, в наших мобильных приложениях и на Smart TV.</span> </div> <div class="purchase-options__drm__button only-mobile"><a href="{{ branchLink }}" class="ivi-button large outline">Открыть в приложении</a></div> </div> {% endif %} </div> </div> </div> {% if not isWorld %} <div class="purchase-options__certificate"> <a class="ivi-button medium outline" href="/cert">Активировать сертификат</a> </div> {% endif %} </div> </div> </div> </div></div>',e)}var a=i(2);t.default=n},function(e,t,i){var n=i(0),a=i(659);t.default=n.View.extend({el:"#js-not-in-subscription-remark",render:function(){this.$el.html(a.default()),this.$el.addClass("purchased")}})},function(e,t,i){function n(e){return a.default.render("Данный фильм не входит в подписку. Этот фильм вы можете приобрести отдельно.",e)}var a=i(2);t.default=n},function(e,t,i){var n=i(0),a=i(5),s=i(11),o=i(661);t.default=n.View.extend({el:"#js-buy-remark",initialize:function(){this.listenTo(s.default,"buy-button:show",this.render)},render:function(e){var t=this;e&&e.isPurchased()&&a.each(e.get("purchases"),function(e){"temporal"===e.ownership_type&&"content"===e.object_type&&t.$el.html(o.default())})}})},function(e,t,i){function n(e){return a.default.render('<div class="remark">Время просмотра ограничено: 30 дней с момента покупки и 48 часов с начала просмотра.</div>',e)}var a=i(2);t.default=n},function(e,t,i){var n=i(16),a=i(663),s=i(11),o=i(3),r=i(664),l=i(4);t.default=n.default.extend({modalId:"js-preorder-cancel",template:r.default,cancelEl:".js-modal-close",openEvent:"billing:preorder:cancel:showModal",regionEnabled:!0,priorityModal:!0,mobileModal:!0,preorderOption:null,events:{"click #js-preorder-cancel-confirm":"confirmClick","click #js-preorder-cancel-abort":"abortClick"},initialize:function(){this.listenTo(s.default,"buy-button:show",this.setContentPurchaseOption)},setContentPurchaseOption:function(e){e&&e.get("purchases").length&&!0===e.get("purchases")[0].is_preorder&&"ok"===e.get("purchases")[0].status&&(this.preorderOption=e.get("purchases")[0])},confirmClick:function(){var e=this;if(o.default.track("cancel_preorder_submit"),this.preorderOption&&this.preorderOption.id){var t=new a.default;t.mapiPost({data:{id:this.preorderOption.id}}).done(function(){e.checkCancelation(t)})}},checkCancelation:function(e){e&&"cancel"===e.get("status")&&(this.triggerCancel(),l.default.forceReload())},abortClick:function(){this.triggerCancel()}})},function(e,t,i){var n=i(14);t.default=n.default.extend({uri:"/billing/v1/purchase/preorder/cancel"})},function(e,t,i){function n(e){return a.default.render('<div class="ivi-modal-wrapper-content preorder-cancel"> <h1 class="ivi-modal-title">Вы хотите отменить предзаказ?</h1> <div class="ivi-modal-content"> <p>Сумма отмененного предзаказа будет зачислена на&nbsp;ваш Личный&nbsp;счет&nbsp;ivi</p> <div class="button-wrapper"> <a id="js-preorder-cancel-abort" class="ivi-button large">Нет</a> <a id="js-preorder-cancel-confirm" class="ivi-button pale large">Да, отменить</a> </div> </div> <span class="ivi-modal-close js-modal-close">Закрыть</span></div>',e)}var a=i(2);t.default=n},function(e,t,i){var n=i(192),a=i(666);t.default=n.default.extend({template:a.default})},function(e,t,i){function n(e){return a.default.render('<div class="fullscreen-popup fullscreen-popup_has-close-view-button"> <div class="fullscreen-popup__overlay"> <span></span> <span></span> <span></span> </div> <div class="fullscreen-popup__scroll-wrapper"> <div class="fullscreen-popup__wrapper fullscreen-popup_has-close-view-button ivi-page__popup-wrapper"> <a class="fullscreen-popup__close-view-button js-modal-close" href="#" title="Нажмите, чтобы закрыть форму">Закрыть Окно</a> <div class="purchase-options"> <div class="purchase-options-inner"> <div class="purchase-options__content"> <div class="purchase-options__variations-description"> <div class="purchase-options__variations"> {% for ownershipType,options in purchaseOptionList %} <div class="purchase-options__actions"> <div class="purchase-options__actions__title"> Предзаказ </div> <div class="purchase-options__actions__buttons"> {% for option in options %} {% set price = option.getMaxPrice() %} {% set user_price = option.getMaxUserPrice() %} {% set priceFormat = "<ins>" ~ user_price ~ "</ins>" %} {% if user_price < price %} {% set priceFormat = "<del>" ~ price ~ "</del>&nbsp;" ~ priceFormat %} {% endif %} <div class="purchase-options__actions__buttons__item"> <a class="js-buy ivi-button large {% if option.get("quality") == "HD" %}hd{% endif %}" href="{{ internationalExpansion.getSchemaWithHost("https", host) }}/buy?object_id={{ option.get("object_id") }}&option_hash={{ option.get("option_hash") }}&redirect_url={{ redirectUrl }}" data-option_hash="{{ option.get("option_hash") }}" data-product-identifier="{{ option.getProductIdentifier() }}" > {{ internationalExpansion.getPriceWithCurrency(priceFormat) }} </a> </div> {% endfor %} </div> <div class="purchase-options__actions__caption purchase-options__actions__caption_buy"> <p> Предзаказанный {% if contentInfo.isAnimation() %}мультфильм{% else %}фильм{% endif %} станет доступен для просмотра в день {% if contentInfo.getIviReleaseDate()|default(false) %} официальной премьеры на ivi - {{ video.getIviReleaseDate()|default("") }}. {% else %} официальной премьеры на ivi. Ее точная дата пока неизвестна. {% endif %} </p> <p>После премьеры {% if contentInfo.isAnimation() %}мультфильм{% else %}фильм{% endif %} будет доступен вам в любое время.</p> <p>Количество просмотров не ограничено.</p> </div> </div> {% endfor %} </div> <div class="purchase-options__description"> <div class="purchase-options__product"> <div class="purchase-options__product__poster"><img src="{{ contentEntity.getPosterPath() }}/165x253/" alt="{{ contentEntity.getTitle() }}"></div> <div class="purchase-options__product__note">{{ contentEntity.getTitle() }}</div> </div> </div> </div> </div> {% if not isWorld %} <div class="purchase-options__certificate"> <a class="ivi-button medium outline" href="/cert">Активировать сертификат</a> </div> {% endif %} </div> </div> </div> </div></div>',e)}var a=i(2);t.default=n},function(e,t,i){var n=i(1),a=i(5),s=i(0),o=i(11),r=i(668),l=i(125),d=i(55),u=i(23),c=i(79),p=i(28),f=i(18);t.default=s.View.extend({contentPurchaseOptions:null,millisecPerDay:864e5,daysShowingTimerBeforeDiscountEnds:21,initialize:function(e){var t=n('[itemprop="datePublished"]').text().trim(),i=n('[itemprop="productionCountry"]').text().trim(),a=n('[itemprop="contentRating"]').text().trim(),c=n(".js-trailers-link").data("first-trailer-id"),p=[];n('[itemprop="genre"]').each(function(e,t){p.push(n(t).text().trim())});var h=[];i&&h.push(i),t&&h.push(t),p.length&&h.push(p.slice(0,3).join(", ")),a&&h.push(a);var g=new u.default;this.fullscreenPreorderModal=new r.default({model:new s.Model({contentEntity:e,contentPropertiesString:h.join(", "),synopsis:g.getSynopsis(),promoImageUrl:g.getPromoImageUrl(),trailerId:c,timerAvailabilityPeriod:this.daysShowingTimerBeforeDiscountEnds,showImage:f.default.showImageInNewPreorderPopup(),restrict:a})}),this.fullscreenPreorderModal.checkKey=function(){},this.fullscreenPreorderModal.listen(o.default),this.playerModal=new l.default,this.playerModal.clickOutside=function(){},this.playerModal.clickOutsideElement=function(){},this.playerModal.listen(d.default)},setContentPurchaseOptions:function(e){var t=e.getPurchaseOptionList(),i=this.getTimerRemainingTime(t);this.contentPurchaseOptions=e,this.fullscreenPreorderModal.model.set({discount:t.getMaxEstDiscount(),minPrice:t.getContentMinPrice(),minUserPrice:t.getContentMinUserPrice(),isPurchased:e.isPurchased(),showTimer:!a.isEmpty(i),timerRemainingTime:i,timerAvailabilityPeriod:this.daysShowingTimerBeforeDiscountEnds})},getTimerRemainingTime:function(e){var t={},i=[],n=[];e.each(function(e){var t=new c.default(e);i.push.apply(i,t.getAllDiscountProgramFinishTimeIsoStrings())});for(var s=0,o=i;s<o.length;s++){var r=o[s];r&&n.push(new Date(r))}var l=a.chain(n).sortBy(function(e){return e.getTime()}).last().value();if(l){var d=new Date(l),u=Date.now(),f=d.getTime();if(Math.floor((f-u)/this.millisecPerDay)<this.daysShowingTimerBeforeDiscountEnds){var h=new Date;h.setTime(f-u),t.d=Math.floor(h.getTime()/this.millisecPerDay),t.h=h.getHours(),t.i=h.getMinutes(),t.s=h.getSeconds(),t.dFormatted=p.default.padNumber(t.d,2),t.hFormatted=p.default.padNumber(t.h,2),t.iFormatted=p.default.padNumber(t.i,2),t.sFormatted=p.default.padNumber(t.s,2)}}return t}})},function(e,t,i){var n=i(1),a=i(16),s=i(669),o=i(11),r=i(7),l=i(55),d=i(8),u=i(209),c=i(18),p=i(3);t.default=a.default.extend({regionEnabled:!0,openEvent:"billing:fullscreenPreorderModal:show",wrapper:"-fullscreen-modal",bodyClass:"ivi-page_fullscreen-popup_shown-preorder",trailerReadyDeferred:n.Deferred(),playPromise:null,template:s.default,timer:null,trailerUrl:null,backgroundVideo:null,events:{"click .js-preorder-click":"triggerPreorderClick","click .js-preorder-cancel":"triggerPreorderCancelClick","click .js-open-trailer":"openTrailerPopup"},initialize:function(e){var t=this;a.default.prototype.initialize.call(this,e);var i=this.model.get("trailerId");this.listenTo(l.default,"trailers:player:closed",this.playBackgroundVideo),c.default.showImageInNewPreorderPopup()||this.getContentTrailerLink(i).done(function(e){t.trailerUrl=e,t.trailerReadyDeferred.resolve()})},clickOutside:function(){},clickOutsideElement:function(){},beforeSubmit:function(){return!1},rendererCompleted:function(){var e=this;a.default.prototype.rendererCompleted.apply(this,arguments),this.backgroundVideo||(this.backgroundVideo=document.getElementById("js-trailer-video")),this.trailerReadyDeferred.done(function(){e.placeVideoOnBackground()}),this.timer=new u.default,this.timer.setTimerAvailabilityPeriod(this.model.get("timerAvailabilityPeriod")),this.timer.render(),p.default.rewriteSuperProperties({page:"preorder_popup"}),p.default.track("page_view")},beforeCancel:function(){a.default.prototype.beforeCancel.call(this),n("body").removeClass("show-preorder"),n("#modal-container").empty(),this.timer.clearInterval()},triggerPreorderClick:function(e){o.default.trigger("buy-button:popup:preorderClick",e)},triggerPreorderCancelClick:function(e){d.default.isAuthenticated()?o.default.trigger("buy-button:popup:preorderCancelClick",e):r.default.trigger("auth:showLoginModal","preorder")},openTrailerPopup:function(){this.pauseBackgroundVideo(),l.default.trigger("trailers:player:open",{trailerId:this.model.get("trailerId"),preorder:!0})},placeVideoOnBackground:function(){var e=this;this.trailerUrl&&setTimeout(function(){e.backgroundVideo.setAttribute("src",e.trailerUrl),e.playPromise=e.backgroundVideo.play()},300)},getContentTrailerLink:function(e){var t=n.Deferred();if(window.Html5Player&&e){var i=window.Html5Player.getLight();i.setContentType("trailer"),i.daTimestampGet().done(function(){i.daContentGet(e).done(function(e){var i=e.constructor.getFileByClosestQuality(e.getFiles(e.CONTENT_FORMAT_MP4),"superHigh",e.CONTENT_FORMAT_MP4);i&&t.resolve(i.getUrl())}).fail(function(){t.reject()})})}else t.reject();return t.promise()},playBackgroundVideo:function(){this.backgroundVideo&&(this.playPromise=this.backgroundVideo.play())},pauseBackgroundVideo:function(){var e=this;this.playPromise&&this.playPromise.then(function(){e.backgroundVideo.pause()})}})},function(e,t,i){function n(e){return a.default.render('<div class="fullscreen-popup fullscreen-popup_under-ivi-top fullscreen-popup_show_header fullscreen-popup_has-close-view-button"> <div class="fullscreen-popup__overlay"> <span></span> <span></span> <span></span> </div> <div class="fullscreen-popup__scroll-wrapper"> <div class="fullscreen-popup__wrapper fullscreen-popup__wrapper_full"> <div class="page-preorder page-preorder_inner"> <div class="page-wrapper page-preorder__page-wrapper"> <div class="page-preorder__inner"> <div class="page-preorder__trailer"> <div class="page-preorder__trailer-inner" > {# если не картинка, то видео. если картинки нет, то ничего #} {% if not showImage|default(false) %} <div class="page-preorder__trailer-video-wrapper"> <video class="page-preorder__trailer-video" id="js-trailer-video" src="" loop muted preload webkit-playsinline playsinline> </video> </div> {% else %} {% if promoImageUrl|default(false) %} <div class="page-preorder__trailer-image" style="background-image: url({{ promoImageUrl }})"></div> {% endif %} {% endif %} </div> </div> <div class="page-preorder__topline-grid"> <div class="page-preorder__topline-grid-inner"> <div class="page-preorder__left"> <span class="beacon beacon_theme_chime">Предзаказ</span> </div> <div class="page-preorder__right"> <span class="page-preorder__fullscreen-trailer js-open-trailer"> <span class="page-preorder__fullscreen-trailer-text page-preorder__fullscreen-trailer-text_desktop"> {% if showImage|default(false) %} Смотреть трейлер {% else %} Развернуть трейлер {% endif %} </span> <span class="page-preorder__fullscreen-trailer-text page-preorder__fullscreen-trailer-text_mobile"> Tрейлер </span> </span> </div> </div> </div> <div class="page-preorder__content-grid"> <div class="page-preorder__content-grid-inner"> <div class="page-preorder__aside"> <div class="page-preorder__poster"> <img src="{{ contentEntity.getPosterPath("/344x528/") }}" class="page-preorder__poster-image"> <span class="page-preorder__poster-age-limit age-limit">{{ restrict|default("0+") }}</span> </div> <p class="page-preorder__date">Скоро <span class="page-preorder__inline">на<i class="page-preorder__date-icon-rhomb"></i></span></p> </div> <div class="page-preorder__content"> <h1 class="page-preorder__title">{{ contentEntity.getTitle() }}</h1> <p class="page-preorder__subtitle">{{ contentPropertiesString }}</p> <div class="page-preorder__purchase"> {% set priceFormat = "<ins>" ~ minUserPrice ~ "</ins>" %} {% if minUserPrice < minPrice %} {% set priceFormat = "<del>" ~ minPrice ~ "</del>&nbsp;" ~ priceFormat %} {% endif %} {% if not isPurchased|default(false) %} <button class="page-preorder__button-action ivi-button large js-preorder-click" data-purchase-type="content"> Предзаказ от {{ internationalExpansion.getPriceWithCurrency(priceFormat) }} </button> {% else %} <button class="page-preorder__button-action ivi-button large js-preorder-cancel"> Отменить предзаказ </button> {% endif %} {% if not isPurchased|default(false) %} {% if discount|default(0) %} <div class="page-preorder__discount discount-box"> <p class="discount-box__percent">-{{ discount }}%</p> <p class="discount-box__text">Покупка по предзаказу выгоднее, не&nbsp;упустите скидку</p> </div> {% endif %} {% endif %} </div> {% if showTimer|default(false) %} <div class="page-preorder__timer"> <div class="offer-timer js-timer" data-days="{{ timerRemainingTime.d }}" data-hours="{{ timerRemainingTime.h }}" data-minutes="{{ timerRemainingTime.i }}" data-seconds="{{ timerRemainingTime.s }}"> <div class="offer-timer__title">Предложение действует</div> <div class="offer-timer__days"> <div class="offer-timer__circles"> <div class="offer-timer__circle"> <div class="offer-timer__circle-inner offer-timer__circle-inner_seconds"> <svg class="offer-timer__svg offer-timer__svg_seconds js-timer-seconds-circle" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 962 962"> <g opacity="0.15"> <mask x="0" y="0" id="mask_left_seconds"> <rect y="0" fill="#ffffff" width="50%" height="100%"/> </mask> <mask x="0" y="0" id="mask_right_seconds"> <rect x="50%" fill="#ffffff" width="50%" height="100%"/> </mask> <linearGradient id="gradient_seconds" gradientUnits="userSpaceOnUse" x1="50%" y1="100%" x2="50%" y2="0"> <stop offset="0" stop-color="#ffffff" stop-opacity="1"/> <stop offset="1" stop-color="#ffffff" stop-opacity="0"/> </linearGradient> <circle mask="url(#mask_left_seconds)" fill="none" stroke="#ffffff" stroke-width="2" cx="50%" cy="50%" r="480"/> <circle mask="url(#mask_right_seconds)" fill="none" stroke="url(#gradient_seconds)" stroke-width="2" cx="50%" cy="50%" r="480"/> </g> </svg> </div> </div> <div class="offer-timer__circle"> <div class="offer-timer__circle-inner offer-timer__circle-inner_minutes"> <svg class="offer-timer__svg offer-timer__svg_minutes js-timer-minutes-circle" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 482 482"> <g opacity="0.15"> <mask x="0" y="0" id="mask_left_minutes"> <rect y="0" fill="#ffffff" width="50%" height="100%"/> </mask> <mask x="0" y="0" id="mask_right_minutes"> <rect x="50%" fill="#ffffff" width="50%" height="100%"/> </mask> <linearGradient id="gradient_minutes" gradientUnits="userSpaceOnUse" x1="50%" y1="100%" x2="50%" y2="0"> <stop offset="0" stop-color="#ffffff" stop-opacity="1"/> <stop offset="1" stop-color="#ffffff" stop-opacity="0"/> </linearGradient> <circle mask="url(#mask_left_minutes)" fill="none" stroke="#ffffff" stroke-width="2" cx="50%" cy="50%" r="240"/> <circle mask="url(#mask_right_minutes)" fill="none" stroke="url(#gradient_minutes)" stroke-width="2" cx="50%" cy="50%" r="240"/> </g> </svg> </div> </div> <div class="offer-timer__circle"> <div class="offer-timer__circle-inner offer-timer__circle-inner_hours"> <svg class="offer-timer__svg offer-timer__svg_hours js-timer-hours-circle" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 242 242"> <g opacity="0.15"> <mask x="0" y="0" id="mask_left_hours"> <rect y="0" fill="#ffffff" width="50%" height="100%"/> </mask> <mask x="0" y="0" id="mask_right_hours"> <rect x="50%" fill="#ffffff" width="50%" height="100%"/> </mask> <linearGradient id="gradient_hours" gradientUnits="userSpaceOnUse" x1="50%" y1="100%" x2="50%" y2="0"> <stop offset="0" stop-color="#ffffff" stop-opacity="1"/> <stop offset="1" stop-color="#ffffff" stop-opacity="0"/> </linearGradient> <circle mask="url(#mask_left_hours)" fill="none" stroke="#ffffff" stroke-width="2" cx="50%" cy="50%" r="120"/> <circle mask="url(#mask_right_hours)" fill="none" stroke="url(#gradient_hours)" stroke-width="2" cx="50%" cy="50%" r="120"/> </g> </svg> </div> </div> <div class="offer-timer__circle"> <div class="offer-timer__circle-inner offer-timer__circle-inner_days"> <svg class="offer-timer__svg offer-timer__svg_days" xmlns="http://www.w3.org/2000/svg" width="150" height="150" viewBox="0 0 150 150" x="0" y="0"> <g transform="rotate(-90 75 75)"> <defs> <filter id="shadow" x="-40%" height="200%" width="200%"> <feOffset result="offWhite" in="SourceGraphic" dx="0" dy="0"/> <feGaussianBlur result="blurWhite" in="offWhite" stdDeviation="1"/> <feGaussianBlur result="blurBlack" in="SourceAlpha" stdDeviation="4"/> <feOffset result="offBlack" in="blurBlack" dx="-8" dy="0"/> <feComposite in="SourceGraphic" in2="offBlack" operator="arithmetic" k1="0" k2="1" k3="0" k4="0" result="litPaint"/> <feMerge> <feMergeNode in="offBlack"/> <feMergeNode in="litPaint"/> <feMergeNode in="blurWhite"/> </feMerge> </filter> </defs> <circle class="offer-timer__days-progress-bg" cx="50%" cy="50%" r="60" fill="none" stroke-width="2" stroke-dasharray="377" /> <circle class="offer-timer__days-progress-line js-timer-days-circle" filter="url(#shadow)" cx="50%" cy="50%" r="60" fill="none" stroke-width="2" stroke-dasharray="377" stroke-dashoffset="{{ 754 - (377 / (timerAvailabilityPeriod * 24) * (timerAvailabilityPeriod * 24 - (timerRemainingTime.d * 24 + timerRemainingTime.h))) }}" stroke-linecap="round" /> </g> </svg> </div> </div> </div> <div class="offer-timer__days-inner"> <div class="offer-timer__days-value js-timer-days-value">{{ timerRemainingTime.dFormatted }}</div> <div class="offer-timer__days-unit js-timer-days-unit">{{ declension.days(timerRemainingTime.d) }}</div> </div> </div> <div class="offer-timer__time"> <div class="offer-timer__time-item offer-timer__time-item_hours"> <div class="offer-timer__time-value js-timer-hours-value">{{ timerRemainingTime.hFormatted }}</div> <div class="offer-timer__time-unit js-timer-hours-unit">{{ declension.hours(timerRemainingTime.h) }}</div> </div> <div class="offer-timer__time-item offer-timer__time-item_minutes"> <div class="offer-timer__time-value js-timer-minutes-value">{{ timerRemainingTime.iFormatted }}</div> <div class="offer-timer__time-unit js-timer-minutes-unit">{{ declension.minutes(timerRemainingTime.i) }}</div> </div> <div class="offer-timer__time-item offer-timer__time-item_seconds"> <div class="offer-timer__time-value js-timer-seconds-value">{{ timerRemainingTime.sFormatted }}</div> <div class="offer-timer__time-unit js-timer-seconds-unit">{{ declension.seconds(timerRemainingTime.s) }}</div> </div> </div></div> </div> {% endif %} <p class="page-preorder__description"> {{ synopsis }} </p> <div class="page-preorder__footer"> <button class="ivi-button medium outline js-modal-close">О фильме</button> </div> </div> </div> </div> </div> </div> </div> </div> </div></div>',e)}var a=i(2);t.default=n},function(e,t,i){var n=i(317),a=i(671),s=i(3),o=i(8),r=i(1),l=i(41);t.default=n.default.extend({adBlockClass:"UnlaijzwEDOPxlfpqKfI",events:{"click .UnlaijzwEDOPxlfpqKfI .js-close-link":"closeBlock","click .UnlaijzwEDOPxlfpqKfI .js-how-to-disable-adblock":"howToDisableClick","click .UnlaijzwEDOPxlfpqKfI .js-open-subscription-modal":"openSubscriptionModal"},render:function(){this.$el.prepend(a.default({hasSubscription:o.default.hasSubscription()})),r("."+this.adBlockClass).prepend(this.styles),r("."+this.adBlockClass).is(":visible")&&this.$el.addClass("has-"+this.adBlockClass),s.default.track("adblock_ban_imp")},closeBlock:function(){return s.default.track("adblock_ban_close"),this.$el.removeClass("has-"+this.adBlockClass),this.$("."+this.adBlockClass).remove(),!1},howToDisableClick:function(){s.default.track("adblock_ban_click")},openSubscriptionModal:function(){return s.default.track("adblock_ban_iviplus_click"),l.default.trigger("showSubscriptionLanding","adblock_banner"),!1}})},function(e,t,i){function n(e){return a.default.render('<div class="UnlaijzwEDOPxlfpqKfI"> <div class="content"> <span class="title">AdBlock может блокировать часть удобных функций сайта</span> <div class="text"> <p> <span>Из-за AdBlock может некорректно работать продолжение просмотра и ухудшаться качество воспроизведения видео.</span> {% if hasSubscription|default(false) %} <span>Поскольку у вас подключена подписка, AdBlock не нужен — рекламы на ivi вы не увидите.</span> {% else %} <span>Не нравится реклама? Попробуйте подписку и смотрите ivi на любых устройствах без рекламы и в Full HD.</span> {% endif %} </p> </div> <div class="buttons-wrapper"> {% if not hasSubscription|default(false) %} <a href="#" class="ivi-button large js-open-subscription-modal">Подключить подписку</a> {% endif %} <a href="http://ask.ivi.ru/topics/86-kak-otklyuchit-adblock/" target="_blank" class="ivi-button large dark js-how-to-disable-adblock">Отключить AdBlock</a> <a href="#" class="extra-link js-close-link">Я готов к трудностям</a> </div> </div></div>',e)}var a=i(2);t.default=n},function(e,t,i){var n=i(317),a=i(673),s=i(3),o=i(1),r=i(41),l=i(89),d=i(318);t.default=n.default.extend({adBlockClass:"UnlaijzwEDOPxlfpqKfInew",events:{"click .UnlaijzwEDOPxlfpqKfInew .js-add-to-exclusions":"howToDisableClick","click .UnlaijzwEDOPxlfpqKfInew .js-close-link":"closeBlock","click .UnlaijzwEDOPxlfpqKfInew .js-subscribe":"openSubscriptionLanding","click .UnlaijzwEDOPxlfpqKfInew .text a":"externalLinkClick"},message:null,render:function(e){this.message=e,this.$el.append(a.default({message:e})),o("."+this.adBlockClass).prepend(this.styles),s.default.track("adblock_ban_imp",this.getGrootParams())},isRendered:function(){return 1===this.$("."+this.adBlockClass).length},closeBlock:function(){return s.default.track("adblock_ban_close",this.getGrootParams()),this.$("."+this.adBlockClass).parents(".bottom-popup").remove(),!1},howToDisableClick:function(){l.default.trigger("player:showAdBlockInstructionsModal"),s.default.track("adblock_ban_click",this.getGrootParams())},openSubscriptionLanding:function(){return s.default.track("adblock_ban_iviplus_click",this.getGrootParams()),r.default.trigger("showSubscriptionLanding","AntiAdblock",{id_comm:this.message.getInfo().id,num_comm:this.message.getInfo().num,segment:this.message.getInfo().segment,retention:this.message.getInfo().retention}),!1},externalLinkClick:function(){s.default.track("adblock_ban_external_link_click",this.getGrootParams())},getGrootParams:function(){return{id_comm:this.message.getInfo().id,num_comm:this.message.getInfo().num,segment:this.message.getInfo().segment,retention:this.message.getInfo().retention,is_old_user:d.default.isOldUser(),first_comm_date:this.model.getFirstVisitDate()}}})},function(e,t,i){function n(e){return a.default.render('<div class="bottom-popup bottom-popup_state_active bottom-popup_style_{{ message.getColor() }} js-UnlaijzwEDOPxlfpqKfInew"> <div class="bottom-popup__container"> <div class="bottom-popup__container-inner"> <div class="bottom-popup__content"> <div class="UnlaijzwEDOPxlfpqKfInew"> <div class="icon icon_{{ message.getIcon() }}"></div> <div class="content"> <div class="text">{{ message.getText() }}</div> {% if message.isDisableButton() %} <a href="#" class="ivi-link js-add-to-exclusions">Как добавить сайт в исключения</a> {% elseif message.isSubscribeButton() %} <button class="ivi-button js-subscribe">Узнать больше</button> {% endif %} </div> <a class="bottom-popup__close js-close-link" href="#" title="Нажмите, чтобы закрыть окно">Закрыть окно</a> </div> </div> </div> </div></div>',e)}var a=i(2);t.default=n},function(e,t){var i;!function(e){e.OnceInFourWeek="0",e.OnceInThreeWeek="1",e.OnceInTwoWeek="2",e.OnceAWeek="3",e.TreeTimesAWeek="4",e.SevenTimesAWeek="5"}(i=t.AdBlockRetentionType||(t.AdBlockRetentionType={}));var n=function(){function e(){}return e.getUserRetention=function(t,n,a){var s=e.getUserRetentionValue(t,n,a);return s<=.3?i.OnceInFourWeek:s<=.5?i.OnceInThreeWeek:s<=1?i.OnceInTwoWeek:s<=2?i.OnceAWeek:s<=3?i.TreeTimesAWeek:s>3?i.SevenTimesAWeek:void 0},e.getUserRetentionValue=function(t,i,n){var a=Math.ceil((n.getTime()-i.getTime())/e.ONE_WEEK);return 0===a?0:t/a},e.ONE_WEEK=6048e5,e}();t.default=n},function(e,t){var i=function(){function e(e,t,i,n,a){this.text=e,this.color=t,this.icon=i,this.buttonType=n,this.info=a}return e.prototype.getText=function(){return this.text},e.prototype.getColor=function(){return this.color},e.prototype.getIcon=function(){return this.icon},e.prototype.isDisableButton=function(){return"disable"===this.buttonType},e.prototype.isSubscribeButton=function(){return"subscribe"===this.buttonType},e.prototype.getInfo=function(){return this.info},e}();t.default=i},function(e,t,i){(function(e){var n=i(16),a=i(677),s=i(678);t.default=n.default.extend({modalId:"antiblock-instructions-modal",renderAnimationDuration:300,closeAnimationDuration:300,animate:!0,fullAnimation:!0,mobileModal:!0,template:s.default,openEvent:"player:showAdBlockInstructionsModal",onRender:function(){this.undelegateModalEvents(),new a.default(this.$el).init()},onOpen:function(){n.default.prototype.onOpen.apply(this,arguments),e(".js-UnlaijzwEDOPxlfpqKfInew").removeClass("bottom-popup_state_active"),this.pausePlayer()},triggerCancel:function(t){t&&(e(".js-UnlaijzwEDOPxlfpqKfInew").addClass("bottom-popup_state_active"),this.resumePlayer()),n.default.prototype.triggerCancel.call(this,t)}})}).call(t,i(1))},function(e,t,i){var n=i(1),a=function(){function e(e){this.$el=n(e),this.$tabMenu=this.$el.find(".js-ivi-tabs"),this.$channelList=this.$tabMenu.find(".js-ivi-tabs-wrapper"),this.$channelItems=this.$tabMenu.find(".js-ivi-tabs-tab"),this.$arrowLeft=this.$tabMenu.find(".js-ivi-tabs-arrow-left"),this.$arrowRight=this.$tabMenu.find(".js-ivi-tabs-arrow-right"),this.animating=!1}return e.prototype.stopAnimation=function(){this.animating=!1,this.setArrowStyle()},e.prototype.getMaxChannelListScroll=function(){return this.$channelList.get(0).scrollWidth-this.$channelList.get(0).clientWidth},e.prototype.isChannelListScrollMin=function(){return!this.$channelList.scrollLeft()},e.prototype.isChannelListScrollMax=function(){return this.$channelList.scrollLeft()>=this.getMaxChannelListScroll()},e.prototype.onArrowRightClick=function(){var t=this.$channelList.scrollLeft();this.animating||t===this.getMaxChannelListScroll()||(this.animating=!0,this.$channelList.animate({scrollLeft:"+="+e.SCROLL_STEP,easing:"easeinout"},e.DURATION,null,this.stopAnimation.bind(this)))},e.prototype.onArrowLeftClick=function(){var t=this.$channelList.scrollLeft();this.animating||0===t||(this.animating=!0,this.$channelList.animate({scrollLeft:"-="+e.SCROLL_STEP,easing:"easeinout"},e.DURATION,null,this.stopAnimation.bind(this)))},e.prototype.animateExtremeTab=function(t){var i,n,a,s,o,r=this.$channelList.width();(i=t.parent().hasClass("js-ivi-tabs-tab")?t.parent():null)&&(o=i.get(0).offsetLeft-this.$channelList.get(0).scrollLeft,n=i.width(),this.animating||(o<0?this.$channelList.animate({scrollLeft:"-="+Math.abs(o),easing:"easeinout"},e.ITEM_SCROLL_STEP,null,this.stopAnimation.bind(this)):(a=r-n,s=r+n,o>a&&o<s&&(o-=r-n,this.$channelList.animate({scrollLeft:"+="+Math.abs(o),easing:"easeinout"},e.ITEM_SCROLL_STEP,null,this.stopAnimation.bind(this))))))},e.prototype.getActiveChannel=function(){var e=this;this.$channelItems.each(function(t,i){n(i).hasClass("ivi-tabs__item_active")&&(e.$activeChannel=n(i))})},e.prototype.setActiveItemToggle=function(e){var t=e.parent();if(e.hasClass("ivi-tabs__link")&&!t.hasClass("ivi-tabs__item_active")){var i=t.data("id");this.$el.find(".js-ivi-tabs-content").removeClass("filter-manual__unit_active"),n("#"+i).addClass("filter-manual__unit_active"),this.$activeChannel.removeClass("ivi-tabs__item_active"),this.$activeChannel=t,this.$activeChannel.addClass("ivi-tabs__item_active")}},e.prototype.onChannelListClick=function(e){return this.setActiveItemToggle(n(e.target)),this.animateExtremeTab(n(e.target)),!1},e.prototype.setArrowStyle=function(){this.$arrowLeft.toggleClass("ivi-tabs__arrow_hide",this.isChannelListScrollMin()),this.$arrowRight.toggleClass("ivi-tabs__arrow_hide",this.isChannelListScrollMax())},e.prototype.onChannelListMouseOver=function(){this.setArrowStyle()},e.prototype.setTabListeners=function(){this.$arrowRight.on("click",this.onArrowRightClick.bind(this)),this.$arrowLeft.on("click",this.onArrowLeftClick.bind(this)),this.$channelList.on("click",this.onChannelListClick.bind(this)),this.$tabMenu.on("mouseover",this.onChannelListMouseOver.bind(this))},e.prototype.init=function(){this.getActiveChannel(),this.setTabListeners()},e.SCROLL_STEP=320,e.DURATION=320,e.ITEM_SCROLL_STEP=200,e}();t.default=a},function(e,t,i){function n(e){return a.default.render('<div class="fullscreen-popup fullscreen-popup_active fullscreen-popup_has-close-view-button"> <div class="fullscreen-popup__overlay"> <span></span> <span></span> <span></span> </div> <div class="fullscreen-popup__scroll-wrapper"> <div class="fullscreen-popup__wrapper js-auth-wrapper"> <a class="fullscreen-popup__close-view-button js-modal-close" href="#" title="Нажмите, чтобы закрыть инструкцию"> Закрыть окно </a> <div class="filter-manual fullscreen-popup__filter-manual"> <div class="filter-manual__container"> <div class="filter-manual__container-inner"> <div class="filter-manual__title">Инструкция</div> <div class="filter-manual__ivi-tabs"> <div class="ivi-tabs js-ivi-tabs"> <button class="ivi-tabs__arrow ivi-tabs__arrow_left js-ivi-tabs-arrow-left ivi-tabs__arrow_hide"></button> <div class="ivi-tabs__list-wrapper js-ivi-tabs-wrapper page-tv-channels-list__ivi-tabs-list-wrapper"> <ul class="ivi-tabs__list page-tv-channels-list__ivi-tabs-list"> <li data-id="abp" class="ivi-tabs__item js-ivi-tabs-tab ivi-tabs__item_active"> <a class="ivi-tabs__link" href="#abp">AdBlockPlus</a> </li> <li data-id="ab" class="ivi-tabs__item js-ivi-tabs-tab"> <a class="ivi-tabs__link" href="#ab">AdBlock</a> </li> <li data-id="ub" class="ivi-tabs__item js-ivi-tabs-tab"> <a class="ivi-tabs__link" href="#ub">uBlock</a> </li> <li data-id="ag" class="ivi-tabs__item js-ivi-tabs-tab"> <a class="ivi-tabs__link" href="#ag">Adguard</a> </li> <li data-id="ag-p" class="ivi-tabs__item js-ivi-tabs-tab"> <a class="ivi-tabs__link" href="#ag-p">Adguard (программа)</a> </li> </ul> </div> <button class="ivi-tabs__arrow ivi-tabs__arrow_right js-ivi-tabs-arrow-right ivi-tabs__arrow_hide"></button> </div> </div> <div class="filter-manual__content"> <div id="abp" class="filter-manual__unit js-ivi-tabs-content filter-manual__unit_active"> <div class="filter-manual__unit-item"> <div class="filter-manual__unit-text">Найдите рядом с адресной строкой иконку AdBlock Plus и вызовите меню. </div> <div class="filter-manual__unit-picture"> <img class="filter-manual__image" src="{{ app.config.static.host }}/images/_main/filter-manual/abp_1.png" alt=""> </div> </div> <div class="filter-manual__unit-item"> <div class="filter-manual__unit-text">Переключите верхнюю строку в состояние «Отключен на этом сайте». Иконка программы в браузере должна стать серой. </div> <div class="filter-manual__unit-picture"> <img class="filter-manual__image" src="{{ app.config.static.host }}/images/_main/filter-manual/abp_2.png" alt=""> </div> </div> </div> <div id="ab" class="filter-manual__unit js-ivi-tabs-content"> <div class="filter-manual__unit-item"> <div class="filter-manual__unit-text">Найдите рядом с адресной строкой иконку AdBlock и вызовите меню. </div> <div class="filter-manual__unit-picture"> <img class="filter-manual__image" src="{{ app.config.static.host }}/images/_main/filter-manual/ab_1.png" alt=""> </div> </div> <div class="filter-manual__unit-item"> <div class="filter-manual__unit-text">Нажмите пункт «Не запускать на страницах этого домена» и подтвердите действие, нажав на «Исключить». </div> <div class="filter-manual__unit-picture"> <img class="filter-manual__image" src="{{ app.config.static.host }}/images/_main/filter-manual/ab_2.png" alt=""> </div> </div> </div> <div id="ub" class="filter-manual__unit js-ivi-tabs-content"> <div class="filter-manual__unit-item"> <div class="filter-manual__unit-text">Найдите рядом с адресной строкой иконку uBlock и вызовите меню. </div> <div class="filter-manual__unit-picture"> <img class="filter-manual__image" src="{{ app.config.static.host }}/images/_main/filter-manual/ub_1.png" alt=""> </div> </div> <div class="filter-manual__unit-item"> <div class="filter-manual__unit-text">Нажмите на большую иконку «Выключения». После клика она станет серой. </div> <div class="filter-manual__unit-picture"> <img class="filter-manual__image" src="{{ app.config.static.host }}/images/_main/filter-manual/ub_2.png" alt=""> </div> </div> </div> <div id="ag" class="filter-manual__unit js-ivi-tabs-content"> <div class="filter-manual__unit-item"> <div class="filter-manual__unit-text">Найдите рядом с адресной строкой иконку AdGuard и вызовите окно настроек. </div> <div class="filter-manual__unit-picture"> <img class="filter-manual__image" src="{{ app.config.static.host }}/images/_main/filter-manual/ag_1.png" alt=""> </div> </div> <div class="filter-manual__unit-item"> <div class="filter-manual__unit-text">Щелкните по переключателю и убедитесь, что он стал красного цвета. </div> <div class="filter-manual__unit-picture"> <img class="filter-manual__image" src="{{ app.config.static.host }}/images/_main/filter-manual/ag_2.png" alt=""> </div> </div> </div> <div id="ag-p" class="filter-manual__unit js-ivi-tabs-content"> <div class="filter-manual__unit-item"> <div class="filter-manual__unit-text">Найдите в нижнем правом углу браузера иконку AdGuard и вызовите окно настроек. </div> <div class="filter-manual__unit-picture"> <img class="filter-manual__image" src="{{ app.config.static.host }}/images/_main/filter-manual/ag-p_1.png" alt=""> </div> </div> <div class="filter-manual__unit-item"> <div class="filter-manual__unit-text">Кликните «Добавить в исключения» и подтвердите действие на следующем шаге. </div> <div class="filter-manual__unit-picture"> <img class="filter-manual__image" src="{{ app.config.static.host }}/images/_main/filter-manual/ag-p_2.png" alt=""> </div> </div> </div> </div> </div> </div> </div> </div> </div></div>',e)}var a=i(2);t.default=n},function(e,t,i){var n,a=i(20);!function(e){e[e.HasAdBlock=0]="HasAdBlock",e[e.DisabledAdBlock=1]="DisabledAdBlock",e[e.ReAdBlock=2]="ReAdBlock"}(n=t.UserAdBlockStatus||(t.UserAdBlockStatus={}));var s=function(){function e(){this.today=(new Date).toISOString().split("T")[0]}return e.prototype.setAdBlockStatus=function(e){e?null===this.userInfo.adBlockStatus?this.userInfo.adBlockStatus=n.HasAdBlock:this.userInfo.adBlockStatus===n.DisabledAdBlock&&(this.userInfo.adBlockStatus=n.ReAdBlock):null!==this.userInfo.adBlockStatus&&(this.userInfo.adBlockStatus=n.DisabledAdBlock,this.setViewsCount(null))},e.prototype.isUserAdBlocker=function(){return this.userInfo.adBlockStatus===n.HasAdBlock||this.userInfo.adBlockStatus===n.ReAdBlock},e.prototype.isUserReAdBlocker=function(){return this.userInfo.adBlockStatus===n.ReAdBlock},e.prototype.isAdBlockDisabled=function(){return this.userInfo.adBlockStatus===n.DisabledAdBlock},e.prototype.setLastCommunicationNumber=function(e){this.userInfo.lastCommunicationNumber=e},e.prototype.getLastCommunicationNumber=function(){return this.userInfo.lastCommunicationNumber},e.prototype.getFirstVisitDate=function(){return new Date(this.userInfo.firstVisit)},e.prototype.getLastVisitDate=function(){return new Date(this.userInfo.lastVisit)},e.prototype.getVisitsCount=function(){return this.userInfo.visitsCount},e.prototype.incrementCommunicationsCount=function(){this.userInfo.communicationsCount++},e.prototype.incrementViewsCount=function(){this.userInfo.viewsCount++},e.prototype.setViewsCount=function(e){this.userInfo.viewsCount=e},e.prototype.getViewsCount=function(){return this.userInfo.viewsCount},e.prototype.getCommunicationsCount=function(){return this.userInfo.communicationsCount},e.prototype.saveUserInfo=function(){a.default.localStorage.setItem("adblock_communications",JSON.stringify(this.userInfo))},e.prototype.loadUserInfo=function(){var e=null;try{e=JSON.parse(a.default.localStorage.getItem("adblock_communications"))}catch(e){}e?(this.userInfo=e,this.today!==this.userInfo.lastVisit&&(this.userInfo.lastVisit=this.today,this.userInfo.visitsCount++,this.userInfo.communicationsCount=0)):this.userInfo={firstVisit:this.today,lastVisit:this.today,visitsCount:0,lastCommunicationNumber:null,adBlockStatus:null,communicationsCount:0,viewsCount:null}},e}();t.default=s},function(e,t,i){function n(e){return a.default.render('<div class="ivi-modal-wrapper-content trailers"> <div class="ivi-modal-content"> <div class="player-block"> <div class="player-area"> <div class="player-wrapper loading js-player-wrapper"> <div id="js-player"></div> </div> </div> <div id="video-flack" class="video-flack"></div> </div> </div> <span class="ivi-modal-close js-modal-close">Закрыть</span></div>',e)}var a=i(2);t.default=n},function(e,t,i){var n=i(0),a=i(682),s=i(8);t.default=n.View.extend({el:"#js-preorder-remark-wrapper",render:function(e){this.$el.html(a.default({video:e,user:s.default}))}})},function(e,t,i){function n(e){return a.default.render('<div class="remark preorder js-preorder-remark-wrapper"> {% if video.isBought() %} Вы оформили предзаказ. {% else %} {% if video.isAnimation() %}Мультфильм{% else %}Фильм{% endif %} доступен для предзаказа. {% endif %} Дата появления {% if video.isAnimation() %}мультфильма{% else %}фильма{% endif %} {{ video.getIviReleaseDate()|default("будет известна позже") }}. {% if video.isBought() and user.isGuest() %} Войдите, чтобы отменить предзаказ. {% endif %}</div>',e)}var a=i(2);t.default=n},function(e,t,i){function n(e){return a.default.render('<a class="action-link large enqueue js-favourite-button">Смотреть позже</a>',e)}var a=i(2);t.default=n},function(e,t,i){function n(e){return a.default.render('<div class="ivi-modal-wrapper-content simple-basic"> <h1 class="ivi-modal-title">Спасибо</h1> <div class="ivi-modal-content"> <p> Мы сообщим вам, когда {{ categoryTitle }} появится на ivi </p> <div class="button-wrapper"> <span class="ivi-button large js-modal-close">OK</span> </div> </div> <span class="ivi-modal-close js-modal-close">Закрыть</span></div>',e)}var a=i(2);t.default=n},function(e,t,i){var n=i(275),a=i(23);t.default=n.default.extend({run:function(){(new a.default).isForAdult()&&n.default.prototype.run.call(this)}})},function(e,t,i){var n=i(54),a=i(56),s=i(143),o=i(9),r=i(25);t.default=o.default.extend({routes:["/watch/str:hru/box"],run:function(e){r.default.prototype.run(e),(new s.default).execute(e),(new n.default).execute(e),(new a.default).execute(e)}})},function(e,t,i){var n=i(54),a=i(326),s=i(56),o=i(49),r=i(9),l=i(25);t.default=r.default.extend({routes:["/watch/str:hru/comments","/watch/str:hru/comments/pageint:page"],run:function(e){l.default.prototype.run(e),(new n.default).execute(e),(new s.default).execute(e),(new o.default).execute(e),(new a.default).execute(e)}})},function(e,t,i){function n(e){return a.default.render('<li itemscope itemtype="https://schema.org/UserComments"> <div class="js-votable js-comment-item comment-item {% if hasAnswers|default(false) %}has-foldable-comments{% endif %}" data-id="{{ comment.getId() }}" data-parent-id="{{ comment.getParentId() }}"> <header class="main-info"> <cite class="author" itemprop="name">{{ comment.getAuthor() }}</cite> <time class="date" itemprop="commentTime" content="{{ internationalExpansion.getLocalDateTime(comment.getAdded())|date("Y-m-d") }}"> {{ internationalExpansion.getLocalDateTime(comment.getAdded())|locale_date("d MMMM Y") }} </time> <span class="votes"> <span class="value js-votes{% if comment.getLikesBalance() > 0 %} positive{% elseif comment.getLikesBalance() < 0 %} negative{% endif %}">{{ comment.getLikesBalance() }}</span> {% if comment.canUserRate() %} <span class="vote-action minus js-dislike{% if comment.isDisliked() %} active{% endif %}"></span> <span class="vote-action plus js-like{% if comment.isLiked() %} active{% endif %}"></span> {% endif %} </span> </header> <article class="ugc-text" itemprop="commentText">{{ comment.getText()|specialEscape }}</article> {% if canReply|default(false) or hasAnswers|default(false) %} <footer class="extra-info"> {% if canReply|default(false) %} <span class="reply"> <a class="js-comment-reply" href="#">Ответить</a> </span> {% endif %} {% if hasAnswers|default(false) %} <span class="js-comment-show-answers all-comments unfold"> <a href="#">Ответы</a> </span> {% endif %} </footer> {% endif %} </div> {% if canReply|default(false) %} <ul class="js-reply-list"></ul> {% endif %}</li>',e)}var a=i(2);t.default=n},function(e,t,i){function n(e){return a.default.render("Пожалуйста, переформулируйте свой отзыв",e)}var a=i(2);t.default=n},function(e,t,i){function n(e){return a.default.render("Превышен лимит по количеству символов",e)}var a=i(2);t.default=n},function(e,t,i){function n(e){return a.default.render("Необходимо минимум 10 символов, у вас {{ length }}",e)}var a=i(2);t.default=n},function(e,t,i){function n(e){return a.default.render("Осталось символов: <span>{{ length }}</span>",e)}var a=i(2);t.default=n},function(e,t,i){var n=i(328),a=i(88);t.default=n.default.extend({canReply:!0,loadDataParams:{},initialize:function(e){n.default.prototype.initialize.call(this,e),this.parentId=e.parentId,this.itemId=e.itemId,this.elementsPerPage=this.itemsPerPage,this.elementsPerLine=1,this.startPage=0,this.loadDataParams.data={id:e.itemId,parent_id:e.parentId},this.listenTo(a.default,"comment:replies:toggle",this.toggle)},toggle:function(e){this.$el.children().length&&e===this.parentId&&this.$el.toggle()}})},function(e,t,i){function n(e){return a.default.render('\x3c!-- Форма добавления комментария --\x3e<form class="ugc-add js-comment-form{% if reply|default(false) %} reply{% endif %}"> <ol class="form-data"> <li class="essential ivi-textarea"> <textarea name="subject" class="js-dynamic" placeholder="{{ placeholder|default("") }}"></textarea> </li> <li class="footer-wrapper"> <button type="submit" class="ivi-button medium dark" disabled>Добавить</button> <div class="message-wrapper js-symbols error">Необходимо миниум 10 символов, у вас 0</div> </li> </ol></form>',e)}var a=i(2);t.default=n},function(e,t,i){var n=i(14),a=i(22),s=i(128),o=i(126),r=i(8);t.default=n.default.extend({preventDoubleClick:!1,initialize:function(){this.listenTo(s.default,"like:add",this.addLike),this.listenTo(s.default,"like:delete",this.deleteLike)},addLike:function(e){var t=this;this.valid(e)&&(r.default.isIdentified()||this.preventDoubleClick?this.preventDoubleClick||this.add(e):(this.preventDoubleClick=!0,a.default.registerProofOfWork().done(function(){t.preventDoubleClick=!1,t.add(e)})))},deleteLike:function(e){this.valid(e)&&this.delete(e)},add:function(e){return this.mapiPost({uri:"/like/add",data:{object_id:e.objectId,object_type:e.objectType,value:e.value}}).done(function(t){t.value&&s.default.trigger("like:added",e)})},delete:function(e){return this.mapiPost({uri:"/like/delete",data:{object_id:e.objectId,object_type:e.objectType,value:e.value}}).done(function(t){t.message&&s.default.trigger("like:deleted",e)})},valid:function(e){return e.objectType&&e.objectId&&(e.value===o.default.like||e.value===o.default.dislike)}})},function(e,t,i){var n=i(54),a=i(129),s=i(329),o=i(56),r=i(49),l=i(331),d=i(130),u=i(721),c=i(133),p=i(134),f=i(9),h=i(336),g=i(25);t.default=f.default.extend({routes:["/watch/str:hru","/watch/str:hru/seasonint:season"],run:function(e){g.default.prototype.run(e),(new n.default).execute(e),(new s.default).execute(e),(new l.default).execute(e),(new o.default).execute(e),(new d.default).execute(e),(new h.default).execute(e),(new r.default).execute(e),(new u.default).execute(e),(new a.default).execute(e),(new p.default).execute(e),(new c.default).execute(e)}})},function(e,t,i){var n=i(1),a=i(0),s=i(48);t.default=a.View.extend({el:".seasons-scroll-block",events:{"click li.episode a":"generateChangeGroupEvent","click li.season a":"generateChangeSeasonEvent","click .scroll-button":"moveList"},$listItems:[],availableWidth:0,firstItemIndex:0,firstVisibleItemsToShow:0,currentNotActiveElementIndex:0,activeElementIndex:0,render:function(){var e=this,t=null;if(this.availableWidth=this.$el.find("ul").width(),this.$el.find("li").each(function(i,a){var s=n(a);s.hasClass("active")&&(e.activeElementIndex=i,t=n(a)),e.$listItems.push(s),s.position().left+s.outerWidth(!0)<=e.availableWidth&&e.firstVisibleItemsToShow++}),!window.ivi.adaptive.isMobileStyle)if(this.activeElementIndex>this.firstVisibleItemsToShow){for(var i=0;t.position().left+t.outerWidth(!0)>this.availableWidth;)this.$listItems[i++].hide(),this.firstItemIndex++;0!==this.activeElementIndex&&n(".scroll-button.prev").show(),this.activeElementIndex!==this.$listItems.length-1&&n(".scroll-button.next").show(),this.activeElementIndex+1<this.$listItems.length&&this.deactivateNotFittingItem(this.activeElementIndex+1)}else this.firstVisibleItemsToShow!==this.$listItems.length&&(0!==this.activeElementIndex&&n(".scroll-button.prev").show(),n(".scroll-button.next").show(),this.deactivateNotFittingItem(this.firstVisibleItemsToShow))},moveList:function(e){if(n(e.target).hasClass("prev")){if(0===this.activeElementIndex)return;this.activeElementIndex-1==0&&n(".scroll-button.prev").hide(),n(".scroll-button.next").show(),this.firstItemIndex-1>=0&&(this.$listItems[this.firstItemIndex-1].show(),this.firstItemIndex--),this.activeElementIndex--}else n(e.target).hasClass("next")&&(this.activeElementIndex===this.$listItems.length-2&&n(".scroll-button.next").hide(),n(".scroll-button.prev").show(),this.$listItems.length-this.firstVisibleItemsToShow>this.firstItemIndex&&(this.$listItems[this.firstItemIndex].hide(),this.firstItemIndex++),this.activeElementIndex++);this.$listItems[this.currentNotActiveElementIndex].removeClass("not-active"),this.activeElementIndex<this.$listItems.length&&this.$listItems[this.activeElementIndex].find("a").trigger("click");var t=this.findNotFittingItem();!1!==t&&this.deactivateNotFittingItem(t)},findNotFittingItem:function(){for(var e=0;e<this.$listItems.length;e++){var t=this.$listItems[e];if(t.is(":visible")){if(t.position().left+t.outerWidth(!0)>this.availableWidth)return e}}return!1},deactivateNotFittingItem:function(e){var t=this.currentNotActiveElementIndex;this.currentNotActiveElementIndex=e;var i=this.$listItems[this.currentNotActiveElementIndex];i.hasClass("active")&&(this.$listItems[this.firstItemIndex].hide(),this.firstItemIndex++,n(".scroll-button.prev").show(),this.$listItems[t].removeClass("not-active"),this.currentNotActiveElementIndex<this.$listItems.length-1&&(this.currentNotActiveElementIndex++,i=this.$listItems[this.currentNotActiveElementIndex])),i.hasClass("active")||i.addClass("not-active")},generateChangeGroupEvent:function(e){var t=n(e.target);if(t.parent().hasClass("not-active"))return!1;var i=t.data("group-index");return this.activeElementIndex=t.data("group-index")-1,e.preventDefault(),n("#group-list li.active").removeClass("active"),t.parent().addClass("active"),0===this.activeElementIndex?n(".scroll-button.prev").hide():n(".scroll-button.prev").show(),this.activeElementIndex===this.$listItems.length-1?n(".scroll-button.next").hide():n(".scroll-button.next").show(),s.default.trigger("compilation:change-group",{from:t.data("from"),to:t.data("to")},i),!1},generateChangeSeasonEvent:function(e){var t=n(e.target);return!t.parent().hasClass("not-active")&&(this.activeElementIndex=t.data("season-index")-1,n("#season-list li.active").removeClass("active"),t.parent().addClass("active"),0===this.activeElementIndex?n(".scroll-button.prev").hide():n(".scroll-button.prev").show(),this.activeElementIndex===this.$listItems.length-1?n(".scroll-button.next").hide():n(".scroll-button.next").show(),s.default.trigger("compilation:change-season",t.data("season"),t.data("season-total")),!1)}})},function(e,t,i){var n=i(1),a=i(0),s=i(48);t.default=a.View.extend({el:".js-group-series-list",events:{click:"generateChangeGroupEvent"},generateChangeGroupEvent:function(e){"UL"===e.target.nodeName&&(e.preventDefault(),s.default.trigger("compilation:mobile:change-group",{from:n(e.target).data("from"),to:n(e.target).data("to")},n(e.target).data("group-index")))}})},function(e,t,i){var n=i(1),a=i(0),s=i(48);t.default=a.View.extend({el:".js-serial-series-list",events:{click:"generateChangeSeasonEvent"},generateChangeSeasonEvent:function(e){var t=n(e.target);if(t.is("ul")&&!t.hasClass("expanded")){var i=t.data("season-index"),a=t.data("season-total");s.default.trigger("compilation:mobile:change-season",i,a),e.preventDefault()}else t.removeClass("active"),t.removeClass("expanded")}})},function(e,t,i){var n=i(29),a=i(161),s=i(113),o=i(48),r=i(10),l=i(1);t.default=n.default.extend({uri:"/videofromcompilation/v5/",model:s.default,fields:"id,title,fake,preorderable,available_in_countries,hru,poster_originals,content_paid_types,compilation_hru,kind,additional_data,restrict,hd_available,3d_available,uhd_available,hdr10_available,has_5_1,branding.px_audit,branding.brand_web_js,branding.brand_web_css,branding.link,artists,budget,categories,country,description,synopsis,duration,duration_minutes,genres,gross_russia,gross_usa,gross_world,imdb_rating,ivi_rating_10,kp_rating,season,thumb_originals,orig_title,year,years,episode,subsites_availability,subtitles,compilation,compilation_title,drm_only,has_awards,used_to_be_paid,ivi_release_date,sharing_disabled,ivi_rating_10_count,has_comments,has_reviews,promo_images,ivi_release_info,ivi_pseudo_release_date",isEstSeriesBought:!0,initialize:function(){this.emptySeasonPurchaseOptions=new a.default},getSeries:function(e,t){var i=this,n=l.Deferred();return this.mapiGet({reset:!0,data:{id:this.compilationId,season:this.season,from:e,to:t,fake:1}}).done(function(e){e.error?n.resolve([]):n.resolve(i.models)}),n.promise()},findBySeason:function(e,t){var i=this;this.season=e;for(var n=[],a=0;a<t;a+=100)n.push(this.getSeries(a,a+99));l.when.apply(l,n).done(function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var a=[];if(t.forEach(function(e){a=a.concat(e)}),i.reset(a),i.models.length){var s=i.models.some(function(e){return e.isEst()});o.default.trigger("compilation:serieListLoaded",i.models[0],i.emptySeasonPurchaseOptions,s)}else o.default.trigger("compilation:seasonDataLoaded",e,i.emptySeasonPurchaseOptions)})},findByGroup:function(e,t){var i=this;return this.mapiGet({reset:!0,data:{id:this.compilationId,from:e.from,to:e.to,fake:1}}).done(function(e){e.error||(i.models.forEach(function(e){i.setupSerieBought(e)}),o.default.trigger("compilation:groupDataLoaded",t))})},setUpSeasonSeriesBought:function(e,t){var i=this;this.isEstSeriesBought=!0,this.models.forEach(function(e){i.setupSerieBought(e,t)}),o.default.trigger("compilation:seasonDataProcessed",e,t)},setupSerieBought:function(e,t){var i=!1;e.isPaid()?(e.isEst()&&(i=t&&t.isPurchased()),!i&&e.isSvod()&&(i=t&&t.isPurchased()||r.default.hasSubscription)):i=!0,i?e.setBought():e.isEst()&&1===e.getContentPaidTypes().length&&this.isEstSeriesBought&&(this.isEstSeriesBought=!1)}})},function(e,t,i){var n=i(1),a=i(0),s=i(37),o=i(124),r=i(113),l=i(22),d=i(11),u=i(48),c=i(702),p=i(703),f=i(704),h=i(8),g=i(57);t.default=a.View.extend({el:".episodes-list",events:{"click .js-serie-element-buy":"showSeriePurchaseModal","click .js-buy-season-click":"processSeasonPayment"},watchedListModel:null,initialize:function(e){this.hru=e.hru,this.collection.compilationId=this.$el.data("compilation"),this.watchedListModel=e.watchedListModel,this.compilationInfo=new s.default,this.listenTo(u.default,"compilation:seasonDataProcessed",this.renderSeasonSeries),this.listenTo(u.default,"compilation:groupDataLoaded",this.renderGroupSeries),this.listenTo(g.default,"unfinished:watchhistory:loaded",this.renderNewSerieBadge),this.setBuyButtonLink()},renderSeasonSeries:function(e,t){this.seasonPurchaseOptions=t;var i=!1,a=n(".js-serial-series-list"),s=a.filter("[data-season-index="+e+"]"),o=s.data("season");this.renderSeasonButtons(o,t),s.find("li.js-serie-element").length||(this.renderSeries(this.collection,s,t),i=!0),a.removeClass("active"),s.addClass("active"),i&&u.default.trigger("serieList:render",o),window.ivi.adaptive.isMobile?(n("#season-list li.js-season-tab a").parent().removeClass("active"),n("#season-list li.js-season-tab a[data-season-index="+e+"]").parent().addClass("active"),window.ivi.adaptive.isMobileStyle||a.removeClass("expanded"),s.toggleClass("expanded")):(a.removeClass("expanded"),s.addClass("expanded"))},renderGroupSeries:function(e){var t=!1,i=n(".js-group-series-list"),a=i.filter("[data-group-index="+e+"]");a.find("li").length||(this.renderSeries(this.collection,a),t=!0),i.removeClass("active"),a.addClass("active"),t&&u.default.trigger("serieList:render"),window.ivi.adaptive.isMobile?(n("#group-list li a").parent().removeClass("active"),n("#group-list li a[data-group-index="+e+"]").parent().addClass("active"),window.ivi.adaptive.isMobileStyle||i.removeClass("expanded"),a.toggleClass("expanded")):(i.removeClass("expanded"),a.addClass("expanded"))},renderSeries:function(e,t,i){var n=this;e.each(function(a){a.attributes.hru=e.hru||n.hru,t.append(p.default({compilation:n.compilationInfo,serie:a,isSerieListEternalBought:i&&i.isPurchased()}))})},renderSeasonButtons:function(e,t){n("ul[data-season="+e+"] .js-season-buttons-wrapper").html(c.default({seasonPurchaseOptions:t,serieList:this.collection.models,isBought:this.collection.isEstSeriesBought})),this.setBuyButtonLink()},showSeriePurchaseModal:function(e){var t=n(e.currentTarget),i=t.find(".js-serie-element-link"),a=t.data("episode"),s=this.collection.findWhere({id:i.data("id")});if(void 0===s){var l=i.data("right-types")?i.data("right-types").toUpperCase().split(","):[];s=new r.default({content_paid_types:l,season:i.data("season"),id:i.data("id"),episode:a,compilation_hru:this.compilationInfo.getHru()})}var u=new o.default({contentInfo:this.compilationInfo,contentEntity:s});if(s.isEst()){var c={};this.seasonPurchaseOptions&&(c.seasonPurchaseOptions=this.seasonPurchaseOptions),u.setSpecificParams(c)}if(s.isPaid())return d.default.trigger("billing:processSeasonPurchaseModal",s,u),!1},processSeasonPayment:function(e){var t=n(e.currentTarget),i=t.attr("href"),a=t.closest("ul").find(".js-serie-element-link"),s=t.data("content-paid-types")?t.data("content-paid-types").toUpperCase().split(","):[],u=new r.default({id:a.data("id"),season:a.data("season"),content_paid_types:s,episode:a.closest("li").data("episode"),compilation_hru:this.compilationInfo.getHru()}),c=new o.default({contentInfo:this.compilationInfo,contentEntity:u});return c.setSpecificParams({seasonPurchaseOptions:this.seasonPurchaseOptions,buyUrl:i,optionHash:t.data("option-hash")}),u.isEst()?h.default.isIdentified()?d.default.trigger("billing:processSeasonPayment",u,c,e):l.default.registerProofOfWork().done(function(){d.default.trigger("billing:processSeasonPayment",u,c,e)}):d.default.trigger("billing:processSeasonPurchaseModal",u,c),!1},setBuyButtonLink:function(){var e;e=this.collection.models&&this.collection.models.length?this.collection.models[0].getWatchLink():this.compilationInfo.getSerieWatchLink(),n(".js-buy-season-click").each(function(){this.href=this.dataset.watchLink+"&redirect_url="+encodeURIComponent(e)})},renderNewSerieBadge:function(){var e=this;this.$(".js-serie-element-link").each(function(t,i){var a=n(i);if(a.data("is-new-serie")&&a.data("id")){e.watchedListModel.get(a.data("id"))||a.find(".js-serie").after(f.default())}})}})},function(e,t,i){function n(e){return a.default.render('{% if not isBought and seasonPurchaseOptions.getPurchaseOptions() %} {% for seasonPurchaseOptionParams in seasonPurchaseOptions.getPurchaseOptionsSortedByHd() %} {% if seasonPurchaseOptionParams.getMinUserPrice() %} {% set priceFormat = "<ins>" ~ seasonPurchaseOptionParams.getMinUserPrice() ~ "</ins>" %} {% if seasonPurchaseOptionParams.getMinUserPrice() < seasonPurchaseOptionParams.getMinPrice() %} {% set priceFormat = "<del>" ~ seasonPurchaseOptionParams.getMinPrice() ~ "</del>&nbsp;" ~ priceFormat %} {% endif %} <a class="ivi-button large js-buy-season-click {% if seasonPurchaseOptionParams.isHDQuality() %}hd{% else %}pale{% endif %}" data-watch-link="{{ internationalExpansion.getSchemaWithHost("https", internationalExpansion.getRightHost()) }}/buy?object_id={{ seasonPurchaseOptionParams.getObjectId() }}&option_hash={{ seasonPurchaseOptionParams.getOptionHash() }}&object_type=season&from=content&serie_id={{ serieList[0].getId() }}" data-option-hash="{{ seasonPurchaseOptionParams.getOptionHash() }}" data-product-identifier="{{ seasonPurchaseOptionParams.getProductIdentifier() }}" data-content-paid-types="EST" > {% if not isMobile %}Купить {% if serieList[0].getSeason() %}Сезон {{ serieList[0].getSeason() }} {% endif %}за{% endif %} {{ internationalExpansion.getPriceWithCurrency(priceFormat) }} </a> {% endif %} {% endfor %}{% endif %}',e)}var a=i(2);t.default=n},function(e,t,i){function n(e){return a.default.render('{% set fakeSerieHasFutureReleaseDate = serie.isFake() and serie.hasFutureReleaseDate() %}{% if fakeSerieHasFutureReleaseDate %} {% set serieMainTag = "span" %}{% else %} {% set serieMainTag = "a" %}{% endif %}{% set serieLiClasses = "js-serie-element" %}{% if not serie.isBought() %} {% set serieLiClasses = serieLiClasses ~ " js-serie-element-buy" %}{% endif %}{% if fakeSerieHasFutureReleaseDate %} {% set serieLiClasses = serieLiClasses ~ " upcoming-episode" %}{% endif %}{% if not serie.isFake() or fakeSerieHasFutureReleaseDate %}<li class="{{ serieLiClasses }}" data-episode="{{ serie.getEpisode() }}"> <{{ serieMainTag }} href="/watch/{{ compilation.getHru() }}/{{ serie.getId() }}" class="item-content-wrapper js-serie-element-link" data-season="{{ serie.getSeason() }}" data-right-types="{{ serie.getContentPaidTypes()|join(",") }}" data-id="{{ serie.getId() }}" data-is-new-serie="{{ serie.isNewSerie() }}" itemprop="url"> <span class="image" data-caption="{{ serie.getPosterSpecificCaption(serie.isBought(), false, "", isSerieListEternalBought) }}"> {% if fakeSerieHasFutureReleaseDate %} {% set dateOutCaption = serie.getDateOutCaption() %} <img src="{{ serie.getPosterPath("/160x90/", null, {"blur": true}) }}" alt="{{ compilation.getTitle() }} - {{ serie.getTitle() }}"> <div class="upcoming-date js-upcoming-date"> {% if dateOutCaption is iterable %} <div class="upcoming-date__large">{{ dateOutCaption[0] }}</div> <div class="upcoming-date__small">{{ dateOutCaption[1] }}</div> {% else %} <div class="upcoming-date__small">{{ dateOutCaption }}</div> {% endif %} </div> {% else %} {% if serie.getThumbPath() %} <img src="{{ serie.getThumbPath() }}/160x90/" alt="{{ compilation.getTitle() }} - {{ serie.getTitle() }}" class="js-serie" data-id="{{ serie.getId() }}" data-duration="{{ serie.getDuration() }}"> {% endif %} {% endif %} <div class="properties"> {% if serie.getHdAvailable() %} <span class="feature">HD</span> {% endif %} </div> </span> <span class="episode-num" itemprop="position">{% if serie.getSeason() %}Сезон {{ serie.getSeason() }} серия {{ serie.getEpisode() }}{% else %}Серия {{ serie.getEpisode() }}{% endif %}</span> {% if serie.getSerieName() %} <span class="title js-serie-title"><span itemprop="name">{{ serie.getSerieName() }}</span></span> {% endif %} </{{ serieMainTag }}> <meta itemprop="episodeNumber" content="{{ serie.getEpisode() }}"></li>{% endif %}',e)}var a=i(2);t.default=n},function(e,t,i){function n(e){return a.default.render('<span class="gallery-item-notice gallery-item-notice_new-episode js-new-serie-badge">новая серия</span>',e)}var a=i(2);t.default=n},function(e,t,i){var n=i(1),a=i(0),s=i(48),o=i(57),r=i(706),l=i(707);t.default=a.View.extend({watchHistoryFields:"id,watch_time,duration_minutes,watch_percent",$jsSerieObjects:n(),watchContinue:!1,initialize:function(e){this.listenTo(s.default,"serieList:render",this.findJsSerieObjects),this.listenTo(o.default,"unfinished:watchhistory:loaded",this.handleSeriesData),e&&(this.watchedListModel=e,this.findJsSerieObjects())},findJsSerieObjects:function(){var e=this;this.$jsSerieObjects=n(".active .js-serie"),this.$jsSerieObjects.each(function(t,i){e.watchedListModel.addParamsToUri("content_id="+n(i).data("id"))}),this.watchedListModel.mapiGet({data:{fields:this.watchHistoryFields}})},handleSeriesData:function(){var e=this;this.$jsSerieObjects.each(function(t,i){var a=n(i),s=e.watchedListModel.get(a.data("id"));if(e.watchedListModel.resetAdditionUriParam(),s){var o=s.getWatchPercent();o&&(o>=100?a.after(l.default()):a.after(r.default({progress:o})))}})}})},function(e,t,i){function n(e){return a.default.render('<span class="progress-wrapper"><span class="progress" style="width: {{ progress }}%"></span></span>',e)}var a=i(2);t.default=n},function(e,t,i){function n(e){return a.default.render('<span class="fully-watched">Просмотрено</span>',e)}var a=i(2);t.default=n},function(e,t,i){var n=i(0),a=i(8),s=i(7),o=i(48),r=i(4),l=i(3),d=i(709),u=i(710),c=n.View.extend({el:".episodes-list",newSeriesNotificationModel:null,events:{"click .js-new-series-notification-add":"addNewSeriesNotification","click .js-new-series-notification-delete":"showDeleteNewSeriesNotificationModal"},notificationButtonVisibleGrootEventSent:!1,initialize:function(e){this.newSeriesNotificationModel=e.newSeriesNotificationModel,this.$el.on("scroll",this.checkNotificationButtonVisibility.bind(this))},renderNotificationButton:function(){this.removeNotificationButtons(),this.newSeriesNotificationModel.hasNotification()?this.renderDeleteNotificationButton():this.renderAddNotificationButton(),this.checkNotificationButtonVisibility()},removeNotificationButtons:function(){this.$el.find(".js-new-series-notification").remove()},renderAddNotificationButton:function(){this.$el.append(d.default())},renderDeleteNotificationButton:function(){this.$el.append(u.default())},addNewSeriesNotification:function(){return a.default.isAuthenticated()?this.newSeriesNotificationModel.addNotification():(s.default.trigger("auth:showLoginModal","newSeriesAddNotification"),this.newSeriesNotificationModel.listenToOnce(s.default,"user:login",this.newSeriesNotificationModel.addNotification)),l.default.track("notify_about_new_episodes_click"),!1},showDeleteNewSeriesNotificationModal:function(){return o.default.trigger("compilation:showDeleteNewSeriesNotificationModal"),l.default.track("not_notify_about_new_episodes_click"),!1},deleteNewSeriesNotification:function(){this.newSeriesNotificationModel.deleteNotification()},checkNotificationButtonVisibility:function(){if(!this.notificationButtonVisibleGrootEventSent){var e=this.$(".js-new-series-notification");r.default.getViewPort().height+r.default.getPageYOffset()>e.offset().top+e.height()&&(this.newSeriesNotificationModel.hasNotification()?l.default.track("not_notify_about_new_episodes_view"):l.default.track("notify_about_new_episodes_view"),this.notificationButtonVisibleGrootEventSent=!0)}}});t.default=c},function(e,t,i){function n(e){return a.default.render('<div class="episodes-list__notice js-new-series-notification"> <a href="#" class="ivi-button pale large js-new-series-notification-add">Напоминать о выходе новых серий</a></div>',e)}var a=i(2);t.default=n},function(e,t,i){function n(e){return a.default.render('<div class="episodes-list__notice js-new-series-notification"> <a href="#" class="ivi-button pale large js-new-series-notification-delete">Отписаться от уведомлений</a></div>',e)}var a=i(2);t.default=n},function(e,t,i){var n=i(16),a=i(48),s=i(712),o=n.default.extend({events:{"click .js-new-series-notification-delete":"deleteNewSeriesNotification"},template:s.default,openEvent:"compilation:showDeleteNewSeriesNotificationModal",wrapper:n.default.prototype.wrapper+"-delete-notification",mobileScroll:!0,regionEnabled:!0,compilationInfo:null,initialize:function(e){this.compilationInfo=e.compilationInfo},deleteNewSeriesNotification:function(){a.default.trigger("compilation:newSeriesDeleteNotificationClicked"),this.triggerCancel()},serializeData:function(){return{compilation:this.compilationInfo}}});t.default=o},function(e,t,i){function n(e){return a.default.render('<div class="fullscreen-popup fullscreen-popup_active fullscreen-popup_has-close-view-button"> <div class="fullscreen-popup__overlay"> <span></span> <span></span> <span></span> </div> <div class="fullscreen-popup__scroll-wrapper"> <div class="fullscreen-popup__wrapper"> <a class="fullscreen-popup__close-view-button js-modal-close" href="#" title="Нажмите, чтобы закрыть форму"> Закрыть окно </a> <section class="notice-series notice-series_modal"> <div class="notice-series-inner"> <h3 class="notice-series__title">Вы отписываетесь от уведомлений</h3> <div class="notice-series__content"> <article class="notice-series__desc"> <p class="notice-series__info">Мы перестанем уведомлять вас о выходе новых серий этого сериала</p> <button class="ivi-button large js-new-series-notification-delete">Отписаться</button> </article> <article class="notice-series__poster"> <img class="notice-series__img" src="{{ compilation.getPoster() }}/172x264/" alt="" width="100" height="160"> <span class="notice-series__text">{{ compilation.getTitle() }}</span> </article> </div> </div> </section> </div> </div></div>',e)}var a=i(2);t.default=n},function(e,t,i){var n=i(1),a=i(0),s=i(714),o=i(716),r=i(717);t.default=a.View.extend({el:".js-grade-block",id:null,type:null,initialize:function(e,t){this.id=e,this.type=t},render:function(e){var t=this;this.$el.each(function(i,a){var l=n(a),d=new o.default(t.id,t.type),u=new s.default;(e||e>0)&&d.grade(t.id,t.type,e),l.html(r.default({userRate:e})),d.render(),u.render(),l.find(".js-rating").empty(),l.find(".js-rating").append(d.$el),l.find(".js-rating").append(u.$el)})}})},function(e,t,i){var n=i(0),a=i(715);t.default=n.View.extend({tagName:"ul",minGrade:1,maxGrade:10,render:function(){for(var e=this.minGrade;e<=this.maxGrade;e++){var t=new a.default({value:e});t.render(),this.$el.append(t.$el)}}})},function(e,t,i){var n=i(0),a=i(73);t.default=n.View.extend({tagName:"li",events:{click:"grade"},initialize:function(e){this.value=e.value},grade:function(){a.default.trigger("rate:view:grade",this.value)}})},function(e,t,i){var n=i(0),a=i(73);t.default=n.View.extend({tagName:"div",id:null,type:null,initialize:function(e,t){this.id=e,this.type=t,this.listenTo(a.default,"user:grade",this.grade),this.listenTo(a.default,"api:user:grade",this.grade)},grade:function(e,t,i){e===this.id&&t===this.type&&this.$el.width(10*i+"%")}})},function(e,t,i){function n(e){return a.default.render('<figcaption>Ваша оценка:</figcaption><div class="scale-rating js-rating"> <div></div></div>',e)}var a=i(2);t.default=n},function(e,t,i){var n=i(1),a=i(68),s=i(26);t.default=a.default.extend({el:".js-groot-popup",events:{"click .js-description-link":"descriptionClick"},initialize:function(e){e&&e.blockId&&this.setLocalBlockId(e.blockId,!0),this.listenTo(s.default,"favourite:add",this.addToFavourite)},descriptionClick:function(e){var t=n(e.target).closest(".js-groot-popup").data("content-id");if(t){var i=n(".js-related-item-link[data-content-id="+t+"]");this.trackCollectionContentAction("hydra.content.open_description",i)}},addToFavourite:function(e){if(e.objectId){var t=n(".js-related-item-link[data-content-id="+e.objectId+"]");this.trackCollectionContentAction("hydra.content.add_favourites",t)}}})},function(e,t,i){function n(e){return a.default.render("Похожее{% if visible > 1 %} на «{{ relatedName }}»{% endif %}",e)}var a=i(2);t.default=n},function(e,t,i){function n(e){return a.default.render('<h2 id="related-title" class="fadeout">Похожее{% if visible > 1 %} на «{{ relatedName }}»{% endif %}</h2><ul class="gallery posters-large steady-casing"> {% for video in related %} <li class="{% if video.isInfoVideo() or video.isPreorderable() %}info{% endif %} {% if abExperiment.useNewPriceBadges() %}{{ video.getNewPriceBadgeClasses(abExperiment.showFreeBadge(), hasSubscription) }}{% else %}{{ video.getPaidIcon() }}{% endif %} {% if loop.index > visible %}collapsed{% endif %}"> <a href="{{ video.getPosterSpecificLink(hasSubscription) }}" class="item-content-wrapper{% if video.isForAdult() %} js-adult{% endif %}"> {% if video.isInfoVideo() %} <span class="image" data-caption="Описание"> {% else %} <span class="image" data-caption="{% if video.isSvod() %}{{ video.getPosterSpecificCaption(hasSubscription) }}{% else %}{{ video.getPosterSpecificCaption() }}{% endif %}"> {% endif %} <img src="{{ video.getPosterPath("/172x264/") }}" alt="{{ video.getTitle() }}"> <span class="age-limit" data-value="{{ video.getRestrict()|default(0) }}+"></span> {% if abExperiment.useNewPriceBadges() %} <div class="badge"> <div class="badge__content" data-badge-content="{{ video.getNewPriceBadgeTitle(abExperiment.showFreeBadge(), hasSubscription) }}"></div> </div> {% endif %} </span> <span class="title"><span>{{ video.getTitle() }}</span></span> </a> <div class="popup-wrapper" data-hru="{% if video.isCompilation() %}{{ video.getHru() }}{% else %}{{ video.getId() }}{% endif %}"></div> </li> {% endfor %}</ul>',e)}var a=i(2);t.default=n},function(e,t,i){var n=i(37),a=i(6),s=i(196),o=i(132),r=i(197);t.default=a.default.extend({run:function(e){a.default.prototype.run.call(this);var t=new n.default;new s.default({videoId:t.getId(),kind:2}),new r.default({collection:new o.default([],{contentType:t.getContentType()}),page:e.page,video:t,initWaypoint:!1})}})},function(e,t,i){var n=i(335);t.default=n.default.extend({uri:"/user/compilation/review/v6/add"})},function(e,t,i){function n(e){return a.default.render("В рецензии должно быть не менее 500 символов.",e)}var a=i(2);t.default=n},function(e,t,i){var n=i(335);t.default=n.default.extend({uri:"/user/video/review/v6/add"})},function(e,t,i){var n=i(0),a=i(5),s=i(64);t.default=n.View.extend({errors:[],info:"",initialize:function(){var e=this;this.listenTo(s.default,"error",function(t){e.deleteErrorByType(t.type),e.errors.push(t),e.showError()}),this.listenTo(s.default,"no:error",function(t){e.deleteErrorByType(t),e.showError()}),this.listenTo(s.default,"info:message",function(t){e.info=t,e.showError()})},deleteErrorByType:function(e){this.errors=a.without(this.errors,a.findWhere(this.errors,{type:e}))},showError:function(){this.$el.html((a.first(this.errors)||{}).text||this.info||""),a.isEmpty(this.errors)&&s.default.trigger("form:is:ready")},show:function(){this.$el.removeClass("hide")},hide:function(){this.$el.addClass("hide")}})},function(e,t,i){var n=i(0),a=i(7),s=i(3),o=i(64),r=i(8);t.default=n.View.extend({el:"#review-form-expander",clicked:!1,canBeClicked:!1,events:{click:"click"},initialize:function(){var e=this;this.$el.find("input").is(":focus")&&this.click(),this.listenTo(a.default,"auth:removePopup",function(){e.clicked&&e.click()}),this.listenTo(a.default,"loadUser",function(){e.canBeClicked=!0})},click:function(){this.canBeClicked&&(this.clicked=!0,s.default.track("review_add_click"),r.default.isAuthenticated()?o.default.trigger("expand"):a.default.trigger("auth:showLoginModal","review"))}})},function(e,t,i){var n=i(1),a=i(0),s=i(728),o=i(64),r=i(73);t.default=a.View.extend({initialize:function(){o.default.trigger("error",{type:"rate",text:n.trim(s.default())}),this.listenTo(o.default,"check",function(){r.default.trigger("check:grade")}),this.listenTo(r.default,"have:grade",this.discardError),this.listenTo(r.default,"get:grade",this.discardError)},discardError:function(e,t,i){i&&o.default.trigger("no:error","rate")}})},function(e,t,i){function n(e){return a.default.render("Пожалуйста, поставьте оценку",e)}var a=i(2);t.default=n},function(e,t,i){i(76);var n=i(16),a=i(730);t.default=n.default.extend({modalId:"js-review-rules",template:a.default,openEvent:"review:rules:modal",regionEnabled:!0,mobileModal:!0,mobileScroll:!0,visible:!1,onShow:function(){window.ivi.adaptive.isMobileStyle||this.$el.find(".rules").perfectScrollbar({suppressScrollX:!0})}})},function(e,t,i){function n(e){return a.default.render('<div class="ivi-modal-wrapper-content rules"> <div class="ivi-modal-content"> <ul class="rules-items"> <li>Рецензия должна быть написана грамотным русским языком, а при ее оформлении стоит учитывать базовые правила типографики (стоит разбивать длинный текст на абзацы, не злоупотреблять заглавными буквами и т.д.).</li> <li>Рецензия, в тексте которой содержится большое количество ошибок, опубликована не будет.</li> <li>В тексте рецензии должно содержаться по крайней мере 500 знаков. Меньшие по объему тексты следует добавлять в раздел «Отзывы».</li> <li>При написании рецензии следует по возможности избегать спойлеров (раскрытия важной информации о сюжете), чтобы не портить впечатление о фильме для других пользователей, которые только собираются приступить к просмотру.</li> <li>На ivi запрещен плагиат: не следует копировать (полностью или частично) чужие рецензии и выдавать их за собственные. Все рецензии уличенных в плагиате пользователей будут немедленно удалены.</li> <li>В тексте рецензии запрещено размещать гиперссылки на внешние интернет-ресурсы.</li> <li>При написании рецензии следует избегать нецензурных выражений и жаргонизмов.</li> <li>В тексте рецензии рекомендуется аргументировать свою позицию. Если в рецензии содержатся лишь оскорбительные высказывания в адрес создателей фильма, то она не будет размещена на сайте.</li> <li>Рецензия во время проверки или по жалобе другого пользователя может быть подвергнута редакторской правке (исправлению ошибок, удалению спойлеров и т.д.).</li> <li>В случае регулярного нарушения правил все последующие тексты нарушителя рассматриваться для публикации не будут.</li> <li>На сайте запрещено публиковать заказные рецензии. При обнаружении заказной рецензии все тексты ее автора будут удалены, а возможность дальнейшей публикации будет заблокирована.</li> </ul> </div> <span class="ivi-modal-close js-modal-close">Закрыть</span></div>',e)}var a=i(2);t.default=n},function(e,t,i){var n=i(0),a=i(64);t.default=n.View.extend({initialize:function(){this.listenTo(a.default,"form:is:ready",this.enable),this.listenTo(a.default,"error",this.disable)},enable:function(){this.$el.prop("disabled",!1)},disable:function(){this.$el.prop("disabled",!0)}})},function(e,t,i){i(76);var n=i(1),a=i(0),s=i(733),o=i(734),r=i(64);t.default=a.View.extend({minSymbolCount:500,maxSymbolCount:1e4,events:{keyup:"keyup"},initialize:function(){this.listenTo(r.default,"check",this.check),this.listenTo(r.default,"review:markText",this.markText)},keyup:function(){r.default.trigger("check")},initAutosize:function(){this.$el.autosize()},check:function(){if(this.$el.val().length<this.maxSymbolCount){var e=n.trim(o.default({count:this.$el.val().length,minCount:this.minSymbolCount,maxCount:this.maxSymbolCount}));this.$el.val().length>=this.minSymbolCount?(r.default.trigger("no:error","text"),r.default.trigger("info:message",e)):r.default.trigger("error",{type:"text",text:e})}else r.default.trigger("error",{type:"text",text:n.trim(s.default())})},markText:function(e){try{var t=this.$el.get(0),i=t.value,n=t.selectionStart,a=t.selectionEnd,s=i.substring(n,a),o=void 0;if(!s.length)return;switch(e){case"B":o="b";break;case"I":o="i"}this.$el.val(i.substring(0,n)+"["+o+"]"+s+"[/"+o+"]"+i.substring(a))}catch(e){}}})},function(e,t,i){function n(e){return a.default.render("Превышен лимит максимально допустимого количества символов",e)}var a=i(2);t.default=n},function(e,t,i){function n(e){return a.default.render("Рецензия должна содержать от {{ minCount }} до {{ maxCount - 1 }} символов, у вас <span>{{ count }}</span>",e)}var a=i(2);t.default=n},function(e,t,i){var n=i(1),a=i(0),s=i(736),o=i(64);t.default=a.View.extend({events:{keyup:"keyup"},initialize:function(){this.listenTo(o.default,"check",this.check)},keyup:function(){o.default.trigger("check")},check:function(){this.$el.val()?o.default.trigger("no:error","title"):o.default.trigger("error",{type:"title",text:n.trim(s.default())})}})},function(e,t,i){function n(e){return a.default.render("Заполните заголовок рецензии",e)}var a=i(2);t.default=n},function(e,t,i){function n(e){return a.default.render('<li class="essential auth-required"> Для того чтобы добавить рецензию, <a class="js-auth" href="#">авторизуйтесь</a></li>',e)}var a=i(2);t.default=n},function(e,t,i){var n=i(14),a=i(126);t.default=n.default.extend(a.default).extend({uri:"/review/v6/",initialize:function(e){this.set(e)},getId:function(){return this.get("id")},getTitle:function(){return this.get("title")},getUserRate:function(){return this.get("user_rate")||0},getPreview:function(){return this.get("preview").replace(/<a\b[^>]*>(.*?)<\/a>/i,"")},getUsername:function(){return this.get("username")},getAdded:function(){return new Date(this.get("added"))},getApproved:function(){return this.get("approved")},getAddedAsString:function(){return this.getAdded()},getAddedAsLocalString:function(){return this.getAdded()},getUserId:function(){return this.get("user_id")},getUrl:function(){return this.get("url")},getCommentCount:function(){return this.get("comments_count")}})},function(e,t,i){function n(e){return a.default.render('<li data-id="{{ review.getId() }}" class="js-votable js-reviews-item reviews-item {% if not review.getApproved() %}moderation{% endif %}" itemprop="review" itemscope itemtype="https://schema.org/Review"> <header class="main-info"> <cite class="author js-author" itemprop="author">{% if review.getUsername() %}{{ review.getUsername() }} {% else %}Anonymous{% endif %}</cite> <time class="date"><meta itemprop="datePublished" content="{{ internationalExpansion.getLocalDateTime(review.getAdded())|date("Y-m-d") }}"> {{ internationalExpansion.getLocalDateTime(review.getAdded())|locale_date("d MMMM Y") }} </time> <dl class="numeric-rating"> <dt>Оценка {{ categoryTitle }}</dt> <dd><span itemprop="reviewRating">{{ review.getUserRate() }}</span> из 10</dd> </dl> {% if not review.getApproved() %} <span class="status-plate">На модерации</span> {% endif %} </header> <h2 class="item-title"><a href="{{ video.getWatchLink() }}/reviews/{{ review.getId() }}">{{ review.getTitle()|specialEscape("bbcode") }}</a></h2> <article class="ugc-text" itemprop="reviewBody"> {{ review.getPreview()|striptags|specialEscape("bbcode") }} <span class="more-wrapper"><a href="{{ video.getWatchLink() }}/reviews/{{ review.getId() }}" class="more js-read-more">Читать далее</a></span> </article> <footer class="extra-info"> <span class="comments-count"> {% if review.getApproved() %} <a class="js-comments" href="{{ video.getWatchLink() }}/reviews/{{ review.getId() }}#comments"> {% if review.getCommentCount() %}{{ review.getCommentCount() }} комментари{{ declension.number(review.getCommentCount(), ["й", "я", "ев"]) }}{% else %}Нет комментариев{% endif %} </a> {% endif %} </span> <span class="votes"> <span class="value js-votes{% if review.getLikesBalance() > 0 %} positive{% elseif review.getLikesBalance() < 0 %} negative{% endif %}">{{ review.getLikesBalance() }}</span> {% if review.getUserId() != visitor.getId() %} <span class="vote-action minus js-dislike{% if review.isDisliked() %} active{% endif %}"></span> <span class="vote-action plus js-like{% if review.isLiked() %} active{% endif %}"></span> {% endif %} </span> </footer></li>',e)}var a=i(2);t.default=n},function(e,t,i){var n=i(0),a=i(741),s=i(742);t.default=n.View.extend({el:".js-dynamic-button-wrapper",initialize:function(){var e={descriptionPage:this.$el.data("description-page")};this.$el.hasClass("js-type-button")?this.$el.append(s.default(e)):this.$el.append(a.default(e))}})},function(e,t,i){function n(e){return a.default.render('<a href="{{ descriptionPage }}#reviews" class="action-link huge">Написать рецензию</a>',e)}var a=i(2);t.default=n},function(e,t,i){function n(e){return a.default.render('<a href="{{ descriptionPage }}#reviews" class="ivi-button medium dark button-review">Написать рецензию</a>',e)}var a=i(2);t.default=n},function(e,t,i){var n=i(1),a=i(0),s=i(3);t.default=a.View.extend({el:".js-share",events:{"click .js-share-toggle-form":"expandBlock","click .js-share-input":"highlight"},initialize:function(){try{window.Ya.share2("js-sharing-block",{hooks:{onshare:function(e){s.default.track("share_method_click",{social:e})}}})}catch(e){}},expandBlock:function(){var e=n(".js-share");s.default.track(e.hasClass("expanded")?"share_block_collapse":"share_block_expand"),e.toggleClass("expanded")},highlight:function(e){var t=e.target;t.focus(),t.setSelectionRange(0,t.value.length)}})},function(e,t,i){var n=i(54),a=i(56),s=i(9),o=i(25);t.default=s.default.extend({routes:["/watch/str:hru/person"],run:function(e){o.default.prototype.run(e),(new n.default).execute(e),(new a.default).execute(e)}})},function(e,t,i){var n=i(54),a=i(56),s=i(9),o=i(25);t.default=s.default.extend({routes:["/watch/str:hru/premiere"],run:function(e){o.default.prototype.run(e),(new a.default).execute(e),(new n.default).execute(e)}})},function(e,t,i){var n=i(54),a=i(337),s=i(56),o=i(49),r=i(9),l=i(25);t.default=r.default.extend({routes:["/watch/str:hru/reviews/int:reviewId"],run:function(e){l.default.prototype.run(e),(new n.default).execute(e),(new s.default).execute(e),(new o.default).execute(e),(new a.default).execute(e)}})},function(e,t,i){var n=i(1),a=i(0);t.default=a.View.extend({el:".js-show-all-reviews",events:{click:"showAll"},showAll:function(){n("#comment-list li").show(),this.$el.hide()}})},function(e,t,i){var n=i(0),a=i(194);t.default=n.View.extend(a.default).extend({el:".js-review-item",objectType:"review",initialize:function(){this.initLikes()}})},function(e,t,i){var n=i(54),a=i(56),s=i(49),o=i(331),r=i(338),l=i(133),d=i(9),u=i(25);t.default=d.default.extend({routes:["/watch/str:hru/reviews","/watch/str:hru/reviews/pageint:page"],run:function(e){u.default.prototype.run(e),(new n.default).execute(e),(new a.default).execute(e),(new o.default).execute(e),(new s.default).execute(e),(new r.default).execute(e),(new l.default).execute(e)}})},function(e,t,i){var n=i(54),a=i(129),s=i(329),o=i(56),r=i(49),l=i(339),d=i(135),u=i(130),c=i(134),p=i(9),f=i(25);t.default=p.default.extend({routes:["/watch/str:hru/int:id"],run:function(e){f.default.prototype.run(e),(new n.default).execute(e),(new l.default).execute(e),(new s.default).execute(e),(new d.default).execute(e),(new u.default).execute(e),(new r.default).execute(e),(new a.default).execute(e),(new c.default).execute(e),(new o.default).execute(e)}})},function(e,t,i){var n=i(0),a=i(4);t.default=n.View.extend({el:"#js-player-block",events:{click:"clickEvent"},initialize:function(){this.clickLink=this.$el.data("link"),this.clickLink&&this.$el.addClass("clickable")},clickEvent:function(e){this.clickLink&&(e.target!==this.el&&"js-player-area"!==e.target.id||a.default.open(this.clickLink))}})},function(e,t,i){var n=i(1),a=i(0),s=i(37),o=i(124),r=i(23),l=i(11);t.default=a.View.extend({el:".not-purchased",BUTTON_SOURCE_FOR_GROOT:"d",purchaseParams:null,contentInfo:null,contentEntity:null,events:{"click .js-buy-click":"triggerEvent"},initialize:function(){this.contentInfo=new r.default,this.contentInfo.isCompilation()&&(this.contentInfo=new s.default),this.contentEntity=this.contentInfo.getContentEntity(),this.purchaseParams=new o.default({contentInfo:this.contentInfo,contentEntity:this.contentEntity})},triggerEvent:function(e){return this.purchaseParams.setPurchaseType(n(e.currentTarget).data("purchase-type")),this.purchaseParams.setPurchaseSourceForGroot(this.BUTTON_SOURCE_FOR_GROOT),l.default.trigger("buy:click",this.contentEntity,this.purchaseParams),!1}})},function(e,t,i){var n=i(0),a=i(37),s=i(113),o=i(23),r=i(754),l=i(755),d=i(756),u=i(757);t.default=n.View.extend({el:"#not-purchased-text",render:function(){var e,t=new o.default;e=t.isCompilation()?(new a.default).getContentEntity():t.getContentEntity();var i,n=t.getCategoryHru();i=e.isSerie()&&e.getSeason()?s.default.prototype.SEASON_CATEGORY:t.getCategoryHru(),e.isSvod()&&(e.isEst()||e.isTvod())?this.$el.append(d.default({category:i,canonicalCategory:n})):e.isSvod()?(this.$el.append(l.default({category:i,canonicalCategory:n})),window.ivi.adaptive.isMobileStyle||this.$el.append(r.default())):this.$el.append(u.default({category:i,canonicalCategory:n}))}})},function(e,t,i){function n(e){return a.default.render("<p>Кроме того, подписка ivi включает в себя огромный каталог фильмов и сериалов без рекламы в максимальном качестве</p>",e)}var a=i(2);t.default=n},function(e,t,i){function n(e){return a.default.render('<h2 class="no-mobile"> {{ declension.getNom(category)|capitalize }} доступен при {% if isWorld %}покупке подписки&nbsp;ivi{% else %}подключении подписки{% endif %}</h2><div class="only-mobile title"> {{ declension.getNom(category)|capitalize }} доступен при {% if isWorld %}покупке <small>подписки ivi</small>{% else %}подключении <small>подписки</small>{% endif %}</div>',e)}var a=i(2);t.default=n},function(e,t,i){function n(e){return a.default.render('<h2 class="no-mobile"> {{ declension.getNom(category)|capitalize }} можно посмотреть по подписке или купить</h2><div class="only-mobile title"> {{ declension.getNom(category)|capitalize }} можно посмотреть <small> по подписке или купить </small></div>{% if not isMobile %} <p> <span>Наслаждайтесь просмотром {{ declension.getGen(canonicalCategory) }} без рекламы</span> <span>и на любом устройстве!</span> </p>{% endif %}',e)}var a=i(2);t.default=n},function(e,t,i){function n(e){return a.default.render('<h2 class="no-mobile"> Этот {{ declension.getAcc(category) }} можно купить прямо сейчас!</h2><div class="only-mobile title"> Этот {{ declension.getAcc(category) }} можно купить <small>прямо сейчас!</small></div>{% if not isMobile %} <p> <span>Наслаждайтесь просмотром {{ declension.getGen(canonicalCategory) }} без рекламы</span> <span>и на любом устройстве!</span> </p>{% endif %}',e)}var a=i(2);t.default=n},function(e,t,i){var n=i(14);t.default=n.default.extend({uri:"/video/watchtime/v5/",parse:function(e){return e.result?e.result:null}})},function(e,t,i){var n=i(54),a=i(56),s=i(340),o=i(9),r=i(25);t.default=o.default.extend({routes:["/watch/str:hru/trailers","/watch/str:hru/trailers/int:id"],run:function(e){r.default.prototype.run(e),(new n.default).execute(e),(new a.default).execute(e),(new s.default).execute(e)}})},function(e,t,i){var n=i(1),a=i(0),s=i(6),o=i(11),r=i(89),l=i(3),d=i(761);t.default=a.View.extend({el:".js-additional-video-wrapper",events:{"click .js-preview-wrapper":"playTrailer","click .js-embed-code":"selectEmbedCode","copy .js-embed-code":"trackCopyEvent"},initialize:function(){this.listenTo(o.default,"purchase:personal",this.emptyAutoplayHash),this.replaceLinks()},replaceLinks:function(){n("a.js-preview-wrapper").each(function(e,t){var i=n(t);i.attr("href",i.data("href"))})},playTrailer:function(e){var t;return n(".js-player-wrapper").remove(),n(".js-preview-wrapper").show(),t=n(e?e.currentTarget:".js-preview-wrapper:first"),t.after(d.default()),t.hide(),n(".js-player-wrapper").css("visibility","visible"),r.default.trigger("trailer:play",t.data("id")),!1},selectEmbedCode:function(e){return e.currentTarget.selectionStart=0,e.currentTarget.selectionEnd=e.currentTarget.value.length,!1},trackCopyEvent:function(){l.default.track("trailer_code_copy")},emptyAutoplayHash:function(){s.default.prototype.emptyQueryParams()}})},function(e,t,i){function n(e){return a.default.render('<span class="video-wrapper loading js-player-wrapper" style="visibility: hidden; background: black"> <div class="video-player-wrapper"> <div id="js-player"> </div> </div> <div id="video-flack" class="video-flack"> <div id="flash-video-adv"></div> </div></span>',e)}var a=i(2);t.default=n},function(e,t,i){var n=i(12),a=i(763),s=i(9);t.default=s.default.extend({routes:["/devices"],run:function(e){n.default.prototype.run(e),(new a.default).execute(e)}})},function(e,t,i){var n=i(6),a=i(764);t.default=n.default.extend({enablePseudoRoute:!0,run:function(){this.view=new a.default},pseudoRouter:function(e){switch(e){case"#phonesandtablets":this.view.activateTab("tab-phonesandtablets");break;case"#smarttv":this.view.activateTab("tab-smarttv");break;case"#console":this.view.activateTab("tab-console")}}})},function(e,t,i){var n=i(1),a=i(0);t.default=a.View.extend({el:".js-devices-tabs",activateTab:function(e){this.$el.find(".js-platform-wrapper").hide(),n("#"+e).show(),this.$el.find(".tab-wrapper").find("a").removeClass("active"),this.$el.find('a[data-tab-id="'+e+'"]').addClass("active")}})},function(e,t,i){var n=i(81),a=i(211),s=i(147),o=i(766),r=i(151),l=i(152),d=i(153),u=i(154),c=i(157),p=i(343),f=i(9),h=i(18),g=i(43);t.default=f.default.extend({routes:["/embeds.*"],run:function(e){g.default.useParentGrootTag(),h.default.loadABManagerTests(),n.default.check(),(new r.default).execute(e),(new u.default).execute(e),(new a.default).execute(e),(new o.default).execute(e),(new c.default).execute(e),(new s.default).execute(e),(new p.default).execute(e),(new l.default).execute(e),(new d.default).execute(e)}})},function(e,t,i){var n=i(6),a=i(33),s=i(767),o=i(768),r=i(769),l=i(771),d=i(772),u=i(156),c=i(341),p=i(198),f=i(773),h=i(144),g=i(8);t.default=a.default.extend({ADV_PARTNER_PIXEL_LINK:"https://rtb.com.ru/ivi-sync?uid=",playerInfoView:null,initialize:function(){this.playerInfoView=new p.default},afterLogin:function(){this.playerInfoView.isUnsupportedBrowser()?new o.default:this.playerInfoView.isFake()&&!this.playerInfoView.isBought()?new s.default:n.default.prototype.queryParams.shd?window.opener?this.startPlayer():(new f.default).renderStub({poster:this.playerInfoView.getPosterPath()}):this.startPlayer()},startPlayer:function(){var e=this.playerInfoView.getType();if("flash"===e)if(this.playerInfoView.getPlayerAppVersion())this.trackAdvPartnerPixel(),new d.default;else{var t=h.default.getFlashPlayerVersion();0===t.major?(new r.default).render():(this.trackAdvPartnerPixel(),(new l.default).render())}else"html5"===e?this.playerInfoView.getPlayerForceHtml5()||this.playerInfoView.getPlayerAppVersion()?(this.trackAdvPartnerPixel(),new d.default):(this.trackAdvPartnerPixel(),new c.default):new f.default},trackAdvPartnerPixel:function(){(new u.default).setSrc(this.ADV_PARTNER_PIXEL_LINK+g.default.getId())}})},function(e,t,i){var n=i(1),a=i(0),s=i(4);t.default=a.View.extend({el:".puck-stub-wrapper",events:{"click #app_button":"openLink"},initialize:function(){try{this.gambitApi=parent.window.gambitApi}catch(e){this.gambitApi=window.gambitApi}this.gambitApi&&this.gambitApi.onPlayerLoad()},openLink:function(e){return s.default.redirectParentWindow(n(e.currentTarget).data("href")),!1}})},function(e,t,i){var n=i(1),a=i(0),s=i(4),o=i(3);t.default=a.View.extend({el:".puck-stub-drm",events:{"click #app_button":"openAppLink","click .js-chrome-link":"openChromeLink","click .js-ff-link":"openFirefoxLink"},initialize:function(){try{this.gambitApi=parent.window.gambitApi}catch(e){this.gambitApi=window.gambitApi}this.gambitApi&&this.gambitApi.onPlayerLoad(),o.default.track("stub_no_drm")},openAppLink:function(e){return o.default.track("stub_no_drm_app"),s.default.redirectParentWindow(n(e.currentTarget).data("href")),!1},openChromeLink:function(){o.default.track("stub_no_drm_click_browser",{select_browser:"chrome"})},openFirefoxLink:function(){o.default.track("stub_no_drm_click_browser",{select_browser:"firefox"})}})},function(e,t,i){var n=i(0),a=i(770);t.default=n.View.extend({el:"body",render:function(){try{this.gambitApi=parent.window.gambitApi}catch(e){this.gambitApi=window.gambitApi}this.gambitApi&&this.gambitApi.onPlayerLoad(),this.$el.append(a.default())}})},function(e,t,i){function n(e){return a.default.render('<div class="puck-container puck-state-error puck-state-no-poster"> <div class="puck-stub-wrapper"> <div class="puck-footer"> <span class="puck-message"> Для воспроизведения видео необходим проигрыватель Flash Player </span> </div> <div class="puck-button-wrapper" style="padding-top:20px;"> <a class="embed-app-button" href="https://get.adobe.com/flashplayer/" target="_blank">Установить Flash Player</a> </div> </div></div>',e)}var a=i(2);t.default=n},function(e,t,i){var n=i(1),a=i(0),s=i(6),o=i(198),r=i(10),l=i(144),d=i(4),u=i(18);t.default=a.View.extend({el:"#js-player",render:function(){var e=this;if(!n("#player").length){var t=new o.default,i=t.isPaid()||t.isFake()&&t.isUsedToBePaid()?r.default.player.paid:r.default.player.free,a=d.default.getLocation().href.match(/playerlight(\d*)/);a&&(i=r.default.player.light,i.url+=a[1]||"");var c=d.default.getViewPort(),p=s.default.prototype.queryParams,f=u.default.getUserBucket(),h={id:"js-player",src:i.url,allowScriptAccess:"always",allowFullScreen:"true",wmode:"opaque",bgcolor:"#000000",width:c.width,height:c.height,quality:"high",version:[11,0],isDebugMode:0},g={videoId:t.getContentId(),_isB2C:t.isB2C(),mapi:r.default.player.params.mapiUrl+"/",api:r.default.player.params.lightUrl,content_type:t.getContentType(),autoStart:t.isAutoStart(),disableiviredirect:t.getDisableIviRedirect(),allowSeriesPlaylist:t.getAllowSeriesPlaylist(),app_version:t.getAppVersion()};t.getHostname()&&(g.hostname=t.getHostname()),"trailer"!==t.getContentType()&&(g.continuewatching=!0),p.adr_order_id&&(g.adr_order_id=p.adr_order_id),p.vast_url&&(g.vast_url=p.vast_url),p.start&&(g.start=p.start),f&&(g.user_ab_bucket=f),l.default.createPlayer(h,g),this.setPlayerSize(),n(window).resize(function(){e.setPlayerSize()})}},setPlayerSize:function(){var e=d.default.getViewPort();n("#js-player").css("vertical-align","top").attr("width",e.width).attr("height",e.height)}})},function(e,t,i){var n=i(1),a=i(6),s=i(341),o=i(32),r=i(81),l=i(342),d=i(50),u=i(10),c=i(18);t.default=s.default.extend({ADBLOCK_DETECTOR_WAIT_TIMEOUT:500,playerShown:!1,initialize:function(){s.default.prototype.initialize.call(this),n("body").on("contextmenu",function(){return!1})},getAdditionalParams:function(){var e=a.default.prototype.queryParams,t=new o.default,i=this.playerInfo.getAdvNumberOfAttempts(),n=this.playerInfo.getAdvWaitTime(),s=this.playerInfo.getAdvRequestWaitTime(),r=this.playerInfo.getAdvShowWaitTime(),l=this.playerInfo.getEndscreenRatingTimer(),p=this.playerInfo.getEndscreenNextVideoTimer(),f=this.playerInfo.getEndscreenVariant(),h=this.playerInfo.getSeriesEndscreenVariant(),g="trailer"===this.playerInfo.getContentType()&&"1"===e.preorder||!!t.isSafariBrowser()&&!this.playerInfo.isContentDisable(),m=t.isSafariBrowser()&&!this.playerInfo.isContentDisable()?0:1===this.playerInfo.isAutoStart()||"true"===this.playerInfo.isAutoStart(),v={appVersion:this.playerInfo.getPlayerAppVersion(),browser:{name:t.getBrowserName(),version:t.getBrowserVersion(),os:t.getOsName(),osVersion:t.getOsVersion()},autoStart:m,skipSplash:!(!window.ivi.adaptive.isMobile&&!t.isSafariBrowser())||this.playerInfo.skipSplash(),skipAdv:g,resume:this.playerInfo.isResume(),embed:this.playerInfo.isEmbeded(),debug:"1"===e.debug,isWorld:u.default.isWorld,isPaywall:u.default.isPaywall,isMobile:window.ivi.adaptive.isMobile,mapi:u.default.player.params.mapiUrl+"/",light:u.default.player.params.lightUrl,logger:u.default.player.params.loggerUrl,advNumberOfAttempts:null!==i?i:5,advWaitTime:null!==n?n:10,advRequestWaitTime:null!==s?s:5,advShowWaitTime:null!==r?r:5,playerContainerId:"js-player",start:e.start?e.start:0,postbackUrl:e.postback_url?decodeURIComponent(e.postback_url):"",isBnPostMessage:"1"===e.isBnPostMessage,postMessageDisable:e.postMessageDisable?"1"===e.postMessageDisable:null,noadvPostbackUrl:e.noadv_postback_url?decodeURIComponent(e.noadv_postback_url):"",advPostbackUrl:e.adv_postback_url?decodeURIComponent(e.adv_postback_url):"",clickthruPostback:e.clickthru_postback?decodeURIComponent(e.clickthru_postback):"",contentDisable:this.playerInfo.isContentDisable(),postbackDisable:this.playerInfo.isPostbackDisable(),hsCursorSound:this.playerInfo.isHsCursorSound(),hsPostMessage:this.playerInfo.isHsPostMessage(),hsHideAnnouncement:this.playerInfo.isHsHideAnnouncement(),hsSkipBlockSeconds:this.playerInfo.getHsSkipBlockSeconds(),playerId:e.playerId,referer:this.playerInfo.getReferer(),ancestorOrigin:d.default.getLastAncestorOrigin(),isTnsOff:this.playerInfo.isTnsOff(),endscreenRatingTimer:null!==l?l:15,endscreenNextVideoTimer:null!==p?p:15,endscreenVariant:null!==f?f:3,seriesEndscreenVariant:null!==h?h:3,showSeriesNewEndscreen:c.default.showSeriesNewEndscreen(),pxAuditLinks:this.playerInfo.getPxAuditLinks(),hideRecommendations:this.playerInfo.isHideRecommendations(),hideSubscriptionQuality:this.playerInfo.isHideSubscriptionQuality(),prepareContent:this.playerInfo.isPrepareContent(),disableEndscreen:this.playerInfo.isDisableEndscreen(),weboramaDmpUrl:this.playerInfo.getWeboramaDmpUrl()?this.playerInfo.getWeboramaDmpUrl():null,directAdAtLastRequestEnabled:this.playerInfo.getDirectAdAtLastRequestEnabled(),directAdBeforeTimeoutInterval:this.playerInfo.getDirectAdBeforeTimeoutInterval(),useBrainientSdk:this.playerInfo.isBrainientSdk(),playerIviLogoNotClickable:this.playerInfo.isPlayerIviLogoNotClickable(),hideFavouriteButton:this.playerInfo.isHideFavouriteButton(),advPreviewForPartners:parseInt(e.preview,10)||null};"prod"!==u.default.env&&(e.testScenarioId&&(v.testScenarioId=e.testScenarioId),e.dontSaveAdvHistory&&(v.dontSaveAdvHistory=e.dontSaveAdvHistory),e.light&&(v.light=e.light),e.mapi&&(v.mapi=e.mapi),e.vast_url&&(v.vastUrl=decodeURIComponent(e.vast_url)));var _=this.playerInfo.getCategoryHru(),b=this.playerInfo.getGenreHru();return _&&b&&(v.categoryHru=_,v.genreHru=b),u.default.static.host&&(v.staticHost=u.default.static.host),v},render:function(){var e=this;setTimeout(this.showPlayer.bind(this),this.ADBLOCK_DETECTOR_WAIT_TIMEOUT),r.default.detectedDeferred.done(function(){e.playerParams.adblock=r.default.detected?1:0,e.showPlayer()})},showPlayer:function(){this.playerShown||(l.default.createPlayer(this.playerParams),this.setPlayerSize(),this.playerShown=!0)}})},function(e,t,i){var n=i(1),a=i(0),s=i(774),o=i(4);t.default=a.View.extend({el:"#js-puck-button",events:{click:"click"},popupWidth:720,popupHeight:400,initialize:function(){try{this.gambitApi=parent.window.gambitApi}catch(e){this.gambitApi=window.gambitApi}this.gambitApi&&this.gambitApi.onPlayerLoad()},click:function(){var e=screen.width/2-this.popupWidth/2,t=screen.height/2-this.popupHeight/2,i="toolbar=no, location=no, directories=no, status=no, menubar=no, scrollbars=no, resizable=no, copyhistory=no, width="+this.popupWidth+", height="+this.popupHeight+", top="+t+", left="+e,n=window.location.href+"&shd=1";o.default.open(n,"",i)},renderStub:function(e){n("body").html(s.default(e))}})},function(e,t,i){function n(e){return a.default.render('<div class="puck-container puck-state-error"> <div class="puck-stub-wrapper"> <div class="puck-thumbnail-poster"> <img class="puck-poster" src="{% if poster %}{{ poster }}/198x304/{% else %}{{ app.config.static.host }}/images/stubs/embeds.png{% endif %}"> </div> <div class="puck-footer"> <span class="puck-message"> Извините, но этот фильм недоступен за пределами {{ internationalExpansion.getRightHost() }} </span> </div> </div></div>',e)}var a=i(2);t.default=n},function(e,t,i){var n=i(12),a=i(776),s=i(9);t.default=s.default.extend({routes:["/pages/geocheck/"],run:function(e){n.default.prototype.run(e),(new a.default).execute(e)}})},function(e,t,i){var n=i(1),a=i(6),s=i(777),o=i(778),r=i(7);t.default=a.default.extend({run:function(){var e=new Date,t={cookieSupport:navigator.cookieEnabled,localTime:e.toLocaleString(),utcTime:e.toUTCString(),flashSupport:!1,flashVersion:""};navigator.plugins["Shockwave Flash"]&&(t.flashSupport=!0,navigator.plugins["Shockwave Flash"].description&&(t.flashVersion=navigator.plugins["Shockwave Flash"].description.replace("Shockwave Flash","")));var i=new o.default;i.render(t),this.listenTo(r.default,"loadUser",i.setMapiAvailability.bind(i,!0)),this.listenTo(r.default,"auth:loadUserFailed",i.setMapiAvailability.bind(i,!1));var a=new s.default;a.mapiGet().done(function(){i.setCountryName(a.get("country_name")),i.setIp(a.get("ip"))}),navigator.geolocation&&navigator.geolocation.getCurrentPosition(function(e){var t=e.coords.latitude,n=e.coords.longitude,a=t+", "+n;i.setCurrentGeoPosition(a)}),new window.ivi.dfs.SpeedTest({requestThreshold:8e3,requestTimeout:6e4}),n("#speedtest_aux_link").click(function(){return window.location.reload(),!1})}})},function(e,t,i){var n=i(14);t.default=n.default.extend({uri:"/geocheck/country/v5/"})},function(e,t,i){var n=i(1),a=i(0),s=i(5),o=i(779);t.default=a.View.extend({el:".js-check-list",render:function(e){s.extend(e,{jsSupport:"да",cookieSupport:e.cookieSupport?"да":"нет",flashSupport:e.flashSupport?"да; версия "+e.flashVersion:"нет",browserName:n("#browserName").text(),osName:n("#osName").text(),adblock:n("#ablockercheck").is(":visible")?"отсутствует":"обнаружен",userId:n("#userId").text()}),this.$el.html(o.default(e))},setCountryName:function(e){this.$el.find("#countryName").html(e)},setIp:function(e){this.$el.find("#ip").html(e)},setCurrentGeoPosition:function(e){this.$el.find("#currentGeoPosition").html(e)},setMapiAvailability:function(e){this.$el.find("#mapiAvailability").text(e?"доступно":"недоступно")}})},function(e,t,i){function n(e){return a.default.render('<ul class="keys-list"> <li> <div class="key">IP адрес:</div> <div class="value" id="ip">нет</div> </li> <li> <div class="key">Страна:</div> <div class="value" id="countryName">нет</div> </li> <li> <div class="key">Браузер:</div> <div class="value" id="browserName">{{ browserName|default("нет") }}</div> </li> <li> <div class="key">Операционная система:</div> <div class="value" id="osName">{{ osName|default("нет") }}</div> </li> <li> <div class="key">Локальное время:</div> <div class="value">{{ localTime|default("нет") }}</div> </li> <li> <div class="key">Время UTC:</div> <div class="value">{{ utcTime|default("нет") }}</div> </li> <li> <div class="key">Поддержка JavaScript:</div> <div class="value">{{ jsSupport|default("нет") }}</div> </li> <li> <div class="key">Поддержка cookies:</div> <div class="value">{{ cookieSupport|default("нет") }}</div> </li> <li> <div class="key">Поддержка Flash:</div> <div class="value">{{ flashSupport|default("нет") }}</div> </li> <li> <div class="key">Блокировщик рекламы:</div> <div class="value">{{ adblock|default("отсутствует") }}</div> </li> <li> <div class="key">Геопозиция:</div> <div class="value" id="currentGeoPosition">не определена</div> </li> <li> <div class="key">Id пользователя:</div> <div class="value" id="userId">{{ userId }}</div> </li> <li> <div class="key">API:</div> <div class="value" id="mapiAvailability">ожидание</div> </li></ul>',e)}var a=i(2);t.default=n},function(e,t,i){var n=i(12),a=i(781),s=i(9);t.default=s.default.extend({routes:["/info/.*"],run:function(e){n.default.prototype.run(e),(new a.default).execute(e)}})},function(e,t,i){var n=i(6),a=i(4),s=i(782),o=i(783);t.default=n.default.extend({run:function(){/\/info\/about/.test(a.default.getLocation().pathname)&&new o.default,new s.default}})},function(e,t,i){var n=i(1),a=i(0);t.default=a.View.extend({el:".js-vacancy",events:{"click .js-vacancy-title":"toggleVacancy"},toggleVacancy:function(e){var t=n(e.currentTarget),i=t.closest(".js-vacancy-item");i.hasClass("expanded")?t.next(".info").stop(!0,!0).slideUp():t.next(".info").stop(!0,!0).slideDown(),i.toggleClass("expanded")}})},function(e,t,i){var n=i(0),a=i(1);t.default=n.View.extend({initialize:function(){a(".js-partners-slider").slick({centerPadding:"0",centerMode:!0,slidesToShow:3,touchMove:!1,infinite:!0,prevArrow:'<span class="partners-slider__control partners-slider__control_prev">Назад</span>',nextArrow:'<span class="partners-slider__control partners-slider__control_next">Далее</span>',autoplay:!1,autoplaySpeed:8e3,cssEase:"ease-in-out",speed:500,rows:2,responsive:[{breakpoint:880,settings:{rows:1,slidesToShow:5}},{breakpoint:740,settings:{rows:1,slidesToShow:4}},{breakpoint:600,settings:{rows:2,slidesToShow:4}},{breakpoint:512,settings:{rows:2,slidesToShow:3}},{breakpoint:392,settings:{rows:2,slidesToShow:2}}]})}})},function(e,t,i){var n=i(12),a=i(312),s=i(9);t.default=s.default.extend({routes:["/new/str:hru","/new/str:hru/pageint:page"],run:function(e){n.default.prototype.run(e),(new a.default).execute(e)}})},function(e,t,i){var n=i(12),a=i(9);t.default=a.default.extend({routes:["/new"],run:function(e){n.default.prototype.run(e)}})},function(e,t,i){var n=i(12),a=i(49),s=i(787),o=i(789),r=i(9);t.default=r.default.extend({routes:["/person.*","/temporary/person.*"],run:function(e){n.default.prototype.run(e),(new o.default).execute(e),(new a.default).execute(e),(new s.default).execute(e)}})},function(e,t,i){var n=i(101),a=i(127),s=i(6),o=i(102),r=i(788);t.default=s.default.extend({run:function(e){void 0===e&&(e={});var t=new r.default;void 0===e.page&&(e.page=1),new a.default({collection:new n.default({contentType:"person"}),page:e.page,itemId:t.getId(),initWaypoint:!0}),new o.default({itemId:t.getId(),contentType:"person"})}})},function(e,t,i){var n=i(0);t.default=n.View.extend({el:"person-info",getId:function(){return this.$el.data("id")}})},function(e,t,i){var n=i(6),a=i(790);t.default=n.default.extend({run:function(){new a.default}})},function(e,t,i){var n=i(68);t.default=n.default.extend({el:".js-person-content",events:{"click .js-person-director a":"clickDirector","click .js-person-actor a":"clickActor","click .js-person-filmography a":"clickFilmography"},clickDirector:function(){this.setLocalBlockId("director"),this.setGrootParams()},clickActor:function(){this.setLocalBlockId("actor"),this.setGrootParams()},clickFilmography:function(){this.setLocalBlockId("filmography"),this.setGrootParams()}})},function(e,t,i){var n=i(12),a=i(343),s=i(9);t.default=s.default.extend({routes:["/player.*"],run:function(e){n.default.prototype.run(e),(new a.default).execute(e)}})},function(e,t,i){var n=i(12),a=i(793),s=i(9);t.default=s.default.extend({routes:["/profile"],run:function(e){n.default.prototype.run(e),(new a.default).execute(e)}})},function(e,t,i){var n=i(58),a=i(794),s=i(33),o=i(796),r=i(798),l=i(199),d=i(800),u=i(802),c=i(803),p=i(807),f=i(809),h=i(811),g=i(817),m=i(818),v=i(132),_=i(820),b=i(822),y=i(195),w=i(828),C=i(264),k=i(263),P=i(7),S=i(30),T=i(8),E=i(22),I=i(4),x=i(832),M=i(80),A=i(834),L=i(842),O=i(843),j=i(845),D=i(18),R=i(19);t.default=s.default.extend({enablePseudoRoute:!0,firstShow:!0,views:null,activeRoute:null,firstPageViewSent:!1,sectionChanged:!0,afterLogin:function(){(new b.default).listen(S.default),(new o.default).listen(S.default),(new r.default).listen(S.default),(new x.default).listen(S.default),D.default.isBindContactsAvailable()&&(new R.default).isBindContactsAvailable()&&(new A.default({model:new L.default}).listen(S.default),new O.default({model:new j.default}).listen(S.default));var e=new n.default;window.ivi.adaptive.isMobile?(this.mobileMenuView=new u.default,window.addEventListener("orientationchange",this.handleOrientationChange.bind(this))):this.mobileMenuView=e,this.cardsInfoModel=new C.default,this.psAccounts=new k.default,this.personalView=new c.default(T.default),this.subscriptionView=new p.default(this.cardsInfoModel,this.psAccounts),this.cardsView=new f.default(this.cardsInfoModel,this.psAccounts),this.watchedView=new w.default(new y.default),this.favouritesView=e,this.purchasesView=new h.default,this.reviewsView=new _.default(new v.default([],{contentType:"user"})),this.statusView=new a.default(this.psAccounts),this.setViews(),this.personalView.changeTemplate(),T.default.isIdentified()||this.handleChangeFavCount(),this.setPurchases(),T.default.on("change:favCount",this.handleChangeFavCount.bind(this)),this.listenTo(P.default,"user:login",this.processLoginLogout),this.listenTo(P.default,"user:logout",this.processLoginLogout),this.listenTo(S.default,"profile:sectionOpen",this.onSectionOpen),this.listenTo(S.default,"profile:bindContacts:success",this.bindContactsSuccess)},setViews:function(){this.views=[this.personalView,this.subscriptionView,this.watchedView,this.favouritesView,this.purchasesView,this.reviewsView,this.statusView,this.cardsView]},setPurchases:function(){var e=this,t=E.default.get("purchases")||new M.default;t.createSubscriptionPurchaseObject().fetchSubscriptionInfo().always(function(){e.views.forEach(function(e){e.setUpPurchases(t)}),"#cards"!==I.default.getLocation().hash||T.default.isIdentified()?e.pseudoRouter(I.default.getLocation().hash):e.pseudoRouter("#personal")})},reloadTabs:function(){this.psAccounts=new k.default,this.personalView.changeTemplate(),this.watchedView.stopListening(),this.watchedView.undelegateEvents(),this.watchedView=new w.default(new y.default),this.purchasesView.stopListening(),this.purchasesView.undelegateEvents(),this.purchasesView=new h.default,this.subscriptionView.stopListening(),this.subscriptionView.undelegateEvents(),this.subscriptionView=new p.default(this.cardsInfoModel,this.psAccounts),this.statusView.stopListening(),this.statusView.undelegateEvents(),this.statusView=new a.default(this.psAccounts),this.cardsView.setPsAccounts(this.psAccounts),this.setViews(),this.setPurchases(),this.sectionChanged=!0},processLoginLogout:function(){this.sectionChanged=!1,this.listenToOnce(P.default,"autologin",this.reloadTabs),E.default.loadUserHandler(T.default)},handleChangeFavCount:function(){this.favouritesView.stopListening(),this.favouritesView.undelegateEvents();var e=this.favouritesView.isActive();T.default.get("favCount")>0?this.favouritesView=new d.default(new l.default):this.favouritesView=new m.default(new g.default),this.favouritesView.setUpPurchases(E.default.get("purchases")||new M.default),e&&this.favouritesView.activate()},handleOrientationChange:function(){this.mobileMenuView.setUpLoader(),this.pseudoRouter(I.default.getLocation().hash)},pseudoRouter:function(e){if(this.checkIfViewsAreReady()){switch(this.deactivateViews(),this.activeRoute=e,e){case"#favorites":this.favouritesView.activate();break;case"#watched":this.watchedView.activate();break;case"#purchases":this.purchasesView.activate();break;case"#reviews":this.reviewsView.activate();break;case"#subscription":this.subscriptionView.activate();break;case"#cards":this.cardsView.activate();break;case"#personal":this.personalView.activate();break;default:window.ivi.adaptive.isMobile?(this.statusView.activate(),this.mobileMenuView.activate(),window.ivi.adaptive.isMobileStyle||this.personalView.activate()):this.personalView.activate()}window.ivi.adaptive.isMobileStyle||this.statusView.activate(),this.firstShow=!1}},checkIfViewsAreReady:function(){return!!(this.personalView&&this.subscriptionView&&this.favouritesView&&this.watchedView&&this.purchasesView&&this.reviewsView&&this.statusView&&this.mobileMenuView&&this.cardsView)},deactivateViews:function(){this.personalView.deactivate(),this.subscriptionView.deactivate(),this.cardsView.deactivate(),this.favouritesView.deactivate(),this.watchedView.deactivate(),this.purchasesView.deactivate(),this.reviewsView.deactivate(),window.ivi.adaptive.isMobile&&(window.ivi.adaptive.isMobileStyle&&this.statusView.deactivate(),this.mobileMenuView.deactivate())},onSectionOpen:function(e,t){if((t||!this.firstPageViewSent)&&this.sectionChanged){var i=this.firstPageViewSent?e.grootPage:null;S.default.trigger("profile:groot:paveView",e.grootPage,i),this.firstPageViewSent=!0}},bindContactsSuccess:function(){var e=this;this.sectionChanged=!1,this.listenToOnce(P.default,"loadUser",function(){e.personalView.activate(),e.statusView.render(),e.statusView.activate()}),E.default.loadUser()}})},function(e,t,i){var n=i(1),a=i(0),s=i(8),o=i(22),r=i(3),l=i(795),d=i(7),u=i(30),c=i(41),p=i(11),f=i(18),h=i(19);t.default=a.View.extend({el:".js-profile-status",events:{"click .js-confirm-email":"confirmEmailHandler","click .js-subscribe":"showModalSubscribe","click .js-add-name":"addNameHandler","click .js-add-email":"addEmailHandler","click .js-renew-button":"renewSubscription","click .js-register-btn":"showRegisterModal","click .js-login-btn":"showLoginModal","click .js-login-before-add-funds":"showLoginBeforeFundsModal"},editName:!1,editEmail:!1,personalSectionIsReady:!1,confirmHasBeenSent:!1,subscriptionPurchase:null,psAccounts:null,initialize:function(e){this.psAccounts=e,this.listenTo(d.default,"user:setNameSuccess",this.render),this.listenTo(d.default,"user:setEmailSuccess",this.render),this.listenTo(d.default,"auth:email:confirm:sent",this.confirmSent),this.listenTo(u.default,"profile:personalSectionIsReady",this.changeUserData),this.listenTo(u.default,"profile:personalSectionIsHidden",this.personalSectionHided),this.listenTo(u.default,"profile:unsubscribe",this.continueUnsubscribtion),this.listenTo(u.default,"profile:subscription:renew",this.onSubscriptionRenew),this.listenTo(u.default,"profile:psaccounts:updated",this.render),this.listenTo(p.default,"purchase:personal",this.continueSubscribe),this.listenTo(p.default,"billing:setAutoprolongSuccess",this.render),this.listenTo(p.default,"billing:setAutoprolongError",this.render)},render:function(){this.confirmHasBeenSent&&s.default.setConfirmed(this.confirmHasBeenSent),this.$el.html(l.default({user:s.default,subscriptionPurchase:this.subscriptionPurchase,psAccounts:this.psAccounts}))},confirmEmailHandler:function(){return o.default.sendConfirmEmail(),!1},confirmSent:function(){this.confirmHasBeenSent=!0,this.render()},addNameHandler:function(){this.editName=!0,this.personalSectionIsReady&&this.changeUserData()},addEmailHandler:function(){this.editEmail=!0,this.personalSectionIsReady&&this.changeUserData()},personalSectionHided:function(){this.personalSectionIsReady=!1},changeUserData:function(){this.personalSectionIsReady=!0,this.editName&&(u.default.trigger("user:changeData",{currentTarget:n(".js-profile-content .name .edit.js-edit-user-data")}),this.editName=!1),this.editEmail&&(f.default.isBindContactsAvailable()&&(new h.default).isBindContactsAvailable()?(r.default.track("click_add_email"),u.default.trigger("profile:bindContacts:email")):u.default.trigger("user:changeData",{currentTarget:n(".js-profile-content .email .edit.js-edit-user-data")}),this.editEmail=!1)},setUpPurchases:function(e){this.subscriptionPurchase=e.createSubscriptionPurchaseObject(),this.render()},showModalSubscribe:function(){return c.default.trigger("showSubscriptionLanding","profile"),!1},showLoginModal:function(){if(d.default.trigger("auth:showLoginModal"),!window.ivi.adaptive.isMobile)return!1},showRegisterModal:function(){if(d.default.trigger("auth:showRegModal"),!window.ivi.adaptive.isMobile)return!1},showLoginBeforeFundsModal:function(){if(d.default.trigger("auth:showLoginModal","funds"),!window.ivi.adaptive.isMobile)return!1},renewSubscription:function(e){var t=n(e.currentTarget);if(t.hasClass("disabled"))return!1;var i={};return(this.subscriptionPurchase.isCardPayment()||this.subscriptionPurchase.isCertificatePaymentWithCard())&&(this.subscriptionPurchase.isCardExpired()?i.card_expired=2:this.subscriptionPurchase.isCardExpiring()?i.card_expired=1:i.card_expired=0),t.parent().addClass("loading"),r.default.track("renew_subscribe",i),u.default.trigger("status:subscription:renew"),this.subscriptionPurchase.enableRenew(),!1},onSubscriptionRenew:function(){this.$el.find(".js-renew-button").addClass("disabled")},activate:function(){this.$el.removeClass("hidden")},deactivate:function(){this.$el.addClass("hidden")},continueSubscribe:function(e){"subscription"===e.object_type&&this.$el.find(".js-subscribe").addClass("loading")},continueUnsubscribtion:function(){this.$el.find(".js-unsubscribe-button").addClass("loading")}})},function(e,t,i){function n(e){return a.default.render('<div class="user-information"> {% if user.isAuthenticated() %} <div class="top-line"> <div class="left-block"> {% if user.getName() %} <div class="avatar avatar_name">{{ user.getName()|slice(0, 1)|upper }}</div> {% elseif user.getEmail()|length > 0 %} <div class="avatar avatar_email">{{ user.getEmail()|slice(0, 1)|upper }}</div> {% elseif user.getMsisdn()|length > 0 %} <div class="avatar avatar_phone"></div> {% endif %} </div> <div class="right-block"> {% if user.getName() %} <div class="name">{{ user.getName() }}</div> {% endif %} {% if user.getEmail() %} <div class="email">{{ user.getEmail() }}</div> {% endif %} </div> </div> {% if not user.getEmail() or not user.isEmailConfirmed() or not user.getName() %} <div class="bottom-line button no-mobile"> <div class="left-block"> {% if not user.getEmail() %} <a class="outline ivi-button small js-add-email" href="#personal">Добавить почту</a> {% elseif not user.isEmailConfirmed() %} <a class="outline ivi-button small js-confirm-email" href="#">Подтвердить почту</a> {% elseif not user.getName() %} <a class="outline ivi-button small js-add-name" href="#personal">Добавить имя</a> {% endif %} </div> {% if not user.isEmailConfirmed() %} <div class="right-block js-check-info"> Отправляем чеки на покупку, информацию о восстановлении пароля, рекомендации </div> {% endif %} </div> {% endif %} {% else %} <div class="top-line"> <div class="left-block"> <div class="avatar avatar_unauth"></div> </div> <div class="right-block"> <a class="outline ivi-button medium js-register-btn" href="#">Зарегистрироваться</a> <span class="separate">или</span> <a class="login js-login-btn" href="#">Войти</a> </div> </div> <div class="bottom-line button no-mobile"> <div class="left-block"> Текущий идентификатор в ivi: {{ user.getId() }} </div> </div> {% endif %}</div>{% set hasSubscription = false %}{% if subscriptionPurchase|default(false) %} {% set hasSubscription = subscriptionPurchase.hasSubscription() %}{% endif %}<div class="subscription-information"> <div class="inner"> {% if hasSubscription %} {% set subscriptionDurationInDays = subscriptionPurchase.getSubscriptionDurationInDays() %} {% if subscriptionPurchase.isRebilling() %} <div class="top-line">Подписка{% if not isWorld %} ivi{% endif %}</div> <div class="bottom-line"> <div class="expiration warning">до {{ internationalExpansion.getLocalDateTime(subscriptionPurchase.getSubscriptionExpireDate())|date("d.m.Y") }}</div> </div> {% elseif subscriptionPurchase.isRenewEnabled() %} <div class="top-line">Подписка{% if not isWorld %} ivi{% endif %} активна</div> {% if subscriptionPurchase.isCertificatePayment() %} <div class="bottom-line"> <div class="expiration">до {{ internationalExpansion.getLocalDateTime(subscriptionPurchase.getSubscriptionExpireDate())|date("d.m.Y") }}</div> {% if not subscriptionPurchase.isCertificatePaymentWithCard() %} <div class="name">Сертификат</div> {% endif %} </div> {% else %} <div class="bottom-line"> <div class="expiration">до {{ internationalExpansion.getLocalDateTime(subscriptionPurchase.getSubscriptionExpireDate())|date("d.m.Y") }}</div> {% if subscriptionDurationInDays %} {% if subscriptionDurationInDays % 30 == 0 %} <div class="name">{{ subscriptionDurationInDays / 30 }} {{ declension.month(subscriptionDurationInDays / 30) }}</div> {% else %} <div class="name">{{ subscriptionDurationInDays }} {{ declension.days(subscriptionDurationInDays) }}</div> {% endif %} {% endif %} </div> {% endif %} {% else %} <div class="top-line">Подписка{% if not isWorld %} ivi{% endif %} активна</div> <div class="bottom-line"> <div class="expiration warning">до {{ internationalExpansion.getLocalDateTime(subscriptionPurchase.getSubscriptionExpireDate())|date("d.m.Y") }}</div> </div> {% if (subscriptionPurchase.isCertificatePayment() or subscriptionPurchase.isCardPayment()) and psAccounts is defined and psAccounts.findById(subscriptionPurchase.getAccountId()) %} <div class="button"><a class="ivi-button small js-renew-button">Возобновить</a></div> {% endif %} {% endif %} {% else %} <div class="top-line">Подписка{% if not isWorld %} ivi{% endif %}</div> <div class="button"><a class="ivi-button small js-subscribe" href="#">Подключить</a></div> {% endif %} </div></div><div class="billing-information"> <div class="inner"> {% set addFundsModalClass = "js-login-before-add-funds" %} {% set balance = user.getBalance() %} {% if user.isAuthenticated() %} {% set addFundsModalClass = "js-add-funds-modal" %} {% endif %} <div class="top-line"> <span class="money">{{ internationalExpansion.getPriceWithCurrency(balance|money_format) }}</span> <a class="outline ivi-button small no-mobile {{ addFundsModalClass }}" href="#"> Пополнить </a> </div> <div class="bottom-line">на личном счёте</div> <div class="button only-mobile"> <a class="outline ivi-button small {{ addFundsModalClass }}" href="#"> Пополнить </a> </div> </div></div>',e)}var a=i(2);t.default=n},function(e,t,i){var n=i(16),a=i(797);t.default=n.default.extend({modalId:"js-profile-subscription-autoprolong-modal-wrapper",template:a.default,cancelEl:".js-modal-close",openEvent:"profile:errorMessage:modal",regionEnabled:!0,mobileModal:!0,serializeData:function(){return{errorMessageText:this.eventParams.text}}})},function(e,t,i){function n(e){return a.default.render('<div class="ivi-modal-wrapper-content simple-basic{% if isMobile %} dialog{% endif %}"> <h1 class="ivi-modal-title">Ошибка</h1> <div class="ivi-modal-content"> <p>{{ errorMessageText }}</p> <div class="button-wrapper"> <span class="ivi-button large js-modal-close">Закрыть</span> </div> </div> <span class="ivi-modal-close js-modal-close">Закрыть</span></div>',e)}var a=i(2);t.default=n},function(e,t,i){var n=i(16),a=i(3),s=i(30),o=i(799);t.default=n.default.extend({modalId:"js-profile-remove-card-modal-wrapper",template:o.default,openEvent:"profile:removeCard:modal",regionEnabled:!0,mobileModal:!0,events:{"click .js-subscription":"subscriptionClick","click .js-cancel":"cancelClick","click .js-remove":"removeCard"},serializeData:function(){return{card:this.eventParams.psAccount,subscriptionOption:this.eventParams.subscriptionOption,cardsInfo:this.eventParams.cardsInfo}},subscriptionClick:function(){a.default.track("remove_card_togup"),this.triggerCancel()},removeCard:function(){return a.default.track("remove_card_confirmed"),s.default.trigger("profile:removeCard:continue",this.eventParams.psAccount,this.eventParams.$card),this.triggerCancel(),!1},cancelClick:function(){return a.default.track("remove_card_cancel"),this.triggerCancel(),!1}})},function(e,t,i){function n(e){return a.default.render('<div class="ivi-modal-wrapper-content payment-card-delete"> <h1 class="ivi-modal-title">Удаление карты</h1> <div class="ivi-modal-content"> <div class="notification-block"> {% set bankInfo = cardsInfo.getBankInfo(card.getCardBankKey()) %} {% set psTypeInfo = cardsInfo.getPsTypeInfo(card.getPsType()) %} {% set bankInfo = cardsInfo.getBankInfo(card.getCardBankKey()) %}{% set psTypeInfo = cardsInfo.getPsTypeInfo(card.getPsType()) %}<div data-id="{{ card.getId() }}" class="payment-card js-card-account {% if card.isCardExpired() %} payment-card_expired{% endif %} {% if card.isCardExpiring() %} payment-card_expiring{% endif %} {% if showCardDeactivate|default(false) %} payment-card_with-delete{% endif %} {% if showCardAsLink|default(false) %} payment-card_link{% endif %}"> <div class="payment-card__inner" style="color: {{ bankInfo.getInkColor() }}" > <div class="payment-card__background" style=" background: {{ bankInfo.getGradStart() }}; background: -moz-linear-gradient(33deg, {{ bankInfo.getGradStart() }}, {{ bankInfo.getGradEnd() }}); background: -webkit-linear-gradient(33deg, {{ bankInfo.getGradStart() }}, {{ bankInfo.getGradEnd() }}); background: linear-gradient(33deg, {{ bankInfo.getGradStart() }}, {{ bankInfo.getGradEnd() }}); "></div> {% if bankInfo.getLogoUrl() %} <div class="payment-card__bank-logo"> <img class="payment-card__bank-logo-image" src="{{ bankInfo.getLogoUrl() }}"> </div> {% endif %} <div class="payment-card__number">{{ card.getTitle() }}</div> <div class="payment-card__expired">{{ card.getCardExpiresDate()|card_validity|default("&nbsp;") }}</div> {% if psTypeInfo %} <div class="payment-card__system-type"> <img class="payment-card__system-type-image" src="{{ psTypeInfo[bankInfo.getTypeLogo()] }}"> </div> {% endif %} </div> {% if showCardDeactivate|default(false) %} <button class="payment-card__delete js-deactivate-card">Удалить карту</button> {% endif %} <div class="payment-card__caption">{{ bankInfo.getTitle() }}</div></div> <div class="text-wrapper"> {% if subscriptionOption.isRenewEnabled() and card.getId() == subscriptionOption.getAccountId() %} <div class="caption">Карту нельзя удалить, пока она используется для оплаты подписки</div> <div class="note">Для удаления сначала перейдите в раздел управления подпиской и смените её на другую</div> {% else %} <div class="caption">Все данные этой карты будут удалены из системы безвозвратно</div> {% if not card.isCardExpired() %} <div class="note">Чтобы снова оплачивать покупки этой картой, придётся добавлять её заново</div> {% endif %} {% endif %} </div> </div> <div class="button-wrapper"> {% if subscriptionOption.isRenewEnabled() and card.getId() == subscriptionOption.getAccountId() %} <a href="#subscription" class="ivi-button large js-subscription">Перейти в управление подпиской</a> {% else %} <a class="ivi-button large js-cancel">Отменить удаление</a> <a class="ivi-button large neutral js-remove">Удалить карту</a> {% endif %} </div> </div> <span class="ivi-modal-close js-cancel">Закрыть</span></div>',e)}var a=i(2);t.default=n},function(e,t,i){var n=i(1),a=i(58),s=i(51),o=i(75),r=i(801),l=i(44),d=i(26);t.default=a.default.extend(s.default).extend({tabEl:"#js-favorites",template:r.default,events:{"click .js-favorites-block .more-link":"loadMore","click .js-favourite":"removeFromFavourites"},grootPage:"profile_wanted",grootRefPage:"profile_wanted",initialize:function(e){e.setSelectionFrom(0),e.setSelectionTo(this.selectionSize),a.default.prototype.initialize.call(this,{waypoint:!0}),this.loadData(e),this.mainCollection=e,this.templateParams.favouriteListModel=e,this.listenTo(o.default,"collection:favoriteListMoreDataIsAvailable",this.prepareCollection),this.listenTo(d.default,"favourites:deleted",this.favouriteDeleted)},removeFromFavourites:function(e){var t=n(e.currentTarget).parents("li"),i=t.data("content-id"),a=this.mainCollection.get({id:i});return d.default.trigger("favourite:delete",{objectId:i,type:a.isCompilation()?"compilation":"video",blockId:this.grootBlockId}),!1},favouriteDeleted:function(e){var t=this.mainCollection.get({id:e.objectId});this.mainCollection.remove(t),n(".js-favorites-block li[data-content-id="+e.objectId+"]").fadeOut(100,this.afterFadeOutOnFavouriteDelete)},afterFadeOutOnFavouriteDelete:function(){n(this).remove()},afterShow:function(){this.attachPosterPopup(n(".js-favorites-block li")),a.default.prototype.afterShow.call(this),l.default.viewList(n(".js-favorites-block"))}})},function(e,t,i){function n(e){return a.default.render('<section class="posters-block js-favorites-block"> <ul class="gallery posters-large js-popups-block"> {% for video in favouriteListModel.getVideoList()|slice(0, favouriteListModel.getSelectionTo()) %} <li class="{% if video.isInfoVideo() or video.isPreorderable() %}info {% endif %}{% if abExperiment.useNewPriceBadges() %}{{ video.getNewPriceBadgeClasses(abExperiment.showFreeBadge(), hasSubscription) }}{% else %}{{ video.getPaidIcon() }}{% endif %}" data-content-id="{{ video.getId() }}" data-content-type="{% if video.getCompilationTitle() %}compilation{% else %}content{% endif %}" data-content-position="{{ loop.index }}"> <a href="{{ video.getPosterSpecificLink(hasSubscription) }}" class="item-content-wrapper js-collection-content{% if video.isForAdult() %} js-adult{% endif %}"> <span class="image" data-caption="{% if video.isSvod() %}{{ video.getPosterSpecificCaption(hasSubscription) }}{% else %}{{ video.getPosterSpecificCaption() }}{% endif %}"> <img src="{{ video.getPosterPath("/172x264/") }}" alt="{{ video.getTitle() }}"> <span class="age-limit" data-value="{{ video.getRestrict()|default(0) }}+"></span> {% if abExperiment.useNewPriceBadges() %} <div class="badge"> <div class="badge__content" data-badge-content="{{ video.getNewPriceBadgeTitle(abExperiment.showFreeBadge(), hasSubscription) }}"></div> </div> {% endif %} <span class="remove-wrapper js-favourite"><span class="remove"></span></span> </span> <span class="title"><span>{% if video.getCompilationTitle() %}{{ video.getCompilationTitle() }}{% else %}{{ video.getTitle() }}{% endif %}</span></span> </a> <div class="popup-wrapper" data-hru="{% if video.isCompilation() %}{{ video.getHru() }}{% else %}{{ video.getId() }}{% endif %}"></div> </li> {% endfor %} </ul> {% if favouriteListModel.isMore(selectionSize) %} <a class="ivi-button large outline show-more no-mobile more-link">Показать еще</a> {% endif %}</section>',e)}var a=i(2);t.default=n},function(e,t,i){var n=i(1),a=i(58);t.default=a.default.extend({show:function(){var e=n(".js-profile");n(".js-profile-content").hide();var t=n(".js-profile-header");t.find(".js-back-link").hide(),t.find("h1").show(),e.find(".section-title").text(""),t.find("ul.inner-nav").addClass("enter-page"),e.addClass("enter-page")},setUpLoader:function(){var e=n(".js-profile");e.addClass("loading"),e.css("visibility","hidden")},deactivate:function(){var e=n(".js-profile"),t=e.find(".js-profile-header");e.removeClass("enter-page"),t.find("ul.inner-nav").removeClass("enter-page"),t.find(".js-back-link").show(),window.ivi.adaptive.isMobileStyle?t.find("h1").hide():t.find("h1").show(),t.show(),e.removeClass("loading"),e.css("visibility",""),e.find(".js-profile-content").hide()}})},function(e,t,i){var n=i(1),a=i(58),s=i(28),o=i(116),r=i(7),l=i(10),d=i(82),u=i(804),c=i(805),p=i(30),f=i(8),h=i(145),g=i(806),m=i(18),v=i(19),_=i(3);t.default=a.default.extend({tabEl:"#js-personal",bodyClass:"has-mobile-subscription-status",$valueTpl:n('<strong class="js-value-block" style="display: none">'),template:u.default,events:{"click li .value .js-edit-user-data":"changeData","click li .edit-form .js-cancel-edit-data":"changeDataCancel","click li.name .edit-form .js-apply-edit-data":"updateName","click li.email .edit-form .js-apply-edit-data":"updateEmail","click li.password .edit-form .js-apply-edit-data":"updatePassword","click li.gender .edit-form .js-apply-edit-data":"updateGender","click li.birthdate .edit-form .js-apply-edit-data":"updateBirthdate","click .js-bind-phone":"openBindPhoneModal","click .js-bind-email":"openBindEmailModal","click ul.subscribe .checkbox-switcher-wrapper label":"updateSubscription","click .js-login-btn":"showLoginModal","click .js-register-btn":"showRegisterModal"},genderText:{0:"Указать пол",1:"Мужской",2:"Женский"},nameChangeErrorsText:{base:"Не удалось сменить имя"},emailChangeErrorsText:{base:"Не удалось сменить E-mail",110:"Данный E-mail уже зарегистрирован",112:"Задан неверный E-mail или пароль"},genderChangeErrorsText:{base:"Не удалось задать пол"},birthdayChangeErrorsText:{base:"Не удалось задать год рождения",onlyDigitsAllowed:"Необходимо ввести цифры",400:"Год должен быть указан в промежутке между 1900 и "+(new Date).getFullYear()},grootPage:"myivi",grootRefPage:"myivi",initialize:function(e){this.passwordChangeErrorsText=e.passwordChangeErrorsText,this.notificationStateList=new h.default,this.notification=new g.default,a.default.prototype.initialize.call(this),this.isActivated=!0,this.mainModel=this.model=e,this.templateParams={user:this.mainModel,bindContactsAvailable:m.default.isBindContactsAvailable()&&(new v.default).isBindContactsAvailable()},o.bind(this,{forceUpdate:!0}),this.listenTo(r.default,"user:setNameSuccess",this.nameChanged),this.listenTo(r.default,"user:setEmailSuccess",this.emailChanged),this.listenTo(r.default,"user:setPasswordSuccess",this.passwordChanged),this.listenTo(r.default,"user:setGenderSuccess",this.genderChanged),this.listenTo(r.default,"user:setBirthdaySuccess",this.birthdayChanged),this.listenTo(r.default,"user:setNameError",this.nameChangeError),this.listenTo(r.default,"user:setEmailError",this.emailChangeError),this.listenTo(r.default,"user:setPasswordError",this.passwordChangeError),this.listenTo(r.default,"user:setGenderError",this.genderChangeError),this.listenTo(r.default,"user:setBirthdayError",this.birthdayChangeError),this.listenTo(r.default,"user:login",this.addBodyClass),this.listenTo(r.default,"user:logout",this.removeBodyClass),this.listenTo(p.default,"user:changeData",this.changeData),this.listenToOnce(r.default,"loadUser",this.changeTemplate),this.cssRoutine()},changeTemplate:function(){this.template=f.default.isAuthenticated()?u.default:c.default},showLoginModal:function(){if(r.default.trigger("auth:showLoginModal"),!window.ivi.adaptive.isMobile)return!1},showRegisterModal:function(){if(r.default.trigger("auth:showRegModal"),!window.ivi.adaptive.isMobile)return!1},cssRoutine:function(){n(".user-info li .value, .subscribe li .checkbox-switcher-wrapper").hover(function(){n(this).closest("li").addClass("hover")},function(){n(this).closest("li").removeClass("hover")})},setUpPurchases:function(){var e=this;this.userPurchases=!0,this.loadNotifications().then(function(){e.templateParams.showSupportPhone=e.model.isBuyer(),e.isDataExists=!0,e.show()})},loadNotifications:function(){var e=this;return f.default.isAuthenticated()?this.notificationStateList.getStateList().then(function(t){e.templateParams.notifications=t}):n.Deferred().resolve().promise()},getInputArgs:function(e){var t=[];return e.find("input").each(function(e,i){(i.value&&"radio"!==i.type||"radio"===i.type&&i.checked)&&t.push(s.default.escapeText(i.value))}),t},clearInput:function(e){var t=e.find("input");"radio"!==t.attr("type")&&t.val("").removeAttr("checked")},focusInput:function(e){e.find('input[type!="radio"]').focus()},changeData:function(e){var t=n(e.currentTarget),i=t.parents("li"),a=i.find(".edit-form");return i.addClass("expanded"),i.find(".js-value").hide(),this.clearInput(a),a.show(),this.focusInput(a),!1},changeDataCancel:function(e){var t=n(e.currentTarget),i=t.parents("li"),a=i.find(".edit-form");return this.clearInput(a),i.removeClass("expanded"),a.hide(),i.find(".js-value").show(),!1},updateValue:function(e){var t=n(e.currentTarget),i=t.parents("li"),a=i.find(".edit-form");return e.preventDefault(),e.stopPropagation(),this.getInputArgs(a)},updateName:function(e){var t=this.updateValue(e);t.length&&this.mainModel.setName(t[0])},updateEmail:function(e){var t=this.updateValue(e);this.mainModel.set("email",t[0]),this.mainModel.isValid(!0)&&t.length>1?this.mainModel.setEmail(t[0],t[1]):this.emailChangeError(112)},updatePassword:function(e){var t=this.updateValue(e);t.length>2?this.mainModel.setPassword(t[0],t[1],t[2]):this.passwordChangeError("allFieldsRequired")},updateGender:function(e){var t=this.updateValue(e);t.length&&this.mainModel.setGender(t[0])},updateBirthdate:function(e){var t=this.updateValue(e);t.length&&/^\d{0,4}$/.test(t[0])?this.mainModel.setBirthday(t[0]):this.birthdayChangeError("onlyDigitsAllowed")},setChangedValue:function(e,t){var i=n(e),a=i.find(".edit-form"),s=this.getInputArgs(a),o=s[t];this.clearInput(a),a.hide().find(".js-value-block").text(o),i.find(".value").show();var r=i.find(".js-value .js-value-block"),l=this.$valueTpl.clone().html(o);return r.before(l),r.remove(),i.removeClass("expanded"),i.find(".actions").toggleClass("filled",o),l},nameChanged:function(){this.setChangedValue("li.name",0).show();var e=n("li.name strong");!e.val()&&f.default.getName()&&e.text(f.default.getName())},emailChanged:function(){this.setChangedValue("li.email",0).show()},passwordChanged:function(){this.setChangedValue("li.password",1).html("********").show()},genderChanged:function(){var e=this.setChangedValue("li.gender",0);this.genderText[e.html()]&&e.html(this.genderText[e.html()]),e.show()},birthdayChanged:function(){this.setChangedValue("li.birthdate",0).show()},updateSubscription:function(){var e=n("#subscribe-news");this.mainModel.setSubscribed(!e.prop("checked"))},nameChangeError:function(){p.default.trigger("profile:errorMessage:modal",{text:this.nameChangeErrorsText.base})},emailChangeError:function(e){p.default.trigger("profile:errorMessage:modal",{text:this.emailChangeErrorsText[e]||this.emailChangeErrorsText.base})},passwordChangeError:function(e){p.default.trigger("profile:errorMessage:modal",{text:this.passwordChangeErrorsText[e]||this.passwordChangeErrorsText.base})},genderChangeError:function(){p.default.trigger("profile:errorMessage:modal",{text:this.genderChangeErrorsText.base})},birthdayChangeError:function(e){p.default.trigger("profile:errorMessage:modal",{text:this.birthdayChangeErrorsText[e]||this.birthdayChangeErrorsText.base})},afterShow:function(){this.notification=new g.default,this.cssRoutine(),d.default.trigger("mobile:ensureBranchButtonClickEvent"),p.default.trigger("profile:personalSectionIsReady")},activate:function(){f.default.isAuthenticated()&&n("body").addClass(this.bodyClass),a.default.prototype.activate.call(this)},deactivate:function(){n("body").removeClass(this.bodyClass),this.isActivated=!1,l.default.isWorld&&window.ivi.adaptive.isMobileStyle&&n(".ivi-footer").hide(),p.default.trigger("profile:personalSectionIsHidden")},addBodyClass:function(){this.isActive()&&n("body").addClass(this.bodyClass)},removeBodyClass:function(){n("body").removeClass(this.bodyClass)},openBindPhoneModal:function(){return _.default.track("click_add_phone"),p.default.trigger("profile:bindContacts:phone"),!1},openBindEmailModal:function(){return _.default.track("click_add_email"),p.default.trigger("profile:bindContacts:email"),!1}})},function(e,t,i){function n(e){return a.default.render('<section class="user-block"> <ul class="user-info"> <li class="name"> <span class="name">Ваше имя</span> <div class="actions{% if user.getName() %} filled{% endif %}"> <div class="value js-value">{% if user.getName() %}<strong class="js-value-block">{{ user.getName() }}</strong>{% else %}<a class="action-link dim js-value-block js-edit-user-data" href="#">Указать имя</a>{% endif %}<a class="action-link edit js-edit-user-data" href="#">Изменить</a></div> <form action="#" class="edit-form" style="display: none"> <div class="form-line"> <div class="ivi-input"><input type="text" value="" placeholder="имя" maxlength="40"></div> <button type="submit" class="action-link apply no-mobile js-apply-edit-data">Применить</button> <button type="button" class="action-link dim cancel no-mobile js-cancel-edit-data">Отменить</button> <button class="ivi-button large pale cancel only-mobile js-cancel-edit-data">Отменить</button> <button type="submit" class="ivi-button large apply only-mobile js-apply-edit-data">Применить</button> </div> </form> </div> </li> <li class="gender"> <span class="name">Пол</span> <div class="actions{% if user.getGender() %} filled{% endif %}"> <div class="value js-value"> {% if user.getGender() == 1 %}<strong class="js-value-block">Мужской</strong> {% elseif user.getGender() == 2 %}<strong class="js-value-block">Женский</strong> {% else %}<a class="action-link dim js-value-block js-edit-user-data" href="#">Указать пол</a> {% endif %} <a class="action-link edit js-edit-user-data" href="#">Изменить</a></div> <form action="#" class="edit-form" style="display: none"> <div class="form-line"> <div class="gender-choosing"> <div class="radio-switcher-wrapper"> <input type="radio" name="gender" class="radio-switcher small" id="male-gender" value="1" {% if user.getGender() == 1 %}checked{% endif %}><label for="male-gender">Мужской</label> </div> <div class="radio-switcher-wrapper"> <input type="radio" name="gender" class="radio-switcher small" id="female-gender" value="2" {% if user.getGender() == 2 %}checked{% endif %}><label for="female-gender">Женский</label> </div> </div> <button type="submit" class="action-link apply no-mobile js-apply-edit-data">Применить</button> <button type="button" class="action-link dim cancel no-mobile js-cancel-edit-data">Отменить</button> <button class="ivi-button large pale cancel only-mobile js-cancel-edit-data">Отменить</button> <button type="submit" class="ivi-button large apply only-mobile js-apply-edit-data">Применить</button> </div> </form> </div> </li> <li class="birthdate"> <span class="name">Год рождения</span> <div class="actions{% if user.getBirthday() %} filled{% endif %}"> <div class="value js-value"> {% if user.getBirthday() %}<strong class="js-value-block">{{ user.getBirthday()|slice(0,4) }}</strong> {% else %}<a class="action-link dim js-value-block js-edit-user-data" href="#">Указать год рождения</a> {% endif %} <a class="action-link edit js-edit-user-data" href="#">Изменить</a></div> <form class="edit-form" style="display: none"> <div class="form-line"> <div class="ivi-input"><input type="text" placeholder="введите год" maxlength="4"></div> <button type="submit" class="action-link apply no-mobile js-apply-edit-data">Применить</button> <button type="button" class="action-link dim cancel no-mobile js-cancel-edit-data">Отменить</button> <button class="ivi-button large pale cancel only-mobile js-cancel-edit-data">Отменить</button> <button type="submit" class="ivi-button large apply only-mobile js-apply-edit-data">Применить</button> </div> </form> </div> </li> {% if bindContactsAvailable and not user.isSocialAuth() %} <li class="phone distant"> <span class="name">Телефон</span> <div class="actions filled"> <div class="value"> {% if user.getMsisdn() %}<span class="phone__filled" href="#">{{ user.getFormattedPhoneNumber() }}</span>{% else %}<a class="phone__add js-bind-phone" href="#">Указать телефон</a>{% endif %} </div> </div> </li> <li class="email"> <span class="name">E-mail</span> <div class="actions filled"> <div class="value"> {% if user.getEmail() %}<span class="email__filled" href="#">{{ user.getEmail() }}</span>{% else %}<a class="email__add js-bind-email" href="#">Указать e-mail</a>{% endif %} </div> </div> </li> {% else %} <li class="email distant"> <span class="name">E-mail</span> <div class="actions{% if user.getEmail() %} filled{% endif %}"> <div class="value js-value">{% if user.getEmail() %}<strong class="js-value-block">{{ user.getEmail() }}</strong>{% else %}<a class="action-link dim js-value-block js-edit-user-data" href="#">Указать e-mail</a>{% endif %}<a class="action-link edit js-edit-user-data" href="#">Изменить</a></div> <form action="#" class="edit-form" style="display: none"> <div class="form-line"> <div class="value">Текущий е-mail: <strong class="js-value-block">{{ user.getEmail() }}</strong></div> </div> <div class="form-line"> <div class="ivi-input"><input type="text" placeholder="новый е-mail" maxlength="40"></div> </div> <div class="form-line"> <div class="ivi-input"><input type="password" placeholder="текущий пароль"></div> <button type="submit" class="action-link apply no-mobile js-apply-edit-data">Применить</button> <button type="button" class="action-link dim cancel no-mobile js-cancel-edit-data">Отменить</button> <button class="ivi-button large pale cancel only-mobile js-cancel-edit-data">Отменить</button> <button type="submit" class="ivi-button large apply only-mobile js-apply-edit-data">Применить</button> </div> </form> </div> </li> {% endif %} {% if user.getEmail() %} <li class="password"> <span class="name">Пароль</span> <div class="actions filled"> <div class="value js-value"><strong class="js-value-block">********</strong><a class="action-link edit js-edit-user-data" href="#">Изменить</a></div> <form action="#" class="edit-form" style="display: none"> <div class="form-line"> <div class="ivi-input"><input type="password" value="" placeholder="текущий пароль"></div> </div> <div class="form-line"> <div class="ivi-input"><input type="password" placeholder="новый пароль"></div> </div> <div class="form-line"> <div class="ivi-input"><input type="password" placeholder="повтор нового пароля"></div> <button type="submit" class="action-link apply no-mobile js-apply-edit-data">Применить</button> <button type="button" class="action-link dim cancel no-mobile js-cancel-edit-data">Отменить</button> <button class="ivi-button large pale cancel only-mobile js-cancel-edit-data">Отменить</button> <button type="submit" class="ivi-button large apply only-mobile js-apply-edit-data">Применить</button> </div> </form> </div> </li> {% endif %} </ul> {% if notifications|length %} <div class="profile__notifications js-user-notifications"> <div class="notifications__title"> Настройка уведомлений </div> <div class="notifications__wrapper"> {% for notification in notifications %} <div class="notification js-notification{% if notification.enabled %} enabled{% endif %}"> <div class="notification__title">{{ notification.title }}</div> <div class="notification__text">{{ notification.description }}</div> <div class="notification__checkbox-wrapper"> {% for delivery in notification.children %} <div class="notification__checkbox js-notification-checkbox{% if delivery.state %} checked{% endif %}" delivery-category-id="{{ delivery.id }}" message-category-id="{{ notification.id }}"> <div class="checkbox__box"></div> <div class="checkbox__label">{{ delivery.title }}</div> </div> {% endfor %} </div> <div class="ivi-button small red notification__enable js-enable-notifications">Включить</div> </div> {% endfor %} </div> </div> {% endif %}{% if isWorld or showSupportPhone|default(0) %} <div class="support-phone no-mobile js-user-support-phone"></div>{% endif %}</section>',e)}var a=i(2);t.default=n},function(e,t,i){function n(e){return a.default.render('<div class="teaser__wrapper"> <div class="teaser"> <div class="title">Зарегистрируйтесь, чтобы воспользоваться всеми преимуществами ivi</div> <div class="note">После регистрации ваши покупки и история просмотров станут доступны на любом из ваших устройств</div> <div class="actions"> <a href="#auth" class="ivi-button medium js-register-btn">Зарегистрироваться</a> <div class="moved-elements"> <span class="separate">или</span> <a href="#auth" class="login js-login-btn">Войти</a> </div> </div> </div></div>',e)}var a=i(2);t.default=n},function(e,t,i){var n=i(1),a=i(0),s=i(145),o=i(344),r=i(3);t.default=a.View.extend({el:".js-user-notifications",events:{"mouseenter .js-notification":"mouseEnter","mouseleave .js-notification":"mouseLeave","click .js-notification.enabled .js-notification-checkbox":"checkboxClick","click .js-enable-notifications":"enableNotificationsClick","click .js-notification":"notificationClick"},initialize:function(){this.notificationStateList=new s.default,o.default.setRequestAnimationFrame(),this.transitionEnd=o.default.transitionEndEventName()},checkboxClick:function(e){var t=n(e.currentTarget);if(this.toggleState(t),window.ivi.adaptive.isMobile){var i=t.parents(".js-notification");i.find(".js-notification-checkbox.checked").length||window.requestAnimationFrame(function(){i.removeClass("enabled")})}},getCheckboxData:function(e){var t=e.hasClass("checked");return{messageCategoryId:Number(e.attr("message-category-id")),deliveryCategoryId:Number(e.attr("delivery-category-id")),newState:!t}},toggleState:function(e){var t,i,a,s=this,o=[];n.each(e,function(e,l){var d=n(l);u=s.getCheckboxData(d),t=u.messageCategoryId,i=u.deliveryCategoryId,a=u.newState,o.push(i),r.default.track(a?"notifications_sub":"notifications_unsub",{delivery_category_id:i,message_category_id:t}),d.toggleClass("checked");var u}),this.notificationStateList.setState(t,o,a)},enableNotifications:function(e){e.addClass("enabled").trigger("mouseenter"),this.toggleState(e.find(".js-notification-checkbox"))},enableNotificationsClick:function(e){this.enableNotifications(n(e.currentTarget).parent(".js-notification"))},notificationClick:function(e){var t=n(e.currentTarget);t.hasClass("enabled")||this.enableNotifications(t)},getStateList:function(){return this.notificationStateList.getStateList()},mouseEnter:function(e){var t=n(e.currentTarget);if(t.off(this.transitionEnd),!window.ivi.adaptive.isMobile&&t.hasClass("enabled")){var i=t.find(".notification__checkbox"),a=i.find(".checkbox__label"),s=i.find(".checkbox__box");!0!==t.data("init")&&n.each(a,function(e,t){n(t).data("start-position",n(t).position().left)}),t.data("init",!0),t.addClass("hovered"),n.each(i,function(e){var t=a.eq(e),i=t.data("start-position")-t.position().left,n=s.eq(e);t[0].style.transform="translateX("+i+"px)",n[0].style.opacity=0}),setTimeout(function(){t.addClass("transitions"),window.requestAnimationFrame(function(){n.each(i,function(e){var t=a.eq(e),i=s.eq(e);t[0].style.transform="translateX(0)",i[0].style.opacity=1})})},1)}},mouseLeave:function(e){var t=this,i=n(e.currentTarget);if(!window.ivi.adaptive.isMobile&&i.hasClass("enabled")){var a=i.find(".notification__checkbox"),s=a.find(".checkbox__label"),o=a.find(".checkbox__box");n.each(a,function(e,t){var i=s.eq(e),a=i.data("start-position")-i.position().left,r=o.eq(e);i[0].style.transform="translateX("+a+"px)",i[0].style.opacity=!n(t).hasClass("checked")&&.3,r[0].style.opacity=0}),i.one(this.transitionEnd,function(){clearTimeout(r),t.afterTransitionClear(i,a,s)});var r=setTimeout(function(){t.afterTransitionClear(i,a,s)},200)}},afterTransitionClear:function(e,t,i){e.find(".notification__checkbox.checked").length||e.removeClass("enabled"),e.is(":hover")||(n.each(t,function(e){var t=i.eq(e);t[0].style.transform="",t[0].style.opacity=""}),e.removeClass("hovered transitions"))}})},function(e,t,i){var n=i(1),a=i(5),s=i(58),o=i(808),r=i(60),l=i(141),d=i(79),u=i(200),c=i(3),p=i(4),f=i(20),h=i(41),g=i(30),m=i(11);t.default=s.default.extend({tabEl:"#js-subscription",template:o.default,cardsInfo:null,psAccounts:null,events:{"click .js-subscribe":"showModalSubscribe","click .js-unsubscribe-button":"showModalUnsubscribe","click .js-renew-button":"renewSubscription","click .js-change-card":"changeCard","click .js-change-card-new":"addCardClick","click .js-attach-card":"attachCardClick","click .js-change-card-block .js-card-account":"selectCardAccount","click .js-keep-current-card":"keepCurrentCard","click .js-buy":"sendGrootBuyClick"},grootPage:"gup",grootRefPage:"gup",grootParams:{},renewError:{disable:"Не удалось отключить автопродление",enable:"Не удалось возобновить автопродление"},isCardChanging:!1,purchaseOptionList:null,subscriptionPackView:null,initialize:function(e,t){s.default.prototype.initialize.call(this),this.subscriptionPurchaseModel=null,this.cardsInfo=e,this.psAccounts=t,this.listenTo(g.default,"profile:unsubscribe",this.continueUnsubscribtion),this.listenTo(g.default,"status:subscription:renew",this.onSubscriptionRenew),this.listenTo(g.default,"profile:psaccounts:updated",this.prepareAccountsData),this.listenTo(m.default,"billing:setAutoprolongSuccess",this.updateSubscriptionData),this.listenTo(m.default,"billing:setAutoprolongError",this.subscriptionDataError),this.listenTo(m.default,"purchase:personal",this.continueSubscribe),this.subscriptionPackView=new u.default({from:"gup",redirect_url:"/profile"})},setUpPurchases:function(e){this.userPurchases=!0,this.subscriptionPurchaseModel=e.createSubscriptionPurchaseObject(),this.prepareSubscriptionOptions()},prepareSubscriptionOptions:function(){var e=this;this.templateParams.hasLongSubscriptionOptions=!1,this.templateParams.standardSubscriptionOption=null,this.templateParams.subscriptionOptions=[],this.templateParams.host=p.default.getLocation().host;var t=new r.default;return t.fetchOptions().done(function(){e.purchaseOptionList=t.getPurchaseOptionList(),e.subscriptionPackView.setSubscriptionPurchaseOptionsList(e.purchaseOptionList),e.templateParams.subscriptionOptions=e.purchaseOptionList.getSubscriptionOptions(),e.templateParams.standardSubscriptionOption=e.purchaseOptionList.getStandardSubscription(),e.templateParams.hasLongSubscriptionOptions=e.templateParams.subscriptionOptions.length>1,e.prepareAccountsData()}).fail(function(){e.prepareAccountsData()})},prepareAccountsData:function(){var e=this;if(this.templateParams.canChangeCard=!1,this.templateParams.accounts=[],this.updateGrootSuperProperties(),this.subscriptionPurchaseModel.hasSubscription()){(this.subscriptionPurchaseModel.isCardPayment()||this.subscriptionPurchaseModel.isCertificatePaymentWithCard())&&(this.subscriptionPurchaseModel.isCardExpired()?this.grootParams.card_expired=2:this.subscriptionPurchaseModel.isCardExpiring()?this.grootParams.card_expired=1:this.grootParams.card_expired=0);var t=new r.default;t.fetchChangeCardOptions().done(function(){var i=t.getChangeCardOption();if(i){var n=new d.default(i).getByPsMethod("card");e.templateParams.canChangeCard=n.length>0,a.each(n,function(t){if(null!==t.get("payment_system_account")){var i=new l.default(t.get("payment_system_account"));e.subscriptionPurchaseModel.getAccountId()===i.getId()||i.isCardExpired()||e.templateParams.accounts.push(i)}})}e.prepareCardsInfoData()})}else this.prepareCardsInfoData()},updateGrootSuperProperties:function(){c.default.rewriteSuperProperties({svod_active:this.subscriptionPurchaseModel.hasSubscription()?1:0,renew_active:this.subscriptionPurchaseModel.isRenewEnabled()?1:0,dobill_active:this.subscriptionPurchaseModel.isRebilling()?1:0,svod_by_card:this.subscriptionPurchaseModel.isCardPayment()||this.subscriptionPurchaseModel.isCertificatePaymentWithCard()?1:0})},prepareCardsInfoData:function(){var e=this;this.templateParams.cardsInfo=this.cardsInfo,this.templateParams.psAccounts=this.psAccounts,this.templateParams.canChangeCard||this.subscriptionPurchaseModel.isCardPayment()||this.subscriptionPurchaseModel.isCertificatePaymentWithCard()?n.when(this.cardsInfo.load(),this.psAccounts.load()).done(function(){e.isDataExists=!0,e.show()}):(this.isDataExists=!0,this.show())},show:function(){this.subscriptionPurchaseModel&&(this.templateParams.subscriptionPurchase=this.subscriptionPurchaseModel,this.templateParams.subscriptionRenewalPrice=this.templateParams.subscriptionPurchase.getRenewalPrice()),s.default.prototype.show.apply(this,arguments)},afterShow:function(){if(s.default.prototype.afterShow.apply(this,arguments),this.templateParams.hasLongSubscriptionOptions){var e={from:this.grootPage,is_trybuy:c.default.isTrialAvailable()?1:0,object_type:"subscription"};c.default.track("svod_selection",e)}this.subscriptionPackView.setElement(n(u.default.prototype.el))},showModalUnsubscribe:function(){return c.default.track("unsubscribe_click",this.grootParams),g.default.trigger("profile:unsubscribe:modal",{subscriptionOption:this.subscriptionPurchaseModel,grootParams:this.grootParams},"m","profile"),!1},renewSubscription:function(e){return!n(e.currentTarget).hasClass("disabled")&&(this.showLoader(".js-renew-button"),c.default.track("renew_subscribe",this.grootParams),g.default.trigger("profile:subscription:renew"),this.subscriptionPurchaseModel.enableRenew(),!1)},showModalSubscribe:function(){return h.default.trigger("showSubscriptionLanding","profile"),!1},continueUnsubscribtion:function(){this.showLoader(".js-unsubscribe-button"),this.subscriptionPurchaseModel.disableRenew()},onSubscriptionRenew:function(){this.$el.find(".js-renew-button").addClass("disabled")},showLoader:function(e){this.$el.find(e).addClass("loading")},hideLoader:function(e){this.$el.find(e).removeClass("loading")},updateSubscriptionData:function(){this.isActivated=!0,this.updateGrootSuperProperties(),this.show(),n("html, body").animate({scrollTop:0},"slow")},subscriptionDataError:function(e){var t=e===this.subscriptionPurchaseModel.autoprolongCancelAction?this.renewError.disable:this.renewError.enable;g.default.trigger("profile:errorMessage:modal",{text:t}),this.show()},continueSubscribe:function(e){"subscription"===e.object_type&&this.showLoader(".js-subscribe")},redirectToChangeCard:function(e){void 0===e&&(e=!1);var t=e?"new=1&":"";p.default.redirect("/buy/changecard?"+t+"from=changecard&redirect_url="+encodeURIComponent("/profile#subscription"))},addCardClick:function(){c.default.track("add_svodcard",this.grootParams),this.redirectToChangeCard(!0)},attachCardClick:function(){c.default.track("attach_svodcard",this.grootParams),this.templateParams.accounts.length?this.$el.find(".js-card-accounts").removeClass("collapsed"):this.redirectToChangeCard(!0)},changeCard:function(){c.default.track("change_svodcard_click",this.grootParams),this.templateParams.accounts.length?(c.default.track("change_svodcard_selection",this.grootParams),this.$el.find(".js-card-accounts").removeClass("collapsed")):this.redirectToChangeCard(!0)},keepCurrentCard:function(){this.$el.find(".js-card-accounts").addClass("collapsed")},showCardChanging:function(e){this.isCardChanging=!0,e.addClass("payment-card_loading")},hideCardChanging:function(e){this.isCardChanging=!1,e.removeClass("payment-card_loading")},selectCardAccount:function(e){if(!this.isCardChanging){var t=n(e.currentTarget),i=t.data("id");i&&!t.hasClass("payment-card_expiring")&&(c.default.track("select_svodcard",this.grootParams),f.default.setChangeCardAccountId(i),this.showCardChanging(t),this.redirectToChangeCard())}},sendGrootBuyClick:function(e){var t=n(e.currentTarget),i={from:this.grootPage,is_trybuy:c.default.isTrialAvailable()?1:0,object_type:"subscription",price_svod:t.data("price"),svod_period:t.data("period")};c.default.track("svod_period_click",i)}})},function(e,t,i){function n(e){return a.default.render('{% set subscriptionRenewalPriceWithCurrency = internationalExpansion.getPriceWithCurrency(subscriptionRenewalPrice|money_format, " ", subscriptionRenewalPrice) %}{% if subscriptionPurchase.getPaymentDisplayName() %} {% if subscriptionPurchase.isIviPayment() %} {% set paymentDisplayName = "Личный счёт на ivi" %} {% elseif subscriptionPurchase.isCardPayment() or subscriptionPurchase.isCertificatePaymentWithCard() %} {% set paymentDisplayName = "Банковская карта" %} {% elseif subscriptionPurchase.isSMSPayment() %} {% set paymentDisplayName = "SMS" %} {% elseif subscriptionPurchase.isCertificatePayment() %} {% set paymentDisplayName = "Сертификат" %} {% elseif subscriptionPurchase.isAndroidPayment() %} {% set paymentDisplayName = "Google Play" %} {% elseif subscriptionPurchase.isIOSPayment() %} {% set paymentDisplayName = "Apple AppStore" %} {% else %} {% set paymentDisplayName = subscriptionPurchase.getPaymentDisplayName() %} {% endif %}{% else %} {% set paymentDisplayName = "" %}{% endif %}<section class="subscription-control-block">{% if subscriptionPurchase.hasSubscription() or subscriptionPurchase.hasExpiredSubscription() %} {% set subscriptionDurationInDays = subscriptionPurchase.getSubscriptionDurationInDays() %} <section class="subscription_manage-block grid-12"> <div class="subscription_status-block col-8"> <div class="product{% if subscriptionPurchase.isRebilling() or subscriptionPurchase.isExpired() %} disabled{% endif %}"> <div class="title"> Подписка{% if not isWorld %} ivi{% endif %} {% if subscriptionPurchase.isCertificatePayment() and subscriptionPurchase.getNextRenewalTryTime() is null %} <span class="comment">в подарок</span> {% endif %} </div> {% if subscriptionDurationInDays and ( (subscriptionPurchase.isCertificatePaymentWithCard() and subscriptionPurchase.getNextRenewalTryTime() is not null) or not subscriptionPurchase.isCertificatePayment()) %} {% if subscriptionDurationInDays % 30 == 0 %} <div class="duration">{{ subscriptionDurationInDays / 30 }} <span class="month">{{ declension.month(subscriptionDurationInDays / 30) }}</span></div> {% else %} <div class="duration">{{ subscriptionDurationInDays }} <span class="month">{{ declension.days(subscriptionDurationInDays) }}</span></div> {% endif %} {% endif %} </div> {% set subscriptionBlockTitle = "" %} {% set subscriptionBlockNote = "" %} {% set subscriptionBlockNoteWarning = false %} {% set subscriptionBlockButton = "" %} {% if subscriptionPurchase.isRebilling() and not subscriptionPurchase.isExpired() %} {% set subscriptionBlockTitle %} истекла {{ internationalExpansion.getLocalDateTime(subscriptionPurchase.getSubscriptionExpireDate())|date("d.m.Y") }} {% endset %} {% set subscriptionBlockNoteWarning = true %} {% set subscriptionBlockNote %} <p>Действие подписки остановлено.</p> <p>Следующая попытка продления - <strong>{{ internationalExpansion.getLocalDateTime(subscriptionPurchase.getNextRenewalTryTime())|date("d.m.Y") }}</strong>.</p> <p>С вашего счета будет списано <strong>{{ subscriptionRenewalPriceWithCurrency }}</strong>.</p> {% endset %} {% elseif subscriptionPurchase.isExpired() %} {% set subscriptionBlockTitle %} истекла {{ internationalExpansion.getLocalDateTime(subscriptionPurchase.getSubscriptionExpireDate())|date("d.m.Y") }} {% endset %} {% set subscriptionBlockNote %} <p>Подписка отключена.</p> {% endset %} {% set subscriptionBlockButton %} <a class="ivi-button large js-subscribe">Подключить</a> {% endset %} {% elseif subscriptionPurchase.isRenewEnabled() %} {% if subscriptionPurchase.getSubscriptionExpireDate() %} {% set subscriptionBlockTitle %} активна до {{ internationalExpansion.getLocalDateTime(subscriptionPurchase.getSubscriptionExpireDate())|date("d.m.Y") }} {% endset %} {% endif %} {% set subscriptionBlockNote %} По истечении данного периода сумма списания составит {{ subscriptionRenewalPriceWithCurrency }}. {% endset %} {% else %} {% if subscriptionPurchase.getSubscriptionExpireDate() %} {% set subscriptionBlockTitle %} активна до {{ internationalExpansion.getLocalDateTime(subscriptionPurchase.getSubscriptionExpireDate())|date("d.m.Y") }} {% endset %} {% endif %} {% set subscriptionBlockNoteWarning = true %} {% set subscriptionBlockNote %} По истечении данного периода подписка будет отключена. {% endset %} {% if (subscriptionPurchase.isCertificatePayment() or subscriptionPurchase.isCardPayment()) and psAccounts.findById(subscriptionPurchase.getAccountId()) %} {% set subscriptionBlockButton %} <a class="ivi-button large js-renew-button">Возобновить подписку</a> {% endset %} {% endif %} {% endif %} <div class="term"> {% if subscriptionBlockTitle %} <div class="title">{{ subscriptionBlockTitle }}</div> {% endif %} <div class="note no-mobile{% if subscriptionBlockNoteWarning %} warning{% endif %}">{{ subscriptionBlockNote }}</div> {% if subscriptionBlockButton %} <div class="button no-mobile">{{ subscriptionBlockButton }}</div> {% endif %} </div> <div class="note only-mobile{% if subscriptionBlockNoteWarning %} warning{% endif %}">{{ subscriptionBlockNote }}</div> {% if subscriptionBlockButton %} <div class="button only-mobile">{{ subscriptionBlockButton }}</div> {% endif %} </div> <div class="subscription_payment-block col-4"> {% if subscriptionPurchase.isAndroidPayment() or subscriptionPurchase.isIOSPayment() %} <div class="information"> <div class="caption">Способ оплаты</div> <div class="title {% if not subscriptionPurchase.isRenewEnabled() %}warning{% endif %}">{{ paymentDisplayName }}</div> {% if subscriptionPurchase.isAndroidPayment() %} <div class="note">Управлять подпиской можно в настройках Google Play.</div> {% else %} <div class="note">Управлять подпиской можно в настройках Apple ID.</div> {% endif %} </div> {% elseif subscriptionPurchase.isCardExpired() or subscriptionPurchase.isCardExpiring() %} <div class="information col-2"> {% if subscriptionPurchase.isCardExpired() %} <div class="title warning">Банковская карта истекла</div> {% else %} <div class="title warning">Банковская карта истекает</div> {% endif %} {% if canChangeCard %} <div class="button"> <a class="ivi-button small js-change-card">Сменить карту</a> </div> {% endif %} </div> {% else %} <div class="information col-2"> <div class="caption">Способ оплаты</div> <div class="title {% if not subscriptionPurchase.isRenewEnabled() %}warning{% endif %}">{{ paymentDisplayName }}</div> <div class="button"> {% if canChangeCard %} {% if subscriptionPurchase.isCardPayment() or subscriptionPurchase.isCertificatePaymentWithCard() %} <a class="outline ivi-button small js-change-card">Сменить карту</a> {% elseif subscriptionPurchase.isSMSPayment() or subscriptionPurchase.isIviPayment() or subscriptionPurchase.isCertificatePayment() %} <a class="ivi-button small js-attach-card">Привязать карту</a> {% endif %} {% endif %} </div> </div> {% endif %} {% if subscriptionPurchase.isCardPayment() or subscriptionPurchase.isCertificatePaymentWithCard() %} {% set bankInfo = cardsInfo.getBankInfo(subscriptionPurchase.getCardBankKey()) %} {% set psTypeInfo = cardsInfo.getPsTypeInfo(subscriptionPurchase.getCardPsType()) %} {% set isCardDisabled = false %} {% if subscriptionPurchase.isCardExpiring() or subscriptionPurchase.isCardExpired() or not psAccounts.findById(subscriptionPurchase.getAccountId()) %} {% set isCardDisabled = true %} {% endif %} {% set card = subscriptionPurchase.getPaymentPsAccount() %} {% set bankInfo = cardsInfo.getBankInfo(card.getCardBankKey()) %}{% set psTypeInfo = cardsInfo.getPsTypeInfo(card.getPsType()) %}<div data-id="{{ card.getId() }}" class="payment-card js-card-account {% if card.isCardExpired() %} payment-card_expired{% endif %} {% if card.isCardExpiring() %} payment-card_expiring{% endif %} {% if showCardDeactivate|default(false) %} payment-card_with-delete{% endif %} {% if showCardAsLink|default(false) %} payment-card_link{% endif %}"> <div class="payment-card__inner" style="color: {{ bankInfo.getInkColor() }}" > <div class="payment-card__background" style=" background: {{ bankInfo.getGradStart() }}; background: -moz-linear-gradient(33deg, {{ bankInfo.getGradStart() }}, {{ bankInfo.getGradEnd() }}); background: -webkit-linear-gradient(33deg, {{ bankInfo.getGradStart() }}, {{ bankInfo.getGradEnd() }}); background: linear-gradient(33deg, {{ bankInfo.getGradStart() }}, {{ bankInfo.getGradEnd() }}); "></div> {% if bankInfo.getLogoUrl() %} <div class="payment-card__bank-logo"> <img class="payment-card__bank-logo-image" src="{{ bankInfo.getLogoUrl() }}"> </div> {% endif %} <div class="payment-card__number">{{ card.getTitle() }}</div> <div class="payment-card__expired">{{ card.getCardExpiresDate()|card_validity|default("&nbsp;") }}</div> {% if psTypeInfo %} <div class="payment-card__system-type"> <img class="payment-card__system-type-image" src="{{ psTypeInfo[bankInfo.getTypeLogo()] }}"> </div> {% endif %} </div> {% if showCardDeactivate|default(false) %} <button class="payment-card__delete js-deactivate-card">Удалить карту</button> {% endif %} <div class="payment-card__caption">{{ bankInfo.getTitle() }}</div></div> {% elseif canChangeCard and (subscriptionPurchase.isSMSPayment() or subscriptionPurchase.isIviPayment() or subscriptionPurchase.isCertificatePaymentWithoutCard()) %} <div class="add-card__wrapper col-2"> <div class="add-card js-change-card"><span class="add-card__icon"></span></div> </div> {% endif %} </div> </section> <div class="cards-manage-block collapsed js-card-accounts"> <h2 class="title">Выберите карту для оплаты</h2> <div class="cards-manage__top-wrapper grid-12"> <div class="col-10"></div> <div class="col-2 arrow"></div> </div> <div class="cards-manage__content-wrapper grid-12 js-change-card-block"> {% for card in accounts %} {% set bankInfo = cardsInfo.getBankInfo(account.getCardBankKey()) %} {% set psTypeInfo = cardsInfo.getPsTypeInfo(account.getPsType()) %} <div class="item col-2"> {% set showCardAsLink = true %} {% set bankInfo = cardsInfo.getBankInfo(card.getCardBankKey()) %}{% set psTypeInfo = cardsInfo.getPsTypeInfo(card.getPsType()) %}<div data-id="{{ card.getId() }}" class="payment-card js-card-account {% if card.isCardExpired() %} payment-card_expired{% endif %} {% if card.isCardExpiring() %} payment-card_expiring{% endif %} {% if showCardDeactivate|default(false) %} payment-card_with-delete{% endif %} {% if showCardAsLink|default(false) %} payment-card_link{% endif %}"> <div class="payment-card__inner" style="color: {{ bankInfo.getInkColor() }}" > <div class="payment-card__background" style=" background: {{ bankInfo.getGradStart() }}; background: -moz-linear-gradient(33deg, {{ bankInfo.getGradStart() }}, {{ bankInfo.getGradEnd() }}); background: -webkit-linear-gradient(33deg, {{ bankInfo.getGradStart() }}, {{ bankInfo.getGradEnd() }}); background: linear-gradient(33deg, {{ bankInfo.getGradStart() }}, {{ bankInfo.getGradEnd() }}); "></div> {% if bankInfo.getLogoUrl() %} <div class="payment-card__bank-logo"> <img class="payment-card__bank-logo-image" src="{{ bankInfo.getLogoUrl() }}"> </div> {% endif %} <div class="payment-card__number">{{ card.getTitle() }}</div> <div class="payment-card__expired">{{ card.getCardExpiresDate()|card_validity|default("&nbsp;") }}</div> {% if psTypeInfo %} <div class="payment-card__system-type"> <img class="payment-card__system-type-image" src="{{ psTypeInfo[bankInfo.getTypeLogo()] }}"> </div> {% endif %} </div> {% if showCardDeactivate|default(false) %} <button class="payment-card__delete js-deactivate-card">Удалить карту</button> {% endif %} <div class="payment-card__caption">{{ bankInfo.getTitle() }}</div></div> </div> {% endfor %} <div class="item col-2 js-change-card-new"> <div class="add-card__wrapper"> <div class="add-card"><span class="add-card__icon"></span></div> <div class="caption">+ Добавить новую</div> </div> </div> </div> <div class="cards-manage__bottom-wrapper only-mobile"> <a class="ivi-button large outline keep-current js-keep-current-card">Оставить текущую</a> </div> </div>{% endif %} <div class="content-block"> {% set renewSubscription = subscriptionPurchase.hasSubscription() and not subscriptionPurchase.isExpired() %} {% if not subscriptionPurchase.hasSubscription() or hasLongSubscriptionOptions %} <h2 class="content-title">{% if renewSubscription %}Продлите{% else %}Подключите{% endif %} подписку</h2> {% endif %} {% if hasLongSubscriptionOptions %} <div class="content-text">Выберите период для {% if renewSubscription %}продления{% else %}подключения{% endif %}. Чем больше период, тем больше выгода.</div> {% set subscriptionPackageColors = { 1: "minimal", 3: "middling", 6: "popular", 12: "maximal" } %}<div class="subscription-pack {{ additionalClass | default("") }}"> <div class="subscription-pack__container"> {% for index, option in subscriptionOptions %} {% set durationInMonth = option.getDurationInMonth() %} {% set durationInDays = option.getDurationInDay() %} {% set fullPrice = standardSubscriptionOption.getMinPrice() * durationInMonth %} {% set discountPrice = option.getMinUserPrice() %} {% if option == standardSubscriptionOption %} {% set discount = 0 %} {% else %} {% set discount = (fullPrice - discountPrice) * 100 // fullPrice %} {% endif %} <div class="subscription-pack__item{% if subscriptionPackageColors[durationInMonth] is defined %} subscription-pack__item_{{ subscriptionPackageColors[durationInMonth] }}{% if subscriptionPackageColors[durationInMonth] == "popular" %} subscription-pack__item_picked{% endif %}{% endif %}"> <div class="subscription-pack__item-inner"> <div class="subscription-pack__bonus"> <div class="subscription-pack__sale"> {% if discount %} <div class="subscription-pack__sale-inner">-{{ discount }}%</div> {% endif %} </div> {% if option.getBonusInfo() %} <div class="subscription-pack__offer"> <div class="subscription-pack__offer-inner">+{{ option.getBonusInfo() }}</div> </div> {% endif %} </div> <div class="subscription-pack__duration">{{ durationInMonth }}</div> <div class="subscription-pack__duration-unit">{{ declension.month(durationInMonth) }}</div> <div class="subscription-pack__price"> {% if discountPrice < fullPrice %} <del class="subscription-pack__price-old subscription-pack_middling__price-old">{{ fullPrice }}</del> {% endif %} <ins class="subscription-pack__price-main">{{ discountPrice }}</ins> {% if internationalExpansion.isDefaultCurrency() %} <span class="subscription-pack__price-currency">{{ internationalExpansion.getFormattedCurrency() }}</span> {% else %} <span class="subscription-pack__price-currency subscription-pack__price-currency_world">{{ internationalExpansion.getFormattedCurrency() }}</span> {% endif %} </div> <div class="subscription-pack__actions"> <a data-price="{{ discountPrice }}" data-period="{{ durationInDays }}" data-option-hash="{{ option.getOptionHash() }}" data-product-identifier="{{ option.getProductIdentifier() }}" href="{{ internationalExpansion.getSchemaWithHost("https", host) }}/buy/subscription?option_hash={{ option.getOptionHash() }}{{ from is defined ? "&from="~from : ""}}{{ redirect_url is defined ? "&redirect_url="~redirect_url : ""}}{{ tab is defined ? "&tab="~tab : ""}}" class="js-buy ivi-button large outline"> {% if renewSubscription %}Продлить{% else %}Подключить{% endif %} </a> </div> </div> </div> {% endfor %} </div> <div class="subscription-pack__note"> {{ note | default("Один месяц равен тридцати календарным дням") }} </div></div> {% endif %} {% if subscriptionPurchase.hasSubscription() %} {% if subscriptionPurchase.isRenewEnabled() and not subscriptionPurchase.isExpired() %} <div class="content-action"> <a class="ivi-button medium outline js-unsubscribe-button" href="#">Отключить подписку</a> </div> {% endif %} {% else %} {% if isWorld %} <div class="subscription-control_world"> <div class="content-action only-mobile"><a class="ivi-button large js-subscribe">Подключить</a></div> <div class="premium-advantages"> <div class="premium-advantages__item auditory"> <div class="premium-advantages__item__icon"></div> <div class="premium-advantages__item__text"> <span>Онлайн-кинотеатр №1</span> <span>Нас выбрали 30 млн человек</span> </div> </div> <div class="premium-advantages__item devices"> <div class="premium-advantages__item__icon"></div> <div class="premium-advantages__item__text"> <span>Смотрите онлайн</span> <span>на любых устройствах</span> </div> </div> <div class="premium-advantages__item no-adv"> <div class="premium-advantages__item__icon"></div> <div class="premium-advantages__item__text"> <span>Без рекламы</span> <span>в качестве Full HD</span> </div> </div> <div class="premium-advantages__item subtitles"> <div class="premium-advantages__item__icon"></div> <div class="premium-advantages__item__text"> <span>Субтитры</span> <span>и оригинальные дорожки</span> </div> </div> </div> </div> {% else %} <div class="premium-advantages"> <div class="premium-advantages__item no-adv"> <div class="premium-advantages__item__icon"></div> <div class="premium-advantages__item__text"> Все фильмы и сериалы без рекламы </div> </div> <div class="premium-advantages__item best-ribbon"> <div class="premium-advantages__item__icon"></div> <div class="premium-advantages__item__text"> Лучшие мировые фильмы и сериалы </div> </div> <div class="premium-advantages__item full-hd"> <div class="premium-advantages__item__icon"></div> <div class="premium-advantages__item__text"> Фильмы в качестве Full HD 1080 <small>там, где доступно</small> </div> </div> <div class="premium-advantages__item original-lang"> <div class="premium-advantages__item__icon"></div> <div class="premium-advantages__item__text"> Фильмы на языке оригинала <small>там, где доступно</small> </div> </div> </div> {% endif %} {% if not hasLongSubscriptionOptions %} <div class="content-action{% if isWorld %} no-mobile{% endif %}"><a class="ivi-button large js-subscribe" href="#">Подключить</a></div> {% endif %} {% endif %} </div></section>',e)}var a=i(2);t.default=n},function(e,t,i){var n=i(1),a=i(58),s=i(8),o=i(3),r=i(4),l=i(810),d=i(30);t.default=a.default.extend({tabEl:"#js-cards",template:l.default,cardsInfo:null,psAccounts:null,events:{"click .js-deactivate-card":"deactivateCardClick","click .js-add-card":"addCardClick"},grootPage:"mycards",grootRefPage:"mycards",initialize:function(e,t){a.default.prototype.initialize.call(this),this.cardsInfo=e,this.psAccounts=t,this.listenTo(d.default,"profile:removeCard:continue",this.removeCard)},setPsAccounts:function(e){this.psAccounts=e},setUpPurchases:function(e){this.userPurchases=!0,s.default.isIdentified()?(n(this.tabEl).removeClass("hidden"),this.subscriptionPurchaseModel=e.createSubscriptionPurchaseObject(),this.psAccounts.load().done(this.prepareAccountsData.bind(this))):n(this.tabEl).addClass("hidden")},prepareAccountsData:function(){var e=this;this.templateParams.accounts=this.psAccounts,this.templateParams.cardsInfo=this.cardsInfo,this.templateParams.accounts.length?this.cardsInfo.load().done(function(){e.isDataExists=!0,e.show()}):(this.isDataExists=!0,this.show())},deactivateCardClick:function(e){var t=n(e.currentTarget).closest(".js-card-account"),i=t.data("id");if(i){var a=this.psAccounts.findById(i);a&&(o.default.track("remove_card_begin",{renewal_svod_card:this.subscriptionPurchaseModel.getAccountId()===a.getId()?1:0}),d.default.trigger("profile:removeCard:modal",{psAccount:a,subscriptionOption:this.subscriptionPurchaseModel,$card:t,cardsInfo:this.cardsInfo}))}return!1},addCardClick:function(){o.default.track("add_card_click"),r.default.redirect("/buy/addcard?redirect_url="+encodeURIComponent("/profile#cards"))},removeCard:function(e,t){var i=this;t.addClass("payment-card_loading"),this.psAccounts.deactivate(e.getId()).done(function(){i.psAccounts.mapiGet().done(function(){i.prepareAccountsData(),d.default.trigger("profile:psaccounts:updated")})})},activate:function(){s.default.isIdentified()&&a.default.prototype.activate.call(this)}})},function(e,t,i){function n(e){return a.default.render('{% set cards = accounts.getActiveCards() %}{% set showCardDeactivate = true %}<div class="cards-manage-block {% if not cards.length %}cards-manage-block_empty{% endif %}"> {% if cards.length %} <div class="cards-manage__content-wrapper grid-12"> {% for card in cards %} <div class="item col-2"> {% set bankInfo = cardsInfo.getBankInfo(card.getCardBankKey()) %}{% set psTypeInfo = cardsInfo.getPsTypeInfo(card.getPsType()) %}<div data-id="{{ card.getId() }}" class="payment-card js-card-account {% if card.isCardExpired() %} payment-card_expired{% endif %} {% if card.isCardExpiring() %} payment-card_expiring{% endif %} {% if showCardDeactivate|default(false) %} payment-card_with-delete{% endif %} {% if showCardAsLink|default(false) %} payment-card_link{% endif %}"> <div class="payment-card__inner" style="color: {{ bankInfo.getInkColor() }}" > <div class="payment-card__background" style=" background: {{ bankInfo.getGradStart() }}; background: -moz-linear-gradient(33deg, {{ bankInfo.getGradStart() }}, {{ bankInfo.getGradEnd() }}); background: -webkit-linear-gradient(33deg, {{ bankInfo.getGradStart() }}, {{ bankInfo.getGradEnd() }}); background: linear-gradient(33deg, {{ bankInfo.getGradStart() }}, {{ bankInfo.getGradEnd() }}); "></div> {% if bankInfo.getLogoUrl() %} <div class="payment-card__bank-logo"> <img class="payment-card__bank-logo-image" src="{{ bankInfo.getLogoUrl() }}"> </div> {% endif %} <div class="payment-card__number">{{ card.getTitle() }}</div> <div class="payment-card__expired">{{ card.getCardExpiresDate()|card_validity|default("&nbsp;") }}</div> {% if psTypeInfo %} <div class="payment-card__system-type"> <img class="payment-card__system-type-image" src="{{ psTypeInfo[bankInfo.getTypeLogo()] }}"> </div> {% endif %} </div> {% if showCardDeactivate|default(false) %} <button class="payment-card__delete js-deactivate-card">Удалить карту</button> {% endif %} <div class="payment-card__caption">{{ bankInfo.getTitle() }}</div></div> </div> {% endfor %} <div class="item col-2"> <div class="add-card__wrapper js-add-card"> <div class="add-card"><span class="add-card__icon"></span></div> <div class="caption">+ Добавить новую</div> </div> </div> </div> {% else %} <div class="cards-manage__add-card js-add-card"> <div class="title">Добавить банковскую карту</div> <div class="note"> <span>Это позволит в будущем продлевать подписку</span> <span>и оплачивать фильмы «в один клик»</span> </div> </div> {% endif %}</div>{% set cards = accounts.getExpiredCards() %}{% if cards.length %} <div class="cards-manage-block expired-cards-block"> <h2 class="content-title">Истёкшие карты</h2> <div class="cards-manage__content-wrapper grid-12"> {% for card in cards %} <div class="item col-2"> {% set bankInfo = cardsInfo.getBankInfo(card.getCardBankKey()) %}{% set psTypeInfo = cardsInfo.getPsTypeInfo(card.getPsType()) %}<div data-id="{{ card.getId() }}" class="payment-card js-card-account {% if card.isCardExpired() %} payment-card_expired{% endif %} {% if card.isCardExpiring() %} payment-card_expiring{% endif %} {% if showCardDeactivate|default(false) %} payment-card_with-delete{% endif %} {% if showCardAsLink|default(false) %} payment-card_link{% endif %}"> <div class="payment-card__inner" style="color: {{ bankInfo.getInkColor() }}" > <div class="payment-card__background" style=" background: {{ bankInfo.getGradStart() }}; background: -moz-linear-gradient(33deg, {{ bankInfo.getGradStart() }}, {{ bankInfo.getGradEnd() }}); background: -webkit-linear-gradient(33deg, {{ bankInfo.getGradStart() }}, {{ bankInfo.getGradEnd() }}); background: linear-gradient(33deg, {{ bankInfo.getGradStart() }}, {{ bankInfo.getGradEnd() }}); "></div> {% if bankInfo.getLogoUrl() %} <div class="payment-card__bank-logo"> <img class="payment-card__bank-logo-image" src="{{ bankInfo.getLogoUrl() }}"> </div> {% endif %} <div class="payment-card__number">{{ card.getTitle() }}</div> <div class="payment-card__expired">{{ card.getCardExpiresDate()|card_validity|default("&nbsp;") }}</div> {% if psTypeInfo %} <div class="payment-card__system-type"> <img class="payment-card__system-type-image" src="{{ psTypeInfo[bankInfo.getTypeLogo()] }}"> </div> {% endif %} </div> {% if showCardDeactivate|default(false) %} <button class="payment-card__delete js-deactivate-card">Удалить карту</button> {% endif %} <div class="payment-card__caption">{{ bankInfo.getTitle() }}</div></div> </div> {% endfor %} </div> </div>{% endif %}',e)}var a=i(2);t.default=n},function(e,t,i){var n=i(1),a=i(812),s=i(58),o=i(51),r=i(815),l=i(816),d=i(19);t.default=s.default.extend(o.default).extend({tabEl:"#js-purchases",template:r.default,events:{"click .js-purchases-block .more-link":"loadMore"},grootPage:"profile_shop",grootRefPage:"profile_shop",hasCredits:null,paymentStatementFormView:new a.default,initialize:function(){s.default.prototype.initialize.call(this,{waypoint:!0})},setUpPurchases:function(e){this.mainCollection=this.userPurchases=e,this.mainCollection.setVideoOptionsSelectionFrom(0),this.mainCollection.setVideoOptionsSelectionTo(this.selectionSize),this.templateParams.purchaseOptions=this.mainCollection,this.isDataExists=!0},afterShow:function(){var e=this;if(this.attachPosterPopup(this.$el.find("li.available")),s.default.prototype.afterShow.call(this),(new d.default).isFzShowPaymentStatementButtonCapability())if(null!==this.hasCredits)this.showPaymentStatementForm();else{var t=new l.default;t.mapiGet().done(function(){e.hasCredits=t.hasCredits(),e.showPaymentStatementForm()})}this.mainCollection.hasPurchaseVideoOptions()||n(".content-main").addClass(this.contentMainNoPurchasesClass)},loadMore:function(){return this.mainCollection.increaseVideoOptionsSelection(this.selectionSize),this.show(),!1},showPaymentStatementForm:function(){this.hasCredits&&(this.paymentStatementFormView.setElement(n(a.default.prototype.el)),this.paymentStatementFormView.render(),n("body").addClass(this.bodyHasPaymentStatementClass))}})},function(e,t,i){var n=i(0),a=i(116),s=i(813),o=i(8),r=i(814),l=i(7),d=i(28),u=i(3),c=i(30);t.default=n.View.extend({el:"#js-payment-statement-form",inputValue:null,$submitButton:null,expanded:!1,billingStatementModel:new r.default,events:{"input .js-email-input":"validateInput","click .js-submit":"processSubmit","click .js-receipt-button":"processReceiptClick","click #js-show-login":"showLoginModal"},initialize:function(){this.emailModel=new(n.Model.extend({validation:{email:{required:!0,pattern:"email"}}})),a.bind(this,{model:this.emailModel})},render:function(){var e=o.default.getPaymentCredentials()||{},t="";t=this.inputValue?this.inputValue:o.default.getEmail()?o.default.getEmail():e.email?e.email:"",this.$el.html(s.default({email:t,expanded:this.expanded})),this.$submitButton=this.$(".js-submit"),this.$input=this.$(".js-email-input"),this.validateInput()},processReceiptClick:function(){o.default.getEmail()?this.sendPaymentStatementRequest(o.default.getEmail()):(this.$(".receipt").addClass("expanded"),this.expanded=!0),u.default.track("billingstatement_click")},validateInput:function(){this.inputValue=this.$input.val(),this.emailModel.set("email",this.inputValue),this.$submitButton.toggleClass("disabled",!this.emailModel.isValid(!0))},processSubmit:function(){var e=this;if(this.$submitButton.hasClass("disabled"))return!1;this.disableForm();var t=d.default.escapeText(this.inputValue);this.listenToOnce(l.default,"user:paymentCredentialsChanged",function(i){i?e.sendPaymentStatementRequest(t):c.default.trigger("profile:showPaymentStatementModal",{email:t,status:"error"}),e.enableForm()}),o.default.setPaymentCredentials({email:t})},sendPaymentStatementRequest:function(e){this.billingStatementModel.sendStatement().done(function(t){t===r.default.prototype.STATUS_OK?(c.default.trigger("profile:showPaymentStatementModal",{email:e,status:r.default.prototype.STATUS_OK}),u.default.track("billingstatement_send",{email:e})):t===r.default.prototype.STATUS_PENDING&&(c.default.trigger("profile:showPaymentStatementModal",{email:e,status:r.default.prototype.STATUS_PENDING}),u.default.track("billingstatement_pending"))}).fail(function(){c.default.trigger("profile:showPaymentStatementModal",{email:e,status:r.default.prototype.STATUS_ERROR}),u.default.track("billingstatement_error")})},showLoginModal:function(){return l.default.trigger("auth:showRegModal"),!1},disableForm:function(){this.$submitButton.addClass("disabled"),this.$input.attr("disabled","disabled")},enableForm:function(){this.$submitButton.removeClass("disabled"),this.$input.removeAttr("disabled")}})},function(e,t,i){function n(e){return a.default.render('<div class="receipt {% if expanded %} expanded {% endif %}"> <div class="receipt__button"> <div class="ivi-button large outline js-receipt-button">Получить выписку на email</div> </div> <div class="receipt__form"> <div class="ivi-input"> <input type="text" class="js-email-input" maxlength="255" value="{{ email }}" placeholder="{% if isMobile %}Email для получения выписки{% else %}Введите email для получения выписки{% endif %}"> </div> <button class="ivi-button large outline js-submit">Получить выписку</button> <div class="receipt__info"> При повторном запросе придётся вводить email снова, <a href="#" id="js-show-login">зарегистрируйтесь</a> с помощью email и получайте выписку в один клик </div> </div></div>',e)}var a=i(2);t.default=n},function(e,t,i){var n=i(1),a=i(14);t.default=a.default.extend({uri:"/billing/v1/statement/send",PENDING_ERROR_CODE:1230,STATUS_OK:"ok",STATUS_PENDING:"pending",STATUS_ERROR:"error",sendStatement:function(){var e=this,t=n.Deferred();return this.mapiPost().done(function(i){i&&i.result===e.STATUS_OK?t.resolve(e.STATUS_OK):i&&i.error&&i.error.code===e.PENDING_ERROR_CODE?t.resolve(e.STATUS_PENDING):t.reject()}).fail(function(){t.reject()}),t.promise()}})},function(e,t,i){function n(e){return a.default.render('<section class="posters-block js-purchases-block"> {% if purchaseOptions.hasPurchaseVideoOptions() %} <ul class="gallery posters-large js-popups-block"> {% for videoOption in purchaseOptions.getPurchaseVideoOptions()|slice(0, purchaseOptions.getVideoOptionsSelectionTo()) %} {% if videoOption.getVideoEntity() %} {% set video = videoOption.getVideoEntity() %} <li data-content-id="{{ video.getId() }}" data-content-type="{% if video.isCompilation() %}compilation{% else %}content{% endif %}" data-content-position="{{ loop.index }}" {% if video.isPreorderable() %}class="info"{% endif %}> <a href="{{ video.getSpecificWatchLink(true) }}" class="item-content-wrapper js-collection-content{% if video.isForAdult() %} js-adult{% endif %}"> <span class="image" data-caption="{% if video.isPreorderable() %}{{ video.getPosterSpecificCaption(isMobile) }}{% else %}Смотреть{% if video.isFake() %} трейлер{% endif %}{% endif %}"> <img src="{{ video.getPosterPath("/172x264/") }}" alt="{{ video.getTitle() }} (Сезон {{ video.getSeason() }})"> <span class="age-limit" data-value="{{ video.getRestrict()|default(0) }}+"></span> </span> <span class="title"><span>{% if video.isCompilation() %}{{ video.getTitle() }}{% if video.getSeason() %} (Сезон {{ video.getSeason() }}){% endif %}{% else %}{{ video.getTitle() }}{% endif %}</span></span> </a> </li> {% endif %} {% if videoOption.getCollectionEntity() %} {% set collection = videoOption.getCollectionEntity() %} <li data-collection-id="{{ collection.getId() }}" data-content-type="collection" data-content-position="{{ loop.index }}"> <a href="{{ collection.getLink() }}" class="item-content-wrapper js-collection-content"> <span class="image" data-caption="В коллекцию"> <img src="{{ collection.getPosterPath() }}/172x264/" alt="{{ collection.getTitle() }}"> </span> <span class="title"> <span>{{ collection.getTitle() }}</span> </span> </a> </li> {% endif %} {% endfor %} </ul> {% else %} <div class="teaser"> <div class="title">У вас ещё нет купленных фильмов</div> <div class="note">Все купленные фильмы будут храниться здесь</div> {% if not isMobile and not isWorld %} <div class="actions"> <a href="/movies/blockbusters" class="ivi-button medium">Перейти в раздел с блокбастерами</a> </div> {% endif %} </div> {% endif %} {% if purchaseOptions.isMore() %} <a class="ivi-button large dark show-more no-mobile more-link">Показать ещё</a> {% endif %}</section><div id="js-payment-statement-form"></div>',e)}var a=i(2);t.default=n},function(e,t,i){var n=i(14);t.default=n.default.extend({uri:"/billing/v1/summary",hasCredits:function(){return!!this.get("credits")}})},function(e,t,i){var n=i(103),a=i(29),s=i(345);t.default=s.default.extend(n.default).extend({totalCount:40,scenarioId:"MAIN_PAGE",mapiGet:function(){var e={data:{top:this.totalCount,scenario_id:this.scenarioId}};return a.default.prototype.mapiGet.call(this,e)}})},function(e,t,i){var n=i(1),a=i(58),s=i(51),o=i(44),r=i(75),l=i(819);t.default=a.default.extend(s.default).extend({tabEl:"#js-favorites",template:l.default,events:{"click .js-recommendations-block .more-link":"loadMore"},grootPage:"profile_wanted",grootRefPage:"profile_wanted",viewListSent:!1,videosPerPage:10,initialize:function(e){a.default.prototype.initialize.call(this,{waypoint:!0}),e.setSelectionFrom(0),e.setSelectionTo(this.videosPerPage),this.loadData(e),this.mainCollection=e,this.templateParams.recommendationsListModel=e,this.listenTo(r.default,"collection:favoriteListMoreDataIsAvailable",this.prepareCollection)},afterShow:function(){a.default.prototype.afterShow.call(this),this.attachPosterPopup(this.$el.find("li")),this.viewListSent||(o.default.viewList(n(".js-recommendations-block")),this.viewListSent=!0)},loadMore:function(){this.mainCollection.increaseSelection(this.videosPerPage),this.show(!1)}})},function(e,t,i){function n(e){return a.default.render('<section class="posters-block js-recommendations-block"> <div class="teaser"> <div class="title">У вас нет фильмов, добавленных для просмотра позже</div> <div class="note">Все фильмы, которые вы добавите, будут храниться здесь</div> </div> <h2 class="content-title">Рекомендованные вам фильмы</h2> <ul class="gallery posters-large js-popups-block"> {% for video in recommendationsListModel.getVideoList()|slice(0, recommendationsListModel.getSelectionTo()) %} <li class="{% if video.isInfoVideo() or video.isPreorderable() %}info {% endif %}{% if abExperiment.useNewPriceBadges() %}{{ video.getNewPriceBadgeClasses(abExperiment.showFreeBadge(), hasSubscription) }}{% else %}{{ video.getPaidIcon() }}{% endif %}" data-content-id="{{ video.getId() }}" data-content-type="{% if video.getCompilationTitle() %}compilation{% else %}content{% endif %}" data-content-position="{{ loop.index }}"> <a href="{{ video.getPosterSpecificLink(hasSubscription) }}" class="item-content-wrapper js-collection-content{% if video.isForAdult() %} js-adult{% endif %}"> <span class="image" data-caption="{% if video.isSvod() %}{{ video.getPosterSpecificCaption(hasSubscription) }}{% else %}{{ video.getPosterSpecificCaption() }}{% endif %}"> <img src="{{ video.getPosterPath("/172x264/") }}" alt="{{ video.getTitle() }}"> <span class="age-limit" data-value="{{ video.getRestrict()|default(0) }}+"></span> {% if abExperiment.useNewPriceBadges() %} <div class="badge"> <div class="badge__content" data-badge-content="{{ video.getNewPriceBadgeTitle(abExperiment.showFreeBadge(), hasSubscription) }}"></div> </div> {% endif %} </span> <span class="title"><span>{% if video.getCompilationTitle() %}{{ video.getCompilationTitle() }}{% else %}{{ video.getTitle() }}{% endif %}</span></span> </a> <div class="popup-wrapper" data-hru="{% if video.isCompilation() %}{{ video.getHru() }}{% else %}{{ video.getId() }}{% endif %}"></div> </li> {% endfor %} </ul> {% if recommendationsListModel.isMore(selectionSize) %} <a class="ivi-button large outline show-more no-mobile more-link">Показать еще</a> {% endif %}</section>',e)}var a=i(2);t.default=n},function(e,t,i){var n=i(58),a=i(821);t.default=n.default.extend({tabEl:"#js-reviews",template:a.default,events:{"click .js-reviews-block .more-link":"loadMore"},selectionSize:20,initialize:function(e){n.default.prototype.initialize.call(this,{waypoint:!0}),this.mainCollection=e,this.mainCollection.setSelectionFrom(0),this.mainCollection.setSelectionTo(this.selectionSize),this.loadData(this.mainCollection),this.templateParams.reviewsList=this.mainCollection}})},function(e,t,i){function n(e){return a.default.render('<section class="reviews-block js-reviews-block"> {% if reviewsList.models.length %} <span class="total-rating">Общий рейтинг ваших рецензий: {{ reviewsList.getRating() }}</span> <ul class="reviews"> {% for review in reviewsList.models %} <li> <div class="votes-container"> <span class="votes static"> <span class="value {% if review.getLikesBalance() > 0 %} positive{% elseif review.getLikesBalance() < 0 %} negative{% endif %}">{{ review.getLikesBalance() }}</span> <span class="vote-action minus"></span> <span class="vote-action plus"></span> </span> </div> <div class="title-container"> {% if review.getUrl() %} <a href="{{ review.getUrl() }}">{{ review.getTitle() }}</a> {% else %} <span>{{ review.getTitle() }}</span> {% endif %} </div> <span class="numeric-rating">(оценка {{ review.getUserRate() }} из 10)</span> <time>{{ internationalExpansion.getLocalDateTime(review.getAdded())|locale_date("d MMMM y") }}</time> </li> {% endfor %} </ul> {% if reviewsList.isMore(selectionSize) %} <a class="more-link"><span>Показать еще</span></a> {% endif %} {% else %} <div class="text-block">У вас нет рецензий</div> {% endif %}</section>',e)}var a=i(2);t.default=n},function(e,t,i){var n=i(16),a=i(11),s=i(3),o=i(30),r=i(823),l=i(824),d=i(825),u=i(826),c=i(827);t.default=n.default.extend({modalId:"js-profile-subscription-autoprolong-modal-wrapper",template:"",openEvent:"profile:unsubscribe:modal",regionEnabled:!0,mobileModal:!0,events:{"click .js-unsubscribe":"continueUnsubscribtion","click .js-unsubscribe-cancel":"cancelUnsubscribtion","click .js-unsubscribe-android":"continueUnsubscribeAndroid","click #confirm-email":"continueUnsubscribeIos"},modalShowGrootEvent:"sub_cancel_popup_imp",initialize:function(e){n.default.prototype.initialize.call(this,e),this.listenTo(a.default,"billing:setAutoprolongSuccess",this.closeModal),this.listenTo(a.default,"billing:setAutoprolongError",this.closeModal)},open:function(e,t,i){this.setTemplate(e.subscriptionOption),n.default.prototype.open.call(this,e,t,i),s.default.track(this.modalShowGrootEvent)},setTemplate:function(e){e.isRebilling()?this.template=d.default:e.isAndroidPayment()?this.template=r.default:e.isIOSPayment()?this.template=l.default:e.isTrialSubscription()?this.template=c.default:this.template=u.default},serializeData:function(){return{subscriptionExpireDate:this.eventParams.subscriptionOption.getSubscriptionExpireDate()}},continueUnsubscribtion:function(){s.default.track("unsubscribe_confirmed",this.eventParams.grootParams),this.triggerCancel(),o.default.trigger("profile:unsubscribe")},cancelUnsubscribtion:function(){s.default.track("unsubscribe_cancel",this.eventParams.grootParams),this.triggerCancel()}})},function(e,t,i){function n(e){return a.default.render('<div class="ivi-modal-wrapper-content simple-basic"> <h1 class="ivi-modal-title">Управление подпиской</h1> <div class="ivi-modal-content wider"> <p>Отменить подписку вы можете только в настройках своего планшета или телефона на Android. Подробную информацию, как это сделать вы можете посмотреть <a href="http://ask.ivi.ru/topic/574258-kak-otmenit-avtomaticheskoe-spisanie-sredstv-s-google-koshelka-s-privyazannoj-kartyi-za-podpisku-ivi/">здесь</a>.</p> <div class="button-wrapper"> <span class="ivi-button large js-unsubscribe-cancel">Ок</span> </div> </div> <span class="ivi-modal-close js-unsubscribe-cancel">Закрыть</span></div>',e)}var a=i(2);t.default=n},function(e,t,i){function n(e){return a.default.render('<div class="ivi-modal-wrapper-content simple-basic"> <h1 class="ivi-modal-title">Управление подпиской</h1> <div class="ivi-modal-content"> <p>Отменить подписку вы можете только в настройках своего iPad/iPhone. Подробную информацию, как это сделать, вы можете посмотреть <a href="http://ask.ivi.ru/topic/574250-kak-otmenit-avtomaticheskoe-spisanie-sredstv-na-ios-s-privyazannoj-kartyi-za-podpisku-ivi/">здесь</a>.</p> <div class="button-wrapper align-right"> <span class="ivi-button large js-unsubscribe-cancel">Ок</span> </div> </div> <span class="ivi-modal-close js-unsubscribe-cancel">Закрыть</span></div>',e)}var a=i(2);t.default=n},function(e,t,i){function n(e){return a.default.render('<div class="ivi-modal-wrapper-content subscription-cancel"> <h1 class="ivi-modal-title">Вы действительно хотите отключить подписку?</h1> <div class="ivi-modal-content"> <div class="text-wrapper">Вы потеряете</div> <ul class="ticks large"> {% if not isWorld %} <li>Просмотр фильмов без рекламы</li> <li>Дополнительный каталог</li> <li>Качество Full HD 1080p</li> <li>Фильмы в подарок каждую пятницу</li> <li>Скачивание на устройства</li> {% else %} <li>Возможность смотреть фильмы, сериалы и мультфильмы на ivi</li> {% endif %} </ul> <div class="button-wrapper"> <a class="ivi-button large js-unsubscribe-cancel">Не отключать</a> <a class="ivi-button large neutral js-unsubscribe">Отключить</a> </div> </div> <span class="ivi-modal-close js-unsubscribe-cancel">Закрыть</span></div>',e)}var a=i(2);t.default=n},function(e,t,i){function n(e){return a.default.render('<div class="ivi-modal-wrapper-content subscription-cancel"> <h1 class="ivi-modal-title">Вы действительно хотите отключить подписку?</h1> <div class="ivi-modal-content"> <div class="text-wrapper"><b>{{ internationalExpansion.getLocalDateTime(subscriptionExpireDate)|date("d.m.Y") }}</b> вы потеряете</div> <ul class="ticks large"> {% if not isWorld %} <li>Просмотр фильмов без рекламы</li> <li>Дополнительный каталог</li> <li>Качество Full HD 1080p</li> <li>Фильмы в подарок каждую пятницу</li> <li>Скачивание на устройства</li> {% else %} <li>Возможность смотреть фильмы, сериалы и мультфильмы на ivi</li> {% endif %} </ul> <div class="button-wrapper"> <a class="ivi-button large js-unsubscribe-cancel">Не отключать</a> <a class="ivi-button large neutral js-unsubscribe">Отключить</a> </div> </div> <span class="ivi-modal-close js-unsubscribe-cancel">Закрыть</span></div>',e)}var a=i(2);t.default=n},function(e,t,i){function n(e){return a.default.render('<div class="ivi-modal-wrapper-content subscription-cancel"> <h1 class="ivi-modal-title">Вы действительно хотите отключить подписку?</h1> <div class="ivi-modal-content"> <div class="text-wrapper">Вы потеряете</div> <ul class="ticks large"> {% if not isWorld %} <li>Просмотр фильмов без рекламы</li> <li>Дополнительный каталог</li> <li>Качество Full HD 1080p</li> <li>Фильмы в подарок каждую пятницу</li> <li>Скачивание на устройства</li> {% else %} <li>Возможность смотреть фильмы, сериалы и мультфильмы на ivi</li> {% endif %} </ul> <div class="button-wrapper"> <a class="ivi-button large js-unsubscribe-cancel">Не отключать</a> <a class="ivi-button large neutral js-unsubscribe">Отключить</a> </div> </div> <span class="ivi-modal-close js-unsubscribe-cancel">Закрыть</span></div>',e)}var a=i(2);t.default=n},function(e,t,i){var n=i(1),a=i(58),s=i(829),o=i(75),r=i(30),l=i(831);t.default=a.default.extend({tabEl:"#js-watched",template:l.default,events:{"click .remove-link":"removeFromWatched","click .js-watched-block .more-link":"loadMore","mouseover .watched .remove-link":"highlightLineBlock"},selectionSize:20,grootPage:"profile_history",grootRefPage:"profile_history",waypointTrigger:14,initialize:function(e){a.default.prototype.initialize.call(this,{waypoint:!0}),(new s.default).listen(r.default),this.mainCollection=e,this.mainCollection.setSelectionFrom(0),this.mainCollection.setSelectionTo(this.selectionSize),this.loadData(this.mainCollection),this.templateParams.watchedList=this.mainCollection,this.listenTo(o.default,"collection:deleteWatchedSuccess",this.removedFromWatched),this.listenTo(o.default,"collection:watchedListMoreDataIsAvailable",this.show),window.ivi.adaptive.isMobile&&this.listenTo(r.default,"profile:removeFromWatched",this.removeFromWatched)},cssRoutine:function(){n(".watched .remove-link").hover(function(){n(this).parent().addClass("active")},function(){n(this).parent().removeClass("active")})},removeFromWatched:function(e,t){return t=e?n(e.currentTarget).parent().data("id"):t,window.ivi.adaptive.isMobileStyle&&e?r.default.trigger("profile:showMobileRemoveFromWatchedModal",this.mainCollection.findWhere({id:t})):this.mainCollection.deleteFromWatched(t),!1},removedFromWatched:function(e){var t=n("li[data-id="+e.getId()+"]"),i=t.parent();t.remove(),this.mainCollection.remove(e.getId()),0===i.children("li").length&&(i.prev().remove(),i.remove())},afterShow:function(){this.cssRoutine(),a.default.prototype.afterShow.call(this)}})},function(e,t,i){var n=i(16),a=i(30),s=i(830);t.default=n.default.extend({openEvent:"profile:showMobileRemoveFromWatchedModal",regionEnabled:!0,template:s.default,events:{"click .js-remove-from-watched":"continueRemoveFromWatched"},mobileModal:!0,initialize:function(){window.ivi.adaptive.isMobile&&window.addEventListener("orientationchange",this.handleOrientationChangeEvent.bind(this))},handleOrientationChangeEvent:function(){window.ivi.adaptive.isMobileStyle||this.triggerCancel()},serializeData:function(){return{video:this.eventParams}},continueRemoveFromWatched:function(){this.triggerCancel(),a.default.trigger("profile:removeFromWatched",void 0,this.eventParams.get("id"))}})},function(e,t,i){function n(e){return a.default.render('{% if video.getCompilationTitle() %} {% set videoTitle = video.getCompilationTitle() ~ " (" ~ video.getTitle() ~ ")" %}{% else %} {% set videoTitle = video.getTitle() %}{% endif %}<div class="ivi-modal-wrapper-content remove-favorite wider"> <h1 class="ivi-modal-title">Удалить из списка «Смотреть позже»?</h1> <div class="ivi-modal-content"> <div class="remove-item-target"> <figure class="poster"> <img src="{{ video.getPosterPath("/86x132/") }}" title="{{ videoTitle }}" itemprop="image"> </figure> <p>{{ videoTitle }}</p> </div> <div class="button-wrapper"> <a class="ivi-button pale large js-modal-close">Отменить</a> <a class="ivi-button large js-remove-from-watched">Удалить</a> </div> </div> <span class="ivi-modal-close js-modal-close">Закрыть</span></div>',e)}var a=i(2);t.default=n},function(e,t,i){function n(e){return a.default.render('<section class="watched-block js-watched-block"> {% if watchedList.models.length %} {% for watchYear in watchedList.getWatchedListByYear() %} <h3>{{ watchYear.year }}</h3> <ul class="watched"> {% for watchedVideo in watchYear.videoList %} <li data-id="{{ watchedVideo.getId() }}" data-hru="{{ watchedVideo.getHru() }}"> <time>{{ internationalExpansion.getLocalDateTime(watchedVideo.getWatchDate())|date("d MMMM") }}</time> <strong> <a href="{{ watchedVideo.getWatchLink(watchedVideo.isBought()) }}"> {% if watchedVideo.getCompilationTitle() %} {{ watchedVideo.getCompilationTitle() }} ({{ watchedVideo.getTitle() }}) {% else %} {{ watchedVideo.getTitle() }} {% endif %} </a> </strong> <a href="" class="remove-link" >Удалить</a> </li> {% endfor %} </ul> {% endfor %} {% if watchedList.isMore(selectionSize) %} <a class="ivi-button large outline show-more no-mobile more-link">Показать еще</a> {% endif %} {% else %} <div class="teaser"> <div class="title">У вас ещё нет просмотренных фильмов</div> <div class="note">Все просмотренные фильмы будут храниться здесь</div> </div> {% endif %}</section>',e)}var a=i(2);t.default=n},function(e,t,i){var n=i(16),a=i(833);t.default=n.default.extend({modalId:"js-success-payment-statement",template:a.default,openEvent:"profile:showPaymentStatementModal",regionEnabled:!0,priorityModal:!0,mobileModal:!0,serializeData:function(){return{email:this.eventParams.email,status:this.eventParams.status}}})},function(e,t,i){function n(e){return a.default.render('<div class="ivi-modal-wrapper-content transaction-send"> <h1 class="ivi-modal-title"> Заявка {% if status|default("error") == "error" %}не{% endif %} принята </h1> <div class="ivi-modal-content"> {% if status|default("error") == "ok" %} <p>Выписка будет подготовлена и отправлена в течение нескольких минут на {{ email }}</p> {% elseif status|default("error") == "pending" %} <p>Ваша заявка на выписку уже обрабатывается. Повторно запросить выписку можно через час.</p> {% else %} <p>Что-то пошло не так. Пожалуйста, попробуйте ещё раз.</p> {% endif %} </div> <span class="ivi-modal-close js-modal-close">Закрыть</span></div>',e)}var a=i(2);t.default=n},function(e,t,i){var n=i(21),a=i(16),s=i(346),o=i(8),r=i(22),l=i(72),d=i(840),u=i(841),c=i(3),p=i(30),f=i(7),h=s.default.extend({modalId:"bind-phone-modal",wrapper:a.default.prototype.wrapper+"-bind-phone",openEvent:"profile:bindContacts:phone",additionalStatuses:{STATUS_EMAIL_PASSWORD:4,STATUS_SUCCESS:5},grootPageStatusRel:{1:"enter_add_phone",2:"confirm_add_phone",3:"error_add_phone",4:"password_add_phone",5:"success_add_phone"},initialize:function(){s.default.prototype.initialize.apply(this,arguments),this.onTokenInput=this.handleInput.bind(this,"phoneToken"),this.onTokenSubmit=this.handlePhoneToken.bind(this),this.onEmailPasswordInput=this.handleInput.bind(this,"password"),this.onEmailPasswordSubmit=this.bindBegin.bind(this),this.onReturnToProfileClick=this.closeModal.bind(this),this.statuses=n.__assign({},this.statuses,this.additionalStatuses),this.model.resetLoadings()},listenModalEvents:function(){this.listenTo(p.default,"profile:bindContacts:phone:beginSuccess",this.onBindStartSuccess),this.listenTo(p.default,"profile:bindContacts:phone:beginError",this.onError),this.listenTo(p.default,"profile:bindContacts:phone:confirmSuccess",this.onBindConfirmSuccess),this.listenTo(p.default,"profile:bindContacts:phone:confirmError",this.onError),this.listenTo(f.default,"auth:validateAuthToken:success",this.onPhoneTokenValidateSuccess),this.listenTo(f.default,"auth:request:error",this.onPhoneTokenValidateError)},stopListeningModalEvents:function(){this.stopListening(p.default,"profile:bindContacts:phone:beginSuccess",this.onBindStartSuccess),this.stopListening(p.default,"profile:bindContacts:phone:beginError",this.onError),this.stopListening(p.default,"profile:bindContacts:phone:confirmSuccess",this.onBindConfirmSuccess),this.stopListening(p.default,"profile:bindContacts:phone:confirmError",this.onError),this.stopListening(f.default,"auth:validateAuthToken:success",this.onPhoneTokenValidateSuccess),this.stopListening(f.default,"auth:request:error",this.onPhoneTokenValidateError)},renderReact:function(){s.default.prototype.renderReact.apply(this,arguments);var e=this.serializeData(),t=this.getBlocksPositions();this.renderReactComponent(d.default,".js-bind-contacts-email-password-react-wrapper",e,t.emailPasswordBlockPosition),this.renderReactComponent(u.default,".js-bind-contacts-success-react-wrapper",e,t.successBlockPosition)},serializeData:function(){var e=s.default.prototype.serializeData.apply(this,arguments),t={bindPhone:!0,onTokenInput:this.onTokenInput,onEmailPasswordInput:this.onEmailPasswordInput,emailToken:o.default.getEmail(),phoneToken:this.model.get("phoneToken"),formattedPhone:this.model.getFormattedPhone(),onTokenSubmit:this.onTokenSubmit,onEmailPasswordSubmit:this.onEmailPasswordSubmit,onReturnToProfileClick:this.onReturnToProfileClick};return n.__assign({},e,t)},getBlocksPositions:function(){var e=l.FullscreenPopupBlockPosition.LEFT,t=l.FullscreenPopupBlockPosition.RIGHT,i=l.FullscreenPopupBlockPosition.RIGHT,n=l.FullscreenPopupBlockPosition.RIGHT,a=l.FullscreenPopupBlockPosition.RIGHT;switch(this.model.get("status")){case this.statuses.STATUS_TOKEN:e=l.FullscreenPopupBlockPosition.CENTER;break;case this.statuses.STATUS_VERIFY_PHONE_BY_SMS:i=l.FullscreenPopupBlockPosition.CENTER,t=l.FullscreenPopupBlockPosition.LEFT;break;case this.statuses.STATUS_ERROR:n=l.FullscreenPopupBlockPosition.CENTER,t=l.FullscreenPopupBlockPosition.LEFT;break;case this.statuses.STATUS_EMAIL_PASSWORD:t=l.FullscreenPopupBlockPosition.CENTER;break;case this.statuses.STATUS_SUCCESS:i=l.FullscreenPopupBlockPosition.LEFT,a=l.FullscreenPopupBlockPosition.CENTER}return{tokenBlockPosition:e,emailPasswordBlockPosition:t,verifyPhoneBySMSBlockPosition:i,errorBlockPosition:n,successBlockPosition:a}},setModalControls:function(){s.default.prototype.setModalControls.apply(this,arguments);var e=this.$el.find(".fullscreen-popup");switch(this.model.get("status")){case this.statuses.STATUS_SUCCESS:e.addClass("fullscreen-popup_has-close-view-button");break;case this.statuses.STATUS_EMAIL_PASSWORD:e.addClass("fullscreen-popup_has-previous-view-button")}},handlePhoneToken:function(e){c.default.track("next_step_add");var t=this.phoneNumberHelper.getFormattedRussianPhone(this.model.get("phoneToken"));this.model.setFormattedPhone(t),this.model.setVisibleToken(t),r.default.validateAuthToken({authToken:this.model.get("phoneToken"),expectedType:"phone"}),e.preventDefault()},onPhoneTokenValidateSuccess:function(){"register"===r.default.get("action")?this.model.setStatus(this.statuses.STATUS_EMAIL_PASSWORD):(this.model.setStatus(this.statuses.STATUS_ERROR),this.model.setErrorCode(this.BIND_TOKEN_EXISTS_ERROR_CODE)),this.moveToNextStep()},onPhoneTokenValidateError:function(e,t){this.model.set({code:t,message:e}),this.onError()},onBindNextToken:function(){c.default.track("other_phone_add"),this.model.deletePhoneToken(),this.moveToPrevStep()},onErrorGroot:function(){c.default.track("error_add_phone")},onBindConfirmSuccess:function(){this.model.setStatus(this.statuses.STATUS_SUCCESS),s.default.prototype.onBindConfirmSuccess.apply(this,arguments)}});t.default=h},function(e,t,i){var n=i(21),a=i(31),s=i(347),o=i(104),r=i(72),l=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t.prototype.getInputProps=function(){var e=["style_default size_large"],t="",i="";return this.props.bindEmail?(i=this.props.emailToken,e.push("icon_user"),t="bindContactsEmailToken"):(i=this.props.phoneToken,e.push("icon_phone"),t="bindContactsPhoneToken"),{addClasses:e.join(" "),id:"bindContactsTokenInput",name:t,tooltipMessage:this.props.message,error:!!this.props.code,onInput:this.props.onTokenInput,value:i}},t.prototype.render=function(){var e="",t="",i="",l="",d="",u="";return this.props.bindEmail?(e="Введите свой email",t="Привязка email к профилю",i=this.props.formattedPhone,l="Укажите email, который хотите привязать",d="add-contacts__enter-email",u=this.props.emailToken):(e="Введите телефон",t="Привязка телефона к профилю",i=this.props.emailToken,l="Укажите номер телефона, который хотите привязать",d="add-contacts__enter-phone",u=this.props.phoneToken),a.createElement(r.default,{addClasses:"add-contacts add-contacts_modal-multiple",position:this.props.position},a.createElement("div",{className:"add-contacts__container"},a.createElement("div",{className:"add-contacts__container-inner"},a.createElement("div",{className:"add-contacts__content"},a.createElement("div",{className:"add-contacts__badge"},a.createElement("span",{className:"add-contacts__user-badge user-badge\n                                        user-badge_full-width user-badge_depicts-not-authorized medium"},a.createElement("span",{className:"user-badge__icon"}))),a.createElement("div",{className:"add-contacts__title"},t),a.createElement("div",{className:"add-contacts__value"},i),a.createElement("div",{className:"add-contacts__step-wrapper"},a.createElement("div",{className:"add-contacts__step"},"Шаг 1 из 3"),a.createElement("div",{className:"add-contacts__action"},l),a.createElement("div",{className:d},a.createElement("form",{id:"jsBindContactsToken",className:"add-contacts__form add-contacts__form_fix-width",action:"#",onSubmit:this.props.onTokenSubmit},a.createElement(s.default,n.__assign({},this.getInputProps()),e),a.createElement(o.default,{addClasses:"add-contacts__ivi-button",size:o.default.SIZES.large,loading:this.props.isTokenChecking,type:"submit",disabled:!u||!!this.props.code},"Продолжить"),a.createElement("p",{className:"add-contacts__additional-info"},"В дальнейшем вы сможете его использовать для взаимодействия с сервисом и входа на других платформах"))))))))},t}(a.Component);t.default=l},function(e,t,i){var n=i(21),a=i(31),s=i(72),o=i(104),r=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t.prototype.getSupportContactsHtml=function(){var e=this.props.supportContacts;if(!e||!e.getPhone()&&!e.getEmail())return null;var t=["add-contacts__support"];e.getPhone()&&e.getEmail()||t.push("add-contacts__support_only");var i=null;if(e.getPhone()){var n="tel:"+e.getPhone();i=a.createElement("div",{className:"add-contacts__support-item"},a.createElement("div",{className:"add-contacts__support-icon add-contacts__support-icon_phone"}),a.createElement("p",{className:"add-contacts__support-value"},a.createElement("span",{className:"add-contacts__support-value-info"},"Позвонить по номеру",a.createElement("br",null)),a.createElement("a",{href:n},e.getPhone())))}var s=null;if(e.getEmail()){var n="mailto:"+e.getEmail();s=a.createElement("div",{className:"add-contacts__support-item"},a.createElement("div",{className:"add-contacts__support-icon add-contacts__support-icon_mail"}),a.createElement("p",{className:"add-contacts__support-value"},a.createElement("span",{className:"add-contacts__support-value-info"},"Написать на",a.createElement("br",null)),a.createElement("a",{href:n},e.getEmail())))}return a.createElement("div",{className:t.join(" ")},a.createElement("div",{className:"add-contacts__support-inner"},a.createElement("h2",{className:"add-contacts__support-title"},"Обратитесь в поддержку"),a.createElement("div",{className:"add-contacts__support-item-wrap"},i,s)))},t.prototype.getErrorCauseElement=function(){var e=this.props.bindEmail?"email":"телефон",t=this.props.bindEmail?e:e+"а";return a.createElement("div",{className:"add-contacts__content"},a.createElement("div",{className:"add-contacts__badge\n                        add-contacts__badge_status\n                        add-contacts__badge_status_error"}),a.createElement("div",{className:"add-contacts__title"},"Произошла ошибка"),a.createElement("div",{className:"add-contacts__value"},this.props.visibleToken),a.createElement("div",{className:"add-contacts__status"},a.createElement("p",{className:"add-contacts__additional-info"},"При попытке привязать ",e," произошла ошибка. Проверьте правильность указанного ",t," или обратитесь в поддержку"),a.createElement(o.default,{addClasses:"add-contacts__ivi-button",size:o.default.SIZES.large,onClick:this.props.onBindNextToken},"Ввести другой ",e)))},t.prototype.render=function(){return a.createElement(s.default,{addClasses:"add-contacts add-contacts_modal-multiple",position:this.props.position},a.createElement("div",{className:"add-contacts__container"},a.createElement("div",{className:"add-contacts__container-inner"},this.getErrorCauseElement()),this.getSupportContactsHtml()))},t}(a.Component);t.default=r},function(e,t,i){var n=i(21),a=i(31),s=i(72),o=i(348),r=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t.prototype.getTitle=function(){return this.props.bindEmail?"Привязка email к профилю":"Привязка телефона к профилю"},t.prototype.getFormId=function(){return"jsValidatePhoneBySmsOnBind"+(this.props.bindEmail?"Email":"Phone")},t.prototype.render=function(){var e=["add-contacts__step-wrapper"];return this.props.code&&this.props.code!==o.default.SMS_RATE_LIMIT_EXCEEDED_CODE&&e.push("add-contacts__step-wrapper_error-active"),a.createElement(s.default,{addClasses:"add-contacts add-contacts_modal-multiple",position:this.props.position},a.createElement("div",{className:"add-contacts__container"},a.createElement("div",{className:"add-contacts__container-inner"},a.createElement("div",{className:"add-contacts__content"},a.createElement("div",{className:"add-contacts__badge"},a.createElement("span",{className:"add-contacts__user-badge user-badge user-badge_full-width\n                                        user-badge_depicts-not-authorized medium"},a.createElement("span",{className:"user-badge__icon"}))),a.createElement("div",{className:"add-contacts__title"},this.getTitle()),a.createElement("div",{className:"add-contacts__value"},this.props.bindEmail?this.props.formattedPhone:this.props.emailToken),a.createElement("div",{className:e.join(" ")},a.createElement("div",{className:"add-contacts__step"},"Шаг ",this.props.bindEmail?"2":"3"," из 3"),a.createElement("div",{className:"add-contacts__action"},"Введите код из смс"),a.createElement("div",{className:"add-contacts__event"},"Смс с кодом отправлено на номер ",a.createElement("span",{className:"add-contacts__event-phone"},this.props.formattedPhone)),a.createElement("div",{className:"add-contacts__event add-contacts__event_error"},this.props.message),a.createElement("div",{className:"add-contacts__code"},a.createElement("form",{id:this.getFormId(),className:"add-contacts__form add-contacts__form_code",action:"#"},a.createElement(o.default,{smsLeft:this.props.smsLeft,errorCode:this.props.code,smsSending:this.props.isTokenChecking,codeCheking:this.props.isVerifyPhoneBySMSChecking,smsCodeSent:this.props.smsCodeSent,visible:this.props.position===s.FullscreenPopupBlockPosition.CENTER,onSmsCodeFillingComplete:this.props.onSmsCodeFillingComplete,onSmsCodeInput:this.props.onSmsCodeInput,onSmsCodeResend:this.props.onSmsCodeResend}))))))))},t}(a.Component);t.default=r},function(e,t,i){function n(e){return a.default.render('<div class="fullscreen-popup fullscreen-popup_active fullscreen-popup_has-close-view-button"> <div class="fullscreen-popup__overlay"> <span></span> <span></span> <span></span> </div> <div class="fullscreen-popup__scroll-wrapper"> <div class="fullscreen-popup__wrapper js-bind-contacts-wrapper"> <a class="fullscreen-popup__previous-view-button js-back-button" href="#" title="Нажмите, чтобы перейти на шаг назад"> Назад </a> <a class="fullscreen-popup__close-view-button js-modal-close" href="#" title="Нажмите, чтобы закрыть форму"> Закрыть окно </a> <div class="js-bind-contacts-token-react-wrapper"></div> <div class="js-bind-contacts-email-password-react-wrapper"></div> <div class="js-bind-contacts-error-react-wrapper"></div> <div class="js-bind-contacts-verify-phone-by-sms-react-wrapper"></div> <div class="js-bind-contacts-success-react-wrapper"></div> <div class="js-bind-contacts-confirm-react-wrapper"></div> </div> </div></div>',e)}var a=i(2);t.default=n},function(e,t){var i=function(){function e(){}return e.prototype.vibrate=function(e){if(!this.featureNotAvailable&&window.ivi.adaptive.isMobile)try{window.navigator.vibrate(e)}catch(e){this.featureNotAvailable=!0}},e.prototype.vibrateShortPeriod=function(){this.vibrate(e.SHORT_VIBRATION_DURATION)},e.SHORT_VIBRATION_DURATION=200,e}();t.default=new i},function(e,t,i){var n=i(21),a=i(31),s=i(72),o=i(347),r=i(104),l=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t.prototype.getInputProps=function(){return{addClasses:"style_default size_large icon_password",id:"bindContactsEmailPassword",name:"bindContactsEmailToken",tooltipMessage:this.props.message,error:!!this.props.code&&this.props.position===s.FullscreenPopupBlockPosition.CENTER,onInput:this.props.onEmailPasswordInput,type:"password",value:this.props.password}},t.prototype.render=function(){return a.createElement(s.default,{addClasses:"add-contacts add-contacts_modal-multiple",position:this.props.position},a.createElement("div",{className:"add-contacts__container"},a.createElement("div",{className:"add-contacts__container-inner"},a.createElement("div",{className:"add-contacts__content"},a.createElement("div",{className:"add-contacts__badge"},a.createElement("span",{className:"add-contacts__user-badge user-badge user-badge_full-width\n                                        user-badge_depicts-not-authorized medium"},a.createElement("span",{className:"user-badge__icon"}))),a.createElement("div",{className:"add-contacts__title"},"Привязка телефона к профилю"),a.createElement("div",{className:"add-contacts__value"},this.props.emailToken),a.createElement("div",{className:"add-contacts__step-wrapper"},a.createElement("div",{className:"add-contacts__step"},"Шаг 2 из 3"),a.createElement("div",{className:"add-contacts__action"},"Введите свой пароль от ivi"),a.createElement("div",{className:"add-contacts__enter-email"},a.createElement("form",{id:"jsBindContactsEmailPassword",className:"add-contacts__form add-contacts__form_fix-width",action:"#",onSubmit:this.props.onEmailPasswordSubmit},a.createElement(o.default,n.__assign({},this.getInputProps()),"Введите пароль"),a.createElement(r.default,{addClasses:"add-contacts__ivi-button",size:r.default.SIZES.large,loading:this.props.isTokenChecking,type:"submit",disabled:this.props.isTokenChecking||!this.props.password||!!this.props.code},"Продолжить"))))))))},t}(a.Component);t.default=l},function(e,t,i){var n=i(21),a=i(31),s=i(72),o=i(104),r=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t.prototype.render=function(){return a.createElement(s.default,{addClasses:"add-contacts add-contacts_modal-multiple",position:this.props.position},a.createElement("div",{className:"add-contacts__container"},a.createElement("div",{className:"add-contacts__container-inner"},a.createElement("div",{className:"add-contacts__content"},a.createElement("div",{className:"add-contacts__badge add-contacts__badge_status\n                                    add-contacts__badge_status_success"}),a.createElement("div",{className:"add-contacts__title"},"Телефон успешно привязан"),a.createElement("div",{className:"add-contacts__value"},this.props.visibleToken),a.createElement("div",{className:"add-contacts__status"},a.createElement("p",{className:"add-contacts__additional-info"},"Теперь вы можете использовать телефон для взаимодействия с сервисом и для входа на любой платформе."),a.createElement(o.default,{addClasses:"add-contacts__ivi-button",disabled:!1,loading:!1,type:"button",size:o.default.SIZES.large,onClick:this.props.onReturnToProfileClick},"Вернуться в профиль"))))))},t}(a.Component);t.default=r},function(e,t,i){var n=i(349);t.default=n.default.extend({bindBeginUri:"/user/bind/phone/begin/v5/",bindConfirmUri:"/user/bind/phone/confirm/v5/",bindType:"phone",bindBegin:function(){this.sendBeginRequest({password:this.get("password"),phone:this.get("phoneToken")})}})},function(e,t,i){var n=i(21),a=i(16),s=i(346),o=i(22),r=i(8),l=i(72),d=i(844),u=i(3),c=i(30),p=s.default.extend({modalId:"bind-email-modal",wrapper:a.default.prototype.wrapper+"-bind-email",openEvent:"profile:bindContacts:email",additionalStatuses:{STATUS_CONFIRM:4},grootPageStatusRel:{1:"enter_add_mail",2:"sms_add_mail",3:"error_add_mail",4:"confirm_add_mail"},initialize:function(){s.default.prototype.initialize.apply(this,arguments),this.onTokenInput=this.handleInput.bind(this,"emailToken"),this.onTokenSubmit=this.bindBegin.bind(this),this.resendConfirmation=this.resendConfirmation.bind(this),this.statuses=n.__assign({},this.statuses,this.additionalStatuses),this.model.resetLoadings()},listenModalEvents:function(){this.listenTo(c.default,"profile:bindContacts:email:beginSuccess",this.onBindStartSuccess),this.listenTo(c.default,"profile:bindContacts:email:beginError",this.onError),this.listenTo(c.default,"profile:bindContacts:email:confirmSuccess",this.onBindConfirmSuccess),this.listenTo(c.default,"profile:bindContacts:email:confirmError",this.onError)},stopListeningModalEvents:function(){this.stopListening(c.default,"profile:bindContacts:email:beginSuccess",this.onBindStartSuccess),this.stopListening(c.default,"profile:bindContacts:email:beginError",this.onError),this.stopListening(c.default,"profile:bindContacts:email:confirmSuccess",this.onBindConfirmSuccess),this.stopListening(c.default,"profile:bindContacts:email:confirmError",this.onError)},renderReact:function(){s.default.prototype.renderReact.apply(this,arguments);var e=this.serializeData(),t=this.getBlocksPositions();this.renderReactComponent(d.default,".js-bind-contacts-confirm-react-wrapper",e,t.confirmBlockPosition)},serializeData:function(){var e=s.default.prototype.serializeData.apply(this,arguments),t={bindEmail:!0,emailToken:this.model.get("emailToken"),phoneToken:r.default.getMsisdn(),formattedPhone:r.default.getFormattedPhoneNumber(),onTokenSubmit:this.onTokenSubmit,resendConfirmation:this.resendConfirmation};return n.__assign({},e,t)},getBlocksPositions:function(){var e=l.FullscreenPopupBlockPosition.LEFT,t=l.FullscreenPopupBlockPosition.RIGHT,i=l.FullscreenPopupBlockPosition.RIGHT,n=l.FullscreenPopupBlockPosition.RIGHT;switch(this.model.get("status")){case this.statuses.STATUS_TOKEN:e=l.FullscreenPopupBlockPosition.CENTER;break;case this.statuses.STATUS_ERROR:i=l.FullscreenPopupBlockPosition.CENTER;break;case this.statuses.STATUS_VERIFY_PHONE_BY_SMS:t=l.FullscreenPopupBlockPosition.CENTER;break;case this.statuses.STATUS_CONFIRM:t=l.FullscreenPopupBlockPosition.LEFT,n=l.FullscreenPopupBlockPosition.CENTER}return{tokenBlockPosition:e,verifyPhoneBySMSBlockPosition:t,errorBlockPosition:i,confirmBlockPosition:n}},setModalControls:function(){s.default.prototype.setModalControls.apply(this,arguments);var e=this.$el.find(".fullscreen-popup");switch(this.model.get("status")){case this.statuses.STATUS_CONFIRM:e.addClass("fullscreen-popup_has-close-view-button")}},bindBegin:function(){this.model.setVisibleToken(this.model.get("emailToken")),s.default.prototype.bindBegin.apply(this,arguments)},onErrorGroot:function(){u.default.track("error_add_mail")},onBindNextToken:function(){u.default.track("other_mail_add"),this.model.deleteEmailToken(),this.moveToPrevStep()},onBindConfirmSuccess:function(){this.model.setStatus(this.statuses.STATUS_CONFIRM),s.default.prototype.onBindConfirmSuccess.apply(this,arguments)},resendConfirmation:function(){o.default.sendConfirmEmail(!1,!0),u.default.track("request_mail_add")}});t.default=p},function(e,t,i){var n=i(21),a=i(31),s=i(72),o=i(104),r=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t.prototype.render=function(){return a.createElement(s.default,{addClasses:"add-contacts add-contacts_modal-multiple",position:this.props.position},a.createElement("div",{className:"add-contacts__container"},a.createElement("div",{className:"add-contacts__container-inner"},a.createElement("div",{className:"add-contacts__content"},a.createElement("div",{className:"add-contacts__badge"},a.createElement("span",{className:"add-contacts__user-badge user-badge\n                                        user-badge_full-width user-badge_depicts-not-authorized medium"},a.createElement("span",{className:"user-badge__icon"}))),a.createElement("div",{className:"add-contacts__title"},"Привязка email к профилю"),a.createElement("div",{className:"add-contacts__value"},this.props.formattedPhone),a.createElement("div",{className:"add-contacts__step-wrapper"},a.createElement("div",{className:"add-contacts__step"},"Шаг 3 из 3"),a.createElement("p",{className:"add-contacts__action"},"Подтвердите email ",a.createElement("br",null),this.props.visibleToken),a.createElement("div",{className:"add-contacts__confirm"},a.createElement("p",{className:"add-contacts__additional-info"},"Перейдите по ссылке из письма, которое мы отправили."),a.createElement("p",{className:"add-contacts__additional-info"},"Если вы не получили письмо, проверьте правильность введённого email или запросите письмо повторно."),a.createElement(o.default,{addClasses:"add-contacts__ivi-button outline pale",size:o.default.SIZES.large,type:"button",onClick:this.props.resendConfirmation},"Выслать письмо повторно")))))))},t}(a.Component);t.default=r},function(e,t,i){var n=i(349);t.default=n.default.extend({bindBeginUri:"/user/bind/email/begin/v5/",bindConfirmUri:"/user/bind/email/confirm/v5/",bindType:"email",bindBegin:function(){this.sendBeginRequest({email:this.get("emailToken")})}})},function(e,t,i){var n=i(12),a=i(9),s=i(847);t.default=a.default.extend({routes:["/search/"],run:function(e){n.default.prototype.run(e),(new s.default).execute(e)}})},function(e,t,i){var n=i(6),a=i(241),s=i(240);t.default=n.default.extend({run:function(){window.ivi.adaptive.isMobile&&window.ivi.adaptive.isMobileStyle?new s.default:new a.default}})},function(e,t,i){var n=i(12),a=i(9),s=i(849);t.default=a.default.extend({routes:["/plus","/movies/plus","/series/plus","/animation/plus"],run:function(e){n.default.prototype.run(e),(new s.default).execute(e)}})},function(e,t,i){var n=i(6),a=i(850),s=i(166);t.default=n.default.extend({run:function(){new a.default,(new s.default).execute()}})},function(e,t,i){var n=i(0),a=i(7),s=i(4);t.default=n.View.extend({initialize:function(){this.listenTo(a.default,"user:login",this.afterAuth),this.listenTo(a.default,"user:logout",this.afterLogout)},afterAuth:function(){this.listenTo(a.default,"user:hasSubscription",function(){s.default.reload()})},afterLogout:function(){s.default.reload()}})},function(e,t,i){var n=i(852),a=i(9),s=i(25);t.default=a.default.extend({routes:["/watch/int:id/similar","/watch/str:hru/similar"],run:function(e){s.default.prototype.run(e),(new n.default).execute(e)}})},function(e,t,i){var n=i(6),a=i(853);t.default=n.default.extend({unfinishedWrapperView:null,run:function(){new a.default}})},function(e,t,i){var n=i(1),a=i(68),s=i(3);t.default=a.default.extend({el:".js-similar-block",events:{"click li > a":"contentClick"},contentClick:function(e){var t=void 0!==e.originalEvent?e.originalEvent.target:null;if(t){var i=n(t).parents("li[data-content-id]");if(i.length){var a=i.data("content-id"),o={poster_content_id:a,collection_id:""};s.default.rewriteSuperProperties(o),s.default.track("poster_click",o),this.setGrootParams()}}}})},function(e,t,i){var n=i(12),a=i(855),s=i(166),o=i(857),r=i(9),l=i(859),d=i(873),u=i(875);t.default=r.default.extend({routes:["/"],run:function(e){n.default.prototype.run(e);var t=new s.default;t.setPage("start"),t.execute(e),(new l.default).execute(e),(new a.default).execute(e),(new d.default).execute(e),(new o.default).execute(e),(new u.default).execute(e)}})},function(e,t,i){var n=i(6),a=i(856);t.default=n.default.extend({run:function(){new a.default}})},function(e,t,i){var n=i(0),a=i(26),s=i(3);t.default=n.View.extend({el:".js-posters-favourites",grootBlockId:"main_wanted",events:{"click li > a":"contentClick"},initialize:function(){this.listenTo(a.default,"favourites:block:loaded",function(){s.default.track("wantsee_view")})},contentClick:function(){s.default.setBlockId(this.grootBlockId),s.default.track("wantsee_click")}})},function(e,t,i){var n=i(6),a=i(858);t.default=n.default.extend({run:function(){new a.default}})},function(e,t,i){var n=i(0),a=i(3),s=i(334);t.default=n.View.extend({el:".js-posters-similar",grootBlockId:"main_wanted_similar",events:{"click li > a":"contentClick"},initialize:function(){this.listenTo(s.default,"related:block:loaded",function(){a.default.track("wantsee_similar_view")})},contentClick:function(){a.default.setBlockId(this.grootBlockId),a.default.track("wantsee_similar_click")}})},function(e,t,i){var n=i(1),a=i(111),s=i(107),o=i(67),r=i(227),l=i(33),d=i(199),u=i(860),c=i(234),p=i(345),f=i(333),h=i(864),g=i(865),m=i(866),v=i(867),_=i(5),b=i(7),y=i(204),w=i(871),C=i(26),k=i(3),P=i(42),S=i(57),T=i(32),E=i(872),I=i(202),x=i(125),M=i(203),A=i(55);t.default=l.default.extend({unfinishedFrom:0,unfinishedTo:2,favouriteFrom:0,favouriteTo:4,unfinishedListCollection:null,favouriteListCollection:null,relatedListCollection:null,unfinishedView:null,unfinishedSlaveView:null,favouriteView:null,relatedView:null,unfinishedLoaded:!1,favouritesLoaded:!1,personalReccomendationLoaded:!1,unfinishedSlaveEl:".js-posters-unfinished-slave",userVideosEl:"#userVideos",playerModal:null,afterLogin:function(){this.browserInfo=new T.default,new h.default,this.initializePersonalBlock(),this.initializeNewTrailersView(),this.listenTo(b.default,"user:login",this.waitSubscriptionStatus.bind(this)),this.listenTo(b.default,"user:logout",this.clearPersonalBlock.bind(this)),this.listenTo(C.default,"start:favorite:itemRemoved",this.hidePersonalBlock.bind(this)),this.listenTo(S.default,"start:unfinished:itemRemoved",this.hidePersonalBlock.bind(this)),n(window).on("message",this.postMessageHandler.bind(this))},postMessageHandler:function(e){var t=e.originalEvent.data;if(t&&"player"===t.type)switch(t.message){case"playerEnded":this.playerModal&&this.playerModal.closeModal()}},waitSubscriptionStatus:function(){this.listenTo(b.default,"user:hasSubscription",this.initializePersonalBlock.bind(this)),this.listenTo(b.default,"user:hasNotSubscription",this.initializePersonalBlock.bind(this))},hidePersonalBlock:function(){null!==this.unfinishedView&&!this.unfinishedView.isHidden()||null!==this.favouriteView&&!this.favouriteView.isHidden()||null!==this.relatedView&&!this.relatedView.isHidden()||this.clearPersonalBlock()},initializePersonalBlock:function(){var e=this;this.clearPersonalBlock(),this.unfinishedListCollection=new g.default,this.favouriteListCollection=new d.default,this.relatedListCollection=new p.default,this.unfinishedListCollection.mapiGet({data:{from:this.unfinishedFrom,to:this.unfinishedTo}}).done(function(t){t.error||(e.unfinishedLoaded=!0,e.checkPersonalReady())}),this.favouriteListCollection.mapiGet({data:{from:this.favouriteFrom,to:this.favouriteTo}}).done(function(t){t.error||(e.favouritesLoaded=!0,e.checkPersonalReady())}),this.loadPersonalRecommendation()},loadPersonalRecommendation:function(){var e=this;if(!this.personalReccomendationLoaded){var t=new a.default({el:".js-personal-recommendation"}),i=t.getPaidTypes(),l=i.shift();if(i.length)for(var d in i)l+="&paid_type="+i[d];var u=t.getGenres(),p=u.shift();if(u.length)for(var f in u)p+="&genre="+u[f];var h=new s.default({id:t.getId(),genre:p,paidType:l}),g=new o.default,m={id:h.getId(),from:0,to:(k.default.isUserPesonalizable()?o.default.prototype.VIDEO_PERSONALIZABLE_COUNT:o.default.prototype.VIDEO_COUNT)-1,sort:"relevance",fields:o.default.prototype.COLLECTION_CATALOG_FIELDS},v=new r.default({el:"#collection-"+h.getId(),model:h});h.getGenre()&&g.addParamsToUri("genre="+h.getGenre()),h.getPaidType()&&g.addParamsToUri("paid_type="+h.getPaidType()),g.mapiGet({data:m}).done(function(i){if(!i.error){h.set({videos:g});var a=n(".js-personal-recommendation");a.html(w.default({collection:t})),v.render(),v.show(),v.enableGallery(),v.enablePosters(),y.default.createElement(a.find(".js-collection-block"),function(e){(new c.default).afterInitialize(e)}),e.personalReccomendationLoaded=!0,P.default.trigger("start:firstCollection:rendered")}})}},clearPersonalBlock:function(){_.each([this.unfinishedListCollection,this.favouriteListCollection,this.relatedListCollection],function(e){null!==e&&e.remove()}),P.default.trigger("start:personalBlock:clear"),n(this.userVideosEl).addClass("collapsed"),this.unfinishedLoaded=!1,this.favouritesLoaded=!1},renderPersonalBlock:function(){var e=this,t=!1;this.unfinishedListCollection.length&&(this.unfinishedView=new v.default({collection:this.unfinishedListCollection}).render(),t=!0),1===this.unfinishedListCollection.length&&this.favouriteListCollection.length>=3||2===this.unfinishedListCollection.length&&1===this.favouriteListCollection.length?this.favouriteView=new u.default({collection:this.favouriteListCollection,favouritesCount:1===this.unfinishedListCollection.length?3:1,mode:"slave"}).render():this.favouriteListCollection.length&&(this.unfinishedListCollection.length&&(this.unfinishedSlaveView=(new m.default).render()),this.relatedListCollection.load(this.favouriteListCollection).done(function(t){e.favouriteView=new u.default({collection:e.favouriteListCollection}).render(),t.error||(e.relatedView=new f.default({collection:e.relatedListCollection,favouritesCollection:e.favouriteListCollection}).render())}),t=!0),t&&n(this.userVideosEl).removeClass("collapsed")},checkPersonalReady:function(){this.favouritesLoaded&&this.unfinishedLoaded&&this.renderPersonalBlock()},initializeNewTrailersView:function(){new E.default,this.playerModal=new x.default,this.playerModal.listen(A.default),(new I.default).listen(A.default),new M.default}})},function(e,t,i){var n=i(1),a=i(0),s=i(199),o=i(51),r=i(5),l=i(26),d=i(861),u=i(862),c=i(863),p=i(3),f=i(42),h=i(131),g=i(57);t.default=a.View.extend(h.default).extend(o.default).extend({el:".js-posters-favourites",$titleEl:null,favouritesFrom:0,favouritesCount:5,favouritesCountWithEmptyUnfinished:5,favouritesCountWithOneUnfinished:3,expansionTitleElementCount:2,compressionTitleElementCount:1,events:{"click .js-favourite":"removeClick"},MOBILE_GALLERY_CLASSES:"carousel posters-large",initialize:function(e){e.favouritesCount&&(this.favouritesCount=e.favouritesCount,this.collection.reset(this.collection.slice(this.favouritesFrom,this.favouritesCount))),this.listenTo(l.default,"favourites:deleted",this.onModelRemoved),this.listenTo(l.default,"favourites:added",this.onModelAdded),this.listenToOnce(f.default,"start:personalBlock:clear",this.hideBlock),e.mode&&"slave"===e.mode&&this.listenTo(g.default,"start:unfinished:itemRemoved",this.onUnfinishedItemRemoved),this.loaderFirstItem=new s.default,l.default.trigger("favourites:block:loaded"),window.ivi.adaptive.isMobile&&window.addEventListener("orientationchange",this.setMobileGallery.bind(this))},removeClick:function(e){var t=n(e.target),i=t.closest("li"),a=i.data("id"),s=i.data("compilation")?"compilation":"video";return l.default.trigger("favourite:delete",{objectId:a,type:s,blockId:p.default.getBlockIds().favouritesBlockId}),e.preventDefault(),e.stopPropagation(),!1},render:function(){if(this.collection&&this.collection.length){var e=c.default({favourites:this.collection.getLimitedFavorites(this.favouritesCount)});this.$el.html(e),this.$el.removeClass(this.transitionClass),this.$titleEl=n("#favourites-title"),this.attachPosterPopup(this.$el.find("li")),window.ivi.adaptive.isMobile&&this.setMobileGallery()}},changeTitle:function(e){e?(this.$titleEl.html(u.default({favourites:r.range(e)})),this.$titleEl.show()):this.$titleEl.hide()},replaceElement:function(e,t){var i=this.$el.find("[data-id="+e.objectId+"]"),n=this.getRenderedModel(t);this.transitionReplace(this.$el.find("ul"),i,n),this.attachPosterPopup(n)},removeElement:function(e){var t=void 0!==e.objectId?e.objectId:e.get("id"),i=this.$el.find("[data-id="+t+"]");this.transitionRemove(i)},prependElement:function(e){var t=this.getRenderedModel(e);this.transitionAdd(this.$el.find("ul"),t,!0),this.attachPosterPopup(t)},appendElement:function(e){var t=this.getRenderedModel(e);this.transitionAdd(this.$el.find("ul"),t),this.attachPosterPopup(t)},getRenderedModel:function(e){return n(d.default({video:e}))},onModelRemoved:function(e){var t=this;this.collection.deleteFromList(e)&&t.collection.mapiGet({data:{from:t.favouritesFrom+this.collection.length,to:t.favouritesFrom+this.collection.length}}).done(function(i){i.result&&i.result.length?t.replaceElement(e,r.last(t.collection.models)):(t.removeElement(e),t.collection.length?t.collection.length===t.compressionTitleElementCount&&t.changeTitle(t.compressionTitleElementCount):t.transitionHide(),l.default.trigger("start:favorite:itemRemoved"))})},onModelAdded:function(e){var t=this;this.loaderFirstItem.mapiGet({data:{from:this.favouritesFrom,to:this.favouritesFrom}}).done(function(i){if(i.result&&i.result.length){if(void 0!==r.find(t.collection.models,function(t){return t.get("id")===e.objectId&&("compilation"===e.type?t.isCompilation():!t.isCompilation())}))return!1;t.collection.unshift(i.result[0]),t.collection.length>t.favouritesCount&&t.removeElement(t.collection.pop()),t.collection.length===t.expansionTitleElementCount&&t.changeTitle(t.expansionTitleElementCount),t.isHidden()?t.transitionShow(function(){t.prependElement(r.first(t.collection.models)),l.default.trigger("start:favorite:itemPrepended")}):(t.prependElement(r.first(t.collection.models)),l.default.trigger("start:favorite:itemPrepended"))}})},fill:function(){var e=this,t=this.collection.length;this.collection.mapiGet({data:{from:this.favouritesFrom+this.collection.length,to:this.favouritesCount-1}}).done(function(i){i.error||r.each(e.collection.models,function(i){t<=0?e.appendElement(i):t--})})},onUnfinishedItemRemoved:function(e){this.favouritesCount=e.collection.length?this.favouritesCountWithOneUnfinished:this.favouritesCountWithEmptyUnfinished,this.fill()},hideBlock:function(){this.stopListening(),this.transitionHide()},setMobileGallery:function(){var e=n("#js-favourites-mobile-carousel");window.ivi.adaptive.isMobileStyle?e.addClass(this.MOBILE_GALLERY_CLASSES):e.removeClass(this.MOBILE_GALLERY_CLASSES)}})},function(e,t,i){function n(e){return a.default.render('<li class="{% if video.isInfoVideo() or video.isPreorderable() %}info{% endif %} {{ video.getPaidIcon() }} collapsed" data-id="{{ video.getId() }}" data-compilation="{% if video.isCompilation() %}1{% else %}0{% endif %}"> <a href="{{ video.getPosterSpecificLink(hasSubscription) }}" class="item-content-wrapper{% if video.isForAdult() %} js-adult{% endif %}"> <span class="image" data-caption="{% if video.isSvod() %}{{ video.getPosterSpecificCaption(hasSubscription) }}{% else %}{{ video.getPosterSpecificCaption() }}{% endif %}"><img src="{{ video.getPosterPath("/172x264/") }}" alt="{{ video.getTitle() }}"> <span class="age-limit" data-value="{{ video.getRestrict()|default(0) }}+"></span> <span class="remove-wrapper js-favourite"><span class="remove"></span></span> </span> <span class="title"><span>{{ video.getTitle() }}</span></span> </a> <div class="popup-wrapper" data-hru="{% if video.isCompilation() %}{{ video.getHru() }}{% else %}{{ video.getId() }}{% endif %}"></div></li>',e)}var a=i(2);t.default=n},function(e,t,i){function n(e){return a.default.render('<a href="/profile#favorites">{% if favourites|length == 1 %}См. {% else %}Смотреть {% endif %}позже</a>',e)}var a=i(2);t.default=n},function(e,t,i){function n(e){return a.default.render('<h2 id="favourites-title"><a href="/profile#favorites">{% if favourites|length == 1 %}См. {% else %}Смотреть {% endif %}позже</a></h2><div id="js-favourites-mobile-carousel"> <div class="viewport"> <ul id="favourites" class="gallery posters-large alternate-item-background steady-casing"> {% for video in favourites %} <li class="{% if abExperiment.useNewPriceBadges() %}{{ video.getNewPriceBadgeClasses(abExperiment.showFreeBadge(), hasSubscription) }}{% else %}{{ video.getPaidIcon() }}{% endif %}{% if video.isInfoVideo() or video.isPreorderable() %} info{% endif %}" data-id="{{ video.getId() }}" data-compilation="{{ video.isCompilation() }}"> <a href="{{ video.getPosterSpecificLink(hasSubscription) }}" class="item-content-wrapper{% if video.isForAdult() %} js-adult{% endif %}"> <span class="image" data-caption="{% if video.isSvod() %}{{ video.getPosterSpecificCaption(hasSubscription) }}{% else %}{{ video.getPosterSpecificCaption() }}{% endif %}"> <img src="{{ video.getPosterPath("/172x264/") }}" alt="{{ video.getTitle() }}"> <span class="age-limit" data-value="{{ video.getRestrict()|default(0) }}+"></span> {% if abExperiment.useNewPriceBadges() %} <div class="badge"> <div class="badge__content" data-badge-content="{{ video.getNewPriceBadgeTitle(abExperiment.showFreeBadge(), hasSubscription) }}"></div> </div> {% endif %} <span class="remove-wrapper js-favourite"><span class="remove"></span></span> </span> <span class="title"><span>{{ video.getTitle() }}</span></span> </a> <div class="popup-wrapper" data-hru="{% if video.isCompilation() %}{{ video.getHru() }}{% else %}{{ video.getId() }}{% endif %}"></div> </li> {% endfor %} </ul> </div></div>',e)}var a=i(2);t.default=n},function(e,t,i){var n=i(0),a=i(7),s=i(3),o=i(41);t.default=n.View.extend({el:".teaser-plate",events:{"click #js-iviplus":"addSubscription"},initialize:function(){this.listenTo(a.default,"user:hasSubscription",this.hasSubscription),this.listenTo(a.default,"user:logout",this.logout),this.listenTo(a.default,"user:hasNotSubscription",this.hasNotSubscription)},addSubscription:function(e){s.default.setBlockId("main_under_promo"),o.default.trigger("showSubscriptionLanding","main_plashka"),e.preventDefault()},logout:function(){this.$el.find("#js-iviplus").show(),this.$el.find("#js-iviplus-text").show()},hasSubscription:function(){this.$el.find("#js-iviplus").hide(),this.$el.find("#js-iviplus-text").hide()},hasNotSubscription:function(){this.logout()}})},function(e,t,i){i(57);var n=i(29),a=i(40);t.default=n.default.extend({uri:"/unfinished/video/v5/",model:a.default,deleteFromList:function(e){var t=this.findWhere({id:e.getId()});return void 0!==t&&(this.remove(t),!0)}})},function(e,t,i){var n=i(0),a=i(42),s=i(131),o=i(57);t.default=n.View.extend(s.default).extend({el:".js-posters-unfinished-slave",initialize:function(){this.listenToOnce(a.default,"start:personalBlock:clear",this.transitionHide),this.listenTo(o.default,"start:unfinished:itemRemoved",this.onUnfinishedItemRemoved)},render:function(){this.$el.removeClass(this.transitionClass)},hideBlock:function(){this.stopListening(),this.transitionHide()},onUnfinishedItemRemoved:function(e){e.collection.length||this.hideBlock()}})},function(e,t,i){var n=i(1),a=i(0),s=i(868),o=i(5),r=i(42),l=i(131),d=i(57),u=i(869),c=i(870);t.default=a.View.extend(l.default).extend({el:".js-posters-unfinished",unfinishedFrom:0,unfinishedCount:2,events:{"click .js-unfinished":"removeClick"},initialize:function(){this.watchHistoryModel=new s.default,d.default.trigger("unfinished:block:loaded"),this.listenTo(d.default,"unfinished:deleted",this.onModelRemoved),this.listenToOnce(r.default,"start:personalBlock:clear",this.hideBlock)},render:function(){this.collection.length&&(this.$el.html(c.default({unfinishedItems:this.collection.models})),this.$el.removeClass(this.transitionClass))},hideBlock:function(){this.undelegateEvents(),this.watchHistoryModel.stopListening(),this.stopListening(d.default),this.transitionHide()},removeClick:function(e){var t=n(e.target),i=t.closest("li"),a=i.data("id"),s=this.collection.findWhere({id:a});return void 0!==s&&d.default.trigger("unfinished:delete",s),!1},replaceElement:function(e,t){var i=this.$el.find("[data-id="+e.getId()+"]"),a=n(u.default({video:t}));this.transitionReplace(this.$el.find("ul"),i,a)},removeElement:function(e){var t=this.$el.find("[data-id="+e.getId()+"]");this.transitionRemove(t)},onModelRemoved:function(e){var t=this;this.collection.deleteFromList(e)&&t.collection.mapiGet({data:{from:t.unfinishedFrom+this.collection.length,to:t.unfinishedFrom+this.collection.length},add:!0,remove:!1}).done(function(i){i.result&&i.result.length?t.replaceElement(e,o.last(t.collection.models)):(t.removeElement(e),t.collection.length||t.hideBlock(),d.default.trigger("start:unfinished:itemRemoved",t))})}})},function(e,t,i){var n=i(14),a=i(57);t.default=n.default.extend({initialize:function(){var e=this;this.listenTo(a.default,"unfinished:delete",function(t){e.deleteFromWatched(t)})},deleteFromWatched:function(e){if(void 0!==e)return this.mapiPost({uri:e.isSerie()?"/watchhistory/v5/compilation/delete":"/watchhistory/v5/delete",data:{content_id:e.getId()}}).done(function(t){"ok"===t.result&&a.default.trigger("unfinished:deleted",e)})}})},function(e,t,i){function n(e){return a.default.render('<li class="{% if video.isFake() %}info {% endif %}collapsed" data-id="{{ video.getId() }}" data-hru="{{ video.getCompilationHru() }}"> <a href="{{ video.getWatchLink() }}" class="item-content-wrapper"> <span class="image" data-caption="{% if video.isSvod() %}{{ video.getPosterSpecificCaption(hasSubscription) }}{% else %}{{ video.getPosterSpecificCaption() }}{% endif %}"> <img src="{{ video.getThumbPath() }}{% if unfinishedItems|length > 1 %}/308x174/{% else %}/640x360/{% endif %}" alt="{{ video.getTitle() }}"> <span class="progress-wrapper"><span class="progress" style="width: {{ video.getWatchPercent() }}%"></span></span> <span class="remove-wrapper js-unfinished"><span class="remove"></span></span> </span> <span class="title"><span>{% if video.isSerie() %}{{ video.getCompilationTitle() }}{% else %}{{ video.getTitle() }}{% endif %}</span></span> <span class="extra-info">{% if video.isSerie() %}<strong>{% if video.getSeason() %}Сезон {{ video.getSeason() }} &bull;{% endif %}{% if video.getEpisode() %} Серия {{ video.getEpisode() }}{% endif %}</strong>{% endif %}Просмотрено {{ video.getWatchedTimeMinutes() }} из {{ video.getDurationMinutes() }} мин.</span> </a></li>',e)}var a=i(2);t.default=n},function(e,t,i){function n(e){return a.default.render('<h2 id="unfinished"><a href="/profile#watched">Продолжить просмотр</a></h2><ul class="gallery alternate-item-background{% if unfinishedItems|length > 2 %} thumbs-large{% else %} thumbs-huge{% endif %} steady-casing"> {% for video in unfinishedItems %} <li{% if video.isFake() %} class="info"{% endif %} data-id="{{ video.getId() }}" data-hru="{{ video.getCompilationHru() }}"> <a href="{{ video.getWatchLink() }}" class="item-content-wrapper"> <span class="image" data-caption="{% if video.isSvod() %}{{ video.getPosterSpecificCaption(hasSubscription) }}{% else %}{{ video.getPosterSpecificCaption() }}{% endif %}"> {% if video.getThumbPath() %} <img src="{{ video.getThumbPath() }}{% if unfinishedItems|length > 1 %}/308x174/{% else %}/640x360/{% endif %}" alt="{{ video.getTitle() }}"> {% endif %} <span class="progress-wrapper"><span class="progress" style="width: {{ video.getWatchPercent() }}%"></span></span> <span class="remove-wrapper js-unfinished"><span class="remove"></span></span> </span> <span class="title"><span>{% if video.isSerie() %}{{ video.getCompilationTitle() }}{% else %}{{ video.getTitle() }}{% endif %}</span></span> <span class="extra-info">{% if video.isSerie() %}<strong>{% if video.getSeason() %}Сезон {{ video.getSeason() }} &bull;{% endif %}{% if video.getEpisode() %} Серия {{ video.getEpisode() }}{% endif %}</strong>{% endif %}Просмотрено {{ video.getWatchedTimeMinutes() }} из {{ video.getDurationMinutes() }} мин.</span> </a> </li> {% endfor %}</ul>',e)}var a=i(2);t.default=n},function(e,t,i){function n(e){return a.default.render('<h2><a href="{{ collection.getLink() }}" class="js-collection-header" data-collection-id="{{ collection.getId() }}" data-collection-position="{{ collection.getPosition() }}">{{ collection.getTitle() }}</a></h2><div class="carousel posters-large"> <div class="viewport"> <ul class="gallery posters-large js-collection-block js-popups-block" data-collection-id="{{ collection.getId() }}" data-collection-position="{{ collection.getPosition() }}" data-collection-paid-type="{{ collection.getPaidTypes()|join(",") }}" data-collection-genre="{{ collection.getGenres()|join(",") }}" > </ul> </div> <div class="popup-target"></div> <span tabindex="0" class="hidden control prev">Предыдущие</span> <span tabindex="0" class="hidden control next">Следующие</span></div>',e)}var a=i(2);t.default=n},function(e,t,i){i(149);var n=i(0),a=i(150),s=i(3);t.default=n.View.extend({el:".js-trailers-list",blockIdMain:s.default.getBlockIds().mainTrailersBlock,blockIdThumb:s.default.getBlockIds().mainTrailersThumbnail,events:{"click h2 a":"blockClick","click li .image":"thumbnailClick","click li a":"nameClick"},initialize:function(){var e=this.blockIdMain;this.$el.waypoint({element:this.$el,handler:function(){s.default.rewriteSuperProperties({block_id:e}),s.default.track("trailers_view"),this.destroy()}}),a.default.trigger("gallery:init",this.$el.find(".js-carousel"))},blockClick:function(){s.default.rewriteSuperProperties({block_id:this.blockIdMain}),s.default.setBlockId(this.blockIdMain),s.default.track("trailers_click_block")},thumbnailClick:function(e){s.default.rewriteSuperProperties({block_id:this.blockIdMain}),s.default.track("trailers_click_thumbnail",{position:e.currentTarget.dataset.count}),s.default.rewriteSuperProperties({block_id:this.blockIdThumb})},nameClick:function(e){s.default.rewriteSuperProperties({block_id:this.blockIdMain}),s.default.setBlockId(this.blockIdMain),s.default.track("trailers_click_name",{position:e.currentTarget.dataset.count})}})},function(e,t,i){var n=i(6),a=i(874);t.default=n.default.extend({run:function(){new a.default}})},function(e,t,i){var n=i(0),a=i(1),s=i(57),o=i(3);t.default=n.View.extend({el:".js-posters-unfinished",grootBlockId:"main_continuewatch",events:{"click li > a":"contentClick"},initialize:function(){this.listenTo(s.default,"unfinished:block:loaded",this.unfinishedLoaded),this.listenTo(s.default,"unfinished:deleted",this.onModelRemoved)},unfinishedLoaded:function(){this.$el.length&&o.default.track("continuewatching_view")},contentClick:function(e){o.default.rewriteSuperProperties({content_id:a(e.currentTarget).parent().attr("data-id")}),o.default.setBlockId(this.grootBlockId),o.default.track("continuewatching_click")},onModelRemoved:function(e){var t={};if(o.default.rewriteSuperProperties({block_id:this.grootBlockId}),e.isSerie())t.compilation_id=e.getId(),o.default.track("continuewatching_delete",t);else{var i=o.default.getSuperProperty("content_id");t.content_id=e.getId(),o.default.rewriteSuperProperties(t),o.default.track("continuewatching_delete"),t.content_id=i,o.default.rewriteSuperProperties(t)}}})},function(e,t,i){var n=i(1),a=i(33),s=i(876),o=i(879),r=i(883),l=i(886),d=i(889),u=i(8),c=i(195),p=i(22),f=i(18),h=i(19),g=i(32),m=i(42),v=i(7),_=i(20),b=i(10);t.default=a.default.extend({LAST_OPEN_START_MODAL_KEY:"startModalLastOpenTimestamp",START_MODALS_FIRST_VISIT_DELAY:24,REGISTRATION_MOTIVATION_FIRST_VISIT_KEY:"startModalFirstVisitTimestamp",FAVOURITES_ONBOARDING_OFFER_SHOW_LIMIT:2,FAVOURITES_ONBOARDING_OFFER_SHOW_COUNT_KEY:"favouritesOnboardingOfferShowCount",FAVOURITES_ONBOARDING_WATCH_HISTORY_LIMIT:2,FAVOURITES_ONBOARDING_OFFER_SHOWN_KEY:"favouritesOnboardingOfferShown",mapiData:null,afterLogin:function(){this.mapiData=new h.default,this.browserInfo=new g.default,(new s.default).listen(m.default),new o.default({model:p.default}).listen(v.default),this.favouritesOnboardingCollection=new d.default,new r.default({collection:this.favouritesOnboardingCollection,mapiData:this.mapiData,browserInfo:this.browserInfo}).listen(m.default),"1"!==this.queryParams.force_favourites_onboarding_offer||b.default.isWorld||this.browserInfo.isSearchBot()?this.checkFavouritesOnboardingOffer():(this.showFavouritesOnboardingOffer(),this.emptyQueryParams()),this.anyStartModalCanBeOpened()&&this.canOpenRegistrationMotivation()&&this.openRegistrationMotivationModal()},isAuthQueryParams:function(){return this.queryParams.login_modal||this.queryParams.change_password||this.queryParams.registration_completed},anyStartModalCanBeOpened:function(){if(!this.isAuthQueryParams()&&!this.hasOpenedModals()&&!this.browserInfo.isSearchBot()){var e=parseInt(_.default.localStorage.getItem(this.LAST_OPEN_START_MODAL_KEY),10);return!e||Date.now()-e>this.hoursToMilliseconds(this.START_MODALS_FIRST_VISIT_DELAY)}return!1},checkFavouritesOnboardingOffer:function(){var e=this,t=_.default.localStorage.getItem(this.FAVOURITES_ONBOARDING_OFFER_SHOW_COUNT_KEY),i=_.default.localStorage.getItem(this.FAVOURITES_ONBOARDING_OFFER_SHOWN_KEY);if(!(b.default.isWorld||t&&t>=this.FAVOURITES_ONBOARDING_OFFER_SHOW_LIMIT||i||!this.mapiData.showFavouritesOnboarding()||u.default.isAuthenticated())){var n=new c.default;n.mapiGet({data:{to:this.FAVOURITES_ONBOARDING_WATCH_HISTORY_LIMIT}}).done(function(){n.size()<e.FAVOURITES_ONBOARDING_WATCH_HISTORY_LIMIT&&e.showFavouritesOnboardingOffer()})}},showFavouritesOnboardingOffer:function(){var e=this;if((new l.default).render()){var t=_.default.localStorage.getItem(this.FAVOURITES_ONBOARDING_OFFER_SHOW_COUNT_KEY);null!==t?_.default.localStorage.setItem(this.FAVOURITES_ONBOARDING_OFFER_SHOW_COUNT_KEY,++t):_.default.localStorage.setItem(this.FAVOURITES_ONBOARDING_OFFER_SHOW_COUNT_KEY,1),this.favouritesOnboardingCollection.getOnboardingContent().done(function(){e.listenTo(m.default,"start:favouritesOnboarding:anyContentChosen",function(){return _.default.localStorage.setItem(e.FAVOURITES_ONBOARDING_OFFER_SHOWN_KEY,"1")}),e.listenTo(m.default,"start:favouritesOnboarding:nothingChosen",function(){return _.default.localStorage.removeItem(e.FAVOURITES_ONBOARDING_OFFER_SHOWN_KEY)})})}},canOpenRegistrationMotivation:function(){if(this.isAuthorizeOnEntry()&&!u.default.isAuthenticated()){return Number(_.default.localStorage.getItem(this.LAST_OPEN_START_MODAL_KEY))?this.checkStartModalPeriod():this.checkFirstVisitDelayForRegistrationMotivation()}return!1},openRegistrationMotivationModal:function(){this.setLastOpenTime(),f.default.showRegistrationMotivationWithBonus()?v.default.trigger("auth:showMotivationRegistrationModal"):m.default.trigger("registrationMotivation:show")},setFirstVisitTime:function(){_.default.localStorage.setItem(this.REGISTRATION_MOTIVATION_FIRST_VISIT_KEY,Date.now())},setLastOpenTime:function(){_.default.localStorage.setItem(this.LAST_OPEN_START_MODAL_KEY,Date.now())},checkFirstVisitDelayForRegistrationMotivation:function(){var e=Number(_.default.localStorage.getItem(this.REGISTRATION_MOTIVATION_FIRST_VISIT_KEY));return e?Date.now()-e>this.hoursToMilliseconds(this.START_MODALS_FIRST_VISIT_DELAY):(this.setFirstVisitTime(),!1)},hasOpenedModals:function(){return!!n("#modal-container .ivi-modal").length},isAuthorizeOnEntry:function(){return this.mapiData.isAuthorizeOnEntry()},getStartAuthMotivationPeriod:function(){return this.mapiData.getStartAuthMotivationPeriod()},checkStartModalPeriod:function(){var e=this.getStartAuthMotivationPeriod(),t=Number(_.default.localStorage.getItem(this.LAST_OPEN_START_MODAL_KEY)),i=Date.now();return!(!t||!1===e)&&i-t>this.hoursToMilliseconds(e)},hoursToMilliseconds:function(e){return 60*e*60*1e3}})},function(e,t,i){var n=i(16),a=i(3),s=i(18),o=i(7),r=i(877),l=i(878);t.default=n.default.extend({template:r.default,openEvent:"registrationMotivation:show",modalId:"registration-motivation-modal",mobileModal:!0,fakeCloseClick:!1,events:{"click .js-register":"register","click .js-login":"login","click .js-modal-close":"onClose"},initialize:function(){s.default.showNewRegistrationMotivation()&&(this.template=l.default,this.wrapper=n.default.prototype.wrapper+"-motivation-registration",this.fullAnimation=!0,this.renderAnimationDuration=this.destroyAnimationDuration=300)},beforeRender:function(){a.default.track("popup_show",{popup_type:"reg_popup"})},login:function(){return o.default.trigger("auth:showLoginModal"),a.default.track("popup_click",{popup_type:"reg_popup",where_click:"login"}),this.fakeCloseClick=!0,this.closeModal(),!1},register:function(){return o.default.trigger("auth:showLoginModal"),a.default.track("popup_click",{popup_type:"reg_popup",where_click:s.default.showNewRegistrationMotivation()?"enter":"registration"}),this.fakeCloseClick=!0,this.closeModal(),!1},onClose:function(){this.fakeCloseClick||a.default.track("popup_click",{popup_type:"reg_popup",where_click:"cancel"})}})},function(e,t,i){function n(e){return a.default.render('<div class="ivi-modal-wrapper-content registration-motivation"> <h1 class="ivi-modal-title">Зарегистрируйтесь на ivi</h1> <form class="ivi-modal-content"> <p>После регистрации ваши покупки, история просмотров и фильмы, которые вы смотрите, станут доступны на любом из ваших устройств</p> <div class="platform-wrapper"> <div class="platform platform_ios"></div> <div class="platform platform_android"></div> <div class="platform platform_windows"></div> <div class="platform platform_tv"></div> </div> <div class="button-wrapper"> <button class="ivi-button large register js-register">Зарегистрироваться</button> <span class="button-seperator"> <span class="button-seperator__or">или</span> <button class="ivi-button large neutral login js-login">Войти</button> </span> </div> </form> <span class="ivi-modal-close js-modal-close">Закрыть</span></div>',e)}var a=i(2);t.default=n},function(e,t,i){function n(e){return a.default.render('<div class="fullscreen-popup fullscreen-popup_active fullscreen-popup_has-close-view-button "> <div class="fullscreen-popup__overlay"> <span></span> <span></span> <span></span> </div> <div class="fullscreen-popup__scroll-wrapper"> <div class="fullscreen-popup__wrapper"> <a class="fullscreen-popup__close-view-button js-modal-close" href="#" title="Нажмите, чтобы закрыть форму"> Закрыть окно </a> <div class="motivation motivation-general"> <div class="motivation__container motivation__container_centered"> <div class="motivation__container-inner motivation__container-inner_centered"> <div class="motivation__content"> <h2 class="motivation__title motivation__title_right-empty">Зарегистрируйтесь на&nbsp;ivi</h2> <div class="motivation__main motivation__main_right-empty"> <p class="motivation__info"> Ваши покупки, истории просмотров и&nbsp;списки отложенных фильмов станут доступны на&nbsp;любом из&nbsp;ваших устройств, где&nbsp;есть ivi </p> <div class="motivation__icon-list"> <div class="motivation__icon-item motivation__icon-item_smarttv"></div> <div class="motivation__icon-item motivation__icon-item_mobile"></div> <div class="motivation__icon-item motivation__icon-item_tvconsoles"></div> <div class="motivation__icon-item motivation__icon-item_consoles"></div> <div class="motivation__icon-item motivation__icon-item_desktopdevices"></div> </div> <div class="motivation__button-wrapper"> <button class="motivation__ivi-button ivi-button large js-register">Войти или зарегистрироваться</button> </div> </div> </div> </div> </div> </div> </div> </div></div>',e)}var a=i(2);t.default=n},function(e,t,i){var n=i(1),a=i(5),s=i(16),o=i(108),r=i(19),l=i(32),d=i(215),u=i(8),c=i(880),p=i(881),f=i(882),h=i(216),g=i(217),m=i(219),v=i(218),_=i(7),b=i(3),y=i(18),w=i(20);t.default=o.default.extend({modalId:"motivation-registration-modal",wrapper:s.default.prototype.wrapper+"-motivation-registration",template:c.default,openEvent:"auth:showMotivationRegistrationModal",modalHash:"#motivation-registration",additionalStatuses:{STATUS_MOTIVATION_REGISTRATION_TOKEN:15,STATUS_MOTIVATION_REGISTRATION_SUCCESS:16},additionalEvents:{"click .js-resend-bonus-registration":"resendBonusRegistration"},additionalGrootPageStatusRel:{2:"auth_mail_mot",3:"auth_reg_mot",11:"confidential_mot",15:"auth_reg_mot",16:"gift_sent_mot"},baseFormsToRender:[p.default,h.default,g.default,m.default,f.default,v.default],initialize:function(e){this.extendProperties(),s.default.prototype.initialize.call(this,e),window.ivi.adaptive.isMobile&&(this.onHashChangeCloseModalBinded=this.onHashChangeCloseModal.bind(this)),this.browserInfo=new l.default,this.mapiInfo=new r.default,this.errorActionsModel=new d.default,this.model.set("passwordRules",this.mapiInfo.getPasswordRules()),this.initReloadSubscriber()},listenModalEvents:function(){this.listenTo(_.default,"auth:request:success",this.onSuccess),this.listenTo(_.default,"auth:request:error",this.showError),this.listenTo(_.default,"auth:validateAuthToken:success",this.validateAuthTokenSuccess),this.listenTo(_.default,"auth:mergeError",this.showError)},stopListeningModalEvents:function(){this.stopListening(_.default,"auth:request:success",this.onSuccess),this.stopListening(_.default,"auth:request:error",this.showError),this.stopListening(_.default,"auth:validateAuthToken:success",this.validateAuthTokenSuccess),this.stopListening(_.default,"auth:mergeError",this.showError)},extendProperties:function(){this.statuses=a.extend({},this.statuses,this.additionalStatuses),this.events=a.extend({},this.events,this.additionalEvents),this.grootPageStatusRel=a.extend({},this.grootPageStatusRel,this.additionalGrootPageStatusRel)},moveToPrevStep:function(){return this.resetData(),this.model.set("status",this.statuses.STATUS_MOTIVATION_REGISTRATION_TOKEN),n(".modal-view_finish").removeClass("modal-view_finish"),this.update(),b.default.rewriteSuperProperties({block_id:"back"}),this.afterStepChanged(),!1},setModalControls:function(){var e=this.$el.find(".fullscreen-popup");switch(o.default.prototype.setModalControls.apply(this,arguments),this.model.get("status")){case this.statuses.STATUS_MOTIVATION_REGISTRATION_TOKEN:case this.statuses.STATUS_MOTIVATION_REGISTRATION_SUCCESS:e.addClass("fullscreen-popup_has-close-view-button")}},onOpen:function(){o.default.prototype.onOpen.apply(this,arguments),w.default.setMotivationRegistrationCompletion(!1)},handleAuthToken:function(){return this.model.set("expected_type","email"),o.default.prototype.handleAuthToken.apply(this,arguments)},handleEmailRegistration:function(){return this.model.set("isEmailRegistrationChecking",!0),this.model.get("status")===this.statuses.STATUS_PASSWORD_CHANGE?(b.default.track("change_password_submit"),u.default.setPassword(this.eventParams.oldPassword,this.model.get("password"),this.model.get("passwordRepeat"))):(b.default.track("sign_up_click"),this.model.registerByEmail(!1,!0)),this.update(),!1},onSuccess:function(){switch(this.onSuccessGroot(),this.model.get("status")){case this.statuses.STATUS_EMAIL_REGISTRATION:this.model.set("status",this.statuses.STATUS_MOTIVATION_REGISTRATION_SUCCESS),this.moveToNextStep(),w.default.setMotivationRegistrationCompletion(!0);break;default:o.default.prototype.onSuccess.call(this)}},update:function(){if(!o.default.prototype.update.apply(this,arguments)){var e,t,i=this.serializeData();switch(this.model.get("status")){case this.statuses.STATUS_MOTIVATION_REGISTRATION_TOKEN:e=this.$(".js-motivation-registration-token-block").get(0),t=p.default(i);break;case this.statuses.STATUS_MOTIVATION_REGISTRATION_SUCCESS:e=this.$(".js-motivation-registration-success-block").get(0),t=f.default(i)}this.updateHtml(e,t)}},serializeData:function(){var e=o.default.prototype.serializeData.apply(this,arguments),t=this.model.get("status"),i={isFirstStep:e.isFirstStep||t===this.statuses.STATUS_MOTIVATION_REGISTRATION_TOKEN,isLastStep:e.isLastStep||t===this.statuses.STATUS_MOTIVATION_REGISTRATION_SUCCESS,bonusValue:y.default.getRegistrationMotivationBonusValue(),showRecoveryPassword:!1};return n.extend(e,i)},resendBonusRegistration:function(){this.model.sendConfirmEmail(!0),b.default.track("resend_gift_click")},setViewInitialStatus:function(){this.model.set("status",this.statuses.STATUS_MOTIVATION_REGISTRATION_TOKEN)}})},function(e,t,i){function n(e){return a.default.render('<div class="fullscreen-popup fullscreen-popup_active fullscreen-popup_has-close-view-button"> <div class="fullscreen-popup__overlay"> <span></span> <span></span> <span></span> </div> <div class="fullscreen-popup__scroll-wrapper"> <div class="fullscreen-popup__wrapper js-auth-wrapper"> <a class="fullscreen-popup__previous-view-button js-back-button" href="#" title="Нажмите, чтобы перейти на шаг назад"> Назад </a> <a class="fullscreen-popup__close-view-button js-modal-close" href="#" title="Нажмите, чтобы закрыть форму"> Закрыть окно </a> </div> </div></div>',e)}var a=i(2);t.default=n},function(e,t,i){function n(e){return a.default.render('{% set disableAuthTokenButton = not authToken|default(false) or code|default(false) or isAuthTokenChecking|default(false) %}{% set authTokenInputClass %} {% if authTokenInputFocused|default(false) or authToken|default(false) %} state_focused{% endif %} {% if code|default(false) %} state_error tooltip{% endif %} {% if authToken|default(false) %} state_filled{% endif %}{% endset %}<div class="motivation motivation-registration modal-view modal-view_start {% if isFirstStep|default(false) %}modal-view_finish {% elseif isSecondStep|default(false) %}modal-view_end {% endif %}js-auth-token-block js-motivation-registration-token-block"> <div class="motivation__container motivation__container_centered"> <div class="motivation__container-inner motivation__container-inner_centered"> <div class="motivation__content"> <h2 class="motivation__title motivation__title_right">Подписка ivi на&nbsp;{{ bonusValue }}&nbsp;{{ declension.days(bonusValue) }} в&nbsp;подарок</h2> <div class="motivation__content-inner"> <div class="motivation__main motivation__main_right"> <p class="motivation__info"> Зарегистрируйтесь на&nbsp;ivi прямо сейчас и&nbsp;получите {{ bonusValue }}&nbsp;{{ declension.days(bonusValue) }} подписки в&nbsp;подарок без&nbsp;привязки карты </p> <form id="jsAuthToken" action="" class="motivation__form motivation__form_direction-column"> <div class="ivi-textfield style_default size_large icon_user motivation__ivi-textfield js-ivi-textfield {{ authTokenInputClass }}"> <input id="input_auth>" type="text" class="ivi-textfield__input js-ivi-textfield__input js-auth-token" placeholder="Через email" value="{{ authToken }}"> <label for="input_auth>" class="ivi-textfield__label"> <span class="ivi-textfield__label-value">Через email</span> </label> <div class="ivi-textfield__tooltip-wrapper"> <div class="ivi-textfield__tooltip">{{ userMessage|default("") }}</div> </div> </div> <div class="motivation__button-wrapper"> <button class="motivation__ivi-button ivi-button large{% if isAuthTokenChecking|default(false) %} loading{% endif %}{% if disableAuthTokenButton %} disabled{% endif %}" {% if disableAuthTokenButton %}disabled="disabled"{% endif %}">Получить подарок</button> </div> </form> <ul class="motivation__advantage-list"> <li class="motivation__advantage-item motivation__advantage-item_catalog">Дополнительный каталог</li> <li class="motivation__advantage-item motivation__advantage-item_no-ads">Просмотр без рекламы</li> <li class="motivation__advantage-item motivation__advantage-item_fullhd">Качество Full HD 1080</li> <li class="motivation__advantage-item motivation__advantage-item_download">Скачивание на мобильные</li> <li class="motivation__advantage-item motivation__advantage-item_gift">Подарки каждую неделю</li> </ul> </div> <div class="motivation__aside"> <div class="gift-card motivation__gift-card"> <div class="gift-card__title">Подписка ivi</div> <div class="gift-card__duration"> <span class="gift-card__value">{{ bonusValue }}</span> <span class="gift-card__unit">{{ declension.days(bonusValue) }}</span> </div> </div> </div> </div> </div> </div> </div></div>',e)}var a=i(2);t.default=n},function(e,t,i){function n(e){return a.default.render('<div class="motivation motivation-confirm modal-view modal-view_start {% if isLastStep %}modal-view_finish {% endif %}js-motivation-registration-success-block"> <div class="motivation__container motivation__container_centered"> <div class="motivation__container-inner motivation__container-inner_centered"> <div class="motivation__content"> <div class="motivation__badge"> <span class="user-badge user-badge_full-width user-badge_depicts-email "> <span class="user-badge__icon">{{ email|capitalize|first }}</span> <span class="user-badge__information-type">{{ email }}</span> </span> </div> <h2 class="motivation__title motivation__title_centered motivation__title_small">Подарок отправлен</h2> <div class="motivation__main motivation__main_centered"> <p class="motivation__info"> Мы отправили письмо на&nbsp;указанный email, перейдите по&nbsp;ссылке из&nbsp;этого письма, чтобы активировать {{ bonusValue }}&nbsp;{{ declension.days(bonusValue) }} подписки </p> <div class="motivation__button-wrapper motivation__button-wrapper_full-width"> <button class="ivi-button large motivation__ivi-button motivation__ivi-button_full-width js-modal-close">Продолжить</button> <button class="ivi-button pale outline large motivation__ivi-button motivation__ivi-button_full-width js-resend-bonus-registration">Выслать письмо повторно</button> </div> </div> </div> </div> </div></div>',e)}var a=i(2);t.default=n},function(e,t,i){var n=i(1),a=i(16),s=i(884),o=i(885),r=i(42),l=i(82),d=i(75),u=i(3),c=i(4),p=i(83),f=i(344);t.default=a.default.extend({CONTENT_VISIBLE_PART:.1,SAVE_RESULTS_LOADING_TIME:4e3,OUTER_TOUCH_MOVE_MULTIPLIER:2,CONTENT_TOGGLE_CLASS:"user-onboarding-selector__link_checked",template:s.default,openEvent:"start:favouritesOnboarding:show",modalId:"favourites-onboarding",mobileModal:!0,wrapper:a.default.prototype.wrapper+"-favourites-onboarding",bodyClass:"has-user-onboarding",fullAnimation:!0,mobileScroll:!0,renderAnimationDuration:1e3,destroyAnimationDuration:600,events:{"click .js-show-onboarding":"showOnboardingScreen","click .js-content":"toggleContentInFavourites","click .js-save-results":"saveResults","click .js-skip-onboarding":"skipOnboarding"},minSelect:null,defaultSelect:null,chosenContentCount:0,shownContentIds:[],fullToplineHeight:0,inertiaStartTimeStamp:null,bindedHandleScrollInertia:null,touchMoveEventScreenY:null,initialize:function(e){this.minSelect=e.mapiData.getFavouritesOnboardingContentMinSelect(),this.defaultSelect=e.mapiData.getFavouritesOnboardingContentDefaultSelect(),this.browserInfo=e.browserInfo,this.listenTo(d.default,"collection:favouritesOnboardingMoreDataIsAvailable",this.appendOnboardingContent),window.addEventListener("resize",this.handleResize.bind(this)),this.bindedHandleScrollInertia=this.handleScrollInertia.bind(this),f.default.setRequestAnimationFrame(),window.ivi.adaptive.isMobile&&(this.events.touchmove="outerScrollRedirection",this.events.touchend="outerScrollRedirection")},handleResize:function(){var e=n(".js-selector-topline");e.length>0&&n(".js-content-container").attr("style","padding-top: "+e.outerHeight()+"px")},serializeData:function(){return{onboardingContent:this.collection.models.map(function(e){return o.default({content:e})}).join(""),defaultSelect:this.defaultSelect}},beforeRender:function(){l.default.trigger("mobile:removeBranchLinkBlock"),a.default.prototype.beforeRender.apply(this,arguments)},onShow:function(){u.default.rewriteSuperProperties({page:"content_onboarding"}),this.trackOnboardingShow(),this.collection.getNextOnboardingContent(),window.ivi.adaptive.isMobile?(n(".js-onboarding-screen").addClass("user-onboarding_mobile-scroll"),this.handleScrollInertia()):(n(".js-onboarding-screen").addClass("user-onboarding_desktop-scroll"),n(".js-content-container").on("scroll",this.onContentContainerScroll.bind(this)))},appendOnboardingContent:function(){var e=this.$el.find(".js-content-container");e.empty(),this.collection.models.forEach(function(t){e.append(o.default({content:t}))}),this.collection.getNextOnboardingContent()},handleScrollInertia:function(e){this.inertiaStartTimeStamp||(this.inertiaStartTimeStamp=c.default.getPerformance().now()),e-this.inertiaStartTimeStamp>200&&(this.inertiaStartTimeStamp=c.default.getPerformance().now(),this.changeToplineSize()),c.default.requestAnimationFrame(this.bindedHandleScrollInertia)},onContentContainerScroll:function(e){this.changeToplineSize(e),this.checkVisibleContent()},changeToplineSize:function(){var e=n(".js-user-onboarding-selector");e.length>0&&(window.ivi.adaptive.isMobileStyle&&-1*n(".js-content-container").offset().top>=this.fullToplineHeight?e.addClass("user-onboarding-selector_hide-elements"):e.removeClass("user-onboarding-selector_hide-elements"))},checkVisibleContent:function(){var e=this,t=n(".js-content"),i=t.eq(0).height()*this.CONTENT_VISIBLE_PART,a=n(".js-user-onboarding-selector").height();t.each(function(t,s){var o=n(s),r=o.data("id"),l=o.offset().top;-1===e.shownContentIds.indexOf(r)&&l+i<a&&e.shownContentIds.push(r)})},rendererCompleted:function(){a.default.prototype.rendererCompleted.apply(this,arguments),this.fullToplineHeight=n(".js-selector-topline").height(),this.browserInfo.isIos()&&this.$el.find(".user-onboarding-selector__content").attr("style","-webkit-overflow-scrolling:touch")},trackOnboardingShow:function(){u.default.track("page_view"),u.default.track("show_content_onboarding_page")},showOnboardingScreen:function(){this.$el.find(".js-onboarding-screen"),u.default.track("popup_click",{where_click:"start_onboarding",popup_type:"content_onboarding_popup"}),this.trackOnboardingShow(),this.handleResize()},getContentsInRow:function(){var e=this.$el.find(".js-content").first(),t=e.width(),i=e.offset().left,n=this.$el.find(".js-content-container"),a=n.width(),s=n.offset().left,o=i-s;return c.default.mathTrunc(a/(t+2*o))},toggleContentInFavourites:function(e){var t=n(e.currentTarget),i=t.data("id"),a=this.collection.findWhere({id:i});if(a){var s=this.collection.models.indexOf(a),o=this.getContentsInRow(),l=c.default.mathTrunc(s/o),d=void 0,p={position:l+1,content_position:s-o*l+1};if(t.hasClass(this.CONTENT_TOGGLE_CLASS))d="onboarding_poster_unclick",a.deleteContentFromUserPreferences(),t.removeClass(this.CONTENT_TOGGLE_CLASS),--this.chosenContentCount;else{var f=n(".js-first-progress-wave"),h=n(".js-second-progress-wave");f.removeClass("circle-progress-bar__wave-one-animate"),h.removeClass("circle-progress-bar__wave-two-animate"),d="onboarding_poster_click",a.addContentToUserPreferences(),t.addClass(this.CONTENT_TOGGLE_CLASS),++this.chosenContentCount,setTimeout(function(){f.addClass("circle-progress-bar__wave-one-animate"),h.addClass("circle-progress-bar__wave-two-animate")},100)}a.isCompilation()?u.default.rewriteSuperProperties({compilation_id:a.getId()}):u.default.rewriteSuperProperties({content_id:a.getId()}),u.default.track(d,p),this.changeProgress(),this.chosenContentCount>0?r.default.trigger("start:favouritesOnboarding:anyContentChosen"):r.default.trigger("start:favouritesOnboarding:nothingChosen")}return!1},changeProgress:function(){var e=n(".js-circle-line"),t=e.attr("stroke-dasharray"),i=this.chosenContentCount/this.defaultSelect,a=t-t*i;e.attr("stroke-dashoffset",i>1?1:Math.round(a)),this.chosenContentCount>=this.defaultSelect?this.$el.find(".js-progress-count").addClass("circle-progress-bar__count_full"):(this.$el.find(".js-progress-count").text(this.chosenContentCount),this.$el.find(".js-progress-count").removeClass("circle-progress-bar__count_full"));var s=this.$el.find(".js-top-title-line"),o=this.$el.find(".js-bottom-title-line");this.chosenContentCount>=this.minSelect?(s.removeClass("user-onboarding-selector__title-button_skip_show").addClass("user-onboarding-selector__title-button_save_show"),o.removeClass("user-onboarding-selector__bottom-line_show-button_skip").addClass("user-onboarding-selector__bottom-line_show-button_save")):(s.removeClass("user-onboarding-selector__title-button_save_show").addClass("user-onboarding-selector__title-button_skip_show"),o.removeClass("user-onboarding-selector__bottom-line_show-button_save").addClass("user-onboarding-selector__bottom-line_show-button_skip"))},skipOnboarding:function(){this.checkVisibleContent(),u.default.track("content_onboarding_skip_click",{chosen_number:this.chosenContentCount,shown_number:this.shownContentIds.length}),this.triggerCancel(),this.chosenContentCount>0&&c.default.forceReload()},checkKey:function(e){p.default.getKeyCode(e)===p.default.KEY_ESCAPE&&u.default.track("popup_click",{where_click:"cancel_escape",popup_type:"content_onboarding_popup"}),a.default.prototype.checkKey.call(this,e)},onRenderAnimation:function(){var e=this;a.default.prototype.onRenderAnimation.apply(this,arguments),setTimeout(function(){return e.handleResize()},50)},saveResults:function(){this.$el.find(".js-onboarding-screen").addClass("user-onboarding_end-active"),this.checkVisibleContent(),u.default.track("content_onboarding_save_and_continue_click",{chosen_number:this.chosenContentCount,shown_number:this.shownContentIds.length}),setTimeout(function(){c.default.forceReload()},this.SAVE_RESULTS_LOADING_TIME)},outerScrollRedirection:function(e){var t=n(e.target);if((0===t.closest(".js-content-container").length||t.hasClass("js-content-container"))&&!t.hasClass("user-onboarding-selector__bottom-line-button")&&!t.hasClass("user-onboarding-selector__title-button")&&e.originalEvent.changedTouches&&e.originalEvent.changedTouches.length>0){if(t.hasClass("user-onboarding-selector__top-line")||t.closest(".user-onboarding-selector__top-line").length>0||t.hasClass("user-onboarding-selector__bottom-line")||t.closest(".user-onboarding-selector__bottom-line").length>0)return!1;if("touchend"===e.type)return this.touchMoveEventScreenY=null,!1;if(null===this.touchMoveEventScreenY)return this.touchMoveEventScreenY=e.originalEvent.changedTouches[0].screenY,!1;var i=e.originalEvent.changedTouches[0].screenY,a=(i-this.touchMoveEventScreenY)*this.OUTER_TOUCH_MOVE_MULTIPLIER,s=this.$el.find(".user-onboarding-selector__content"),o=s.scrollTop();return s.scrollTop(o-a),this.touchMoveEventScreenY=e.originalEvent.changedTouches[0].screenY,!1}}})},function(e,t,i){function n(e){return a.default.render('<div class="user-onboarding js-onboarding-screen"> <div class="user-onboarding__overlay"> <span></span> <span></span> <span></span> </div> <div class="user-onboarding__wrapper js-onboarding-selector"> <section class="user-onboarding-selector js-user-onboarding-selector"> <div class="user-onboarding-selector__top-line js-selector-topline"> <div class="user-onboarding-selector__top-line-wrapper"> <div class="circle-progress-bar"> <div class="circle-progress-bar__container"> <svg class="circle-progress-bar__widget" width="90" height="90" viewBox="0 0 90 90"> <circle class="circle-progress-bar__progress-static" cx="45" cy="45" r="40" fill="none" stroke="#1d193f" stroke-width="6" stroke-dasharray="251" stroke-dashoffset="-0"></circle> <circle class="circle-progress-bar__progress-line js-circle-line" cx="45" cy="45" r="40" fill="none" stroke="#ec174f" stroke-width="6.5" stroke-dasharray="251" stroke-dashoffset="251" stroke-linecap="round" x1="60" y1="30" x2="60" y2="90"></circle> </svg> <div class="circle-progress-bar__count js-progress-count">0</div> <div class="circle-progress-bar__wave-one js-first-progress-wave"></div> <div class="circle-progress-bar__wave-two js-second-progress-wave"></div> </div> </div> <div class="user-onboarding-selector__title user-onboarding-selector__title-button_skip_show js-top-title-line"> <h2 class="user-onboarding-selector__title-content"> Выберите {{ defaultSelect }} {{ declension.movies(defaultSelect) }}, которые вам нравятся <span class="user-onboarding-selector__title-content_sub user-onboarding-selector__top-line_hide">Это поможет ivi рекомендовать фильмы специально для вас</span> </h2> <button class="ivi-button large user-onboarding-selector__title-button user-onboarding-selector__title-button_save js-save-results">Сохранить и продолжить</button> <button class="ivi-button large outline user-onboarding-selector__title-button user-onboarding-selector__title-button_skip js-skip-onboarding">Пропустить</button> </div> </div> </div> <div class="user-onboarding-selector__content user-onboarding-selector_grid-container"> <ul class="user-onboarding-selector__content-list user-onboarding-selector_grid-container-inner js-content-container"> {{ onboardingContent }} </ul> </div> <div class="user-onboarding-selector__bottom-line user-onboarding-selector__bottom-line_show-button_skip js-bottom-title-line"> <div class="user-onboarding-selector__bottom-line-wrapper"> <button class="ivi-button large user-onboarding-selector__bottom-line-button user-onboarding-selector__bottom-line-button_save js-save-results">Сохранить и продолжить</button> <button class="ivi-button large outline user-onboarding-selector__bottom-line-button user-onboarding-selector__bottom-line-button_skip js-skip-onboarding">Пропустить</button> </div> </div> </section> <div class="user-onboarding-end"> <div class="user-onboarding-end__wrapper"> <div class="user-onboarding-end__loader"> <div class="user-onboarding-end__loader-icon"></div> </div> <h3 class="user-onboarding-end__title"> Мы подбираем для вас фильмы. <span class="user-onboarding-end__title-mark">Это займет несколько секунд</span> </h3> </div> </div> </div></div>',e)}var a=i(2);t.default=n},function(e,t,i){function n(e){return a.default.render('<li class="user-onboarding-selector__content-item"> <span class="user-onboarding-selector__link js-content" data-id="{{ content.getId() }}"> <img class="user-onboarding-selector__content-image" src="{{ content.getPosterPath("/172x264/") }}" alt="{{ content.getTitle() }}" /> </span></li>',e)}var a=i(2);t.default=n},function(e,t,i){var n=i(0),a=i(1),s=i(42),o=i(7),r=i(18),l=i(3),d=i(887),u=i(888),c=i(4);t.default=n.View.extend({OFFER_BLOCKS_ANIMATION_TIMEOUT:300,TOPLINE_NONADAPTIVE_OFFER_WIDTH:1175,TOPLINE_ONBOARDING_OFFER_BODY_CLASS:"has-user-onboarding-invite-top",el:"body",events:{"click .js-open-onboarding":"openOnboarding"},isGrootForOnboardingOfferInCollectionSent:!1,initialize:function(){this.listenTo(o.default,"user:login",this.hideOnboardingOffer)},render:function(){var e=!1;return r.default.showFavouritesOnboardingInCollectionsOffer()?(this.$el.find(".personal-blocks").after(d.default()),e=!0):r.default.showFavouritesOnboardingToplineOffer()&&!window.ivi.adaptive.isMobile&&c.default.getViewPort().width>this.TOPLINE_NONADAPTIVE_OFFER_WIDTH&&(l.default.track("content_onboarding_view",{onboarding_place:"topline"}),this.$el.append(u.default()),this.$el.addClass(this.TOPLINE_ONBOARDING_OFFER_BODY_CLASS),window.addEventListener("resize",this.changeToplineBlockPosition.bind(this)),e=!0),this.afterRender(),e},afterRender:function(){var e=this;setTimeout(function(){if(r.default.showFavouritesOnboardingInCollectionsOffer()){var t=e.$el.find(".user-onboarding-invite-content");t.addClass("user-onboarding-invite-content_animate-content"),window.ivi.adaptive.isMobile&&(t.css("margin-bottom","0px"),a("#js-favourites-mobile-carousel .viewport").css("margin-bottom","0px")),window.addEventListener("scroll",e.checkInCollectionOfferVisibility.bind(e)),e.checkInCollectionOfferVisibility()}else r.default.showFavouritesOnboardingToplineOffer()&&!window.ivi.adaptive.isMobile&&e.$el.find(".user-onboarding-invite-top").addClass("user-onboarding-invite-top_animate-content")},this.OFFER_BLOCKS_ANIMATION_TIMEOUT)},openOnboarding:function(){return r.default.showFavouritesOnboardingInCollectionsOffer()?l.default.track("content_onboarding_button_click",{onboarding_place:"banner"}):r.default.showFavouritesOnboardingToplineOffer()&&l.default.track("content_onboarding_button_click",{onboarding_place:"topline"}),s.default.trigger("start:favouritesOnboarding:show"),!1},changeToplineBlockPosition:function(){var e=this.$el.find(".user-onboarding-invite-top").height();this.$el.css("margin-top",e+"px"),this.$el.find(".js-menu-block").css("top",e+"px")},hideOnboardingOffer:function(){this.$el.find(".user-onboarding-invite-top, .user-onboarding-invite-content").remove(),r.default.showFavouritesOnboardingToplineOffer()&&this.$el.removeClass(this.TOPLINE_ONBOARDING_OFFER_BODY_CLASS)},checkInCollectionOfferVisibility:function(){var e=this.$el.find(".user-onboarding-invite-content").get(0).getBoundingClientRect();!this.isGrootForOnboardingOfferInCollectionSent&&e.top+e.height<c.default.getViewPort().height&&(this.isGrootForOnboardingOfferInCollectionSent=!0,l.default.track("content_onboarding_view",{onboarding_place:"banner"}))}})},function(e,t,i){function n(e){return a.default.render('<section class="user-onboarding-invite-content"> <div class="user-onboarding-invite-content__container"> <div class="user-onboarding-invite-content__title">Хотите улучшить рекомендации?</div> <div class="user-onboarding-invite-content__title-mark">Настройте ivi, это поможет нам рекомендовать фильмы специально для вас</div> <div class="ivi-button huge user-onboarding-invite-content__button js-open-onboarding" title="Нажмите чтобы улучшить свои рекомендации">Улучшить рекомендации</div> <div class="user-onboarding-invite-content__widget"> <div class="user-onboarding-invite-content__widget-image"></div> <div class="user-onboarding-invite-content__widget-wave-one"></div> <div class="user-onboarding-invite-content__widget-wave-two"></div> </div> </div></section>',e)}var a=i(2);t.default=n},function(e,t,i){function n(e){return a.default.render('<section class="user-onboarding-invite-top"> <div class="user-onboarding-invite-top__grid-container"> <div class="user-onboarding-invite-top__container user-onboarding-invite-top_grid-container-inner"> <div class="user-onboarding-invite-top__content"> <div class="user-onboarding-invite-top__title">Какие фильмы вам нравятся?</div> <div class="user-onboarding-invite-top__title-mark">Настройте ivi, это поможет нам рекомендовать фильмы специально для вас</div> </div> <div class="ivi-button huge user-onboarding-invite-top__button js-open-onboarding" title="Нажмите чтобы улучшить свои рекомендации">Улучшить рекомендации</div> <div class="user-onboarding-invite-top__widget"> <div class="user-onboarding-invite-top__widget-image"></div> <div class="user-onboarding-invite-top__widget-wave-one"></div> <div class="user-onboarding-invite-top__widget-wave-two"></div> </div> </div> </div></section>',e)}var a=i(2);t.default=n},function(e,t,i){var n=i(67),a=i(890),s=i(103),o=n.default.extend(s.default).extend({ONBOARDING_CONTENT_LIMIT_DESKTOP:32,ONBOARDING_CONTENT_LIMIT_TABLE:24,ONBOARDING_CONTENT_LIMIT_MOBILE:12,loadingSize:null,selectionFrom:0,selectionTo:null,selectionPrefix:"favouritesOnboarding",model:a.default,uri:"/hydra/get/onboarding/v5/",fields:"id,title,poster_originals,kind",sendUserABBucket:!0,initialize:function(){this.loadingSize=window.ivi.adaptive.isMobile?window.ivi.adaptive.isMobileStyle?this.ONBOARDING_CONTENT_LIMIT_MOBILE:this.ONBOARDING_CONTENT_LIMIT_TABLE:this.ONBOARDING_CONTENT_LIMIT_DESKTOP,this.selectionTo=this.loadingSize-1,n.default.prototype.initialize.apply(this,arguments)},getNextOnboardingContent:function(){this.increaseSelection(this.loadingSize),this.getOnboardingContent()},getOnboardingContent:function(){return this.mapiGet({data:{withpreorderable:0}})}});t.default=o},function(e,t,i){var n=i(40),a=i(14),s=a.default.extend(n.default.prototype).extend({USER_PREFERENCE_ADD_CONTENT_URI:"/user_preference/v5/add",USER_PREFERENCE_DELETE_CONTENT_URI:"/user_preference/v5/delete",addContentToUserPreferences:function(){this.mapiPost({uri:"/"+this.getContentType()+this.USER_PREFERENCE_ADD_CONTENT_URI,data:{id:this.getId()}})},deleteContentFromUserPreferences:function(){this.mapiPost({uri:"/"+this.getContentType()+this.USER_PREFERENCE_DELETE_CONTENT_URI,data:{id:this.getId()}})},getContentType:function(){return this.isCompilation()?"compilation":"video"}});t.default=s},function(e,t,i){var n=i(12),a=i(9),s=i(892);t.default=a.default.extend({routes:["/trailers","/trailers/pageint:page"],run:function(e){n.default.prototype.run(e),(new s.default).execute(e)}})},function(e,t,i){var n=i(893),a=i(6),s=i(202),o=i(125),r=i(203),l=i(274),d=i(55),u=i(100),c=i(1);t.default=a.default.extend({playerModal:null,run:function(e){new n.default({collection:new l.default,page:e.page}).render(),this.playerModal=new o.default,this.playerModal.listen(d.default),(new s.default).listen(d.default),new r.default,window.ivi.adaptive.isMobile||new u.default,c(window).on("message",this.postMessageHandler.bind(this))},postMessageHandler:function(e){var t=e.originalEvent.data;if(t&&"player"===t.type)switch(t.message){case"playerEnded":this.playerModal&&this.playerModal.closeModal()}}})},function(e,t,i){var n=i(1),a=i(265),s=i(894),o=i(269),r=i(74),l=i(273),d=i(895),u=i(896),c=i(270),p=i(271),f=i(272),h=i(5),g=i(117),m=i(3),v=i(267),_=i(55),b=i(4);t.default=a.default.extend({el:".js-trailers-catalog",eroticGenreId:169,genresAndCategories:[],eroticModalModel:null,events:{"click .js-catalog-filter-category a":"handleStateMutableFilterClick","click .js-catalog-filter-genre a":"handleStateMutableFilterClick","click .js-catalog-filter-year a":"handleStateMutableFilterClick","click .js-catalog-filter-country a":"handleStateMutableFilterClick","change .filters-container select":"handleSelect","focus .js-catalog-filter-genre select":"saveGenrePrevValue","click a.js-collection-content":"setBlockId","click .show-filters":"toggleMobileFilter","click .filters-close":"toggleMobileFilter","click .filters-wrapper-container > .overlay":"toggleMobileFilter","click .js-catalog-reset-filters":"resetFilters"},initialize:function(e){this.page=e&&e.page?parseInt(e.page,10):1,this.$el.find(".js-expandable").on("mouseenter mouseleave",this.toggleMenu.bind(this))},render:function(){var e=this;this.videoYearsModel=new p.default,this.videoCountriesModel=new c.default,this.years=new f.default,this.country=new o.default,this.category=new s.default,this.genre=new d.default,n(".js-catalog-filter-genre a").each(function(t,i){var a=n(i);"all"!==a.data("genres-and-categories-ids")&&(e.genresAndCategories[a.data("genre-index")]=a.data("genres-and-categories-ids"))}),this.parseDefaultParams(),this.baseUrl="/trailers";var t={year_from:this.years.getYearFrom(),year_to:this.years.getYearTo(),country:this.country.getId(),has_trailer:!0,fake:!0,withpreorderable:!0,genre_operator:"or"};this.genre.getGenres().length?t.genre=this.genre.getGenres().join(","):this.category.getCategoryId()&&(t.category=this.category.getCategoryId()),this.model=new l.default(t),this.baseFilterModelParams=h.clone(this.model.defaults),this.replaceHistoryState(),this.videoListView=new u.default({model:this.model,collection:this.collection,page:this.page}),this.fixFilters(),this.listenTo(_.default,"trailers:catalog:filtered",this.scrollToTopPosters),this.listenTo(_.default,"trailers:catalog:added",this.nextPage),this.listenTo(g.default,"common:waypointReached",this.setPage),this.years.on("change",this.handleYearsChange,this),this.category.on("change",this.handleCategoryChange,this),this.genre.on("change",this.handleGenreChange,this),this.country.on("change",this.handleCountryChange,this),h.isUndefined(window.onpopstate)||(window.onpopstate=this.popHistoryState.bind(this)),this.eroticModalModel=new r.default,this.collectMobileFiltersInfo()},parseDefaultParams:function(){if(this.$el.data("years-url")&&(this.years.set("url",this.$el.data("years-url")||""),this.years.set("yearFrom",this.$el.data("years-from")||""),this.years.set("yearTo",this.$el.data("years-to")||"")),this.$el.data("country-id")&&(this.country.set("id",this.$el.data("country-id")||""),this.country.set("code",this.$el.data("country-code")||"")),this.$el.data("category-id")&&(this.category.set("categoryId",this.$el.data("category-id")||""),this.category.set("categoryHru",this.$el.data("category-hru")||"")),this.$el.data("genres-ids")){var e=String(this.$el.data("genres-ids")).split(","),t=parseInt(e[0]),i=null,n=function(e){return e.genreId};for(var a in this.genresAndCategories){var s=h.map(this.genresAndCategories[a],n);if(h.contains(s,t)){i=a;break}}this.genre.set("genres",e||null),this.genre.set("currentGenreIndex",i)}},handleStateMutableFilterClick:function(e){var t=n(e.target).closest("a");return!t.hasClass("disabled")&&(this.pushHistory=!0,this.page=1,t.closest(".js-catalog-filter-year").length?this.filterYear(t):t.closest(".js-catalog-filter-genre").length?this.filterGenre(t):t.closest(".js-catalog-filter-category").length?this.filterCategory(t):t.closest(".js-catalog-filter-country").length&&this.filterCountry(t),!1)},filterGenre:function(e){var t=this,i=null,a=null;"all"!==e.data("genres-and-categories-ids")&&(i=h.map(e.data("genres-and-categories-ids"),function(e){return e.genreId}),a=e.data("genre-index"));var s=function(){t.changeFiltersUIValues("genre",e.data("value"),n.trim(e.text())||n.trim(e.data("caption"))),t.applyGenreFilter(i,a)};return h.contains(i,this.eroticGenreId)&&!this.eroticModalModel.canWatchAdultContent()?(_.default.trigger("trailers:showEroticModal"),this.listenToOnce(_.default,"trailers:18plus:answer",function(e){e&&(this.eroticModalModel.allowToWatchAdultContent(),s.bind(this)())}),!1):(s.bind(this)(),!1)},applyGenreFilter:function(e,t){if(this.resetYearAndCountry(),!h.isNull(e)&&!h.isNull(t)){var i=e.join(","),n=this.category.getCategoryId();if(n){var a=h.chain(this.genresAndCategories[t]).filter(function(e){return e.categoryId===n}).first().value().genreId;this.model.apply({genre:a,category:null}),e=[a]}else this.model.apply({genre:i,category:null})}h.isNull(this.genre.getCurrentGenreIndex())&&h.isNull(t)&&this.genre.trigger("change"),this.genre.set({currentGenreIndex:t,genres:e}),this.trackEvents("genre",h.isNull(e)?"all":e)},handleGenreChange:function(){var e=this.genre.getCurrentGenreIndex();if(h.isNull(e))this.resetCategoryAndGenreFilter();else if(this.genresAndCategories[e]){var t=n(".js-catalog-filter-category a"),i=n('select[name="category"]'),a=i.find("option"),s=h.map(this.genresAndCategories[e],function(e){return e.categoryId});t.addClass("disabled"),a.attr("disabled","disabled");for(var o=0;o<s.length;o++){var r=s[o];t.filter('[data-category-id="'+r+'"]').removeClass("disabled"),a.filter('[data-category-id="'+r+'"]').removeAttr("disabled")}t.filter('[data-category-id="all"]').removeClass("disabled"),a.filter('[data-category-id="all"]').removeAttr("disabled"),a.filter('[value="some"]').removeAttr("disabled"),0===i.find('option[value="some"]').length&&window.ivi.adaptive.isMobileStyle&&(i.prepend('<option value="some">Несколько категорий</option>'),i.val("some"),n(".js-catalog-filter-category .js-catalog-filter-value").text("Несколько категорий"),n(".js-catalog-filter-category .js-catalog-filter-item").addClass("selected"))}this.pushHistoryState(),this.refreshCountries(),this.refreshYears()},filterCategory:function(e){var t=e.data("category-id"),i=e.data("category-hru");return"all"===t&&(t=null),this.applyCategoryFilter(t,i),this.changeFiltersUIValues("category",e.data("value"),n.trim(e.text())||n.trim(e.data("caption"))),!1},applyCategoryFilter:function(e,t){if(this.resetYearAndCountry(),!h.isNull(e)){var i=this.genre.getCurrentGenreIndex();if(i){var n=h.chain(this.genresAndCategories[i]).filter(function(t){return t.categoryId===e}).first().value().genreId;this.model.apply({category:null,genre:n}),this.genre.set({genres:[n]},{silent:!0})}else this.model.apply({category:e,genre:null}),this.genre.set({genres:null},{silent:!0})}h.isNull(this.category.getCategoryId())&&h.isNull(e)&&this.category.trigger("change"),this.category.set({categoryId:e,categoryHru:t}),this.trackEvents("category",h.isNull(e)?"all":e)},handleCategoryChange:function(){var e=this.category.getCategoryId(),t=n(".js-catalog-filter-genre a"),i=n('select[name="genre"]').find("option");if(t.removeClass("disabled"),i.removeAttr("disabled"),e){var a=function(e){return e.categoryId};for(var s in this.genresAndCategories){var o=h.map(this.genresAndCategories[s],a);h.contains(o,e)||(t.filter('[data-genre-index="'+s+'"]').addClass("disabled"),i.filter('[data-genre-index="'+s+'"]').attr("disabled","disabled"))}}else this.resetCategoryAndGenreFilter();n('select[name="category"]').find('option[value="some"]').remove(),this.pushHistoryState(),this.refreshCountries(),this.refreshYears()},prepareDataForDisableYearsOrCountries:function(){var e={};return this.model.getCategory()&&!this.model.getGenre()&&(e.category_id=this.model.getCategory()),e.has_trailer=!0,e.fake=!0,e.withpreorderable=!0,e},getStateObject:function(){var e=window.ivi.adaptive.isMobileStyle;return{years:this.years.attributes,country:this.country.attributes,category:this.category.attributes,genre:this.genre.attributes,filterParams:this.model.attributes,filtersState:{categories:this.getFilterState(n(".js-catalog-filter-category"),e),genres:this.getFilterState(n(".js-catalog-filter-genre"),e),years:this.getFilterState(n(".js-catalog-filter-year"),e),countries:this.getFilterState(n(".js-catalog-filter-country"),e)}}},getFilterState:function(e,t){var i=[],a=[];return t?e.find("option").each(function(e,t){var s=n(t);s.is(":selected")&&i.push(e),s.is(":disabled")||a.push(e)}):e.find("a").each(function(e,t){var s=n(t);s.hasClass("active")&&i.push(e),s.hasClass("disabled")||a.push(e)}),{title:e.find(".js-catalog-filter-value").first().text(),active:i,available:a}},pushHistoryState:function(){this.pushHistory&&b.default.pushHistoryState(this.getStateObject(),null,this.getTrailersCatalogUrl())},replaceHistoryState:function(){b.default.replaceHistoryState(this.getStateObject(),null,this.getTrailersCatalogUrl())},popHistoryState:function(e){e.state&&(this.pushHistory=!1,this.genre.set(e.state.genre,{silent:!0}),this.category.set(e.state.category,{silent:!0}),this.country.set(e.state.country,{silent:!0}),this.years.set(e.state.years,{silent:!0}),this.model.apply(e.state.filterParams),this.changeFiltersUIValues("category",e.state.category.categoryId||"all",n.trim(e.state.filtersState.categories.title)),this.changeFiltersUIValues("genre",e.state.genre.currentGenreIndex||"all",n.trim(e.state.filtersState.genres.title)),this.changeFiltersUIValues("year",e.state.years.url||"",n.trim(e.state.filtersState.years.title)),this.changeFiltersUIValues("country",e.state.country.id||"",n.trim(e.state.filtersState.countries.title)),this.collectMobileFiltersInfo())},getTrailersCatalogUrl:function(){var e={},t=b.default.getLocation().search,i={category:/([?&](category=[^&]*))/.exec(t),genre:/([?&](genre=[^&]*))/.exec(t),year:/([?&](year=[^&]*))/.exec(t),country:/([?&](country=[^&]*))/.exec(t)},a={category:this.category.getCategoryHru(),genre:this.genre.getGenres()?this.genre.getGenres().join(","):null,year:this.years.getUrl(),country:this.country.getCode()};for(var s in a)!function(n,a){i[n]?t=a?t.replace(i[n][2],n+"="+decodeURIComponent(a)):t.replace(i[n][1],""):a&&(e[n]=a)}(s,a[s]);h.isEmpty(e)||(t=t?t+"&":"?");var o=this.page>1?"/page"+this.page:"";return h.isEmpty(e)?this.baseUrl+o+t:this.baseUrl+o+t+decodeURIComponent(n.param(e))},setBlockId:function(){m.default.setBlockId("trailers_catalog")},saveGenrePrevValue:function(e){var t=n(e.target);this.genrePrevValue=t.val()},getFilterSelectValue:function(e){var t=e.find(":selected"),i=e.closest("li").find("span"),a=i.text();switch(e.blur(),i.html(t.text()),this.$el.find(".filters").toggleClass("expanded"),e.attr("name")){case"category":var s=t.data("category-id"),o=t.data("category-hru");"all"===s&&(s=null),this.changeFiltersUIValues("category",t.data("value"),n.trim(t.text())||n.trim(t.data("caption"))),this.applyCategoryFilter(s,o),this.collectMobileFiltersInfo();break;case"genre":var r=null,l=null;"all"!==t.data("genres-and-categories-ids")&&(r=h.map(t.data("genres-and-categories-ids"),function(e){return e.genreId}),l=t.data("genre-index")),h.contains(r,this.eroticGenreId)&&!this.eroticModalModel.canWatchAdultContent()?(_.default.trigger("trailers:showEroticModal"),this.listenToOnce(_.default,"trailers:18plus:answer",function(s){s?(this.eroticModalModel.allowToWatchAdultContent(),this.changeFiltersUIValues("genre",t.data("value"),n.trim(t.text())||n.trim(t.data("caption"))),this.applyGenreFilter(r,l),this.collectMobileFiltersInfo()):(e.val(this.genrePrevValue),i.html(a))})):(this.changeFiltersUIValues("genre",t.data("value"),n.trim(t.text())||n.trim(t.data("caption"))),this.applyGenreFilter(r,l),this.collectMobileFiltersInfo());break;case"country":var d=t.data("country-code"),u=e.val();this.changeFiltersUIValues("country",u,n.trim(t.text())||n.trim(t.data("caption"))),this.applyCountryFilter(u,d),this.collectMobileFiltersInfo();break;case"year":var c=t.data("year-from"),p=t.data("year-to"),f=t.data("year-url");this.changeFiltersUIValues("year",f,n.trim(t.text())||n.trim(t.data("caption"))),this.applyYearFilter(c,p,f),this.collectMobileFiltersInfo()}},resetFilter:function(e,t){e.find("a").removeClass("disabled"),t.find("option").removeAttr("disabled")},resetCategoryAndGenreFilter:function(){var e=n(".js-catalog-filter-category"),t=n(".js-catalog-filter-genre"),i=n('select[name="category"]'),a=n('select[name="genre"]');this.resetFilter(e,i),this.resetFilter(t,a),this.changeFiltersUIValues("genre",t.find("a.js-catalog-default-value").data("value"),n.trim(t.find("a.js-catalog-default-value").text())),this.changeFiltersUIValues("category",e.find("a.js-catalog-default-value").data("value"),n.trim(e.find("a.js-catalog-default-value").text())),i.val("all"),a.val("all"),this.model.apply({category:null,genre:null}),this.category.set({categoryId:null,categoryHru:null},{silent:!0}),this.genre.set({currentGenreIndex:null,genres:null},{silent:!0})},resetYearAndCountry:function(){var e=n(".js-catalog-filter-year"),t=n(".js-catalog-filter-country"),i=n('select[name="country"]'),a=n('select[name="year"]');this.resetFilter(e,i),this.resetFilter(t,a),this.changeFiltersUIValues("year",e.find("a.js-catalog-default-value").data("value"),n.trim(e.find("a.js-catalog-default-value").text())),this.changeFiltersUIValues("country",t.find("a.js-catalog-default-value").data("value"),n.trim(t.find("a.js-catalog-default-value").text())),i.val(""),a.val(""),this.years.set({url:null,yearFrom:null,yearTo:null},{silent:!0}),this.country.set({code:null,id:null},{silent:!0}),this.model.set({country:null,year_from:null,year_to:null},{silent:!0})},trackEvents:function(e,t){var i=t?{filter_value:t}:{},n="trailers_filter_"+e;m.default.track(n,i)},refreshYears:function(){var e=this;this.videoYearsModel.resetAdditionUriParam();var t=this.prepareDataForDisableYearsOrCountries();this.country.getId()&&(t.country_id=this.country.getId());var i=v.default.prepareRepeatingUrlParameter("genre_id",this.model.getGenre());i&&this.videoYearsModel.addParamsToUri(i),this.videoYearsModel.mapiGet({data:t}).done(function(t){t.result&&e.disableYears(t.result)})},disableYears:function(e){var t=this;n('select[name="year"] option').removeAttr("disabled"),n('select[name="year"] option').each(function(){var i=n(this),a=i.data("year-from"),s=i.data("year-to");t.isYearsInList(a,s,e)||i.attr("disabled","disabled")}),n(".js-catalog-filter-year li a").removeClass("disabled"),n(".js-catalog-filter-year li a").each(function(){var i=n(this),a=n(this).data("year-from"),s=n(this).data("year-to");t.isYearsInList(a,s,e)||i.addClass("disabled")})},refreshCountries:function(){var e=this;this.videoCountriesModel.resetAdditionUriParam();var t=this.prepareDataForDisableYearsOrCountries();this.years.getYearFrom()&&(t.year_from=this.years.getYearFrom()),this.years.getYearTo()&&(t.year_to=this.years.getYearTo());var i=v.default.prepareRepeatingUrlParameter("genre_id",this.model.getGenre());i&&this.videoCountriesModel.addParamsToUri(i),this.videoCountriesModel.mapiGet({data:t}).done(function(t){t.result&&e.disableCountries(t.result)})},disableCountries:function(e){n('select[name="country"] option').each(function(){var t=n(this),i=t.val();i&&h.isUndefined(e[i])?t.attr("disabled","disabled"):t.removeAttr("disabled")}),n(".js-catalog-filter-country li a").each(function(){var t=n(this),i=t.data("value");i&&h.isUndefined(e[i])?t.addClass("disabled"):t.removeClass("disabled")})},handleCountryChange:function(){this.pushHistoryState(),this.refreshYears()},handleYearsChange:function(){this.pushHistoryState(),this.refreshCountries()},nextPage:function(){this.page&&this.page>1&&(this.pushHistory=!0,this.pushHistoryState())}})},function(e,t,i){var n=i(0);t.default=n.Model.extend({defaults:{categoryId:null,categoryHru:null},getCategoryId:function(){return this.get("categoryId")},getCategoryHru:function(){return this.get("categoryHru")}})},function(e,t,i){var n=i(0);t.default=n.Model.extend({defaults:{currentGenreIndex:null,genres:null},getCurrentGenreIndex:function(){return this.get("currentGenreIndex")},getGenres:function(){return this.get("genres")||[]}})},function(e,t,i){var n=i(1),a=i(266),s=i(61),o=i(5),r=i(897),l=i(44),d=i(55);t.default=a.default.extend({elementsPerPage:30,elementsPerLine:6,initialize:function(e){this.startPage=e.page-1,this.$videosContainer=this.$el.find(".gallery"),this.loadDataParams.data={fields:this.collection.fields},this.collection.setUriParams(this.model.attributes),this.model.on("change",this.filter,this),this.initLoadMore()},render:function(){var e=n("<div/>");s.default.render.apply(this,arguments),o.each(this.collection.models,function(t,i){n(r.default({video:t,loop:{index:i+1}})).appendTo(e)}),this.filtered?(this.$videosContainer.html(e.html()),d.default.trigger("trailers:catalog:filtered"),l.default.viewList(this.$el.find(".js-criteo-gallery"),!0)):(d.default.trigger("trailers:catalog:added"),this.$videosContainer.append(e.html())),!this.collection.length&&this.filtered&&this.$el.addClass(this.noResultsClass),this.filtered=!1,this.hideLoader(this.$el),this.afterRender()}})},function(e,t,i){function n(e){return a.default.render('<li class="{% if video.isInfoVideo() or video.isPreorderable() %}info {% endif %}{{ video.getPaidIcon() }}" data-content-id="{{ video.getId() }}" data-content-type="{% if video.isCompilation() %}compilation{% else %}content{% endif %}" data-content-position="{{ loop.index }}"> <a tabindex="-1" href="{{ video.getTrailersWatchLink() }}" target="_blank" class="item-content-wrapper js-collection-content{% if video.isForAdult() %} js-adult{% endif %}"> <span class="image" data-caption="Смотреть трейлер"> <img src="{{ video.getPosterPath("/140x215/") }}" alt="{{ video.getTitle() }}"> <span class="age-limit" data-value="{{ video.getRestrict()|default(0) }}+"></span> </span> <span class="title"><span>{{ video.getTitle() }}</span></span> </a> <div class="popup-wrapper-container"> <div class="popup-wrapper" data-hru="{% if video.isCompilation() %}{{ video.getHru() }}{% else %}{{ video.getId() }}{% endif %}"></div> </div></li>',e)}var a=i(2);t.default=n},function(e,t,i){var n=i(12),a=i(899),s=i(9);t.default=s.default.extend({routes:["/trailers/.*"],excludeRoutes:["/trailers/page.*"],run:function(e){n.default.prototype.run(e),(new a.default).execute(e)}})},function(e,t,i){var n=i(6),a=i(202),s=i(125),o=i(203),r=i(900),l=i(902),d=i(55),u=i(100);t.default=n.default.extend({run:function(){new l.default({collection:new r.default}),(new s.default).listen(d.default),(new a.default).listen(d.default),new o.default,window.ivi.adaptive.isMobile||new u.default}})},function(e,t,i){var n=i(29),a=i(901);t.default=n.default.extend({uri:"/trailers/v5/",model:a.default})},function(e,t,i){var n=i(0),a=i(40);t.default=n.Model.extend({videoKind:1,compilationKind:2,getId:function(){return this.get("id")},getKind:function(){return this.get("kind")},getPreview:function(){return this.get("preview")?this.get("preview").replace("http:",""):""},getContentTitle:function(){switch(this.getKind()){case this.videoKind:return this.get("content_title");case this.compilationKind:return this.get("compilation_title");default:return""}},getTitle:function(){return this.get("title")},getContentId:function(){return this.get("content_id")},getCompilationHru:function(){return this.get("compilation_hru")},getSingleTrailerWatchLink:function(){var e="/watch/";switch(this.getKind()){case this.videoKind:e+=this.getContentId();break;case this.compilationKind:e+=this.getCompilationHru()}return e+"/trailers/"+this.getId()+"#play"},getRestrict:function(){return this.get("restrict")},isForAdult:function(){return this.getRestrict()>=a.default.prototype.ageLimit}})},function(e,t,i){var n=i(1),a=i(0),s=i(61),o=i(5),r=i(903);t.default=a.View.extend(s.default).extend({el:".js-trailers-list",elementsPerPage:28,elementsPerLine:4,initialize:function(){this.loadDataParams.data={sort:this.$el.data("trailers-sort"),year_from:this.$el.data("trailers-year-from"),year_to:this.$el.data("trailers-year-to")};var e=this.prepareRepeatingUrlParameter("genre",this.$el.data("trailers-genre"));o.isNull(e)||this.collection.addParamsToUri(e),this.initLoadMore()},render:function(){var e=n("<div/>");s.default.render.apply(this,arguments),o.each(this.collection.models,function(t){n(r.default({trailer:t})).appendTo(e)}),this.$el.append(e.html()),this.afterRender()}})},function(e,t,i){function n(e){return a.default.render('{% set trailerTitle = trailer.getContentTitle() ~ ". " ~ trailer.getTitle() %}<li class="free"> <span class="item-content-wrapper"> <span class="image" data-caption="Смотреть" data-trailer-id="{{ trailer.getId() }}"> <img src="{{ trailer.getPreview() }}/220x128/" alt="{{ trailerTitle }}"> <span class="age-limit" data-value="{{ trailer.getRestrict()|default(0) }}+"></span> </span> <a tabindex="-1" href="{{ trailer.getSingleTrailerWatchLink() }}" class="title {% if trailer.isForAdult() %}js-adult{% endif %}"> <span>{{ trailerTitle }}</span> </a> </span></li>',e)}var a=i(2);t.default=n},function(e,t,i){var n=i(47),a=i(59),s=i(9),o=i(25);t.default=s.default.extend({routes:["/watch/int:id/awards"],run:function(e){o.default.prototype.run(e),(new n.default).execute(e),(new a.default).execute(e)}})},function(e,t,i){var n=i(47),a=i(59),s=i(143),o=i(9),r=i(25);t.default=o.default.extend({routes:["/watch/int:id/box"],run:function(e){r.default.prototype.run(e),(new s.default).execute(e),(new n.default).execute(e),(new a.default).execute(e)}})},function(e,t,i){var n=i(47),a=i(326),s=i(59),o=i(49),r=i(9),l=i(25);t.default=r.default.extend({routes:["/watch/int:id/comments","/watch/int:id/comments/pageint:page"],run:function(e){l.default.prototype.run(e),(new n.default).execute(e),(new s.default).execute(e),(new o.default).execute(e),(new a.default).execute(e)}})},function(e,t,i){var n=i(47),a=i(129),s=i(59),o=i(49),r=i(339),l=i(135),d=i(130),u=i(134),c=i(9),p=i(25);t.default=c.default.extend({routes:["/watch/int:id"],run:function(e){p.default.prototype.run(e),(new r.default).execute(e),(new n.default).execute(e),(new l.default).execute(e),(new d.default).execute(e),(new o.default).execute(e),(new a.default).execute(e),(new s.default).execute(e),(new u.default).execute(e)}})},function(e,t,i){var n=i(47),a=i(129),s=i(59),o=i(49),r=i(135),l=i(130),d=i(133),u=i(909),c=i(134),p=i(9),f=i(336),h=i(25);t.default=p.default.extend({routes:["/watch/int:id/description"],run:function(e){h.default.prototype.run(e),(new o.default).execute(e),(new r.default).execute(e),(new n.default).execute(e),(new l.default).execute(e),(new a.default).execute(e),(new f.default).execute(e),(new u.default).execute(e),(new s.default).execute(e),(new c.default).execute(e),(new d.default).execute(e)}})},function(e,t,i){var n=i(37),a=i(6),s=i(196),o=i(132),r=i(197),l=i(23);t.default=a.default.extend({run:function(e){a.default.prototype.run.call(this);var t=e.hru?new n.default:new l.default;new s.default({videoId:t.getId(),kind:1}),new r.default({collection:new o.default([],{contentType:t.getContentType()}),page:e.page,video:t,initWaypoint:!1})}})},function(e,t,i){var n=i(47),a=i(59),s=i(9),o=i(25);t.default=s.default.extend({routes:["/watch/int:id/person"],run:function(e){o.default.prototype.run(e),(new n.default).execute(e),(new a.default).execute(e)}})},function(e,t,i){var n=i(47),a=i(59),s=i(9),o=i(25);t.default=s.default.extend({routes:["/watch/int:id/premiere"],run:function(e){o.default.prototype.run(e),(new a.default).execute(e),(new n.default).execute(e)}})},function(e,t,i){var n=i(47),a=i(337),s=i(59),o=i(49),r=i(9),l=i(25);t.default=r.default.extend({routes:["/watch/int:id/reviews/int:reviewId"],run:function(e){l.default.prototype.run(e),(new n.default).execute(e),(new s.default).execute(e),(new o.default).execute(e),(new a.default).execute(e)}})},function(e,t,i){var n=i(47),a=i(59),s=i(49),o=i(135),r=i(338),l=i(133),d=i(9),u=i(25);t.default=d.default.extend({routes:["/watch/int:id/reviews","/watch/int:id/reviews/pageint:page"],run:function(e){u.default.prototype.run(e),(new o.default).execute(e),(new a.default).execute(e),(new n.default).execute(e),(new s.default).execute(e),(new r.default).execute(e),(new l.default).execute(e)}})},function(e,t,i){var n=i(47),a=i(59),s=i(340),o=i(9),r=i(25);t.default=o.default.extend({routes:["/watch/int:id/trailers","/watch/int:id/trailers/int:trailerId"],run:function(e){r.default.prototype.run(e),(new n.default).execute(e),(new a.default).execute(e),(new s.default).execute(e)}})},function(e,t,i){var n=i(12),a=i(916),s=i(9);t.default=s.default.extend({routes:["/unsubscribe"],run:function(e){n.default.prototype.run(e),(new a.default).execute(e)}})},function(e,t,i){var n=i(6),a=i(350);t.default=n.default.extend({run:function(){new a.default(n.default.prototype.queryParams)}})},function(e,t,i){var n=i(14),a=i(5);t.default=n.default.extend({changeStateUri:"/user/notification_state/",change:function(e,t){return this.mapiPost({uri:this.changeStateUri+"?"+this.toQueryString(this.filterParams(t)),data:{state:e?1:0}})},filterParams:function(e){var t=["sign","user_id","message_category_id","delivery_category_id","delivery_id","email","app_version"],i={};return a.each(e,function(e,n){-1!==t.indexOf(n)&&(i[n]=e)}),i},toQueryString:function(e){var t=[];for(var i in e)e.hasOwnProperty(i)&&t.push(i+"="+e[i]);return t.join("&")}})},function(e,t,i){var n=i(12),a=i(919),s=i(9);t.default=s.default.extend({routes:["/unsubscribe/favourites"],run:function(e){n.default.prototype.run(e),(new a.default).execute(e)}})},function(e,t,i){var n=i(1),a=i(5),s=i(6),o=i(920),r=i(921),l=i(330),d=i(212),u=i(37),c=i(159),p=i(310),f=i(3),h=i(352);t.default=s.default.extend({FAVOURITE_PAGE_TYPE:"queue",NEW_SERIES_PAGE_TYPE:"subscribe",CONTENT_OBJECT_TYPE_IN_PUSHER:"1",COMPILATION_OBJECT_TYPE_IN_PUSHER:"2",ADD_ACTION:"add",FAVOURITE_PAGE_TYPE_GROOT:1,NEW_EPISODES_PAGE_TYPE_GROOT:2,isFavouritesPage:!1,ALLOWED_GET_PARAMS:["action","app_version","delivery_id","email","favourite_type","id","object_type","user_id","sign"],run:function(){var e=this.decodedQueryParams.email,t=this.queryParams.action===this.ADD_ACTION,i=n(".js-action-already-done").length>0;this.isFavouritesPage=this.queryParams.favourite_type===this.FAVOURITE_PAGE_TYPE;var s=this.queryParams.object_type===this.COMPILATION_OBJECT_TYPE_IN_PUSHER?c.default.prototype.CONTENT_TYPE:p.default.prototype.CONTENT_TYPE;if(t)i||this.onAddToFavorites();else{this.listenTo(h.default,"unsubscribe:favouritesAdd",this.onAddToFavorites),this.listenTo(h.default,"unsubscribe:favouritesDelete",this.onDeleteFromFavourites);var f=a.pick(this.decodedQueryParams,this.ALLOWED_GET_PARAMS);this.isFavouritesPage?new r.default({requestParamsWithSign:f,email:e,objectType:s,model:new d.FavouriteModel}):new o.default({requestParamsWithSign:f,email:e,model:new l.default(null,new u.default)})}},onAddToFavorites:function(){f.default.track("favourites_sub",this.getGrootParams())},onDeleteFromFavourites:function(){f.default.track("favourites_unsub",this.getGrootParams())},getGrootParams:function(){return{delivery_id:this.queryParams.delivery_id,object_id:this.queryParams.id,object_type:this.queryParams.object_type,favourite_type:this.isFavouritesPage?this.FAVOURITE_PAGE_TYPE_GROOT:this.NEW_EPISODES_PAGE_TYPE_GROOT}}})},function(e,t,i){var n=i(351);t.default=n.default.extend({clickUnsubscribe:function(){var e=this;this.model.deleteUsingSign(this.requestParamsWithSign).always(function(t){e.onFavouritesDelete(t)})},clickSubscribe:function(){var e=this;this.model.addUsingSign(this.requestParamsWithSign).always(function(t){e.onFavouritesAdd(t)})}})},function(e,t,i){var n=i(351);t.default=n.default.extend({clickUnsubscribe:function(){var e=this;this.model.deleteUsingSign(this.objectType,this.requestParamsWithSign).always(function(t){e.onFavouritesDelete(t)})},clickSubscribe:function(){var e=this;this.model.addUsingSign(this.objectType,this.requestParamsWithSign).always(function(t){e.onFavouritesAdd(t)})}})},function(e,t,i){var n=i(12),a=i(923),s=i(924),o=i(9);t.default=o.default.extend({routes:["/subscribe"],run:function(e){n.default.prototype.run(e),(new a.default).execute(e),(new s.default).execute(e)}})},function(e,t,i){var n=i(6),a=i(138);t.default=n.default.extend({enablePseudoRoute:!0,run:function(){new a.default({redirectUrl:this.queryParams.redirect_url,from:this.queryParams.from,objectId:this.queryParams.object_id,objectType:this.queryParams.object_type}).render()}})},function(e,t,i){var n=i(6),a=i(925);t.default=n.default.extend({run:function(){new a.default({from:this.queryParams.from,objectId:this.queryParams.object_id,objectType:this.queryParams.object_type})}})},function(e,t,i){var n=i(1),a=i(0),s=i(3),o=i(36),r=i(44);t.default=a.View.extend({el:".page-wrapper",currentPosition:null,from:null,events:{"click .js-buy":"buyClick"},objectId:null,objectType:null,initialize:function(e){this.from=e.from||"subscription_megalanding",this.objectId=parseInt(e.objectId,10),this.objectType=e.objectType||o.default.prototype.SUBSCRIPTION_OBJECT_TYPE,n(window).scroll(this.checkSection),s.default.track("price_selection",this.getSubscriptionGrootParams())},checkSection:function(){var e=this,t=n(window);n(".js-landing-block").each(function(i,a){var o=n(a),r=t.scrollTop(),l=r+t.height(),d=o.offset().top;if(d+o.height()<l&&d>r&&i!==e.currentPosition)return e.currentPosition=i,s.default.rewriteSuperProperties({block_id:o.data("block-id")}),s.default.track("page_scroll",{position:i}),!1})},buyClick:function(e){var t=n(e.currentTarget),i=t.closest(".js-landing-block"),a=this.objectId||t.data("id");s.default.track("price_click",this.getSubscriptionGrootParams(i.data("block-id"))),r.default.viewBasket(a,this.objectType,t.data("price"))},getSubscriptionGrootParams:function(e){var t={is_trybuy:s.default.isTrialAvailable()?1:0,from:this.from,m_svod:1};return e&&(t.landing_from=e),t}})},function(e,t,i){var n=i(12),a=i(927),s=i(9);t.default=s.default.extend({routes:["/subscribe/period"],run:function(e){n.default.prototype.run(e),(new a.default).execute(e)}})},function(e,t,i){var n=i(6),a=i(928);t.default=n.default.extend({run:function(){this.longSubscriptionsView=new a.default({redirectUrl:this.queryParams.redirect_url,from:this.queryParams.from,landingFrom:this.queryParams.landing_from}),this.longSubscriptionsView.render()}})},function(e,t,i){var n=i(1),a=i(0),s=i(3),o=i(200);t.default=a.View.extend({el:".page-wrapper",redirectUrl:null,from:null,landingFrom:null,purchaseOptionList:null,subscriptionPackView:null,events:{"click .js-buy":"sendGrootBuyClick"},initialize:function(e){this.redirectUrl=e.redirectUrl||"/plus",this.from=e.from||"svod_period",this.landingFrom=e.landingFrom;var t={from:this.from,is_trybuy:s.default.isTrialAvailable()?1:0,object_type:"subscription"};this.landingFrom&&(t.landing_from=this.landingFrom),s.default.track("svod_selection",t),this.subscriptionPackView=new o.default({from:this.from,redirectUrl:this.redirectUrl,landingFrom:this.landingFrom}),this.subscriptionPackView.requestSubscriptionPurchaseOptionsList()},sendGrootBuyClick:function(e){var t=n(e.currentTarget),i={from:this.from,is_trybuy:s.default.isTrialAvailable()?1:0,object_type:"subscription",price_svod:t.data("price"),svod_period:t.data("period")};this.landingFrom&&(i.landing_from=this.landingFrom),s.default.track("svod_period_click",i)}})},function(e,t,i){var n=i(930),a=i(9),s=i(12);t.default=a.default.extend({routes:["/spasibo.*"],run:function(e){s.default.prototype.run(e),(new n.default).run(e)}})},function(e,t,i){var n=i(33),a=i(931);t.default=n.default.extend({run:function(){(new a.default).render()}})},function(e,t,i){var n=i(1),a=i(138),s=i(3),o=i(200),r=i(4);t.default=a.default.extend({el:".page-wrapper",events:{"click .js-buy":"handleBuyClick","click .js-buy-trial":"handleBuyClick"},subscriptionPackView:null,initialize:function(e){void 0===e&&(e={}),a.default.prototype.initialize.call(this,{from:e.from||"sb_landing"}),s.default.track("price_selection",this.getSubscriptionGrootParams()),this.subscriptionPackView=new o.default},reloadPage:function(){r.default.getLocation().reload()},handleBuyClick:function(e){this.trackGrootParams(e),n(e.currentTarget).hasClass("js-buy-trial")&&this.subscriptionPackView.buyClick(e)},trackGrootParams:function(e){var t=n(e.currentTarget).closest(".js-landing-block"),i=t.data("block-id"),a="svod_period_click";i&&"spasibo_trial"===i&&(a="price_click"),s.default.track(a,this.getSubscriptionGrootParams())},getSubscriptionGrootParams:function(){return{is_trybuy:s.default.isTrialAvailable()?1:0,from:this.from,m_svod:1}}})},function(e,t,i){var n=i(12),a=i(933),s=i(9);t.default=s.default.extend({routes:["/tvchannels.*"],run:function(e){n.default.prototype.run(e),(new a.default).execute(e)}})},function(e,t,i){var n=i(33);t.default=n.default.extend({afterLogin:function(){window.TVChannelsApplication&&new window.TVChannelsApplication.default}})}]);